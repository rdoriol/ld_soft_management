1731524482
waR3U4bTeM%3Af4ee3da7f27f4a7ead227e0a2383baec-2bf0526ee7f573393186ee208e103d1e
s:363944:"TzozMzoicGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlIjoxNDp7czo0MzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcRmlsZQBkb2NCbG9jayI7TjtzOjM5OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlAGhhc2giO3M6MzI6IjJiZjA1MjZlZTdmNTczMzkzMTg2ZWUyMDhlMTAzZDFlIjtzOjM5OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlAG5hbWUiO3M6NzoiVGFnLnBocCI7czozOToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcRmlsZQBwYXRoIjtzOjI0OiJ2ZW5kb3IvbXBkZi9tcGRmL1RhZy5waHAiO3M6NDE6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXEZpbGUAc291cmNlIjtzOjI2MTg2MToiPD9waHAKCmNsYXNzIFRhZwp7CgoJcHJpdmF0ZSAkbXBkZjsKCglwdWJsaWMgZnVuY3Rpb24gX19jb25zdHJ1Y3QobVBERiAkbXBkZikKCXsKCQkkdGhpcy0+bXBkZiA9ICRtcGRmOwoJfQoKCWZ1bmN0aW9uIE9wZW5UYWcoJHRhZywgJGF0dHIsICYkYWh0bWwsICYkaWh0bWwpCgl7IC8vIG1QREYgNgoJCS8vT3BlbmluZyB0YWcKCQkvLyBtUERGIDYKCQkvLyBDb3JyZWN0IGZvciB0YWdzIHdoZXJlIEhUTUw1IHNwZWNpZmllcyBvcHRpb25hbCBlbmQgdGFncyBleGNsdWRpbmcgdGFibGUgZWxlbWVudHMgKGNmIFdyaXRlSFRNTCgpICkKCQlpZiAoJHRoaXMtPm1wZGYtPmFsbG93X2h0bWxfb3B0aW9uYWxfZW5kdGFncykgewoJCQlpZiAoaXNzZXQoJHRoaXMtPm1wZGYtPmJsa1skdGhpcy0+bXBkZi0+YmxrbHZsXVsndGFnJ10pKSB7CgkJCQkkY2xvc2VkID0gZmFsc2U7CgkJCQkvLyBsaSBlbmQgdGFnIG1heSBiZSBvbWl0dGVkIGlmIGltbWVkaWF0ZWx5IGZvbGxvd2VkIGJ5IGFub3RoZXIgbGkgZWxlbWVudAoJCQkJaWYgKCEkY2xvc2VkICYmICR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ3RhZyddID09ICdMSScgJiYgJHRhZyA9PSAnTEknKSB7CgkJCQkJJHRoaXMtPkNsb3NlVGFnKCdMSScsICRhaHRtbCwgJGlodG1sKTsKCQkJCQkkY2xvc2VkID0gdHJ1ZTsKCQkJCX0KCQkJCS8vIGR0IGVuZCB0YWcgbWF5IGJlIG9taXR0ZWQgaWYgaW1tZWRpYXRlbHkgZm9sbG93ZWQgYnkgYW5vdGhlciBkdCBlbGVtZW50IG9yIGEgZGQgZWxlbWVudAoJCQkJaWYgKCEkY2xvc2VkICYmICR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ3RhZyddID09ICdEVCcgJiYgKCR0YWcgPT0gJ0RUJyB8fCAkdGFnID09ICdERCcpKSB7CgkJCQkJJHRoaXMtPkNsb3NlVGFnKCdEVCcsICRhaHRtbCwgJGlodG1sKTsKCQkJCQkkY2xvc2VkID0gdHJ1ZTsKCQkJCX0KCQkJCS8vIGRkIGVuZCB0YWcgbWF5IGJlIG9taXR0ZWQgaWYgaW1tZWRpYXRlbHkgZm9sbG93ZWQgYnkgYW5vdGhlciBkZCBlbGVtZW50IG9yIGEgZHQgZWxlbWVudAoJCQkJaWYgKCEkY2xvc2VkICYmICR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ3RhZyddID09ICdERCcgJiYgKCR0YWcgPT0gJ0RUJyB8fCAkdGFnID09ICdERCcpKSB7CgkJCQkJJHRoaXMtPkNsb3NlVGFnKCdERCcsICRhaHRtbCwgJGlodG1sKTsKCQkJCQkkY2xvc2VkID0gdHJ1ZTsKCQkJCX0KCQkJCS8vIHAgZW5kIHRhZyBtYXkgYmUgb21pdHRlZCBpZiBpbW1lZGlhdGVseSBmb2xsb3dlZCBieSBhbiBhZGRyZXNzLCBhcnRpY2xlLCBhc2lkZSwgYmxvY2txdW90ZSwgZGl2LCBkbCwgZmllbGRzZXQsIGZvcm0sCgkJCQkvLyBoMSwgaDIsIGgzLCBoNCwgaDUsIGg2LCBoZ3JvdXAsIGhyLCBtYWluLCBuYXYsIG9sLCBwLCBwcmUsIHNlY3Rpb24sIHRhYmxlLCB1bAoJCQkJaWYgKCEkY2xvc2VkICYmICR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ3RhZyddID09ICdQJyAmJiAoJHRhZyA9PSAnUCcgfHwgJHRhZyA9PSAnRElWJyB8fCAkdGFnID09ICdIMScgfHwgJHRhZyA9PSAnSDInIHx8ICR0YWcgPT0gJ0gzJyB8fCAkdGFnID09ICdINCcgfHwgJHRhZyA9PSAnSDUnIHx8ICR0YWcgPT0gJ0g2JyB8fCAkdGFnID09ICdVTCcgfHwgJHRhZyA9PSAnT0wnIHx8ICR0YWcgPT0gJ1RBQkxFJyB8fCAkdGFnID09ICdQUkUnIHx8ICR0YWcgPT0gJ0ZPUk0nIHx8ICR0YWcgPT0gJ0FERFJFU1MnIHx8ICR0YWcgPT0gJ0JMT0NLUVVPVEUnIHx8ICR0YWcgPT0gJ0NFTlRFUicgfHwgJHRhZyA9PSAnREwnIHx8ICR0YWcgPT0gJ0hSJyB8fCAkdGFnID09ICdBUlRJQ0xFJyB8fCAkdGFnID09ICdBU0lERScgfHwgJHRhZyA9PSAnRklFTERTRVQnIHx8ICR0YWcgPT0gJ0hHUk9VUCcgfHwgJHRhZyA9PSAnTUFJTicgfHwgJHRhZyA9PSAnTkFWJyB8fCAkdGFnID09ICdTRUNUSU9OJykpIHsKCQkJCQkkdGhpcy0+Q2xvc2VUYWcoJ1AnLCAkYWh0bWwsICRpaHRtbCk7CgkJCQkJJGNsb3NlZCA9IHRydWU7CgkJCQl9CgkJCQkvLyBvcHRpb24gZW5kIHRhZyBtYXkgYmUgb21pdHRlZCBpZiBpbW1lZGlhdGVseSBmb2xsb3dlZCBieSBhbm90aGVyIG9wdGlvbiBlbGVtZW50IChvciBpZiBpdCBpcyBpbW1lZGlhdGVseSBmb2xsb3dlZCBieSBhbiBvcHRncm91cCBlbGVtZW50KQoJCQkJaWYgKCEkY2xvc2VkICYmICR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ3RhZyddID09ICdPUFRJT04nICYmICR0YWcgPT0gJ09QVElPTicpIHsKCQkJCQkkdGhpcy0+Q2xvc2VUYWcoJ09QVElPTicsICRhaHRtbCwgJGlodG1sKTsKCQkJCQkkY2xvc2VkID0gdHJ1ZTsKCQkJCX0KCQkJCS8vIFRhYmxlIGVsZW1lbnRzIC0gc2VlIGFsc28gV3JpdGVIVE1MKCkKCQkJCWlmICghJGNsb3NlZCAmJiAoJHRhZyA9PSAnVEQnIHx8ICR0YWcgPT0gJ1RIJykgJiYgJHRoaXMtPm1wZGYtPmxhc3RvcHRpb25hbHRhZyA9PSAnVEQnKSB7CgkJCQkJJHRoaXMtPkNsb3NlVGFnKCR0aGlzLT5tcGRmLT5sYXN0b3B0aW9uYWx0YWcsICRhaHRtbCwgJGlodG1sKTsKCQkJCQkkY2xvc2VkID0gdHJ1ZTsKCQkJCX0gLy8gKlRBQkxFUyoKCQkJCWlmICghJGNsb3NlZCAmJiAoJHRhZyA9PSAnVEQnIHx8ICR0YWcgPT0gJ1RIJykgJiYgJHRoaXMtPm1wZGYtPmxhc3RvcHRpb25hbHRhZyA9PSAnVEgnKSB7CgkJCQkJJHRoaXMtPkNsb3NlVGFnKCR0aGlzLT5tcGRmLT5sYXN0b3B0aW9uYWx0YWcsICRhaHRtbCwgJGlodG1sKTsKCQkJCQkkY2xvc2VkID0gdHJ1ZTsKCQkJCX0gLy8gKlRBQkxFUyoKCQkJCWlmICghJGNsb3NlZCAmJiAkdGFnID09ICdUUicgJiYgJHRoaXMtPm1wZGYtPmxhc3RvcHRpb25hbHRhZyA9PSAnVFInKSB7CgkJCQkJJHRoaXMtPkNsb3NlVGFnKCR0aGlzLT5tcGRmLT5sYXN0b3B0aW9uYWx0YWcsICRhaHRtbCwgJGlodG1sKTsKCQkJCQkkY2xvc2VkID0gdHJ1ZTsKCQkJCX0gLy8gKlRBQkxFUyoKCQkJCWlmICghJGNsb3NlZCAmJiAkdGFnID09ICdUUicgJiYgJHRoaXMtPm1wZGYtPmxhc3RvcHRpb25hbHRhZyA9PSAnVEQnKSB7CgkJCQkJJHRoaXMtPkNsb3NlVGFnKCR0aGlzLT5tcGRmLT5sYXN0b3B0aW9uYWx0YWcsICRhaHRtbCwgJGlodG1sKTsKCQkJCQkkdGhpcy0+Q2xvc2VUYWcoJ1RSJywgJGFodG1sLCAkaWh0bWwpOwoJCQkJCSR0aGlzLT5DbG9zZVRhZygnVEhFQUQnLCAkYWh0bWwsICRpaHRtbCk7CgkJCQkJJGNsb3NlZCA9IHRydWU7CgkJCQl9IC8vICpUQUJMRVMqCgkJCQlpZiAoISRjbG9zZWQgJiYgJHRhZyA9PSAnVFInICYmICR0aGlzLT5tcGRmLT5sYXN0b3B0aW9uYWx0YWcgPT0gJ1RIJykgewoJCQkJCSR0aGlzLT5DbG9zZVRhZygkdGhpcy0+bXBkZi0+bGFzdG9wdGlvbmFsdGFnLCAkYWh0bWwsICRpaHRtbCk7CgkJCQkJJHRoaXMtPkNsb3NlVGFnKCdUUicsICRhaHRtbCwgJGlodG1sKTsKCQkJCQkkdGhpcy0+Q2xvc2VUYWcoJ1RIRUFEJywgJGFodG1sLCAkaWh0bWwpOwoJCQkJCSRjbG9zZWQgPSB0cnVlOwoJCQkJfSAvLyAqVEFCTEVTKgoJCQl9CgkJfQoKCQkkYWxpZ24gPSBhcnJheSgnbGVmdCcgPT4gJ0wnLCAnY2VudGVyJyA9PiAnQycsICdyaWdodCcgPT4gJ1InLCAndG9wJyA9PiAnVCcsICd0ZXh0LXRvcCcgPT4gJ1RUJywgJ21pZGRsZScgPT4gJ00nLCAnYmFzZWxpbmUnID0+ICdCUycsICdib3R0b20nID0+ICdCJywgJ3RleHQtYm90dG9tJyA9PiAnVEInLCAnanVzdGlmeScgPT4gJ0onKTsKCgkJc3dpdGNoICgkdGFnKSB7CgoJCQljYXNlICdET1RUQUInOgoJCQkJJG9iamF0dHIgPSBhcnJheSgpOwoJCQkJJG9iamF0dHJbJ3R5cGUnXSA9ICdkb3R0YWInOwoJCQkJJGRvdHMgPSBzdHJfcmVwZWF0KCcuJywgMykgLiAiICAiOyAvLyBtaW5pbXVtIG51bWJlciBvZiBkb3RzCgkJCQkkb2JqYXR0clsnd2lkdGgnXSA9ICR0aGlzLT5tcGRmLT5HZXRTdHJpbmdXaWR0aCgkZG90cyk7CgkJCQkkb2JqYXR0clsnbWFyZ2luX3RvcCddID0gMDsKCQkJCSRvYmphdHRyWydtYXJnaW5fYm90dG9tJ10gPSAwOwoJCQkJJG9iamF0dHJbJ21hcmdpbl9sZWZ0J10gPSAwOwoJCQkJJG9iamF0dHJbJ21hcmdpbl9yaWdodCddID0gMDsKCQkJCSRvYmphdHRyWydoZWlnaHQnXSA9IDA7CgkJCQkkb2JqYXR0clsnY29sb3JhcnJheSddID0gJHRoaXMtPm1wZGYtPmNvbG9yYXJyYXk7CgkJCQkkb2JqYXR0clsnYm9yZGVyX3RvcCddWyd3J10gPSAwOwoJCQkJJG9iamF0dHJbJ2JvcmRlcl9ib3R0b20nXVsndyddID0gMDsKCQkJCSRvYmphdHRyWydib3JkZXJfbGVmdCddWyd3J10gPSAwOwoJCQkJJG9iamF0dHJbJ2JvcmRlcl9yaWdodCddWyd3J10gPSAwOwoJCQkJJG9iamF0dHJbJ3ZlcnRpY2FsX2FsaWduJ10gPSAnQlMnOyAvLyBtUERGIDYgRE9UVEFCCgoJCQkJJHByb3BlcnRpZXMgPSAkdGhpcy0+bXBkZi0+Y3NzbWdyLT5NZXJnZUNTUygnSU5MSU5FJywgJHRhZywgJGF0dHIpOwoJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydPVVRERU5UJ10pKSB7CgkJCQkJJG9iamF0dHJbJ291dGRlbnQnXSA9ICR0aGlzLT5tcGRmLT5Db252ZXJ0U2l6ZSgkcHJvcGVydGllc1snT1VUREVOVCddLCAkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWydpbm5lcl93aWR0aCddLCAkdGhpcy0+bXBkZi0+Rm9udFNpemUsIGZhbHNlKTsKCQkJCX0gZWxzZSBpZiAoaXNzZXQoJGF0dHJbJ09VVERFTlQnXSkpIHsKCQkJCQkkb2JqYXR0clsnb3V0ZGVudCddID0gJHRoaXMtPm1wZGYtPkNvbnZlcnRTaXplKCRhdHRyWydPVVRERU5UJ10sICR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ2lubmVyX3dpZHRoJ10sICR0aGlzLT5tcGRmLT5Gb250U2l6ZSwgZmFsc2UpOwoJCQkJfSBlbHNlIHsKCQkJCQkkb2JqYXR0clsnb3V0ZGVudCddID0gMDsKCQkJCX0KCgkJCQkkb2JqYXR0clsnZm9udGZhbWlseSddID0gJHRoaXMtPm1wZGYtPkZvbnRGYW1pbHk7CgkJCQkkb2JqYXR0clsnZm9udHNpemUnXSA9ICR0aGlzLT5tcGRmLT5Gb250U2l6ZVB0OwoKCQkJCSRlID0gIlx4YmJceGE0XHhhY3R5cGU9ZG90dGFiLG9iamF0dHI9IiAuIHNlcmlhbGl6ZSgkb2JqYXR0cikgLiAiXHhiYlx4YTRceGFjIjsKCQkJCS8qIC0tIFRBQkxFUyAtLSAqLwoJCQkJLy8gT3V0cHV0IGl0IHRvIGJ1ZmZlcnMKCQkJCWlmICgkdGhpcy0+bXBkZi0+dGFibGVMZXZlbCkgewoJCQkJCWlmICghaXNzZXQoJHRoaXMtPm1wZGYtPmNlbGxbJHRoaXMtPm1wZGYtPnJvd11bJHRoaXMtPm1wZGYtPmNvbF1bJ21heHMnXSkpIHsKCQkJCQkJJHRoaXMtPm1wZGYtPmNlbGxbJHRoaXMtPm1wZGYtPnJvd11bJHRoaXMtPm1wZGYtPmNvbF1bJ21heHMnXSA9ICR0aGlzLT5tcGRmLT5jZWxsWyR0aGlzLT5tcGRmLT5yb3ddWyR0aGlzLT5tcGRmLT5jb2xdWydzJ107CgkJCQkJfSBlbHNlaWYgKCR0aGlzLT5tcGRmLT5jZWxsWyR0aGlzLT5tcGRmLT5yb3ddWyR0aGlzLT5tcGRmLT5jb2xdWydtYXhzJ10gPCAkdGhpcy0+bXBkZi0+Y2VsbFskdGhpcy0+bXBkZi0+cm93XVskdGhpcy0+bXBkZi0+Y29sXVsncyddKSB7CgkJCQkJCSR0aGlzLT5tcGRmLT5jZWxsWyR0aGlzLT5tcGRmLT5yb3ddWyR0aGlzLT5tcGRmLT5jb2xdWydtYXhzJ10gPSAkdGhpcy0+bXBkZi0+Y2VsbFskdGhpcy0+bXBkZi0+cm93XVskdGhpcy0+bXBkZi0+Y29sXVsncyddOwoJCQkJCX0KCQkJCQkkdGhpcy0+bXBkZi0+Y2VsbFskdGhpcy0+bXBkZi0+cm93XVskdGhpcy0+bXBkZi0+Y29sXVsncyddID0gMDsgLy8gcmVzZXQKCQkJCQkkdGhpcy0+bXBkZi0+X3NhdmVDZWxsVGV4dEJ1ZmZlcigkZSk7CgkJCQl9IGVsc2UgewoJCQkJCS8qIC0tIEVORCBUQUJMRVMgLS0gKi8KCQkJCQkkdGhpcy0+bXBkZi0+X3NhdmVUZXh0QnVmZmVyKCRlKTsKCQkJCX0gLy8gKlRBQkxFUyoKCQkJCWJyZWFrOwoKCQkJY2FzZSAnUEFHRUhFQURFUic6CgkJCWNhc2UgJ1BBR0VGT09URVInOgoJCQkJJHRoaXMtPm1wZGYtPmlnbm9yZWZvbGxvd2luZ3NwYWNlcyA9IHRydWU7CgkJCQlpZiAoJGF0dHJbJ05BTUUnXSkgewoJCQkJCSRwbmFtZSA9ICRhdHRyWydOQU1FJ107CgkJCQl9IGVsc2UgewoJCQkJCSRwbmFtZSA9ICdfbm9uaHRtbGRlZmF1bHQnOwoJCQkJfSAvLyBtUERGIDYKCgkJCQkkcCA9IGFycmF5KCk7IC8vIG1QREYgNgoJCQkJJHBbJ0wnXSA9IGFycmF5KCk7CgkJCQkkcFsnQyddID0gYXJyYXkoKTsKCQkJCSRwWydSJ10gPSBhcnJheSgpOwoJCQkJJHBbJ0wnXVsnZm9udC1zdHlsZSddID0gJyc7CgkJCQkkcFsnQyddWydmb250LXN0eWxlJ10gPSAnJzsKCQkJCSRwWydSJ11bJ2ZvbnQtc3R5bGUnXSA9ICcnOwoKCQkJCWlmIChpc3NldCgkYXR0clsnQ09OVEVOVC1MRUZUJ10pKSB7CgkJCQkJJHBbJ0wnXVsnY29udGVudCddID0gJGF0dHJbJ0NPTlRFTlQtTEVGVCddOwoJCQkJfQoJCQkJaWYgKGlzc2V0KCRhdHRyWydDT05URU5ULUNFTlRFUiddKSkgewoJCQkJCSRwWydDJ11bJ2NvbnRlbnQnXSA9ICRhdHRyWydDT05URU5ULUNFTlRFUiddOwoJCQkJfQoJCQkJaWYgKGlzc2V0KCRhdHRyWydDT05URU5ULVJJR0hUJ10pKSB7CgkJCQkJJHBbJ1InXVsnY29udGVudCddID0gJGF0dHJbJ0NPTlRFTlQtUklHSFQnXTsKCQkJCX0KCgkJCQlpZiAoaXNzZXQoJGF0dHJbJ0hFQURFUi1TVFlMRSddKSB8fCBpc3NldCgkYXR0clsnRk9PVEVSLVNUWUxFJ10pKSB7IC8vIGZvbnQtZmFtaWx5LHNpemUsd2VpZ2h0LHN0eWxlLGNvbG9yCgkJCQkJaWYgKCR0YWcgPT0gJ1BBR0VIRUFERVInKSB7CgkJCQkJCSRwcm9wZXJ0aWVzID0gJHRoaXMtPm1wZGYtPmNzc21nci0+cmVhZElubGluZUNTUygkYXR0clsnSEVBREVSLVNUWUxFJ10pOwoJCQkJCX0gZWxzZSB7CgkJCQkJCSRwcm9wZXJ0aWVzID0gJHRoaXMtPm1wZGYtPmNzc21nci0+cmVhZElubGluZUNTUygkYXR0clsnRk9PVEVSLVNUWUxFJ10pOwoJCQkJCX0KCQkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ0ZPTlQtRkFNSUxZJ10pKSB7CgkJCQkJCSRwWydMJ11bJ2ZvbnQtZmFtaWx5J10gPSAkcHJvcGVydGllc1snRk9OVC1GQU1JTFknXTsKCQkJCQkJJHBbJ0MnXVsnZm9udC1mYW1pbHknXSA9ICRwcm9wZXJ0aWVzWydGT05ULUZBTUlMWSddOwoJCQkJCQkkcFsnUiddWydmb250LWZhbWlseSddID0gJHByb3BlcnRpZXNbJ0ZPTlQtRkFNSUxZJ107CgkJCQkJfQoJCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snRk9OVC1TSVpFJ10pKSB7CgkJCQkJCSRwWydMJ11bJ2ZvbnQtc2l6ZSddID0gJHRoaXMtPm1wZGYtPkNvbnZlcnRTaXplKCRwcm9wZXJ0aWVzWydGT05ULVNJWkUnXSkgKiBfTVBERks7CgkJCQkJCSRwWydDJ11bJ2ZvbnQtc2l6ZSddID0gJHRoaXMtPm1wZGYtPkNvbnZlcnRTaXplKCRwcm9wZXJ0aWVzWydGT05ULVNJWkUnXSkgKiBfTVBERks7CgkJCQkJCSRwWydSJ11bJ2ZvbnQtc2l6ZSddID0gJHRoaXMtPm1wZGYtPkNvbnZlcnRTaXplKCRwcm9wZXJ0aWVzWydGT05ULVNJWkUnXSkgKiBfTVBERks7CgkJCQkJfQoJCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snRk9OVC1XRUlHSFQnXSkgJiYgJHByb3BlcnRpZXNbJ0ZPTlQtV0VJR0hUJ10gPT0gJ2JvbGQnKSB7CgkJCQkJCSRwWydMJ11bJ2ZvbnQtc3R5bGUnXSA9ICdCJzsKCQkJCQkJJHBbJ0MnXVsnZm9udC1zdHlsZSddID0gJ0InOwoJCQkJCQkkcFsnUiddWydmb250LXN0eWxlJ10gPSAnQic7CgkJCQkJfQoJCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snRk9OVC1TVFlMRSddKSAmJiAkcHJvcGVydGllc1snRk9OVC1TVFlMRSddID09ICdpdGFsaWMnKSB7CgkJCQkJCSRwWydMJ11bJ2ZvbnQtc3R5bGUnXSAuPSAnSSc7CgkJCQkJCSRwWydDJ11bJ2ZvbnQtc3R5bGUnXSAuPSAnSSc7CgkJCQkJCSRwWydSJ11bJ2ZvbnQtc3R5bGUnXSAuPSAnSSc7CgkJCQkJfQoJCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snQ09MT1InXSkpIHsKCQkJCQkJJHBbJ0wnXVsnY29sb3InXSA9ICRwcm9wZXJ0aWVzWydDT0xPUiddOwoJCQkJCQkkcFsnQyddWydjb2xvciddID0gJHByb3BlcnRpZXNbJ0NPTE9SJ107CgkJCQkJCSRwWydSJ11bJ2NvbG9yJ10gPSAkcHJvcGVydGllc1snQ09MT1InXTsKCQkJCQl9CgkJCQl9CgkJCQlpZiAoaXNzZXQoJGF0dHJbJ0hFQURFUi1TVFlMRS1MRUZUJ10pIHx8IGlzc2V0KCRhdHRyWydGT09URVItU1RZTEUtTEVGVCddKSkgewoJCQkJCWlmICgkdGFnID09ICdQQUdFSEVBREVSJykgewoJCQkJCQkkcHJvcGVydGllcyA9ICR0aGlzLT5tcGRmLT5jc3NtZ3ItPnJlYWRJbmxpbmVDU1MoJGF0dHJbJ0hFQURFUi1TVFlMRS1MRUZUJ10pOwoJCQkJCX0gZWxzZSB7CgkJCQkJCSRwcm9wZXJ0aWVzID0gJHRoaXMtPm1wZGYtPmNzc21nci0+cmVhZElubGluZUNTUygkYXR0clsnRk9PVEVSLVNUWUxFLUxFRlQnXSk7CgkJCQkJfQoJCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snRk9OVC1GQU1JTFknXSkpIHsKCQkJCQkJJHBbJ0wnXVsnZm9udC1mYW1pbHknXSA9ICRwcm9wZXJ0aWVzWydGT05ULUZBTUlMWSddOwoJCQkJCX0KCQkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ0ZPTlQtU0laRSddKSkgewoJCQkJCQkkcFsnTCddWydmb250LXNpemUnXSA9ICR0aGlzLT5tcGRmLT5Db252ZXJ0U2l6ZSgkcHJvcGVydGllc1snRk9OVC1TSVpFJ10pICogX01QREZLOwoJCQkJCX0KCQkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ0ZPTlQtV0VJR0hUJ10pICYmICRwcm9wZXJ0aWVzWydGT05ULVdFSUdIVCddID09ICdib2xkJykgewoJCQkJCQkkcFsnTCddWydmb250LXN0eWxlJ10gPSAnQic7CgkJCQkJfQoJCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snRk9OVC1TVFlMRSddKSAmJiAkcHJvcGVydGllc1snRk9OVC1TVFlMRSddID09ICdpdGFsaWMnKSB7CgkJCQkJCSRwWydMJ11bJ2ZvbnQtc3R5bGUnXSAuPSdJJzsKCQkJCQl9CgkJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydDT0xPUiddKSkgewoJCQkJCQkkcFsnTCddWydjb2xvciddID0gJHByb3BlcnRpZXNbJ0NPTE9SJ107CgkJCQkJfQoJCQkJfQoJCQkJaWYgKGlzc2V0KCRhdHRyWydIRUFERVItU1RZTEUtQ0VOVEVSJ10pIHx8IGlzc2V0KCRhdHRyWydGT09URVItU1RZTEUtQ0VOVEVSJ10pKSB7CgkJCQkJaWYgKCR0YWcgPT0gJ1BBR0VIRUFERVInKSB7CgkJCQkJCSRwcm9wZXJ0aWVzID0gJHRoaXMtPm1wZGYtPmNzc21nci0+cmVhZElubGluZUNTUygkYXR0clsnSEVBREVSLVNUWUxFLUNFTlRFUiddKTsKCQkJCQl9IGVsc2UgewoJCQkJCQkkcHJvcGVydGllcyA9ICR0aGlzLT5tcGRmLT5jc3NtZ3ItPnJlYWRJbmxpbmVDU1MoJGF0dHJbJ0ZPT1RFUi1TVFlMRS1DRU5URVInXSk7CgkJCQkJfQoJCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snRk9OVC1GQU1JTFknXSkpIHsKCQkJCQkJJHBbJ0MnXVsnZm9udC1mYW1pbHknXSA9ICRwcm9wZXJ0aWVzWydGT05ULUZBTUlMWSddOwoJCQkJCX0KCQkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ0ZPTlQtU0laRSddKSkgewoJCQkJCQkkcFsnQyddWydmb250LXNpemUnXSA9ICR0aGlzLT5tcGRmLT5Db252ZXJ0U2l6ZSgkcHJvcGVydGllc1snRk9OVC1TSVpFJ10pICogX01QREZLOwoJCQkJCX0KCQkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ0ZPTlQtV0VJR0hUJ10pICYmICRwcm9wZXJ0aWVzWydGT05ULVdFSUdIVCddID09ICdib2xkJykgewoJCQkJCQkkcFsnQyddWydmb250LXN0eWxlJ10gPSAnQic7CgkJCQkJfQoJCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snRk9OVC1TVFlMRSddKSAmJiAkcHJvcGVydGllc1snRk9OVC1TVFlMRSddID09ICdpdGFsaWMnKSB7CgkJCQkJCSRwWydDJ11bJ2ZvbnQtc3R5bGUnXSAuPSAnSSc7CgkJCQkJfQoJCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snQ09MT1InXSkpIHsKCQkJCQkJJHBbJ0MnXVsnY29sb3InXSA9ICRwcm9wZXJ0aWVzWydDT0xPUiddOwoJCQkJCX0KCQkJCX0KCQkJCWlmIChpc3NldCgkYXR0clsnSEVBREVSLVNUWUxFLVJJR0hUJ10pIHx8IGlzc2V0KCRhdHRyWydGT09URVItU1RZTEUtUklHSFQnXSkpIHsKCQkJCQlpZiAoJHRhZyA9PSAnUEFHRUhFQURFUicpIHsKCQkJCQkJJHByb3BlcnRpZXMgPSAkdGhpcy0+bXBkZi0+Y3NzbWdyLT5yZWFkSW5saW5lQ1NTKCRhdHRyWydIRUFERVItU1RZTEUtUklHSFQnXSk7CgkJCQkJfSBlbHNlIHsKCQkJCQkJJHByb3BlcnRpZXMgPSAkdGhpcy0+bXBkZi0+Y3NzbWdyLT5yZWFkSW5saW5lQ1NTKCRhdHRyWydGT09URVItU1RZTEUtUklHSFQnXSk7CgkJCQkJfQoJCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snRk9OVC1GQU1JTFknXSkpIHsKCQkJCQkJJHBbJ1InXVsnZm9udC1mYW1pbHknXSA9ICRwcm9wZXJ0aWVzWydGT05ULUZBTUlMWSddOwoJCQkJCX0KCQkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ0ZPTlQtU0laRSddKSkgewoJCQkJCQkkcFsnUiddWydmb250LXNpemUnXSA9ICR0aGlzLT5tcGRmLT5Db252ZXJ0U2l6ZSgkcHJvcGVydGllc1snRk9OVC1TSVpFJ10pICogX01QREZLOwoJCQkJCX0KCQkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ0ZPTlQtV0VJR0hUJ10pICYmICRwcm9wZXJ0aWVzWydGT05ULVdFSUdIVCddID09ICdib2xkJykgewoJCQkJCQkkcFsnUiddWydmb250LXN0eWxlJ10gPSAnQic7CgkJCQkJfQoJCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snRk9OVC1TVFlMRSddKSAmJiAkcHJvcGVydGllc1snRk9OVC1TVFlMRSddID09ICdpdGFsaWMnKSB7CgkJCQkJCSRwWydSJ11bJ2ZvbnQtc3R5bGUnXSAuPSAnSSc7CgkJCQkJfQoJCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snQ09MT1InXSkpIHsKCQkJCQkJJHBbJ1InXVsnY29sb3InXSA9ICRwcm9wZXJ0aWVzWydDT0xPUiddOwoJCQkJCX0KCQkJCX0KCQkJCWlmIChpc3NldCgkYXR0clsnTElORSddKSAmJiAkYXR0clsnTElORSddKSB7IC8vIDB8MXxvbnxvZmYKCQkJCQlpZiAoJGF0dHJbJ0xJTkUnXSA9PSAnMScgfHwgc3RydG91cHBlcigkYXR0clsnTElORSddKSA9PSAnT04nKSB7CgkJCQkJCSRsaW5lc2V0ID0gMTsKCQkJCQl9IGVsc2UgewoJCQkJCQkkbGluZXNldCA9IDA7CgkJCQkJfQoJCQkJCSRwWydsaW5lJ10gPSAkbGluZXNldDsKCQkJCX0KCQkJCS8vIG1QREYgNgoJCQkJaWYgKCR0YWcgPT0gJ1BBR0VIRUFERVInKSB7CgkJCQkJJHRoaXMtPm1wZGYtPkRlZkhlYWRlckJ5TmFtZSgkcG5hbWUsICRwKTsKCQkJCX0gZWxzZSB7CgkJCQkJJHRoaXMtPm1wZGYtPkRlZkZvb3RlckJ5TmFtZSgkcG5hbWUsICRwKTsKCQkJCX0KCQkJCWJyZWFrOwoKCgkJCWNhc2UgJ1NFVFBBR0VIRUFERVInOiAvLyBtUERGIDYKCQkJY2FzZSAnU0VUUEFHRUZPT1RFUic6CgkJCWNhc2UgJ1NFVEhUTUxQQUdFSEVBREVSJzoKCQkJY2FzZSAnU0VUSFRNTFBBR0VGT09URVInOgoJCQkJJHRoaXMtPm1wZGYtPmlnbm9yZWZvbGxvd2luZ3NwYWNlcyA9IHRydWU7CgkJCQlpZiAoaXNzZXQoJGF0dHJbJ05BTUUnXSkgJiYgJGF0dHJbJ05BTUUnXSkgewoJCQkJCSRwbmFtZSA9ICRhdHRyWydOQU1FJ107CgkJCQl9IGVsc2UgaWYgKCR0YWcgPT0gJ1NFVFBBR0VIRUFERVInIHx8ICR0YWcgPT0gJ1NFVFBBR0VGT09URVInKSB7CgkJCQkJJHBuYW1lID0gJ19ub25odG1sZGVmYXVsdCc7CgkJCQl9IC8vIG1QREYgNgoJCQkJZWxzZSB7CgkJCQkJJHBuYW1lID0gJ19kZWZhdWx0JzsKCQkJCX0KCQkJCWlmIChpc3NldCgkYXR0clsnUEFHRSddKSAmJiAkYXR0clsnUEFHRSddKSB7ICAvLyBPfG9kZHxldmVufEV8QUxMfFtibGFua10KCQkJCQlpZiAoc3RydG91cHBlcigkYXR0clsnUEFHRSddKSA9PSAnTycgfHwgc3RydG91cHBlcigkYXR0clsnUEFHRSddKSA9PSAnT0REJykgewoJCQkJCQkkc2lkZSA9ICdvZGQnOwoJCQkJCX0gZWxzZSBpZiAoc3RydG91cHBlcigkYXR0clsnUEFHRSddKSA9PSAnRScgfHwgc3RydG91cHBlcigkYXR0clsnUEFHRSddKSA9PSAnRVZFTicpIHsKCQkJCQkJJHNpZGUgPSAnZXZlbic7CgkJCQkJfSBlbHNlIGlmIChzdHJ0b3VwcGVyKCRhdHRyWydQQUdFJ10pID09ICdBTEwnKSB7CgkJCQkJCSRzaWRlID0gJ2JvdGgnOwoJCQkJCX0gZWxzZSB7CgkJCQkJCSRzaWRlID0gJ29kZCc7CgkJCQkJfQoJCQkJfSBlbHNlIHsKCQkJCQkkc2lkZSA9ICdvZGQnOwoJCQkJfQoJCQkJaWYgKGlzc2V0KCRhdHRyWydWQUxVRSddKSAmJiAkYXR0clsnVkFMVUUnXSkgeyAgLy8gLTF8MXxvbnxvZmYKCQkJCQlpZiAoJGF0dHJbJ1ZBTFVFJ10gPT0gJzEnIHx8IHN0cnRvdXBwZXIoJGF0dHJbJ1ZBTFVFJ10pID09ICdPTicpIHsKCQkJCQkJJHNldCA9IDE7CgkJCQkJfSBlbHNlIGlmICgkYXR0clsnVkFMVUUnXSA9PSAnLTEnIHx8IHN0cnRvdXBwZXIoJGF0dHJbJ1ZBTFVFJ10pID09ICdPRkYnKSB7CgkJCQkJCSRzZXQgPSAwOwoJCQkJCX0gZWxzZSB7CgkJCQkJCSRzZXQgPSAxOwoJCQkJCX0KCQkJCX0gZWxzZSB7CgkJCQkJJHNldCA9IDE7CgkJCQl9CgkJCQlpZiAoaXNzZXQoJGF0dHJbJ1NIT1ctVEhJUy1QQUdFJ10pICYmICRhdHRyWydTSE9XLVRISVMtUEFHRSddICYmICgkdGFnID09ICdTRVRIVE1MUEFHRUhFQURFUicgfHwgJHRhZyA9PSAnU0VUUEFHRUhFQURFUicpKSB7CgkJCQkJJHdyaXRlID0gMTsKCQkJCX0gZWxzZSB7CgkJCQkJJHdyaXRlID0gMDsKCQkJCX0KCQkJCWlmICgkc2lkZSA9PSAnb2RkJyB8fCAkc2lkZSA9PSAnYm90aCcpIHsKCQkJCQlpZiAoJHNldCAmJiAoJHRhZyA9PSAnU0VUSFRNTFBBR0VIRUFERVInIHx8ICR0YWcgPT0gJ1NFVFBBR0VIRUFERVInKSkgewoJCQkJCQkkdGhpcy0+bXBkZi0+U2V0SFRNTEhlYWRlcigkdGhpcy0+bXBkZi0+cGFnZUhUTUxoZWFkZXJzWyRwbmFtZV0sICdPJywgJHdyaXRlKTsKCQkJCQl9IGVsc2UgaWYgKCRzZXQgJiYgKCR0YWcgPT0gJ1NFVEhUTUxQQUdFRk9PVEVSJyB8fCAkdGFnID09ICdTRVRQQUdFRk9PVEVSJykpIHsKCQkJCQkJJHRoaXMtPm1wZGYtPlNldEhUTUxGb290ZXIoJHRoaXMtPm1wZGYtPnBhZ2VIVE1MZm9vdGVyc1skcG5hbWVdLCAnTycpOwoJCQkJCX0gZWxzZSBpZiAoJHRhZyA9PSAnU0VUSFRNTFBBR0VIRUFERVInIHx8ICR0YWcgPT0gJ1NFVFBBR0VIRUFERVInKSB7CgkJCQkJCSR0aGlzLT5tcGRmLT5TZXRIVE1MSGVhZGVyKCcnLCAnTycpOwoJCQkJCX0gZWxzZSB7CgkJCQkJCSR0aGlzLT5tcGRmLT5TZXRIVE1MRm9vdGVyKCcnLCAnTycpOwoJCQkJCX0KCQkJCX0KCQkJCWlmICgkc2lkZSA9PSAnZXZlbicgfHwgJHNpZGUgPT0gJ2JvdGgnKSB7CgkJCQkJaWYgKCRzZXQgJiYgKCR0YWcgPT0gJ1NFVEhUTUxQQUdFSEVBREVSJyB8fCAkdGFnID09ICdTRVRQQUdFSEVBREVSJykpIHsKCQkJCQkJJHRoaXMtPm1wZGYtPlNldEhUTUxIZWFkZXIoJHRoaXMtPm1wZGYtPnBhZ2VIVE1MaGVhZGVyc1skcG5hbWVdLCAnRScsICR3cml0ZSk7CgkJCQkJfSBlbHNlIGlmICgkc2V0ICYmICgkdGFnID09ICdTRVRIVE1MUEFHRUZPT1RFUicgfHwgJHRhZyA9PSAnU0VUUEFHRUZPT1RFUicpKSB7CgkJCQkJCSR0aGlzLT5tcGRmLT5TZXRIVE1MRm9vdGVyKCR0aGlzLT5tcGRmLT5wYWdlSFRNTGZvb3RlcnNbJHBuYW1lXSwgJ0UnKTsKCQkJCQl9IGVsc2UgaWYgKCR0YWcgPT0gJ1NFVEhUTUxQQUdFSEVBREVSJyB8fCAkdGFnID09ICdTRVRQQUdFSEVBREVSJykgewoJCQkJCQkkdGhpcy0+bXBkZi0+U2V0SFRNTEhlYWRlcignJywgJ0UnKTsKCQkJCQl9IGVsc2UgewoJCQkJCQkkdGhpcy0+bXBkZi0+U2V0SFRNTEZvb3RlcignJywgJ0UnKTsKCQkJCQl9CgkJCQl9CgkJCQlicmVhazsKCgoKCQkJLyogLS0gVE9DIC0tICovCgkJCWNhc2UgJ1RPQyc6IC8vYWRkZWQgY3VzdG9tLXRhZyAtIHNldCBNYXJrZXIgZm9yIGluc2VydGlvbiBsYXRlciBvZiBUb0MKCQkJCWlmICghY2xhc3NfZXhpc3RzKCd0b2NvbnRlbnRzJywgZmFsc2UpKSB7CgkJCQkJaW5jbHVkZShfTVBERl9QQVRIIC4gJ2NsYXNzZXMvdG9jb250ZW50cy5waHAnKTsKCQkJCX0KCQkJCWlmIChlbXB0eSgkdGhpcy0+bXBkZi0+dG9jb250ZW50cykpIHsKCQkJCQkkdGhpcy0+bXBkZi0+dG9jb250ZW50cyA9IG5ldyB0b2NvbnRlbnRzKCR0aGlzKTsKCQkJCX0KCQkJCSR0aGlzLT5tcGRmLT50b2NvbnRlbnRzLT5vcGVuVGFnVE9DKCRhdHRyKTsKCQkJCWJyZWFrOwoKCgkJCWNhc2UgJ1RPQ1BBR0VCUkVBSyc6IC8vIGN1c3RvbS10YWcgLSBzZXQgTWFya2VyIGZvciBpbnNlcnRpb24gbGF0ZXIgb2YgVG9DIEFORCBhZGRzIFBBR0VCUkVBSwoJCQkJaWYgKCFjbGFzc19leGlzdHMoJ3RvY29udGVudHMnLCBmYWxzZSkpIHsKCQkJCQlpbmNsdWRlKF9NUERGX1BBVEggLiAnY2xhc3Nlcy90b2NvbnRlbnRzLnBocCcpOwoJCQkJfQoJCQkJaWYgKGVtcHR5KCR0aGlzLT5tcGRmLT50b2NvbnRlbnRzKSkgewoJCQkJCSR0aGlzLT5tcGRmLT50b2NvbnRlbnRzID0gbmV3IHRvY29udGVudHMoJHRoaXMtPm1wZGYpOwoJCQkJfQoJCQkJbGlzdCgkaXNicmVhaywgJHRvY19pZCkgPSAkdGhpcy0+bXBkZi0+dG9jb250ZW50cy0+b3BlblRhZ1RPQ1BBR0VCUkVBSygkYXR0cik7CgkJCQlpZiAoJGlzYnJlYWspCgkJCQkJYnJlYWs7CgkJCQlpZiAoIWlzc2V0KCRhdHRyWydSRVNFVFBBR0VOVU0nXSkgfHwgJGF0dHJbJ1JFU0VUUEFHRU5VTSddIDwgMSkgewoJCQkJCSRhdHRyWydSRVNFVFBBR0VOVU0nXSA9IDE7CgkJCQl9IC8vIG1QREYgNgoJCQkvLyBObyBicmVhayAtIGNvbnRpbnVlcyBhcyBQQUdFQlJFQUsuLi4KCQkJLyogLS0gRU5EIFRPQyAtLSAqLwoKCgkJCWNhc2UgJ1BBR0VfQlJFQUsnOiAvL2N1c3RvbS10YWcKCQkJY2FzZSAnUEFHRUJSRUFLJzogLy9jdXN0b20tdGFnCgkJCWNhc2UgJ05FV1BBR0UnOiAvL2N1c3RvbS10YWcKCQkJY2FzZSAnRk9STUZFRUQnOiAvL2N1c3RvbS10YWcKCgkJCQlpZiAoaXNzZXQoJGF0dHJbJ1NIRUVULVNJWkUnXSkpIHsKCQkJCQkvLyBDb252ZXJ0IHRvIHNhbWUgdHlwZXMgYXMgYWNjZXB0ZWQgaW4gaW5pdGlhbCBtUERGKCkgQTQsIEE0LUwsIG9yIGFycmF5KHcsaCkKCQkJCQkkcHJvcCA9IHByZWdfc3BsaXQoJy9ccysvJywgdHJpbSgkYXR0clsnU0hFRVQtU0laRSddKSk7CgkJCQkJaWYgKGNvdW50KCRwcm9wKSA9PSAyKSB7CgkJCQkJCSRuZXdmb3JtYXQgPSBhcnJheSgkdGhpcy0+bXBkZi0+Q29udmVydFNpemUoJHByb3BbMF0pLCAkdGhpcy0+bXBkZi0+Q29udmVydFNpemUoJHByb3BbMV0pKTsKCQkJCQl9IGVsc2UgewoJCQkJCQkkbmV3Zm9ybWF0ID0gJGF0dHJbJ1NIRUVULVNJWkUnXTsKCQkJCQl9CgkJCQl9IGVsc2UgewoJCQkJCSRuZXdmb3JtYXQgPSAnJzsKCQkJCX0KCgkJCQkkc2F2ZV9ibGtsdmwgPSAkdGhpcy0+bXBkZi0+YmxrbHZsOwoJCQkJJHNhdmVfYmxrID0gJHRoaXMtPm1wZGYtPmJsazsKCQkJCSRzYXZlX3NpbHAgPSAkdGhpcy0+bXBkZi0+c2F2ZUlubGluZVByb3BlcnRpZXMoKTsKCQkJCSRzYXZlX2lscCA9ICR0aGlzLT5tcGRmLT5JbmxpbmVQcm9wZXJ0aWVzOwoJCQkJJHNhdmVfYmZscCA9ICR0aGlzLT5tcGRmLT5JbmxpbmVCREY7CgkJCQkkc2F2ZV9iZmxwYyA9ICR0aGlzLT5tcGRmLT5JbmxpbmVCREZjdHI7IC8vIG1QREYgNgoKCQkJCSRtZ3IgPSAkbWdsID0gJG1ndCA9ICRtZ2IgPSAkbWdoID0gJG1nZiA9ICcnOwoJCQkJaWYgKGlzc2V0KCRhdHRyWydNQVJHSU4tUklHSFQnXSkpIHsKCQkJCQkkbWdyID0gJHRoaXMtPm1wZGYtPkNvbnZlcnRTaXplKCRhdHRyWydNQVJHSU4tUklHSFQnXSwgJHRoaXMtPm1wZGYtPncsICR0aGlzLT5tcGRmLT5Gb250U2l6ZSwgZmFsc2UpOwoJCQkJfQoJCQkJaWYgKGlzc2V0KCRhdHRyWydNQVJHSU4tTEVGVCddKSkgewoJCQkJCSRtZ2wgPSAkdGhpcy0+bXBkZi0+Q29udmVydFNpemUoJGF0dHJbJ01BUkdJTi1MRUZUJ10sICR0aGlzLT5tcGRmLT53LCAkdGhpcy0+bXBkZi0+Rm9udFNpemUsIGZhbHNlKTsKCQkJCX0KCQkJCWlmIChpc3NldCgkYXR0clsnTUFSR0lOLVRPUCddKSkgewoJCQkJCSRtZ3QgPSAkdGhpcy0+bXBkZi0+Q29udmVydFNpemUoJGF0dHJbJ01BUkdJTi1UT1AnXSwgJHRoaXMtPm1wZGYtPncsICR0aGlzLT5tcGRmLT5Gb250U2l6ZSwgZmFsc2UpOwoJCQkJfQoJCQkJaWYgKGlzc2V0KCRhdHRyWydNQVJHSU4tQk9UVE9NJ10pKSB7CgkJCQkJJG1nYiA9ICR0aGlzLT5tcGRmLT5Db252ZXJ0U2l6ZSgkYXR0clsnTUFSR0lOLUJPVFRPTSddLCAkdGhpcy0+bXBkZi0+dywgJHRoaXMtPm1wZGYtPkZvbnRTaXplLCBmYWxzZSk7CgkJCQl9CgkJCQlpZiAoaXNzZXQoJGF0dHJbJ01BUkdJTi1IRUFERVInXSkpIHsKCQkJCQkkbWdoID0gJHRoaXMtPm1wZGYtPkNvbnZlcnRTaXplKCRhdHRyWydNQVJHSU4tSEVBREVSJ10sICR0aGlzLT5tcGRmLT53LCAkdGhpcy0+bXBkZi0+Rm9udFNpemUsIGZhbHNlKTsKCQkJCX0KCQkJCWlmIChpc3NldCgkYXR0clsnTUFSR0lOLUZPT1RFUiddKSkgewoJCQkJCSRtZ2YgPSAkdGhpcy0+bXBkZi0+Q29udmVydFNpemUoJGF0dHJbJ01BUkdJTi1GT09URVInXSwgJHRoaXMtPm1wZGYtPncsICR0aGlzLT5tcGRmLT5Gb250U2l6ZSwgZmFsc2UpOwoJCQkJfQoJCQkJJG9obmFtZSA9ICRlaG5hbWUgPSAkb2ZuYW1lID0gJGVmbmFtZSA9ICcnOwoJCQkJaWYgKGlzc2V0KCRhdHRyWydPREQtSEVBREVSLU5BTUUnXSkpIHsKCQkJCQkkb2huYW1lID0gJGF0dHJbJ09ERC1IRUFERVItTkFNRSddOwoJCQkJfQoJCQkJaWYgKGlzc2V0KCRhdHRyWydFVkVOLUhFQURFUi1OQU1FJ10pKSB7CgkJCQkJJGVobmFtZSA9ICRhdHRyWydFVkVOLUhFQURFUi1OQU1FJ107CgkJCQl9CgkJCQlpZiAoaXNzZXQoJGF0dHJbJ09ERC1GT09URVItTkFNRSddKSkgewoJCQkJCSRvZm5hbWUgPSAkYXR0clsnT0RELUZPT1RFUi1OQU1FJ107CgkJCQl9CgkJCQlpZiAoaXNzZXQoJGF0dHJbJ0VWRU4tRk9PVEVSLU5BTUUnXSkpIHsKCQkJCQkkZWZuYW1lID0gJGF0dHJbJ0VWRU4tRk9PVEVSLU5BTUUnXTsKCQkJCX0KCQkJCSRvaHZhbHVlID0gJGVodmFsdWUgPSAkb2Z2YWx1ZSA9ICRlZnZhbHVlID0gMDsKCQkJCWlmIChpc3NldCgkYXR0clsnT0RELUhFQURFUi1WQUxVRSddKSAmJiAoJGF0dHJbJ09ERC1IRUFERVItVkFMVUUnXSA9PSAnMScgfHwgc3RydG91cHBlcigkYXR0clsnT0RELUhFQURFUi1WQUxVRSddKSA9PSAnT04nKSkgewoJCQkJCSRvaHZhbHVlID0gMTsKCQkJCX0gZWxzZSBpZiAoaXNzZXQoJGF0dHJbJ09ERC1IRUFERVItVkFMVUUnXSkgJiYgKCRhdHRyWydPREQtSEVBREVSLVZBTFVFJ10gPT0gJy0xJyB8fCBzdHJ0b3VwcGVyKCRhdHRyWydPREQtSEVBREVSLVZBTFVFJ10pID09ICdPRkYnKSkgewoJCQkJCSRvaHZhbHVlID0gLTE7CgkJCQl9CgkJCQlpZiAoaXNzZXQoJGF0dHJbJ0VWRU4tSEVBREVSLVZBTFVFJ10pICYmICgkYXR0clsnRVZFTi1IRUFERVItVkFMVUUnXSA9PSAnMScgfHwgc3RydG91cHBlcigkYXR0clsnRVZFTi1IRUFERVItVkFMVUUnXSkgPT0gJ09OJykpIHsKCQkJCQkkZWh2YWx1ZSA9IDE7CgkJCQl9IGVsc2UgaWYgKGlzc2V0KCRhdHRyWydFVkVOLUhFQURFUi1WQUxVRSddKSAmJiAoJGF0dHJbJ0VWRU4tSEVBREVSLVZBTFVFJ10gPT0gJy0xJyB8fCBzdHJ0b3VwcGVyKCRhdHRyWydFVkVOLUhFQURFUi1WQUxVRSddKSA9PSAnT0ZGJykpIHsKCQkJCQkkZWh2YWx1ZSA9IC0xOwoJCQkJfQoJCQkJaWYgKGlzc2V0KCRhdHRyWydPREQtRk9PVEVSLVZBTFVFJ10pICYmICgkYXR0clsnT0RELUZPT1RFUi1WQUxVRSddID09ICcxJyB8fCBzdHJ0b3VwcGVyKCRhdHRyWydPREQtRk9PVEVSLVZBTFVFJ10pID09ICdPTicpKSB7CgkJCQkJJG9mdmFsdWUgPSAxOwoJCQkJfSBlbHNlIGlmIChpc3NldCgkYXR0clsnT0RELUZPT1RFUi1WQUxVRSddKSAmJiAoJGF0dHJbJ09ERC1GT09URVItVkFMVUUnXSA9PSAnLTEnIHx8IHN0cnRvdXBwZXIoJGF0dHJbJ09ERC1GT09URVItVkFMVUUnXSkgPT0gJ09GRicpKSB7CgkJCQkJJG9mdmFsdWUgPSAtMTsKCQkJCX0KCQkJCWlmIChpc3NldCgkYXR0clsnRVZFTi1GT09URVItVkFMVUUnXSkgJiYgKCRhdHRyWydFVkVOLUZPT1RFUi1WQUxVRSddID09ICcxJyB8fCBzdHJ0b3VwcGVyKCRhdHRyWydFVkVOLUZPT1RFUi1WQUxVRSddKSA9PSAnT04nKSkgewoJCQkJCSRlZnZhbHVlID0gMTsKCQkJCX0gZWxzZSBpZiAoaXNzZXQoJGF0dHJbJ0VWRU4tRk9PVEVSLVZBTFVFJ10pICYmICgkYXR0clsnRVZFTi1GT09URVItVkFMVUUnXSA9PSAnLTEnIHx8IHN0cnRvdXBwZXIoJGF0dHJbJ0VWRU4tRk9PVEVSLVZBTFVFJ10pID09ICdPRkYnKSkgewoJCQkJCSRlZnZhbHVlID0gLTE7CgkJCQl9CgoJCQkJaWYgKGlzc2V0KCRhdHRyWydPUklFTlRBVElPTiddKSAmJiAoc3RydG91cHBlcigkYXR0clsnT1JJRU5UQVRJT04nXSkgPT0gJ0wnIHx8IHN0cnRvdXBwZXIoJGF0dHJbJ09SSUVOVEFUSU9OJ10pID09ICdMQU5EU0NBUEUnKSkgewoJCQkJCSRvcmllbnQgPSAnTCc7CgkJCQl9IGVsc2UgaWYgKGlzc2V0KCRhdHRyWydPUklFTlRBVElPTiddKSAmJiAoc3RydG91cHBlcigkYXR0clsnT1JJRU5UQVRJT04nXSkgPT0gJ1AnIHx8IHN0cnRvdXBwZXIoJGF0dHJbJ09SSUVOVEFUSU9OJ10pID09ICdQT1JUUkFJVCcpKSB7CgkJCQkJJG9yaWVudCA9ICdQJzsKCQkJCX0gZWxzZSB7CgkJCQkJJG9yaWVudCA9ICR0aGlzLT5tcGRmLT5DdXJPcmllbnRhdGlvbjsKCQkJCX0KCgkJCQlpZiAoaXNzZXQoJGF0dHJbJ1BBR0UtU0VMRUNUT1InXSkgJiYgJGF0dHJbJ1BBR0UtU0VMRUNUT1InXSkgewoJCQkJCSRwYWdlc2VsID0gJGF0dHJbJ1BBR0UtU0VMRUNUT1InXTsKCQkJCX0gZWxzZSB7CgkJCQkJJHBhZ2VzZWwgPSAnJzsKCQkJCX0KCgkJCQkvLyBtUERGIDYgcGFnZWJyZWFrdHlwZQoJCQkJJHBhZ2VicmVha3R5cGUgPSAkdGhpcy0+bXBkZi0+ZGVmYXVsdFBhZ2VicmVha1R5cGU7CgkJCQlpZiAoJHRhZyA9PSAnRk9STUZFRUQnKSB7CgkJCQkJJHBhZ2VicmVha3R5cGUgPSAnc2xpY2UnOwoJCQkJfSAvLyBjYW4gYmUgb3ZlcnJpZGRlbiBieSBQQUdFLUJSRUFLLVRZUEUKCQkJCSRzdGFydHBhZ2UgPSAkdGhpcy0+bXBkZi0+cGFnZTsKCQkJCWlmIChpc3NldCgkYXR0clsnUEFHRS1CUkVBSy1UWVBFJ10pKSB7CgkJCQkJaWYgKHN0cnRvbG93ZXIoJGF0dHJbJ1BBR0UtQlJFQUstVFlQRSddKSA9PSAnY2xvbmVhbGwnIHx8IHN0cnRvbG93ZXIoJGF0dHJbJ1BBR0UtQlJFQUstVFlQRSddKSA9PSAnY2xvbmVieWNzcycgfHwgc3RydG9sb3dlcigkYXR0clsnUEFHRS1CUkVBSy1UWVBFJ10pID09ICdzbGljZScpIHsKCQkJCQkJJHBhZ2VicmVha3R5cGUgPSBzdHJ0b2xvd2VyKCRhdHRyWydQQUdFLUJSRUFLLVRZUEUnXSk7CgkJCQkJfQoJCQkJfQoJCQkJaWYgKCR0YWcgPT0gJ1RPQ1BBR0VCUkVBSycpIHsKCQkJCQkkcGFnZWJyZWFrdHlwZSA9ICdjbG9uZWFsbCc7CgkJCQl9IGVsc2UgaWYgKCR0aGlzLT5tcGRmLT5Db2xBY3RpdmUpIHsKCQkJCQkkcGFnZWJyZWFrdHlwZSA9ICdjbG9uZWFsbCc7CgkJCQl9CgkJCQkvLyBBbnkgY2hhbmdlIGluIGhlYWRlcnMvZm9vdGVycyAobWF5IG5lZWQgdG8gX2dldEh0bWxIZWlnaHQpLCBvciBwYWdlIHNpemUvb3JpZW50YXRpb24sIEBwYWdlIHNlbGVjdG9yLCBvciBtYXJnaW5zIC0gZm9yY2UgY2xvbmVhbGwKCQkJCWVsc2UgaWYgKCRtZ3IgIT09ICcnIHx8ICRtZ2wgIT09ICcnIHx8ICRtZ3QgIT09ICcnIHx8ICRtZ2IgIT09ICcnIHx8ICRtZ2ggIT09ICcnIHx8ICRtZ2YgIT09ICcnIHx8CgkJCQkJJG9obmFtZSAhPT0gJycgfHwgJGVobmFtZSAhPT0gJycgfHwgJG9mbmFtZSAhPT0gJycgfHwgJGVmbmFtZSAhPT0gJycgfHwKCQkJCQkkb2h2YWx1ZSB8fCAkZWh2YWx1ZSB8fCAkb2Z2YWx1ZSB8fCAkZWZ2YWx1ZSB8fAoJCQkJCSRvcmllbnQgIT0gJHRoaXMtPm1wZGYtPkN1ck9yaWVudGF0aW9uIHx8ICRuZXdmb3JtYXQgfHwgJHBhZ2VzZWwpIHsKCQkJCQkkcGFnZWJyZWFrdHlwZSA9ICdjbG9uZWFsbCc7CgkJCQl9CgoJCQkJLy8gbVBERiA2IHBhZ2VicmVha3R5cGUKCQkJCSR0aGlzLT5tcGRmLT5fcHJlRm9yY2VkUGFnZWJyZWFrKCRwYWdlYnJlYWt0eXBlKTsKCgkJCQkkdGhpcy0+bXBkZi0+aWdub3JlZm9sbG93aW5nc3BhY2VzID0gdHJ1ZTsKCgoJCQkJJHJlc2V0cGFnZW51bSA9ICcnOwoJCQkJJHBhZ2VudW1zdHlsZSA9ICcnOwoJCQkJJHN1cHByZXNzID0gJyc7CgkJCQlpZiAoaXNzZXQoJGF0dHJbJ1JFU0VUUEFHRU5VTSddKSkgewoJCQkJCSRyZXNldHBhZ2VudW0gPSAkYXR0clsnUkVTRVRQQUdFTlVNJ107CgkJCQl9CgkJCQlpZiAoaXNzZXQoJGF0dHJbJ1BBR0VOVU1TVFlMRSddKSkgewoJCQkJCSRwYWdlbnVtc3R5bGUgPSAkYXR0clsnUEFHRU5VTVNUWUxFJ107CgkJCQl9CgkJCQlpZiAoaXNzZXQoJGF0dHJbJ1NVUFBSRVNTJ10pKSB7CgkJCQkJJHN1cHByZXNzID0gJGF0dHJbJ1NVUFBSRVNTJ107CgkJCQl9CgoJCQkJaWYgKCR0YWcgPT0gJ1RPQ1BBR0VCUkVBSycpIHsKCQkJCQkkdHlwZSA9ICdORVhULU9ERCc7CgkJCQl9IGVsc2UgaWYgKGlzc2V0KCRhdHRyWydUWVBFJ10pKSB7CgkJCQkJJHR5cGUgPSBzdHJ0b3VwcGVyKCRhdHRyWydUWVBFJ10pOwoJCQkJfSBlbHNlIHsKCQkJCQkkdHlwZSA9ICcnOwoJCQkJfQoKCQkJCWlmICgkdHlwZSA9PSAnRScgfHwgJHR5cGUgPT0gJ0VWRU4nKSB7CgkJCQkJJHRoaXMtPm1wZGYtPkFkZFBhZ2UoJG9yaWVudCwgJ0UnLCAkcmVzZXRwYWdlbnVtLCAkcGFnZW51bXN0eWxlLCAkc3VwcHJlc3MsICRtZ2wsICRtZ3IsICRtZ3QsICRtZ2IsICRtZ2gsICRtZ2YsICRvaG5hbWUsICRlaG5hbWUsICRvZm5hbWUsICRlZm5hbWUsICRvaHZhbHVlLCAkZWh2YWx1ZSwgJG9mdmFsdWUsICRlZnZhbHVlLCAkcGFnZXNlbCwgJG5ld2Zvcm1hdCk7CgkJCQl9IGVsc2UgaWYgKCR0eXBlID09ICdPJyB8fCAkdHlwZSA9PSAnT0REJykgewoJCQkJCSR0aGlzLT5tcGRmLT5BZGRQYWdlKCRvcmllbnQsICdPJywgJHJlc2V0cGFnZW51bSwgJHBhZ2VudW1zdHlsZSwgJHN1cHByZXNzLCAkbWdsLCAkbWdyLCAkbWd0LCAkbWdiLCAkbWdoLCAkbWdmLCAkb2huYW1lLCAkZWhuYW1lLCAkb2ZuYW1lLCAkZWZuYW1lLCAkb2h2YWx1ZSwgJGVodmFsdWUsICRvZnZhbHVlLCAkZWZ2YWx1ZSwgJHBhZ2VzZWwsICRuZXdmb3JtYXQpOwoJCQkJfSBlbHNlIGlmICgkdHlwZSA9PSAnTkVYVC1PREQnKSB7CgkJCQkJJHRoaXMtPm1wZGYtPkFkZFBhZ2UoJG9yaWVudCwgJ05FWFQtT0REJywgJHJlc2V0cGFnZW51bSwgJHBhZ2VudW1zdHlsZSwgJHN1cHByZXNzLCAkbWdsLCAkbWdyLCAkbWd0LCAkbWdiLCAkbWdoLCAkbWdmLCAkb2huYW1lLCAkZWhuYW1lLCAkb2ZuYW1lLCAkZWZuYW1lLCAkb2h2YWx1ZSwgJGVodmFsdWUsICRvZnZhbHVlLCAkZWZ2YWx1ZSwgJHBhZ2VzZWwsICRuZXdmb3JtYXQpOwoJCQkJfSBlbHNlIGlmICgkdHlwZSA9PSAnTkVYVC1FVkVOJykgewoJCQkJCSR0aGlzLT5tcGRmLT5BZGRQYWdlKCRvcmllbnQsICdORVhULUVWRU4nLCAkcmVzZXRwYWdlbnVtLCAkcGFnZW51bXN0eWxlLCAkc3VwcHJlc3MsICRtZ2wsICRtZ3IsICRtZ3QsICRtZ2IsICRtZ2gsICRtZ2YsICRvaG5hbWUsICRlaG5hbWUsICRvZm5hbWUsICRlZm5hbWUsICRvaHZhbHVlLCAkZWh2YWx1ZSwgJG9mdmFsdWUsICRlZnZhbHVlLCAkcGFnZXNlbCwgJG5ld2Zvcm1hdCk7CgkJCQl9IGVsc2UgewoJCQkJCSR0aGlzLT5tcGRmLT5BZGRQYWdlKCRvcmllbnQsICcnLCAkcmVzZXRwYWdlbnVtLCAkcGFnZW51bXN0eWxlLCAkc3VwcHJlc3MsICRtZ2wsICRtZ3IsICRtZ3QsICRtZ2IsICRtZ2gsICRtZ2YsICRvaG5hbWUsICRlaG5hbWUsICRvZm5hbWUsICRlZm5hbWUsICRvaHZhbHVlLCAkZWh2YWx1ZSwgJG9mdmFsdWUsICRlZnZhbHVlLCAkcGFnZXNlbCwgJG5ld2Zvcm1hdCk7CgkJCQl9CgoJCQkJLyogLS0gVE9DIC0tICovCgkJCQlpZiAoJHRhZyA9PSAnVE9DUEFHRUJSRUFLJykgewoJCQkJCWlmICgkdG9jX2lkKSB7CgkJCQkJCSR0aGlzLT5tcGRmLT50b2NvbnRlbnRzLT5tX1RPQ1skdG9jX2lkXVsnVE9DbWFyayddID0gJHRoaXMtPm1wZGYtPnBhZ2U7CgkJCQkJfSBlbHNlIHsKCQkJCQkJJHRoaXMtPm1wZGYtPnRvY29udGVudHMtPlRPQ21hcmsgPSAkdGhpcy0+bXBkZi0+cGFnZTsKCQkJCQl9CgkJCQl9CgkJCQkvKiAtLSBFTkQgVE9DIC0tICovCgoJCQkJLy8gbVBERiA2IHBhZ2VicmVha3R5cGUKCQkJCSR0aGlzLT5tcGRmLT5fcG9zdEZvcmNlZFBhZ2VicmVhaygkcGFnZWJyZWFrdHlwZSwgJHN0YXJ0cGFnZSwgJHNhdmVfYmxrLCAkc2F2ZV9ibGtsdmwpOwoKCQkJCSR0aGlzLT5tcGRmLT5JbmxpbmVQcm9wZXJ0aWVzID0gJHNhdmVfaWxwOwoJCQkJJHRoaXMtPm1wZGYtPklubGluZUJERiA9ICRzYXZlX2JmbHA7CgkJCQkkdGhpcy0+bXBkZi0+SW5saW5lQkRGY3RyID0gJHNhdmVfYmZscGM7IC8vIG1QREYgNgoJCQkJJHRoaXMtPm1wZGYtPnJlc3RvcmVJbmxpbmVQcm9wZXJ0aWVzKCRzYXZlX3NpbHApOwoKCQkJCWJyZWFrOwoKCgkJCS8qIC0tIFRPQyAtLSAqLwoJCQljYXNlICdUT0NFTlRSWSc6CgkJCQlpZiAoaXNzZXQoJGF0dHJbJ0NPTlRFTlQnXSkgJiYgJGF0dHJbJ0NPTlRFTlQnXSkgewoJCQkJCSRvYmphdHRyID0gYXJyYXkoKTsKCQkJCQkkb2JqYXR0clsnQ09OVEVOVCddID0gaHRtbHNwZWNpYWxjaGFyc19kZWNvZGUoJGF0dHJbJ0NPTlRFTlQnXSwgRU5UX1FVT1RFUyk7CgkJCQkJJG9iamF0dHJbJ3R5cGUnXSA9ICd0b2MnOwoJCQkJCSRvYmphdHRyWyd2ZXJ0aWNhbC1hbGlnbiddID0gJ1QnOwoJCQkJCWlmIChpc3NldCgkYXR0clsnTEVWRUwnXSkgJiYgJGF0dHJbJ0xFVkVMJ10pIHsKCQkJCQkJJG9iamF0dHJbJ3RvY2xldmVsJ10gPSAkYXR0clsnTEVWRUwnXTsKCQkJCQl9IGVsc2UgewoJCQkJCQkkb2JqYXR0clsndG9jbGV2ZWwnXSA9IDA7CgkJCQkJfQoJCQkJCWlmIChpc3NldCgkYXR0clsnTkFNRSddKSAmJiAkYXR0clsnTkFNRSddKSB7CgkJCQkJCSRvYmphdHRyWyd0b2NfaWQnXSA9ICRhdHRyWydOQU1FJ107CgkJCQkJfSBlbHNlIHsKCQkJCQkJJG9iamF0dHJbJ3RvY19pZCddID0gMDsKCQkJCQl9CgkJCQkJJGUgPSAiXHhiYlx4YTRceGFjdHlwZT10b2Msb2JqYXR0cj0iIC4gc2VyaWFsaXplKCRvYmphdHRyKSAuICJceGJiXHhhNFx4YWMiOwoJCQkJCWlmICgkdGhpcy0+bXBkZi0+dGFibGVMZXZlbCkgewoJCQkJCQkkdGhpcy0+bXBkZi0+Y2VsbFskdGhpcy0+bXBkZi0+cm93XVskdGhpcy0+bXBkZi0+Y29sXVsndGV4dGJ1ZmZlciddW10gPSBhcnJheSgkZSk7CgkJCQkJfSAvLyAqVEFCTEVTKgoJCQkJCWVsc2UgeyAvLyAqVEFCTEVTKgoJCQkJCQkkdGhpcy0+bXBkZi0+dGV4dGJ1ZmZlcltdID0gYXJyYXkoJGUpOwoJCQkJCX0gLy8gKlRBQkxFUyoKCQkJCX0KCQkJCWJyZWFrOwoJCQkvKiAtLSBFTkQgVE9DIC0tICovCgoJCQkvKiAtLSBJTkRFWCAtLSAqLwoJCQljYXNlICdJTkRFWEVOVFJZJzoKCQkJCWlmIChpc3NldCgkYXR0clsnQ09OVEVOVCddKSAmJiAkYXR0clsnQ09OVEVOVCddKSB7CgkJCQkJaWYgKGlzc2V0KCRhdHRyWydYUkVGJ10pICYmICRhdHRyWydYUkVGJ10pIHsKCQkJCQkJJHRoaXMtPm1wZGYtPkluZGV4RW50cnkoaHRtbHNwZWNpYWxjaGFyc19kZWNvZGUoJGF0dHJbJ0NPTlRFTlQnXSwgRU5UX1FVT1RFUyksICRhdHRyWydYUkVGJ10pOwoJCQkJCQlicmVhazsKCQkJCQl9CgkJCQkJJG9iamF0dHIgPSBhcnJheSgpOwoJCQkJCSRvYmphdHRyWydDT05URU5UJ10gPSBodG1sc3BlY2lhbGNoYXJzX2RlY29kZSgkYXR0clsnQ09OVEVOVCddLCBFTlRfUVVPVEVTKTsKCQkJCQkkb2JqYXR0clsndHlwZSddID0gJ2luZGV4ZW50cnknOwoJCQkJCSRvYmphdHRyWyd2ZXJ0aWNhbC1hbGlnbiddID0gJ1QnOwoJCQkJCSRlID0gIlx4YmJceGE0XHhhY3R5cGU9aW5kZXhlbnRyeSxvYmphdHRyPSIgLiBzZXJpYWxpemUoJG9iamF0dHIpIC4gIlx4YmJceGE0XHhhYyI7CgkJCQkJaWYgKCR0aGlzLT5tcGRmLT50YWJsZUxldmVsKSB7CgkJCQkJCSR0aGlzLT5tcGRmLT5jZWxsWyR0aGlzLT5tcGRmLT5yb3ddWyR0aGlzLT5tcGRmLT5jb2xdWyd0ZXh0YnVmZmVyJ11bXSA9IGFycmF5KCRlKTsKCQkJCQl9ICAvLyAqVEFCTEVTKgoJCQkJCWVsc2UgeyAvLyAqVEFCTEVTKgoJCQkJCQkkdGhpcy0+bXBkZi0+dGV4dGJ1ZmZlcltdID0gYXJyYXkoJGUpOwoJCQkJCX0gLy8gKlRBQkxFUyoKCQkJCX0KCQkJCWJyZWFrOwoKCgkJCWNhc2UgJ0lOREVYSU5TRVJUJzoKCQkJCWlmIChpc3NldCgkYXR0clsnQ09MTEFUSU9OJ10pKSB7CgkJCQkJJGluZGV4Q29sbGF0aW9uTG9jYWxlID0gJGF0dHJbJ0NPTExBVElPTiddOwoJCQkJfSBlbHNlIHsKCQkJCQkkaW5kZXhDb2xsYXRpb25Mb2NhbGUgPSAnJzsKCQkJCX0KCQkJCWlmIChpc3NldCgkYXR0clsnQ09MTEFUSU9OLUdST1VQJ10pKSB7CgkJCQkJJGluZGV4Q29sbGF0aW9uR3JvdXAgPSAkYXR0clsnQ09MTEFUSU9OLUdST1VQJ107CgkJCQl9IGVsc2UgewoJCQkJCSRpbmRleENvbGxhdGlvbkdyb3VwID0gJyc7CgkJCQl9CgkJCQlpZiAoaXNzZXQoJGF0dHJbJ1VTRURJVkxFVFRFUlMnXSkgJiYgKHN0cnRvdXBwZXIoJGF0dHJbJ1VTRURJVkxFVFRFUlMnXSkgPT0gJ09GRicgfHwgJGF0dHJbJ1VTRURJVkxFVFRFUlMnXSA9PSAtMSB8fCAkYXR0clsnVVNFRElWTEVUVEVSUyddID09PSAnMCcpKSB7CgkJCQkJJHVzZWRpdmxldHRlcnMgPSAwOwoJCQkJfSBlbHNlIHsKCQkJCQkkdXNlZGl2bGV0dGVycyA9IDE7CgkJCQl9CgkJCQlpZiAoaXNzZXQoJGF0dHJbJ0xJTktTJ10pICYmIChzdHJ0b3VwcGVyKCRhdHRyWydMSU5LUyddKSA9PSAnT04nIHx8ICRhdHRyWydMSU5LUyddID09IDEpKSB7CgkJCQkJJGxpbmtzID0gdHJ1ZTsKCQkJCX0gZWxzZSB7CgkJCQkJJGxpbmtzID0gZmFsc2U7CgkJCQl9CgkJCQkkdGhpcy0+bXBkZi0+SW5zZXJ0SW5kZXgoJHVzZWRpdmxldHRlcnMsICRsaW5rcywgJGluZGV4Q29sbGF0aW9uTG9jYWxlLCAkaW5kZXhDb2xsYXRpb25Hcm91cCk7CgoJCQkJYnJlYWs7CgkJCS8qIC0tIEVORCBJTkRFWCAtLSAqLwoKCQkJLyogLS0gV0FURVJNQVJLIC0tICovCgoJCQljYXNlICdXQVRFUk1BUktURVhUJzoKCQkJCWlmIChpc3NldCgkYXR0clsnQ09OVEVOVCddKSAmJiAkYXR0clsnQ09OVEVOVCddKSB7CgkJCQkJJHR4dCA9IGh0bWxzcGVjaWFsY2hhcnNfZGVjb2RlKCRhdHRyWydDT05URU5UJ10sIEVOVF9RVU9URVMpOwoJCQkJfSBlbHNlIHsKCQkJCQkkdHh0ID0gJyc7CgkJCQl9CgkJCQlpZiAoaXNzZXQoJGF0dHJbJ0FMUEhBJ10pICYmICRhdHRyWydBTFBIQSddID4gMCkgewoJCQkJCSRhbHBoYSA9ICRhdHRyWydBTFBIQSddOwoJCQkJfSBlbHNlIHsKCQkJCQkkYWxwaGEgPSAtMTsKCQkJCX0KCQkJCSR0aGlzLT5tcGRmLT5TZXRXYXRlcm1hcmtUZXh0KCR0eHQsICRhbHBoYSk7CgkJCQlicmVhazsKCgoJCQljYXNlICdXQVRFUk1BUktJTUFHRSc6CgkJCQlpZiAoaXNzZXQoJGF0dHJbJ1NSQyddKSkgewoJCQkJCSRzcmMgPSAkYXR0clsnU1JDJ107CgkJCQl9IGVsc2UgewoJCQkJCSRzcmMgPSAnJzsKCQkJCX0KCQkJCWlmIChpc3NldCgkYXR0clsnQUxQSEEnXSkgJiYgJGF0dHJbJ0FMUEhBJ10gPiAwKSB7CgkJCQkJJGFscGhhID0gJGF0dHJbJ0FMUEhBJ107CgkJCQl9IGVsc2UgewoJCQkJCSRhbHBoYSA9IC0xOwoJCQkJfQoJCQkJaWYgKGlzc2V0KCRhdHRyWydTSVpFJ10pICYmICRhdHRyWydTSVpFJ10pIHsKCQkJCQkkc2l6ZSA9ICRhdHRyWydTSVpFJ107CgkJCQkJaWYgKHN0cnBvcygkc2l6ZSwgJywnKSkgewoJCQkJCQkkc2l6ZSA9IGV4cGxvZGUoJywnLCAkc2l6ZSk7CgkJCQkJfQoJCQkJfSBlbHNlIHsKCQkJCQkkc2l6ZSA9ICdEJzsKCQkJCX0KCQkJCWlmIChpc3NldCgkYXR0clsnUE9TSVRJT04nXSkgJiYgJGF0dHJbJ1BPU0lUSU9OJ10pIHsgIC8vIG1QREYgNS43LjIKCQkJCQkkcG9zID0gJGF0dHJbJ1BPU0lUSU9OJ107CgkJCQkJaWYgKHN0cnBvcygkcG9zLCAnLCcpKSB7CgkJCQkJCSRwb3MgPSBleHBsb2RlKCcsJywgJHBvcyk7CgkJCQkJfQoJCQkJfSBlbHNlIHsKCQkJCQkkcG9zID0gJ1AnOwoJCQkJfQoJCQkJJHRoaXMtPm1wZGYtPlNldFdhdGVybWFya0ltYWdlKCRzcmMsICRhbHBoYSwgJHNpemUsICRwb3MpOwoJCQkJYnJlYWs7CgkJCS8qIC0tIEVORCBXQVRFUk1BUksgLS0gKi8KCgkJCS8qIC0tIEJPT0tNQVJLUyAtLSAqLwoJCQljYXNlICdCT09LTUFSSyc6CgkJCQlpZiAoaXNzZXQoJGF0dHJbJ0NPTlRFTlQnXSkpIHsKCQkJCQkkb2JqYXR0ciA9IGFycmF5KCk7CgkJCQkJJG9iamF0dHJbJ0NPTlRFTlQnXSA9IGh0bWxzcGVjaWFsY2hhcnNfZGVjb2RlKCRhdHRyWydDT05URU5UJ10sIEVOVF9RVU9URVMpOwoJCQkJCSRvYmphdHRyWyd0eXBlJ10gPSAnYm9va21hcmsnOwoJCQkJCWlmIChpc3NldCgkYXR0clsnTEVWRUwnXSkgJiYgJGF0dHJbJ0xFVkVMJ10pIHsKCQkJCQkJJG9iamF0dHJbJ2JrbGV2ZWwnXSA9ICRhdHRyWydMRVZFTCddOwoJCQkJCX0gZWxzZSB7CgkJCQkJCSRvYmphdHRyWydia2xldmVsJ10gPSAwOwoJCQkJCX0KCQkJCQkkZSA9ICJceGJiXHhhNFx4YWN0eXBlPWJvb2ttYXJrLG9iamF0dHI9IiAuIHNlcmlhbGl6ZSgkb2JqYXR0cikgLiAiXHhiYlx4YTRceGFjIjsKCQkJCQlpZiAoJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWwpIHsKCQkJCQkJJHRoaXMtPm1wZGYtPmNlbGxbJHRoaXMtPm1wZGYtPnJvd11bJHRoaXMtPm1wZGYtPmNvbF1bJ3RleHRidWZmZXInXVtdID0gYXJyYXkoJGUpOwoJCQkJCX0gLy8gKlRBQkxFUyoKCQkJCQllbHNlIHsgLy8gKlRBQkxFUyoKCQkJCQkJJHRoaXMtPm1wZGYtPnRleHRidWZmZXJbXSA9IGFycmF5KCRlKTsKCQkJCQl9IC8vICpUQUJMRVMqCgkJCQl9CgkJCQlicmVhazsKCQkJLyogLS0gRU5EIEJPT0tNQVJLUyAtLSAqLwoKCQkJLyogLS0gQU5OT1RBVElPTlMgLS0gKi8KCQkJY2FzZSAnQU5OT1RBVElPTic6CgoJCQkJLy9pZiAoaXNzZXQoJGF0dHJbJ0NPTlRFTlQnXSkgJiYgISR0aGlzLT5tcGRmLT53cml0aW5nSFRNTGhlYWRlciAmJiAhJHRoaXMtPm1wZGYtPndyaXRpbmdIVE1MZm9vdGVyKSB7CS8vIFN0b3BzIGFubm90YXRpb25zIGluIEZpeGVkUG9zCgkJCQlpZiAoaXNzZXQoJGF0dHJbJ0NPTlRFTlQnXSkpIHsKCQkJCQkkb2JqYXR0ciA9IGFycmF5KCk7CgkJCQkJJG9iamF0dHJbJ21hcmdpbl90b3AnXSA9IDA7CgkJCQkJJG9iamF0dHJbJ21hcmdpbl9ib3R0b20nXSA9IDA7CgkJCQkJJG9iamF0dHJbJ21hcmdpbl9sZWZ0J10gPSAwOwoJCQkJCSRvYmphdHRyWydtYXJnaW5fcmlnaHQnXSA9IDA7CgkJCQkJJG9iamF0dHJbJ3dpZHRoJ10gPSAwOwoJCQkJCSRvYmphdHRyWydoZWlnaHQnXSA9IDA7CgkJCQkJJG9iamF0dHJbJ2JvcmRlcl90b3AnXVsndyddID0gMDsKCQkJCQkkb2JqYXR0clsnYm9yZGVyX2JvdHRvbSddWyd3J10gPSAwOwoJCQkJCSRvYmphdHRyWydib3JkZXJfbGVmdCddWyd3J10gPSAwOwoJCQkJCSRvYmphdHRyWydib3JkZXJfcmlnaHQnXVsndyddID0gMDsKCQkJCQkkb2JqYXR0clsnQ09OVEVOVCddID0gaHRtbHNwZWNpYWxjaGFyc19kZWNvZGUoJGF0dHJbJ0NPTlRFTlQnXSwgRU5UX1FVT1RFUyk7CgkJCQkJJG9iamF0dHJbJ3R5cGUnXSA9ICdhbm5vdCc7CgkJCQkJJG9iamF0dHJbJ1BPUFVQJ10gPSAnJzsKCQkJCX0gZWxzZSB7CgkJCQkJYnJlYWs7CgkJCQl9CgkJCQlpZiAoaXNzZXQoJGF0dHJbJ1BPUy1YJ10pKSB7CgkJCQkJJG9iamF0dHJbJ1BPUy1YJ10gPSAkYXR0clsnUE9TLVgnXTsKCQkJCX0gZWxzZSB7CgkJCQkJJG9iamF0dHJbJ1BPUy1YJ10gPSAwOwoJCQkJfQoJCQkJaWYgKGlzc2V0KCRhdHRyWydQT1MtWSddKSkgewoJCQkJCSRvYmphdHRyWydQT1MtWSddID0gJGF0dHJbJ1BPUy1ZJ107CgkJCQl9IGVsc2UgewoJCQkJCSRvYmphdHRyWydQT1MtWSddID0gMDsKCQkJCX0KCQkJCWlmIChpc3NldCgkYXR0clsnSUNPTiddKSkgewoJCQkJCSRvYmphdHRyWydJQ09OJ10gPSAkYXR0clsnSUNPTiddOwoJCQkJfSBlbHNlIHsKCQkJCQkkb2JqYXR0clsnSUNPTiddID0gJ05vdGUnOwoJCQkJfQoJCQkJaWYgKGlzc2V0KCRhdHRyWydBVVRIT1InXSkpIHsKCQkJCQkkb2JqYXR0clsnQVVUSE9SJ10gPSAkYXR0clsnQVVUSE9SJ107CgkJCQl9IGVsc2UgaWYgKGlzc2V0KCRhdHRyWydUSVRMRSddKSkgewoJCQkJCSRvYmphdHRyWydBVVRIT1InXSA9ICRhdHRyWydUSVRMRSddOwoJCQkJfSBlbHNlIHsKCQkJCQkkb2JqYXR0clsnQVVUSE9SJ10gPSAnJzsKCQkJCX0KCQkJCWlmIChpc3NldCgkYXR0clsnRklMRSddKSkgewoJCQkJCSRvYmphdHRyWydGSUxFJ10gPSAkYXR0clsnRklMRSddOwoJCQkJfSBlbHNlIHsKCQkJCQkkb2JqYXR0clsnRklMRSddID0gJyc7CgkJCQl9CgkJCQlpZiAoaXNzZXQoJGF0dHJbJ1NVQkpFQ1QnXSkpIHsKCQkJCQkkb2JqYXR0clsnU1VCSkVDVCddID0gJGF0dHJbJ1NVQkpFQ1QnXTsKCQkJCX0gZWxzZSB7CgkJCQkJJG9iamF0dHJbJ1NVQkpFQ1QnXSA9ICcnOwoJCQkJfQoJCQkJaWYgKGlzc2V0KCRhdHRyWydPUEFDSVRZJ10pICYmICRhdHRyWydPUEFDSVRZJ10gPiAwICYmICRhdHRyWydPUEFDSVRZJ10gPD0gMSkgewoJCQkJCSRvYmphdHRyWydPUEFDSVRZJ10gPSAkYXR0clsnT1BBQ0lUWSddOwoJCQkJfSBlbHNlIGlmICgkdGhpcy0+bXBkZi0+YW5ub3RNYXJnaW4pIHsKCQkJCQkkb2JqYXR0clsnT1BBQ0lUWSddID0gMTsKCQkJCX0gZWxzZSB7CgkJCQkJJG9iamF0dHJbJ09QQUNJVFknXSA9ICR0aGlzLT5tcGRmLT5hbm5vdE9wYWNpdHk7CgkJCQl9CgkJCQlpZiAoaXNzZXQoJGF0dHJbJ0NPTE9SJ10pKSB7CgkJCQkJJGNvciA9ICR0aGlzLT5tcGRmLT5Db252ZXJ0Q29sb3IoJGF0dHJbJ0NPTE9SJ10pOwoJCQkJCWlmICgkY29yKSB7CgkJCQkJCSRvYmphdHRyWydDT0xPUiddID0gJGNvcjsKCQkJCQl9IGVsc2UgewoJCQkJCQkkb2JqYXR0clsnQ09MT1InXSA9ICR0aGlzLT5tcGRmLT5Db252ZXJ0Q29sb3IoJ3llbGxvdycpOwoJCQkJCX0KCQkJCX0gZWxzZSB7CgkJCQkJJG9iamF0dHJbJ0NPTE9SJ10gPSAkdGhpcy0+bXBkZi0+Q29udmVydENvbG9yKCd5ZWxsb3cnKTsKCQkJCX0KCgkJCQlpZiAoaXNzZXQoJGF0dHJbJ1BPUFVQJ10pICYmICFlbXB0eSgkYXR0clsnUE9QVVAnXSkpIHsKCQkJCQkkcG9wID0gcHJlZ19zcGxpdCgnL1xzKy8nLCB0cmltKCRhdHRyWydQT1BVUCddKSk7CgkJCQkJaWYgKGNvdW50KCRwb3ApID4gMSkgewoJCQkJCQkkb2JqYXR0clsnUE9QVVAnXSA9ICRwb3A7CgkJCQkJfSBlbHNlIHsKCQkJCQkJJG9iamF0dHJbJ1BPUFVQJ10gPSB0cnVlOwoJCQkJCX0KCQkJCX0KCQkJCSRlID0gIlx4YmJceGE0XHhhY3R5cGU9YW5ub3Qsb2JqYXR0cj0iIC4gc2VyaWFsaXplKCRvYmphdHRyKSAuICJceGJiXHhhNFx4YWMiOwoJCQkJaWYgKCR0aGlzLT5tcGRmLT50YWJsZUxldmVsKSB7CgkJCQkJJHRoaXMtPm1wZGYtPmNlbGxbJHRoaXMtPm1wZGYtPnJvd11bJHRoaXMtPm1wZGYtPmNvbF1bJ3RleHRidWZmZXInXVtdID0gYXJyYXkoJGUpOwoJCQkJfSAvLyAqVEFCTEVTKgoJCQkJZWxzZSB7IC8vICpUQUJMRVMqCgkJCQkJJHRoaXMtPm1wZGYtPnRleHRidWZmZXJbXSA9IGFycmF5KCRlKTsKCQkJCX0gLy8gKlRBQkxFUyoKCQkJCWJyZWFrOwoJCQkvKiAtLSBFTkQgQU5OT1RBVElPTlMgLS0gKi8KCgoJCQkvKiAtLSBDT0xVTU5TIC0tICovCgkJCWNhc2UgJ0NPTFVNTlMnOiAvL2FkZGVkIGN1c3RvbS10YWcKCQkJCWlmIChpc3NldCgkYXR0clsnQ09MVU1OLUNPVU5UJ10pICYmICgkYXR0clsnQ09MVU1OLUNPVU5UJ10gfHwgJGF0dHJbJ0NPTFVNTi1DT1VOVCddID09PSAnMCcpKSB7CgkJCQkJLy8gQ2xvc2UgYW55IG9wZW4gYmxvY2sgdGFncwoJCQkJCWZvciAoJGIgPSAkdGhpcy0+bXBkZi0+YmxrbHZsOyAkYiA+IDA7ICRiLS0pIHsKCQkJCQkJJHRoaXMtPkNsb3NlVGFnKCR0aGlzLT5tcGRmLT5ibGtbJGJdWyd0YWcnXSwgJGFodG1sLCAkaWh0bWwpOwoJCQkJCX0KCQkJCQlpZiAoIWVtcHR5KCR0aGlzLT5tcGRmLT50ZXh0YnVmZmVyKSkgeyAvL091dHB1dCBwcmV2aW91c2x5IGJ1ZmZlcmVkIGNvbnRlbnQKCQkJCQkJJHRoaXMtPm1wZGYtPnByaW50YnVmZmVyKCR0aGlzLT5tcGRmLT50ZXh0YnVmZmVyKTsKCQkJCQkJJHRoaXMtPm1wZGYtPnRleHRidWZmZXIgPSBhcnJheSgpOwoJCQkJCX0KCgkJCQkJaWYgKGlzc2V0KCRhdHRyWydWQUxJR04nXSkgJiYgJGF0dHJbJ1ZBTElHTiddKSB7CgkJCQkJCWlmICgkYXR0clsnVkFMSUdOJ10gPT0gJ0onKSB7CgkJCQkJCQkkdmFsaWduID0gJ0onOwoJCQkJCQl9IGVsc2UgewoJCQkJCQkJJHZhbGlnbiA9ICRhbGlnblskYXR0clsnVkFMSUdOJ11dOwoJCQkJCQl9CgkJCQkJfSBlbHNlIHsKCQkJCQkJJHZhbGlnbiA9ICcnOwoJCQkJCX0KCQkJCQlpZiAoaXNzZXQoJGF0dHJbJ0NPTFVNTi1HQVAnXSkgJiYgJGF0dHJbJ0NPTFVNTi1HQVAnXSkgewoJCQkJCQkkdGhpcy0+bXBkZi0+U2V0Q29sdW1ucygkYXR0clsnQ09MVU1OLUNPVU5UJ10sICR2YWxpZ24sICRhdHRyWydDT0xVTU4tR0FQJ10pOwoJCQkJCX0gZWxzZSB7CgkJCQkJCSR0aGlzLT5tcGRmLT5TZXRDb2x1bW5zKCRhdHRyWydDT0xVTU4tQ09VTlQnXSwgJHZhbGlnbik7CgkJCQkJfQoJCQkJfQoJCQkJJHRoaXMtPm1wZGYtPmlnbm9yZWZvbGxvd2luZ3NwYWNlcyA9IHRydWU7CgkJCQlicmVhazsKCgkJCWNhc2UgJ0NPTFVNTl9CUkVBSyc6IC8vY3VzdG9tLXRhZwoJCQljYXNlICdDT0xVTU5CUkVBSyc6IC8vY3VzdG9tLXRhZwoJCQljYXNlICdORVdDT0xVTU4nOiAvL2N1c3RvbS10YWcKCQkJCSR0aGlzLT5tcGRmLT5pZ25vcmVmb2xsb3dpbmdzcGFjZXMgPSB0cnVlOwoJCQkJJHRoaXMtPm1wZGYtPk5ld0NvbHVtbigpOwoJCQkJJHRoaXMtPm1wZGYtPkNvbHVtbkFkanVzdCA9IGZhbHNlOyAvLyBkaXNhYmxlcyBhbGwgY29sdW1uIGhlaWdodCBhZGp1c3RtZW50IGZvciB0aGUgcGFnZS4KCQkJCWJyZWFrOwoKCQkJLyogLS0gRU5EIENPTFVNTlMgLS0gKi8KCgoJCQljYXNlICdUVFonOgoJCQkJJHRoaXMtPm1wZGYtPnR0eiA9IHRydWU7CgkJCQkkdGhpcy0+bXBkZi0+SW5saW5lUHJvcGVydGllc1skdGFnXSA9ICR0aGlzLT5tcGRmLT5zYXZlSW5saW5lUHJvcGVydGllcygpOwoJCQkJJHRoaXMtPm1wZGYtPnNldENTUyhhcnJheSgnRk9OVC1GQU1JTFknID0+ICdjemFwZmRpbmdiYXRzJywgJ0ZPTlQtV0VJR0hUJyA9PiAnbm9ybWFsJywgJ0ZPTlQtU1RZTEUnID0+ICdub3JtYWwnKSwgJ0lOTElORScpOwoJCQkJYnJlYWs7CgoJCQljYXNlICdUVFMnOgoJCQkJJHRoaXMtPm1wZGYtPnR0cyA9IHRydWU7CgkJCQkkdGhpcy0+bXBkZi0+SW5saW5lUHJvcGVydGllc1skdGFnXSA9ICR0aGlzLT5tcGRmLT5zYXZlSW5saW5lUHJvcGVydGllcygpOwoJCQkJJHRoaXMtPm1wZGYtPnNldENTUyhhcnJheSgnRk9OVC1GQU1JTFknID0+ICdjc3ltYm9sJywgJ0ZPTlQtV0VJR0hUJyA9PiAnbm9ybWFsJywgJ0ZPTlQtU1RZTEUnID0+ICdub3JtYWwnKSwgJ0lOTElORScpOwoJCQkJYnJlYWs7CgoJCQljYXNlICdUVEEnOgoJCQkJJHRoaXMtPm1wZGYtPnR0YSA9IHRydWU7CgkJCQkkdGhpcy0+bXBkZi0+SW5saW5lUHJvcGVydGllc1skdGFnXSA9ICR0aGlzLT5tcGRmLT5zYXZlSW5saW5lUHJvcGVydGllcygpOwoKCQkJCWlmIChpbl9hcnJheSgkdGhpcy0+bXBkZi0+Rm9udEZhbWlseSwgJHRoaXMtPm1wZGYtPm1vbm9fZm9udHMpKSB7CgkJCQkJJHRoaXMtPm1wZGYtPnNldENTUyhhcnJheSgnRk9OVC1GQU1JTFknID0+ICdjY291cmllcicpLCAnSU5MSU5FJyk7CgkJCQl9IGVsc2UgaWYgKGluX2FycmF5KCR0aGlzLT5tcGRmLT5Gb250RmFtaWx5LCAkdGhpcy0+bXBkZi0+c2VyaWZfZm9udHMpKSB7CgkJCQkJJHRoaXMtPm1wZGYtPnNldENTUyhhcnJheSgnRk9OVC1GQU1JTFknID0+ICdjdGltZXMnKSwgJ0lOTElORScpOwoJCQkJfSBlbHNlIHsKCQkJCQkkdGhpcy0+bXBkZi0+c2V0Q1NTKGFycmF5KCdGT05ULUZBTUlMWScgPT4gJ2NoZWx2ZXRpY2EnKSwgJ0lOTElORScpOwoJCQkJfQoJCQkJYnJlYWs7CgoKCgkJCS8vIElOTElORSBQSFJBU0VTIE9SIFNUWUxFUwoJCQljYXNlICdTVUInOgoJCQljYXNlICdTVVAnOgoJCQljYXNlICdBQ1JPTllNJzoKCQkJY2FzZSAnQklHJzoKCQkJY2FzZSAnU01BTEwnOgoJCQljYXNlICdJTlMnOgoJCQljYXNlICdTJzoKCQkJY2FzZSAnU1RSSUtFJzoKCQkJY2FzZSAnREVMJzoKCQkJY2FzZSAnU1RST05HJzoKCQkJY2FzZSAnQ0lURSc6CgkJCWNhc2UgJ1EnOgoJCQljYXNlICdFTSc6CgkJCWNhc2UgJ0InOgoJCQljYXNlICdJJzoKCQkJY2FzZSAnVSc6CgkJCWNhc2UgJ1NBTVAnOgoJCQljYXNlICdDT0RFJzoKCQkJY2FzZSAnS0JEJzoKCQkJY2FzZSAnVFQnOgoJCQljYXNlICdWQVInOgoJCQljYXNlICdGT05UJzoKCQkJY2FzZSAnTUFSSyc6CgkJCWNhc2UgJ1RJTUUnOgoJCQljYXNlICdCRE8nOiAvLyBtUERGIDYKCQkJY2FzZSAnQkRJJzogLy8gbVBERiA2CgoJCQljYXNlICdTUEFOJzoKCQkJCS8qIC0tIEFOTk9UQVRJT05TIC0tICovCgkJCQlpZiAoJHRoaXMtPm1wZGYtPnRpdGxlMmFubm90cyAmJiBpc3NldCgkYXR0clsnVElUTEUnXSkpIHsKCQkJCQkkb2JqYXR0ciA9IGFycmF5KCk7CgkJCQkJJG9iamF0dHJbJ21hcmdpbl90b3AnXSA9IDA7CgkJCQkJJG9iamF0dHJbJ21hcmdpbl9ib3R0b20nXSA9IDA7CgkJCQkJJG9iamF0dHJbJ21hcmdpbl9sZWZ0J10gPSAwOwoJCQkJCSRvYmphdHRyWydtYXJnaW5fcmlnaHQnXSA9IDA7CgkJCQkJJG9iamF0dHJbJ3dpZHRoJ10gPSAwOwoJCQkJCSRvYmphdHRyWydoZWlnaHQnXSA9IDA7CgkJCQkJJG9iamF0dHJbJ2JvcmRlcl90b3AnXVsndyddID0gMDsKCQkJCQkkb2JqYXR0clsnYm9yZGVyX2JvdHRvbSddWyd3J10gPSAwOwoJCQkJCSRvYmphdHRyWydib3JkZXJfbGVmdCddWyd3J10gPSAwOwoJCQkJCSRvYmphdHRyWydib3JkZXJfcmlnaHQnXVsndyddID0gMDsKCgkJCQkJJG9iamF0dHJbJ0NPTlRFTlQnXSA9ICRhdHRyWydUSVRMRSddOwoJCQkJCSRvYmphdHRyWyd0eXBlJ10gPSAnYW5ub3QnOwoJCQkJCSRvYmphdHRyWydQT1MtWCddID0gMDsKCQkJCQkkb2JqYXR0clsnUE9TLVknXSA9IDA7CgkJCQkJJG9iamF0dHJbJ0lDT04nXSA9ICdDb21tZW50JzsKCQkJCQkkb2JqYXR0clsnQVVUSE9SJ10gPSAnJzsKCQkJCQkkb2JqYXR0clsnU1VCSkVDVCddID0gJyc7CgkJCQkJJG9iamF0dHJbJ09QQUNJVFknXSA9ICR0aGlzLT5tcGRmLT5hbm5vdE9wYWNpdHk7CgkJCQkJJG9iamF0dHJbJ0NPTE9SJ10gPSAkdGhpcy0+bXBkZi0+Q29udmVydENvbG9yKCd5ZWxsb3cnKTsKCQkJCQkkYW5ub3QgPSAiXHhiYlx4YTRceGFjdHlwZT1hbm5vdCxvYmphdHRyPSIgLiBzZXJpYWxpemUoJG9iamF0dHIpIC4gIlx4YmJceGE0XHhhYyI7CgkJCQl9CgkJCQkvKiAtLSBFTkQgQU5OT1RBVElPTlMgLS0gKi8KCgkJCQkvLyBtUERGIDUuNy4zIElubGluZSB0YWdzCgkJCQlpZiAoIWlzc2V0KCR0aGlzLT5tcGRmLT5JbmxpbmVQcm9wZXJ0aWVzWyR0YWddKSkgewoJCQkJCSR0aGlzLT5tcGRmLT5JbmxpbmVQcm9wZXJ0aWVzWyR0YWddID0gYXJyYXkoJHRoaXMtPm1wZGYtPnNhdmVJbmxpbmVQcm9wZXJ0aWVzKCkpOwoJCQkJfSBlbHNlIHsKCQkJCQkkdGhpcy0+bXBkZi0+SW5saW5lUHJvcGVydGllc1skdGFnXVtdID0gJHRoaXMtPm1wZGYtPnNhdmVJbmxpbmVQcm9wZXJ0aWVzKCk7CgkJCQl9CgkJCQlpZiAoaXNzZXQoJGFubm90KSkgeyAgLy8gKkFOTk9UQVRJT05TKgoJCQkJCWlmICghaXNzZXQoJHRoaXMtPm1wZGYtPklubGluZUFubm90c1skdGFnXSkpIHsKCQkJCQkJJHRoaXMtPm1wZGYtPklubGluZUFubm90c1skdGFnXSA9IGFycmF5KCRhbm5vdCk7CgkJCQkJfSAvLyAqQU5OT1RBVElPTlMqCgkJCQkJZWxzZSB7CgkJCQkJCSR0aGlzLT5tcGRmLT5JbmxpbmVBbm5vdHNbJHRhZ11bXSA9ICRhbm5vdDsKCQkJCQl9IC8vICpBTk5PVEFUSU9OUyoKCQkJCX0gLy8gKkFOTk9UQVRJT05TKgoKCQkJCSRwcm9wZXJ0aWVzID0gJHRoaXMtPm1wZGYtPmNzc21nci0+TWVyZ2VDU1MoJ0lOTElORScsICR0YWcsICRhdHRyKTsKCQkJCWlmICghZW1wdHkoJHByb3BlcnRpZXMpKQoJCQkJCSR0aGlzLT5tcGRmLT5zZXRDU1MoJHByb3BlcnRpZXMsICdJTkxJTkUnKTsKCgkJCQkvLyBtUERGIDYgQmlkaXJlY3Rpb25hbCBmb3JtYXR0aW5nIGZvciBpbmxpbmUgZWxlbWVudHMKCQkJCSRiZGYgPSBmYWxzZTsKCQkJCSRiZGYyID0gJyc7CgkJCQkkcG9wZCA9ICcnOwoKCQkJCS8vIEdldCBjdXJyZW50IGRpcmVjdGlvbgoJCQkJaWYgKGlzc2V0KCR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ2RpcmVjdGlvbiddKSkgewoJCQkJCSRjdXJyZGlyID0gJHRoaXMtPm1wZGYtPmJsa1skdGhpcy0+bXBkZi0+YmxrbHZsXVsnZGlyZWN0aW9uJ107CgkJCQl9IGVsc2UgewoJCQkJCSRjdXJyZGlyID0gJ2x0cic7CgkJCQl9CgkJCQlpZiAoJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWwgJiYgaXNzZXQoJHRoaXMtPm1wZGYtPmNlbGxbJHRoaXMtPm1wZGYtPnJvd11bJHRoaXMtPm1wZGYtPmNvbF1bJ2RpcmVjdGlvbiddKSAmJiAkdGhpcy0+bXBkZi0+Y2VsbFskdGhpcy0+bXBkZi0+cm93XVskdGhpcy0+bXBkZi0+Y29sXVsnZGlyZWN0aW9uJ10gPT0gJ3J0bCcpIHsKCQkJCQkkY3VycmRpciA9ICdydGwnOwoJCQkJfQoJCQkJaWYgKGlzc2V0KCRhdHRyWydESVInXSkgYW5kICRhdHRyWydESVInXSAhPSAnJykgewoJCQkJCSRjdXJyZGlyID0gc3RydG9sb3dlcigkYXR0clsnRElSJ10pOwoJCQkJfQoJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydESVJFQ1RJT04nXSkpIHsKCQkJCQkkY3VycmRpciA9IHN0cnRvbG93ZXIoJHByb3BlcnRpZXNbJ0RJUkVDVElPTiddKTsKCQkJCX0KCgkJCQkvLyBtUERGIDYgYmlkaQoJCQkJLy8gY2YuIGh0dHA6Ly93d3cudzMub3JnL1RSL2NzczMtd3JpdGluZy1tb2Rlcy8jdW5pY29kZS1iaWRpCgkJCQlpZiAoJHRhZyA9PSAnQkRPJykgewoJCQkJCWlmIChpc3NldCgkYXR0clsnRElSJ10pIGFuZCBzdHJ0b2xvd2VyKCRhdHRyWydESVInXSkgPT0gJ3J0bCcpIHsKCQkJCQkJJGJkZiA9IDB4MjAyRTsKCQkJCQkJJHBvcGQgPSAnUkxPUERGJzsKCQkJCQl9IC8vIFUrMjAyRSBSTE8KCQkJCQllbHNlIGlmIChpc3NldCgkYXR0clsnRElSJ10pIGFuZCBzdHJ0b2xvd2VyKCRhdHRyWydESVInXSkgPT0gJ2x0cicpIHsKCQkJCQkJJGJkZiA9IDB4MjAyRDsKCQkJCQkJJHBvcGQgPSAnTFJPUERGJzsKCQkJCQl9IC8vIFUrMjAyRCBMUk8KCQkJCX0gZWxzZSBpZiAoJHRhZyA9PSAnQkRJJykgewoJCQkJCWlmIChpc3NldCgkYXR0clsnRElSJ10pIGFuZCBzdHJ0b2xvd2VyKCRhdHRyWydESVInXSkgPT0gJ3J0bCcpIHsKCQkJCQkJJGJkZiA9IDB4MjA2NzsKCQkJCQkJJHBvcGQgPSAnUkxJUERJJzsKCQkJCQl9IC8vIFUrMjA2NyBSTEkKCQkJCQllbHNlIGlmIChpc3NldCgkYXR0clsnRElSJ10pIGFuZCBzdHJ0b2xvd2VyKCRhdHRyWydESVInXSkgPT0gJ2x0cicpIHsKCQkJCQkJJGJkZiA9IDB4MjA2NjsKCQkJCQkJJHBvcGQgPSAnTFJJUERJJzsKCQkJCQl9IC8vIFUrMjA2NiBMUkkKCQkJCQllbHNlIHsKCQkJCQkJJGJkZiA9IDB4MjA2ODsKCQkJCQkJJHBvcGQgPSAnRlNJUERJJzsKCQkJCQl9IC8vIFUrMjA2OCBGU0kKCQkJCX0gZWxzZSBpZiAoaXNzZXQoJHByb3BlcnRpZXMgWydVTklDT0RFLUJJREknXSkgJiYgc3RydG9sb3dlcigkcHJvcGVydGllcyBbJ1VOSUNPREUtQklESSddKSA9PSAnYmlkaS1vdmVycmlkZScpIHsKCQkJCQlpZiAoJGN1cnJkaXIgPT0gJ3J0bCcpIHsKCQkJCQkJJGJkZiA9IDB4MjAyRTsKCQkJCQkJJHBvcGQgPSAnUkxPUERGJzsKCQkJCQl9IC8vIFUrMjAyRSBSTE8KCQkJCQllbHNlIHsKCQkJCQkJJGJkZiA9IDB4MjAyRDsKCQkJCQkJJHBvcGQgPSAnTFJPUERGJzsKCQkJCQl9IC8vIFUrMjAyRCBMUk8KCQkJCX0gZWxzZSBpZiAoaXNzZXQoJHByb3BlcnRpZXMgWydVTklDT0RFLUJJREknXSkgJiYgc3RydG9sb3dlcigkcHJvcGVydGllcyBbJ1VOSUNPREUtQklESSddKSA9PSAnZW1iZWQnKSB7CgkJCQkJaWYgKCRjdXJyZGlyID09ICdydGwnKSB7CgkJCQkJCSRiZGYgPSAweDIwMkI7CgkJCQkJCSRwb3BkID0gJ1JMRVBERic7CgkJCQkJfSAvLyBVKzIwMkIgUkxFCgkJCQkJZWxzZSB7CgkJCQkJCSRiZGYgPSAweDIwMkE7CgkJCQkJCSRwb3BkID0gJ0xSRVBERic7CgkJCQkJfSAvLyBVKzIwMkEgTFJFCgkJCQl9IGVsc2UgaWYgKGlzc2V0KCRwcm9wZXJ0aWVzIFsnVU5JQ09ERS1CSURJJ10pICYmIHN0cnRvbG93ZXIoJHByb3BlcnRpZXMgWydVTklDT0RFLUJJREknXSkgPT0gJ2lzb2xhdGUnKSB7CgkJCQkJaWYgKCRjdXJyZGlyID09ICdydGwnKSB7CgkJCQkJCSRiZGYgPSAweDIwNjc7CgkJCQkJCSRwb3BkID0gJ1JMSVBESSc7CgkJCQkJfSAvLyBVKzIwNjcgUkxJCgkJCQkJZWxzZSB7CgkJCQkJCSRiZGYgPSAweDIwNjY7CgkJCQkJCSRwb3BkID0gJ0xSSVBESSc7CgkJCQkJfSAvLyBVKzIwNjYgTFJJCgkJCQl9IGVsc2UgaWYgKGlzc2V0KCRwcm9wZXJ0aWVzIFsnVU5JQ09ERS1CSURJJ10pICYmIHN0cnRvbG93ZXIoJHByb3BlcnRpZXMgWydVTklDT0RFLUJJREknXSkgPT0gJ2lzb2xhdGUtb3ZlcnJpZGUnKSB7CgkJCQkJaWYgKCRjdXJyZGlyID09ICdydGwnKSB7CgkJCQkJCSRiZGYgPSAweDIwNjc7CgkJCQkJCSRiZGYyID0gMHgyMDJFOwoJCQkJCQkkcG9wZCA9ICdSTElSTE9QREZQREknOwoJCQkJCX0gLy8gVSsyMDY3IFJMSSAvLyBVKzIwMkUgUkxPCgkJCQkJZWxzZSB7CgkJCQkJCSRiZGYgPSAweDIwNjY7CgkJCQkJCSRiZGYyID0gMHgyMDJEOwoJCQkJCQkkcG9wZCA9ICdMUklMUk9QREZQREknOwoJCQkJCX0gLy8gVSsyMDY2IExSSSAgLy8gVSsyMDJEIExSTwoJCQkJfSBlbHNlIGlmIChpc3NldCgkcHJvcGVydGllcyBbJ1VOSUNPREUtQklESSddKSAmJiBzdHJ0b2xvd2VyKCRwcm9wZXJ0aWVzIFsnVU5JQ09ERS1CSURJJ10pID09ICdwbGFpbnRleHQnKSB7CgkJCQkJJGJkZiA9IDB4MjA2ODsKCQkJCQkkcG9wZCA9ICdGU0lQREknOyAvLyBVKzIwNjggRlNJCgkJCQl9IGVsc2UgewoJCQkJCWlmIChpc3NldCgkYXR0clsnRElSJ10pIGFuZCBzdHJ0b2xvd2VyKCRhdHRyWydESVInXSkgPT0gJ3J0bCcpIHsKCQkJCQkJJGJkZiA9IDB4MjAyQjsKCQkJCQkJJHBvcGQgPSAnUkxFUERGJzsKCQkJCQl9IC8vIFUrMjAyQiBSTEUKCQkJCQllbHNlIGlmIChpc3NldCgkYXR0clsnRElSJ10pIGFuZCBzdHJ0b2xvd2VyKCRhdHRyWydESVInXSkgPT0gJ2x0cicpIHsKCQkJCQkJJGJkZiA9IDB4MjAyQTsKCQkJCQkJJHBvcGQgPSAnTFJFUERGJzsKCQkJCQl9IC8vIFUrMjAyQSBMUkUKCQkJCX0KCgkJCQlpZiAoJGJkZikgewoJCQkJCS8vIG1QREYgNS43LjMgSW5saW5lIHRhZ3MKCQkJCQlpZiAoIWlzc2V0KCR0aGlzLT5tcGRmLT5JbmxpbmVCREZbJHRhZ10pKSB7CgkJCQkJCSR0aGlzLT5tcGRmLT5JbmxpbmVCREZbJHRhZ10gPSBhcnJheShhcnJheSgkcG9wZCwgJHRoaXMtPm1wZGYtPklubGluZUJERmN0cikpOwoJCQkJCX0gZWxzZSB7CgkJCQkJCSR0aGlzLT5tcGRmLT5JbmxpbmVCREZbJHRhZ11bXSA9IGFycmF5KCRwb3BkLCAkdGhpcy0+bXBkZi0+SW5saW5lQkRGY3RyKTsKCQkJCQl9CgkJCQkJJHRoaXMtPm1wZGYtPklubGluZUJERmN0cisrOwoJCQkJCWlmICgkYmRmMikgewoJCQkJCQkkYmRmMiA9IGNvZGUydXRmKCRiZGYpOwoJCQkJCX0KCQkJCQkkdGhpcy0+bXBkZi0+T1RMZGF0YSA9IGFycmF5KCk7CgkJCQkJaWYgKCR0aGlzLT5tcGRmLT50YWJsZUxldmVsKSB7CgkJCQkJCSR0aGlzLT5tcGRmLT5fc2F2ZUNlbGxUZXh0QnVmZmVyKGNvZGUydXRmKCRiZGYpIC4gJGJkZjIpOwoJCQkJCX0gZWxzZSB7CgkJCQkJCSR0aGlzLT5tcGRmLT5fc2F2ZVRleHRCdWZmZXIoY29kZTJ1dGYoJGJkZikgLiAkYmRmMik7CgkJCQkJfQoJCQkJCSR0aGlzLT5tcGRmLT5iaURpcmVjdGlvbmFsID0gdHJ1ZTsKCQkJCX0KCgkJCQlicmVhazsKCgoJCQljYXNlICdBJzoKCQkJCWlmIChpc3NldCgkYXR0clsnTkFNRSddKSBhbmQgJGF0dHJbJ05BTUUnXSAhPSAnJykgewoJCQkJCSRlID0gJyc7CgkJCQkJLyogLS0gQk9PS01BUktTIC0tICovCgkJCQkJaWYgKCR0aGlzLT5tcGRmLT5hbmNob3IyQm9va21hcmspIHsKCQkJCQkJJG9iamF0dHIgPSBhcnJheSgpOwoJCQkJCQkkb2JqYXR0clsnQ09OVEVOVCddID0gaHRtbHNwZWNpYWxjaGFyc19kZWNvZGUoJGF0dHJbJ05BTUUnXSwgRU5UX1FVT1RFUyk7CgkJCQkJCSRvYmphdHRyWyd0eXBlJ10gPSAnYm9va21hcmsnOwoJCQkJCQlpZiAoaXNzZXQoJGF0dHJbJ0xFVkVMJ10pICYmICRhdHRyWydMRVZFTCddKSB7CgkJCQkJCQkkb2JqYXR0clsnYmtsZXZlbCddID0gJGF0dHJbJ0xFVkVMJ107CgkJCQkJCX0gZWxzZSB7CgkJCQkJCQkkb2JqYXR0clsnYmtsZXZlbCddID0gMDsKCQkJCQkJfQoJCQkJCQkkZSA9ICJceGJiXHhhNFx4YWN0eXBlPWJvb2ttYXJrLG9iamF0dHI9IiAuIHNlcmlhbGl6ZSgkb2JqYXR0cikgLiAiXHhiYlx4YTRceGFjIjsKCQkJCQl9CgkJCQkJLyogLS0gRU5EIEJPT0tNQVJLUyAtLSAqLwoJCQkJCWlmICgkdGhpcy0+bXBkZi0+dGFibGVMZXZlbCkgeyAvLyAqVEFCTEVTKgoJCQkJCQkkdGhpcy0+bXBkZi0+X3NhdmVDZWxsVGV4dEJ1ZmZlcigkZSwgJycsICRhdHRyWydOQU1FJ10pOyAvLyAqVEFCTEVTKgoJCQkJCX0gLy8gKlRBQkxFUyoKCQkJCQllbHNlIHsgLy8gKlRBQkxFUyoKCQkJCQkJJHRoaXMtPm1wZGYtPl9zYXZlVGV4dEJ1ZmZlcigkZSwgJycsICRhdHRyWydOQU1FJ10pOyAvL2FuIGludGVybmFsIGxpbmsgKGFkZHMgYSBzcGFjZSBmb3IgcmVjb2duaXRpb24pCgkJCQkJfSAvLyAqVEFCTEVTKgoJCQkJfQoJCQkJaWYgKGlzc2V0KCRhdHRyWydIUkVGJ10pKSB7CgkJCQkJJHRoaXMtPm1wZGYtPklubGluZVByb3BlcnRpZXNbJ0EnXSA9ICR0aGlzLT5tcGRmLT5zYXZlSW5saW5lUHJvcGVydGllcygpOwoJCQkJCSRwcm9wZXJ0aWVzID0gJHRoaXMtPm1wZGYtPmNzc21nci0+TWVyZ2VDU1MoJ0lOTElORScsICR0YWcsICRhdHRyKTsKCQkJCQlpZiAoIWVtcHR5KCRwcm9wZXJ0aWVzKSkKCQkJCQkJJHRoaXMtPm1wZGYtPnNldENTUygkcHJvcGVydGllcywgJ0lOTElORScpOwoJCQkJCSR0aGlzLT5tcGRmLT5IUkVGID0gJGF0dHJbJ0hSRUYnXTsgLy8gbVBERiA1LjcuNCBVUkxzCgkJCQl9CgkJCQlicmVhazsKCgkJCWNhc2UgJ0xFR0VORCc6CgkJCQkkdGhpcy0+bXBkZi0+SW5saW5lUHJvcGVydGllc1snTEVHRU5EJ10gPSAkdGhpcy0+bXBkZi0+c2F2ZUlubGluZVByb3BlcnRpZXMoKTsKCQkJCSRwcm9wZXJ0aWVzID0gJHRoaXMtPm1wZGYtPmNzc21nci0+TWVyZ2VDU1MoJ0lOTElORScsICR0YWcsICRhdHRyKTsKCQkJCWlmICghZW1wdHkoJHByb3BlcnRpZXMpKQoJCQkJCSR0aGlzLT5tcGRmLT5zZXRDU1MoJHByb3BlcnRpZXMsICdJTkxJTkUnKTsKCQkJCWJyZWFrOwoKCgoJCQljYXNlICdQUk9HUkVTUyc6CgkJCWNhc2UgJ01FVEVSJzoKCQkJCSR0aGlzLT5tcGRmLT5pbk1ldGVyID0gdHJ1ZTsKCgkJCQlpZiAoaXNzZXQoJGF0dHJbJ01BWCddKSAmJiAkYXR0clsnTUFYJ10pIHsKCQkJCQkkbWF4ID0gJGF0dHJbJ01BWCddOwoJCQkJfSBlbHNlIHsKCQkJCQkkbWF4ID0gMTsKCQkJCX0KCQkJCWlmIChpc3NldCgkYXR0clsnTUlOJ10pICYmICRhdHRyWydNSU4nXSAmJiAkdGFnID09ICdNRVRFUicpIHsKCQkJCQkkbWluID0gJGF0dHJbJ01JTiddOwoJCQkJfSBlbHNlIHsKCQkJCQkkbWluID0gMDsKCQkJCX0KCQkJCWlmICgkbWF4IDwgJG1pbikgewoJCQkJCSRtYXggPSAkbWluOwoJCQkJfQoKCQkJCWlmIChpc3NldCgkYXR0clsnVkFMVUUnXSkgJiYgKCRhdHRyWydWQUxVRSddIHx8ICRhdHRyWydWQUxVRSddID09PSAnMCcpKSB7CgkJCQkJJHZhbHVlID0gJGF0dHJbJ1ZBTFVFJ107CgkJCQkJaWYgKCR2YWx1ZSA8ICRtaW4pIHsKCQkJCQkJJHZhbHVlID0gJG1pbjsKCQkJCQl9IGVsc2UgaWYgKCR2YWx1ZSA+ICRtYXgpIHsKCQkJCQkJJHZhbHVlID0gJG1heDsKCQkJCQl9CgkJCQl9IGVsc2UgewoJCQkJCSR2YWx1ZSA9ICcnOwoJCQkJfQoKCQkJCWlmIChpc3NldCgkYXR0clsnTE9XJ10pICYmICRhdHRyWydMT1cnXSkgewoJCQkJCSRsb3cgPSAkYXR0clsnTE9XJ107CgkJCQl9IGVsc2UgewoJCQkJCSRsb3cgPSAkbWluOwoJCQkJfQoJCQkJaWYgKCRsb3cgPCAkbWluKSB7CgkJCQkJJGxvdyA9ICRtaW47CgkJCQl9IGVsc2UgaWYgKCRsb3cgPiAkbWF4KSB7CgkJCQkJJGxvdyA9ICRtYXg7CgkJCQl9CgkJCQlpZiAoaXNzZXQoJGF0dHJbJ0hJR0gnXSkgJiYgJGF0dHJbJ0hJR0gnXSkgewoJCQkJCSRoaWdoID0gJGF0dHJbJ0hJR0gnXTsKCQkJCX0gZWxzZSB7CgkJCQkJJGhpZ2ggPSAkbWF4OwoJCQkJfQoJCQkJaWYgKCRoaWdoIDwgJGxvdykgewoJCQkJCSRoaWdoID0gJGxvdzsKCQkJCX0gZWxzZSBpZiAoJGhpZ2ggPiAkbWF4KSB7CgkJCQkJJGhpZ2ggPSAkbWF4OwoJCQkJfQoJCQkJaWYgKGlzc2V0KCRhdHRyWydPUFRJTVVNJ10pICYmICRhdHRyWydPUFRJTVVNJ10pIHsKCQkJCQkkb3B0aW11bSA9ICRhdHRyWydPUFRJTVVNJ107CgkJCQl9IGVsc2UgewoJCQkJCSRvcHRpbXVtID0gJG1pbiArICgoJG1heCAtICRtaW4pIC8gMik7CgkJCQl9CgkJCQlpZiAoJG9wdGltdW0gPCAkbWluKSB7CgkJCQkJJG9wdGltdW0gPSAkbWluOwoJCQkJfSBlbHNlIGlmICgkb3B0aW11bSA+ICRtYXgpIHsKCQkJCQkkb3B0aW11bSA9ICRtYXg7CgkJCQl9CgkJCQlpZiAoaXNzZXQoJGF0dHJbJ1RZUEUnXSkgJiYgJGF0dHJbJ1RZUEUnXSkgewoJCQkJCSR0eXBlID0gJGF0dHJbJ1RZUEUnXTsKCQkJCX0gZWxzZSB7CgkJCQkJJHR5cGUgPSAnJzsKCQkJCX0KCQkJCSRvYmphdHRyID0gYXJyYXkoKTsKCQkJCSRvYmphdHRyWydtYXJnaW5fdG9wJ10gPSAwOwoJCQkJJG9iamF0dHJbJ21hcmdpbl9ib3R0b20nXSA9IDA7CgkJCQkkb2JqYXR0clsnbWFyZ2luX2xlZnQnXSA9IDA7CgkJCQkkb2JqYXR0clsnbWFyZ2luX3JpZ2h0J10gPSAwOwoJCQkJJG9iamF0dHJbJ3BhZGRpbmdfdG9wJ10gPSAwOwoJCQkJJG9iamF0dHJbJ3BhZGRpbmdfYm90dG9tJ10gPSAwOwoJCQkJJG9iamF0dHJbJ3BhZGRpbmdfbGVmdCddID0gMDsKCQkJCSRvYmphdHRyWydwYWRkaW5nX3JpZ2h0J10gPSAwOwoJCQkJJG9iamF0dHJbJ3dpZHRoJ10gPSAwOwoJCQkJJG9iamF0dHJbJ2hlaWdodCddID0gMDsKCQkJCSRvYmphdHRyWydib3JkZXJfdG9wJ11bJ3cnXSA9IDA7CgkJCQkkb2JqYXR0clsnYm9yZGVyX2JvdHRvbSddWyd3J10gPSAwOwoJCQkJJG9iamF0dHJbJ2JvcmRlcl9sZWZ0J11bJ3cnXSA9IDA7CgkJCQkkb2JqYXR0clsnYm9yZGVyX3JpZ2h0J11bJ3cnXSA9IDA7CgoJCQkJJHByb3BlcnRpZXMgPSAkdGhpcy0+bXBkZi0+Y3NzbWdyLT5NZXJnZUNTUygnSU5MSU5FJywgJHRhZywgJGF0dHIpOwoJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzIFsnRElTUExBWSddKSAmJiBzdHJ0b2xvd2VyKCRwcm9wZXJ0aWVzIFsnRElTUExBWSddKSA9PSAnbm9uZScpIHsKCQkJCQlyZXR1cm47CgkJCQl9CgkJCQkkb2JqYXR0clsndmlzaWJpbGl0eSddID0gJ3Zpc2libGUnOwoJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydWSVNJQklMSVRZJ10pKSB7CgkJCQkJJHYgPSBzdHJ0b2xvd2VyKCRwcm9wZXJ0aWVzWydWSVNJQklMSVRZJ10pOwoJCQkJCWlmICgoJHYgPT0gJ2hpZGRlbicgfHwgJHYgPT0gJ3ByaW50b25seScgfHwgJHYgPT0gJ3NjcmVlbm9ubHknKSAmJiAkdGhpcy0+bXBkZi0+dmlzaWJpbGl0eSA9PSAndmlzaWJsZScpIHsKCQkJCQkJJG9iamF0dHJbJ3Zpc2liaWxpdHknXSA9ICR2OwoJCQkJCX0KCQkJCX0KCgkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ01BUkdJTi1UT1AnXSkpIHsKCQkJCQkkb2JqYXR0clsnbWFyZ2luX3RvcCddID0gJHRoaXMtPm1wZGYtPkNvbnZlcnRTaXplKCRwcm9wZXJ0aWVzWydNQVJHSU4tVE9QJ10sICR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ2lubmVyX3dpZHRoJ10sICR0aGlzLT5tcGRmLT5Gb250U2l6ZSwgZmFsc2UpOwoJCQkJfQoJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydNQVJHSU4tQk9UVE9NJ10pKSB7CgkJCQkJJG9iamF0dHJbJ21hcmdpbl9ib3R0b20nXSA9ICR0aGlzLT5tcGRmLT5Db252ZXJ0U2l6ZSgkcHJvcGVydGllc1snTUFSR0lOLUJPVFRPTSddLCAkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWydpbm5lcl93aWR0aCddLCAkdGhpcy0+bXBkZi0+Rm9udFNpemUsIGZhbHNlKTsKCQkJCX0KCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snTUFSR0lOLUxFRlQnXSkpIHsKCQkJCQkkb2JqYXR0clsnbWFyZ2luX2xlZnQnXSA9ICR0aGlzLT5tcGRmLT5Db252ZXJ0U2l6ZSgkcHJvcGVydGllc1snTUFSR0lOLUxFRlQnXSwgJHRoaXMtPm1wZGYtPmJsa1skdGhpcy0+bXBkZi0+YmxrbHZsXVsnaW5uZXJfd2lkdGgnXSwgJHRoaXMtPm1wZGYtPkZvbnRTaXplLCBmYWxzZSk7CgkJCQl9CgkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ01BUkdJTi1SSUdIVCddKSkgewoJCQkJCSRvYmphdHRyWydtYXJnaW5fcmlnaHQnXSA9ICR0aGlzLT5tcGRmLT5Db252ZXJ0U2l6ZSgkcHJvcGVydGllc1snTUFSR0lOLVJJR0hUJ10sICR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ2lubmVyX3dpZHRoJ10sICR0aGlzLT5tcGRmLT5Gb250U2l6ZSwgZmFsc2UpOwoJCQkJfQoKCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snUEFERElORy1UT1AnXSkpIHsKCQkJCQkkb2JqYXR0clsncGFkZGluZ190b3AnXSA9ICR0aGlzLT5tcGRmLT5Db252ZXJ0U2l6ZSgkcHJvcGVydGllc1snUEFERElORy1UT1AnXSwgJHRoaXMtPm1wZGYtPmJsa1skdGhpcy0+bXBkZi0+YmxrbHZsXVsnaW5uZXJfd2lkdGgnXSwgJHRoaXMtPm1wZGYtPkZvbnRTaXplLCBmYWxzZSk7CgkJCQl9CgkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ1BBRERJTkctQk9UVE9NJ10pKSB7CgkJCQkJJG9iamF0dHJbJ3BhZGRpbmdfYm90dG9tJ10gPSAkdGhpcy0+bXBkZi0+Q29udmVydFNpemUoJHByb3BlcnRpZXNbJ1BBRERJTkctQk9UVE9NJ10sICR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ2lubmVyX3dpZHRoJ10sICR0aGlzLT5tcGRmLT5Gb250U2l6ZSwgZmFsc2UpOwoJCQkJfQoJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydQQURESU5HLUxFRlQnXSkpIHsKCQkJCQkkb2JqYXR0clsncGFkZGluZ19sZWZ0J10gPSAkdGhpcy0+bXBkZi0+Q29udmVydFNpemUoJHByb3BlcnRpZXNbJ1BBRERJTkctTEVGVCddLCAkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWydpbm5lcl93aWR0aCddLCAkdGhpcy0+bXBkZi0+Rm9udFNpemUsIGZhbHNlKTsKCQkJCX0KCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snUEFERElORy1SSUdIVCddKSkgewoJCQkJCSRvYmphdHRyWydwYWRkaW5nX3JpZ2h0J10gPSAkdGhpcy0+bXBkZi0+Q29udmVydFNpemUoJHByb3BlcnRpZXNbJ1BBRERJTkctUklHSFQnXSwgJHRoaXMtPm1wZGYtPmJsa1skdGhpcy0+bXBkZi0+YmxrbHZsXVsnaW5uZXJfd2lkdGgnXSwgJHRoaXMtPm1wZGYtPkZvbnRTaXplLCBmYWxzZSk7CgkJCQl9CgoJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydCT1JERVItVE9QJ10pKSB7CgkJCQkJJG9iamF0dHJbJ2JvcmRlcl90b3AnXSA9ICR0aGlzLT5tcGRmLT5ib3JkZXJfZGV0YWlscygkcHJvcGVydGllc1snQk9SREVSLVRPUCddKTsKCQkJCX0KCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snQk9SREVSLUJPVFRPTSddKSkgewoJCQkJCSRvYmphdHRyWydib3JkZXJfYm90dG9tJ10gPSAkdGhpcy0+bXBkZi0+Ym9yZGVyX2RldGFpbHMoJHByb3BlcnRpZXNbJ0JPUkRFUi1CT1RUT00nXSk7CgkJCQl9CgkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ0JPUkRFUi1MRUZUJ10pKSB7CgkJCQkJJG9iamF0dHJbJ2JvcmRlcl9sZWZ0J10gPSAkdGhpcy0+bXBkZi0+Ym9yZGVyX2RldGFpbHMoJHByb3BlcnRpZXNbJ0JPUkRFUi1MRUZUJ10pOwoJCQkJfQoJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydCT1JERVItUklHSFQnXSkpIHsKCQkJCQkkb2JqYXR0clsnYm9yZGVyX3JpZ2h0J10gPSAkdGhpcy0+bXBkZi0+Ym9yZGVyX2RldGFpbHMoJHByb3BlcnRpZXNbJ0JPUkRFUi1SSUdIVCddKTsKCQkJCX0KCgkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ1ZFUlRJQ0FMLUFMSUdOJ10pKSB7CgkJCQkJJG9iamF0dHJbJ3ZlcnRpY2FsLWFsaWduJ10gPSAkYWxpZ25bc3RydG9sb3dlcigkcHJvcGVydGllc1snVkVSVElDQUwtQUxJR04nXSldOwoJCQkJfQoJCQkJJHcgPSAwOwoJCQkJJGggPSAwOwoJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydXSURUSCddKSkKCQkJCQkkdyA9ICR0aGlzLT5tcGRmLT5Db252ZXJ0U2l6ZSgkcHJvcGVydGllc1snV0lEVEgnXSwgJHRoaXMtPm1wZGYtPmJsa1skdGhpcy0+bXBkZi0+YmxrbHZsXVsnaW5uZXJfd2lkdGgnXSwgJHRoaXMtPm1wZGYtPkZvbnRTaXplLCBmYWxzZSk7CgkJCQllbHNlIGlmIChpc3NldCgkYXR0clsnV0lEVEgnXSkpCgkJCQkJJHcgPSAkdGhpcy0+bXBkZi0+Q29udmVydFNpemUoJGF0dHJbJ1dJRFRIJ10sICR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ2lubmVyX3dpZHRoJ10sICR0aGlzLT5tcGRmLT5Gb250U2l6ZSwgZmFsc2UpOwoKCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snSEVJR0hUJ10pKQoJCQkJCSRoID0gJHRoaXMtPm1wZGYtPkNvbnZlcnRTaXplKCRwcm9wZXJ0aWVzWydIRUlHSFQnXSwgJHRoaXMtPm1wZGYtPmJsa1skdGhpcy0+bXBkZi0+YmxrbHZsXVsnaW5uZXJfd2lkdGgnXSwgJHRoaXMtPm1wZGYtPkZvbnRTaXplLCBmYWxzZSk7CgkJCQllbHNlIGlmIChpc3NldCgkYXR0clsnSEVJR0hUJ10pKQoJCQkJCSRoID0gJHRoaXMtPm1wZGYtPkNvbnZlcnRTaXplKCRhdHRyWydIRUlHSFQnXSwgJHRoaXMtPm1wZGYtPmJsa1skdGhpcy0+bXBkZi0+YmxrbHZsXVsnaW5uZXJfd2lkdGgnXSwgJHRoaXMtPm1wZGYtPkZvbnRTaXplLCBmYWxzZSk7CgoJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydPUEFDSVRZJ10pICYmICRwcm9wZXJ0aWVzWydPUEFDSVRZJ10gPiAwICYmICRwcm9wZXJ0aWVzWydPUEFDSVRZJ10gPD0gMSkgewoJCQkJCSRvYmphdHRyWydvcGFjaXR5J10gPSAkcHJvcGVydGllc1snT1BBQ0lUWSddOwoJCQkJfQoJCQkJaWYgKCR0aGlzLT5tcGRmLT5IUkVGKSB7CgkJCQkJaWYgKHN0cnBvcygkdGhpcy0+bXBkZi0+SFJFRiwgIi4iKSA9PT0gZmFsc2UgJiYgc3RycG9zKCR0aGlzLT5tcGRmLT5IUkVGLCAiQCIpICE9PSAwKSB7CgkJCQkJCSRocmVmID0gJHRoaXMtPm1wZGYtPkhSRUY7CgkJCQkJCXdoaWxlIChhcnJheV9rZXlfZXhpc3RzKCRocmVmLCAkdGhpcy0+bXBkZi0+aW50ZXJuYWxsaW5rKSkKCQkJCQkJCSRocmVmID0gIiMiIC4gJGhyZWY7CgkJCQkJCSR0aGlzLT5tcGRmLT5pbnRlcm5hbGxpbmtbJGhyZWZdID0gJHRoaXMtPm1wZGYtPkFkZExpbmsoKTsKCQkJCQkJJG9iamF0dHJbJ2xpbmsnXSA9ICR0aGlzLT5tcGRmLT5pbnRlcm5hbGxpbmtbJGhyZWZdOwoJCQkJCX0gZWxzZSB7CgkJCQkJCSRvYmphdHRyWydsaW5rJ10gPSAkdGhpcy0+bXBkZi0+SFJFRjsKCQkJCQl9CgkJCQl9CgkJCQkkZXh0cmFoZWlnaHQgPSAkb2JqYXR0clsncGFkZGluZ190b3AnXSArICRvYmphdHRyWydwYWRkaW5nX2JvdHRvbSddICsgJG9iamF0dHJbJ21hcmdpbl90b3AnXSArICRvYmphdHRyWydtYXJnaW5fYm90dG9tJ10gKyAkb2JqYXR0clsnYm9yZGVyX3RvcCddWyd3J10gKyAkb2JqYXR0clsnYm9yZGVyX2JvdHRvbSddWyd3J107CgkJCQkkZXh0cmF3aWR0aCA9ICRvYmphdHRyWydwYWRkaW5nX2xlZnQnXSArICRvYmphdHRyWydwYWRkaW5nX3JpZ2h0J10gKyAkb2JqYXR0clsnbWFyZ2luX2xlZnQnXSArICRvYmphdHRyWydtYXJnaW5fcmlnaHQnXSArICRvYmphdHRyWydib3JkZXJfbGVmdCddWyd3J10gKyAkb2JqYXR0clsnYm9yZGVyX3JpZ2h0J11bJ3cnXTsKCgkJCQkvLyBJbWFnZSBmaWxlCgkJCQlpZiAoIWNsYXNzX2V4aXN0cygnbWV0ZXInLCBmYWxzZSkpIHsKCQkJCQlpbmNsdWRlKF9NUERGX1BBVEggLiAnY2xhc3Nlcy9tZXRlci5waHAnKTsKCQkJCX0KCQkJCSR0aGlzLT5tcGRmLT5tZXRlciA9IG5ldyBtZXRlcigpOwoJCQkJJHN2ZyA9ICR0aGlzLT5tcGRmLT5tZXRlci0+bWFrZVNWRyhzdHJ0b2xvd2VyKCR0YWcpLCAkdHlwZSwgJHZhbHVlLCAkbWF4LCAkbWluLCAkb3B0aW11bSwgJGxvdywgJGhpZ2gpOwoJCQkJLy9TYXZlIHRvIGxvY2FsIGZpbGUKCQkJCSRzcmNwYXRoID0gX01QREZfVEVNUF9QQVRIIC4gJ190ZW1wU1ZHJyAuIHVuaXFpZChyYW5kKDEsIDEwMDAwMCksIHRydWUpIC4gJ18nIC4gc3RydG9sb3dlcigkdGFnKSAuICcuc3ZnJzsKCQkJCWZpbGVfcHV0X2NvbnRlbnRzKCRzcmNwYXRoLCAkc3ZnKTsKCQkJCSRvcmlnX3NyY3BhdGggPSAkc3JjcGF0aDsKCQkJCSR0aGlzLT5tcGRmLT5HZXRGdWxsUGF0aCgkc3JjcGF0aCk7CgoJCQkJJGluZm8gPSAkdGhpcy0+bXBkZi0+X2dldEltYWdlKCRzcmNwYXRoLCB0cnVlLCB0cnVlLCAkb3JpZ19zcmNwYXRoKTsKCQkJCWlmICghJGluZm8pIHsKCQkJCQkkaW5mbyA9ICR0aGlzLT5tcGRmLT5fZ2V0SW1hZ2UoJHRoaXMtPm1wZGYtPm5vSW1hZ2VGaWxlKTsKCQkJCQlpZiAoJGluZm8pIHsKCQkJCQkJJHNyY3BhdGggPSAkdGhpcy0+bXBkZi0+bm9JbWFnZUZpbGU7CgkJCQkJCSR3ID0gKCRpbmZvWyd3J10gKiAoMjUuNCAvICR0aGlzLT5tcGRmLT5kcGkpKTsKCQkJCQkJJGggPSAoJGluZm9bJ2gnXSAqICgyNS40IC8gJHRoaXMtPm1wZGYtPmRwaSkpOwoJCQkJCX0KCQkJCX0KCQkJCWlmICghJGluZm8pCgkJCQkJYnJlYWs7CgoJCQkJJG9iamF0dHJbJ2ZpbGUnXSA9ICRzcmNwYXRoOwoJCQkJLy9EZWZhdWx0IHdpZHRoIGFuZCBoZWlnaHQgY2FsY3VsYXRpb24gaWYgbmVlZGVkCgkJCQlpZiAoJHcgPT0gMCBhbmQgJGggPT0gMCkgewoJCQkJCS8vIFNWRyB1bml0cyBhcmUgcGl4ZWxzCgkJCQkJJHcgPSAkdGhpcy0+bXBkZi0+Rm9udFNpemUgLyAoMTAgLyBfTVBERkspICogYWJzKCRpbmZvWyd3J10pIC8gX01QREZLOwoJCQkJCSRoID0gJHRoaXMtPm1wZGYtPkZvbnRTaXplIC8gKDEwIC8gX01QREZLKSAqIGFicygkaW5mb1snaCddKSAvIF9NUERGSzsKCQkJCX0KCQkJCS8vIElGIFdJRFRIIE9SIEhFSUdIVCBTUEVDSUZJRUQKCQkJCWlmICgkdyA9PSAwKQoJCQkJCSR3ID0gYWJzKCRoICogJGluZm9bJ3cnXSAvICRpbmZvWydoJ10pOwoJCQkJaWYgKCRoID09IDApCgkJCQkJJGggPSBhYnMoJHcgKiAkaW5mb1snaCddIC8gJGluZm9bJ3cnXSk7CgoJCQkJLy8gUmVzaXplIHRvIG1heGltdW0gZGltZW5zaW9ucyBvZiBwYWdlCgkJCQkkbWF4V2lkdGggPSAkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWydpbm5lcl93aWR0aCddOwoJCQkJJG1heEhlaWdodCA9ICR0aGlzLT5tcGRmLT5oIC0gKCR0aGlzLT5tcGRmLT50TWFyZ2luICsgJHRoaXMtPm1wZGYtPmJNYXJnaW4gKyAxKTsKCQkJCWlmICgkdGhpcy0+bXBkZi0+ZnVsbEltYWdlSGVpZ2h0KSB7CgkJCQkJJG1heEhlaWdodCA9ICR0aGlzLT5tcGRmLT5mdWxsSW1hZ2VIZWlnaHQ7CgkJCQl9CgkJCQlpZiAoKCR3ICsgJGV4dHJhd2lkdGgpID4gKCRtYXhXaWR0aCArIDAuMDAwMSkpIHsgLy8gbVBERiA1LjcuNCAgMC4wMDAxIHRvIGFsbG93IGZvciByb3VuZGluZyBlcnJvcnMgd2hlbiB3PT1tYXhXaWR0aAoJCQkJCSR3ID0gJG1heFdpZHRoIC0gJGV4dHJhd2lkdGg7CgkJCQkJJGggPSBhYnMoJHcgKiAkaW5mb1snaCddIC8gJGluZm9bJ3cnXSk7CgkJCQl9CgoJCQkJaWYgKCRoICsgJGV4dHJhaGVpZ2h0ID4gJG1heEhlaWdodCkgewoJCQkJCSRoID0gJG1heEhlaWdodCAtICRleHRyYWhlaWdodDsKCQkJCQkkdyA9IGFicygkaCAqICRpbmZvWyd3J10gLyAkaW5mb1snaCddKTsKCQkJCX0KCQkJCSRvYmphdHRyWyd0eXBlJ10gPSAnaW1hZ2UnOwoJCQkJJG9iamF0dHJbJ2l0eXBlJ10gPSAkaW5mb1sndHlwZSddOwoKCQkJCSRvYmphdHRyWydvcmlnX2gnXSA9ICRpbmZvWydoJ107CgkJCQkkb2JqYXR0clsnb3JpZ193J10gPSAkaW5mb1sndyddOwoJCQkJJG9iamF0dHJbJ3dtZl94J10gPSAkaW5mb1sneCddOwoJCQkJJG9iamF0dHJbJ3dtZl95J10gPSAkaW5mb1sneSddOwoJCQkJJG9iamF0dHJbJ2hlaWdodCddID0gJGggKyAkZXh0cmFoZWlnaHQ7CgkJCQkkb2JqYXR0clsnd2lkdGgnXSA9ICR3ICsgJGV4dHJhd2lkdGg7CgkJCQkkb2JqYXR0clsnaW1hZ2VfaGVpZ2h0J10gPSAkaDsKCQkJCSRvYmphdHRyWydpbWFnZV93aWR0aCddID0gJHc7CgkJCQkkZSA9ICJceGJiXHhhNFx4YWN0eXBlPWltYWdlLG9iamF0dHI9IiAuIHNlcmlhbGl6ZSgkb2JqYXR0cikgLiAiXHhiYlx4YTRceGFjIjsKCQkJCSRwcm9wZXJ0aWVzID0gYXJyYXkoKTsKCQkJCWlmICgkdGhpcy0+bXBkZi0+dGFibGVMZXZlbCkgewoJCQkJCSR0aGlzLT5tcGRmLT5fc2F2ZUNlbGxUZXh0QnVmZmVyKCRlLCAkdGhpcy0+bXBkZi0+SFJFRik7CgkJCQkJJHRoaXMtPm1wZGYtPmNlbGxbJHRoaXMtPm1wZGYtPnJvd11bJHRoaXMtPm1wZGYtPmNvbF1bJ3MnXSArPSAkb2JqYXR0clsnd2lkdGgnXTsKCQkJCX0gZWxzZSB7CgkJCQkJJHRoaXMtPm1wZGYtPl9zYXZlVGV4dEJ1ZmZlcigkZSwgJHRoaXMtPm1wZGYtPkhSRUYpOwoJCQkJfQoKCQkJCWJyZWFrOwoKCgkJCWNhc2UgJ0JSJzoKCQkJCS8vIEFkZGVkIG1QREYgMy4wIEZsb2F0IERJViAtIENMRUFSCgkJCQlpZiAoaXNzZXQoJGF0dHJbJ1NUWUxFJ10pKSB7CgkJCQkJJHByb3BlcnRpZXMgPSAkdGhpcy0+bXBkZi0+Y3NzbWdyLT5yZWFkSW5saW5lQ1NTKCRhdHRyWydTVFlMRSddKTsKCQkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ0NMRUFSJ10pKSB7CgkJCQkJCSR0aGlzLT5tcGRmLT5DbGVhckZsb2F0cyhzdHJ0b3VwcGVyKCRwcm9wZXJ0aWVzWydDTEVBUiddKSwgJHRoaXMtPm1wZGYtPmJsa2x2bCk7CgkJCQkJfSAvLyAqQ1NTLUZMT0FUKgoJCQkJfQoKCQkJCS8vIG1QREYgNiBiaWRpCgkJCQkvLyBJbmxpbmUKCQkJCS8vIElmIHVuaWNvZGUtYmlkaSBzZXQsIGFueSBlbWJlZGRpbmcgbGV2ZWxzLCBpc29sYXRlcywgb3Igb3ZlcnJpZGVzIHN0YXJ0ZWQgYnkgdGhlIGlubGluZSBib3ggYXJlIGNsb3NlZCBhdCB0aGUgYnIgYW5kIHJlb3BlbmVkIG9uIHRoZSBvdGhlciBzaWRlCgkJCQkkYmxvY2twcmUgPSAnJzsKCQkJCSRibG9ja3Bvc3QgPSAnJzsKCQkJCWlmIChpc3NldCgkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWydiaWRpY29kZSddKSkgewoJCQkJCSRibG9ja3ByZSA9ICR0aGlzLT5tcGRmLT5fc2V0QmlkaUNvZGVzKCdlbmQnLCAkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWydiaWRpY29kZSddKTsKCQkJCQkkYmxvY2twb3N0ID0gJHRoaXMtPm1wZGYtPl9zZXRCaWRpQ29kZXMoJ3N0YXJ0JywgJHRoaXMtPm1wZGYtPmJsa1skdGhpcy0+bXBkZi0+YmxrbHZsXVsnYmlkaWNvZGUnXSk7CgkJCQl9CgoJCQkJLy8gSW5saW5lCgkJCQkvLyBJZiB1bmljb2RlLWJpZGkgc2V0LCBhbnkgZW1iZWRkaW5nIGxldmVscywgaXNvbGF0ZXMsIG9yIG92ZXJyaWRlcyBzdGFydGVkIGJ5IHRoZSBpbmxpbmUgYm94IGFyZSBjbG9zZWQgYXQgdGhlIGJyIGFuZCByZW9wZW5lZCBvbiB0aGUgb3RoZXIgc2lkZQoJCQkJJGlubGluZXByZSA9ICcnOwoJCQkJJGlubGluZXBvc3QgPSAnJzsKCQkJCSRpQkRGID0gYXJyYXkoKTsKCQkJCWlmIChjb3VudCgkdGhpcy0+bXBkZi0+SW5saW5lQkRGKSkgewoJCQkJCWZvcmVhY2ggKCR0aGlzLT5tcGRmLT5JbmxpbmVCREYgQVMgJGsgPT4gJGliKSB7CgkJCQkJCWZvcmVhY2ggKCRpYiBBUyAkaWIyKSB7CgkJCQkJCQkkaUJERlskaWIyWzFdXSA9ICRpYjJbMF07CgkJCQkJCX0KCQkJCQl9CgkJCQkJaWYgKGNvdW50KCRpQkRGKSkgewoJCQkJCQlrc29ydCgkaUJERik7CgkJCQkJCWZvciAoJGkgPSBjb3VudCgkaUJERikgLSAxOyAkaSA+PSAwOyAkaS0tKSB7CgkJCQkJCQkkaW5saW5lcHJlIC49ICR0aGlzLT5tcGRmLT5fc2V0QmlkaUNvZGVzKCdlbmQnLCAkaUJERlskaV0pOwoJCQkJCQl9CgkJCQkJCWZvciAoJGkgPSAwOyAkaSA8IGNvdW50KCRpQkRGKTsgJGkrKykgewoJCQkJCQkJJGlubGluZXBvc3QgLj0gJHRoaXMtPm1wZGYtPl9zZXRCaWRpQ29kZXMoJ3N0YXJ0JywgJGlCREZbJGldKTsKCQkJCQkJfQoJCQkJCX0KCQkJCX0KCgkJCQkvKiAtLSBUQUJMRVMgLS0gKi8KCQkJCWlmICgkdGhpcy0+bXBkZi0+dGFibGVMZXZlbCkgewoKCQkJCQlpZiAoJHRoaXMtPm1wZGYtPmJsb2NranVzdGZpbmlzaGVkKSB7CgkJCQkJCSR0aGlzLT5tcGRmLT5fc2F2ZUNlbGxUZXh0QnVmZmVyKCRibG9ja3ByZSAuICRpbmxpbmVwcmUgLiAiXG4iIC4gJGlubGluZXBvc3QgLiAkYmxvY2twb3N0KTsKCQkJCQl9CgoJCQkJCSR0aGlzLT5tcGRmLT5fc2F2ZUNlbGxUZXh0QnVmZmVyKCRibG9ja3ByZSAuICRpbmxpbmVwcmUgLiAiXG4iIC4gJGlubGluZXBvc3QgLiAkYmxvY2twb3N0KTsKCQkJCQlpZiAoIWlzc2V0KCR0aGlzLT5tcGRmLT5jZWxsWyR0aGlzLT5tcGRmLT5yb3ddWyR0aGlzLT5tcGRmLT5jb2xdWydtYXhzJ10pKSB7CgkJCQkJCSR0aGlzLT5tcGRmLT5jZWxsWyR0aGlzLT5tcGRmLT5yb3ddWyR0aGlzLT5tcGRmLT5jb2xdWydtYXhzJ10gPSAkdGhpcy0+bXBkZi0+Y2VsbFskdGhpcy0+bXBkZi0+cm93XVskdGhpcy0+bXBkZi0+Y29sXVsncyddOwoJCQkJCX0gZWxzZWlmICgkdGhpcy0+bXBkZi0+Y2VsbFskdGhpcy0+bXBkZi0+cm93XVskdGhpcy0+bXBkZi0+Y29sXVsnbWF4cyddIDwgJHRoaXMtPm1wZGYtPmNlbGxbJHRoaXMtPm1wZGYtPnJvd11bJHRoaXMtPm1wZGYtPmNvbF1bJ3MnXSkgewoJCQkJCQkkdGhpcy0+bXBkZi0+Y2VsbFskdGhpcy0+bXBkZi0+cm93XVskdGhpcy0+bXBkZi0+Y29sXVsnbWF4cyddID0gJHRoaXMtPm1wZGYtPmNlbGxbJHRoaXMtPm1wZGYtPnJvd11bJHRoaXMtPm1wZGYtPmNvbF1bJ3MnXTsKCQkJCQl9CgkJCQkJJHRoaXMtPm1wZGYtPmNlbGxbJHRoaXMtPm1wZGYtPnJvd11bJHRoaXMtPm1wZGYtPmNvbF1bJ3MnXSA9IDA7IC8vIHJlc2V0CgkJCQl9IGVsc2UgewoJCQkJCS8qIC0tIEVORCBUQUJMRVMgLS0gKi8KCQkJCQlpZiAoY291bnQoJHRoaXMtPm1wZGYtPnRleHRidWZmZXIpKSB7CgkJCQkJCSR0aGlzLT5tcGRmLT50ZXh0YnVmZmVyW2NvdW50KCR0aGlzLT5tcGRmLT50ZXh0YnVmZmVyKSAtIDFdWzBdID0gcHJlZ19yZXBsYWNlKCcvICQvJywgJycsICR0aGlzLT5tcGRmLT50ZXh0YnVmZmVyW2NvdW50KCR0aGlzLT5tcGRmLT50ZXh0YnVmZmVyKSAtIDFdWzBdKTsKCQkJCQkJaWYgKCFlbXB0eSgkdGhpcy0+bXBkZi0+dGV4dGJ1ZmZlcltjb3VudCgkdGhpcy0+bXBkZi0+dGV4dGJ1ZmZlcikgLSAxXVsxOF0pKSB7CgkJCQkJCQkkdGhpcy0+bXBkZi0+b3RsLT50cmltT1RMZGF0YSgkdGhpcy0+bXBkZi0+dGV4dGJ1ZmZlcltjb3VudCgkdGhpcy0+bXBkZi0+dGV4dGJ1ZmZlcikgLSAxXVsxOF0sIGZhbHNlLCB0cnVlKTsKCQkJCQkJfSAvLyAqT1RMKgoJCQkJCX0KCQkJCQkkdGhpcy0+bXBkZi0+X3NhdmVUZXh0QnVmZmVyKCRibG9ja3ByZSAuICRpbmxpbmVwcmUgLiAiXG4iIC4gJGlubGluZXBvc3QgLiAkYmxvY2twb3N0KTsKCQkJCX0gLy8gKlRBQkxFUyoKCQkJCSR0aGlzLT5tcGRmLT5pZ25vcmVmb2xsb3dpbmdzcGFjZXMgPSB0cnVlOwoJCQkJJHRoaXMtPm1wZGYtPmJsb2NranVzdGZpbmlzaGVkID0gZmFsc2U7CgoJCQkJJHRoaXMtPm1wZGYtPmxpbmVicmVha2p1c3RmaW5pc2hlZCA9IHRydWU7CgkJCQlicmVhazsKCgoJCQkvLyAqKioqKioqKioqKiBCTE9DS1MgICoqKioqKioqKioqKioqKioqKioqCgoKCQkJY2FzZSAnUFJFJzoKCQkJCSR0aGlzLT5tcGRmLT5pc3ByZSA9IHRydWU7IC8vIEFEREVEIC0gUHJldmVudHMgbGVmdCB0cmltIG9mIHRleHRidWZmZXIgaW4gcHJpbnRidWZmZXIoKQoKCQkJY2FzZSAnRElWJzoKCQkJY2FzZSAnRk9STSc6CgkJCWNhc2UgJ0NFTlRFUic6CgoJCQljYXNlICdCTE9DS1FVT1RFJzoKCQkJY2FzZSAnQUREUkVTUyc6CgoJCQljYXNlICdDQVBUSU9OJzoKCQkJY2FzZSAnUCc6CgkJCWNhc2UgJ0gxJzoKCQkJY2FzZSAnSDInOgoJCQljYXNlICdIMyc6CgkJCWNhc2UgJ0g0JzoKCQkJY2FzZSAnSDUnOgoJCQljYXNlICdINic6CgkJCWNhc2UgJ0RMJzoKCQkJY2FzZSAnRFQnOgoJCQljYXNlICdERCc6CgkJCWNhc2UgJ1VMJzogLy8gbVBERiA2ICBMaXN0cwoJCQljYXNlICdPTCc6IC8vIG1QREYgNgoJCQljYXNlICdMSSc6IC8vIG1QREYgNgoJCQljYXNlICdGSUVMRFNFVCc6CgkJCWNhc2UgJ0RFVEFJTFMnOgoJCQljYXNlICdTVU1NQVJZJzoKCQkJY2FzZSAnQVJUSUNMRSc6CgkJCWNhc2UgJ0FTSURFJzoKCQkJY2FzZSAnRklHVVJFJzoKCQkJY2FzZSAnRklHQ0FQVElPTic6CgkJCWNhc2UgJ0ZPT1RFUic6CgkJCWNhc2UgJ0hFQURFUic6CgkJCWNhc2UgJ0hHUk9VUCc6CgkJCWNhc2UgJ05BVic6CgkJCWNhc2UgJ1NFQ1RJT04nOgoJCQljYXNlICdNQUlOJzoKCQkJCS8vIG1QREYgNiAgTGlzdHMKCQkJCSR0aGlzLT5tcGRmLT5sYXN0b3B0aW9uYWx0YWcgPSAnJzsKCgkJCQkvLyBtUERGIDYgYmlkaQoJCQkJLy8gQmxvY2sKCQkJCS8vIElmIHVuaWNvZGUtYmlkaSBzZXQgb24gY3VycmVudCBjbG9jaywgYW55IGVtYmVkZGluZyBsZXZlbHMsIGlzb2xhdGVzLCBvciBvdmVycmlkZXMgYXJlIGNsb3NlZCAobm90IGluaGVyaXRlZCkKCQkJCWlmIChpc3NldCgkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWydiaWRpY29kZSddKSkgewoJCQkJCSRibG9ja3Bvc3QgPSAkdGhpcy0+bXBkZi0+X3NldEJpZGlDb2RlcygnZW5kJywgJHRoaXMtPm1wZGYtPmJsa1skdGhpcy0+bXBkZi0+YmxrbHZsXVsnYmlkaWNvZGUnXSk7CgkJCQkJaWYgKCRibG9ja3Bvc3QpIHsKCQkJCQkJJHRoaXMtPm1wZGYtPk9UTGRhdGEgPSBhcnJheSgpOwoJCQkJCQlpZiAoJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWwpIHsKCQkJCQkJCSR0aGlzLT5tcGRmLT5fc2F2ZUNlbGxUZXh0QnVmZmVyKCRibG9ja3Bvc3QpOwoJCQkJCQl9IGVsc2UgewoJCQkJCQkJJHRoaXMtPm1wZGYtPl9zYXZlVGV4dEJ1ZmZlcigkYmxvY2twb3N0KTsKCQkJCQkJfQoJCQkJCX0KCQkJCX0KCgoJCQkJJHAgPSAkdGhpcy0+bXBkZi0+Y3NzbWdyLT5QcmV2aWV3QmxvY2tDU1MoJHRhZywgJGF0dHIpOwoJCQkJaWYgKGlzc2V0KCRwWydESVNQTEFZJ10pICYmIHN0cnRvbG93ZXIoJHBbJ0RJU1BMQVknXSkgPT0gJ25vbmUnKSB7CgkJCQkJJHRoaXMtPm1wZGYtPmJsa2x2bCsrOwoJCQkJCSR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ2hpZGUnXSA9IHRydWU7CgkJCQkJJHRoaXMtPm1wZGYtPmJsa1skdGhpcy0+bXBkZi0+YmxrbHZsXVsndGFnJ10gPSAkdGFnOyAgLy8gbVBERiA2CgkJCQkJcmV0dXJuOwoJCQkJfQoJCQkJaWYgKCR0YWcgPT0gJ0NBUFRJT04nKSB7CgkJCQkJLy8gcG9zaXRpb24gaXMgd3JpdHRlbiBpbiBBZGpzdEhUTUwKCQkJCQlpZiAoaXNzZXQoJGF0dHJbJ1BPU0lUSU9OJ10pICYmIHN0cnRvbG93ZXIoJGF0dHJbJ1BPU0lUSU9OJ10pID09ICdib3R0b20nKSB7CgkJCQkJCSRkaXZwb3MgPSAnQic7CgkJCQkJfSBlbHNlIHsKCQkJCQkJJGRpdnBvcyA9ICdUJzsKCQkJCQl9CgkJCQkJaWYgKGlzc2V0KCRhdHRyWydBTElHTiddKSAmJiBzdHJ0b2xvd2VyKCRhdHRyWydBTElHTiddKSA9PSAnYm90dG9tJykgewoJCQkJCQkkY2FwcG9zID0gJ0InOwoJCQkJCX0gZWxzZSBpZiAoaXNzZXQoJHBbJ0NBUFRJT04tU0lERSddKSAmJiBzdHJ0b2xvd2VyKCRwWydDQVBUSU9OLVNJREUnXSkgPT0gJ2JvdHRvbScpIHsKCQkJCQkJJGNhcHBvcyA9ICdCJzsKCQkJCQl9IGVsc2UgewoJCQkJCQkkY2FwcG9zID0gJ1QnOwoJCQkJCX0KCQkJCQlpZiAoaXNzZXQoJGF0dHJbJ0FMSUdOJ10pKSB7CgkJCQkJCXVuc2V0KCRhdHRyWydBTElHTiddKTsKCQkJCQl9CgkJCQkJaWYgKCRjYXBwb3MgIT0gJGRpdnBvcykgewoJCQkJCQkkdGhpcy0+bXBkZi0+YmxrbHZsKys7CgkJCQkJCSR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ2hpZGUnXSA9IHRydWU7CgkJCQkJCSR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ3RhZyddID0gJHRhZzsgIC8vIG1QREYgNgoJCQkJCQlyZXR1cm47CgkJCQkJfQoJCQkJfQoKCQkJCS8qIC0tIEZPUk1TIC0tICovCgkJCQlpZiAoJHRhZyA9PSAnRk9STScpIHsKCQkJCQlpZiAoaXNzZXQoJGF0dHJbJ01FVEhPRCddKSAmJiBzdHJ0b2xvd2VyKCRhdHRyWydNRVRIT0QnXSkgPT0gJ2dldCcpIHsKCQkJCQkJJHRoaXMtPm1wZGYtPm1wZGZmb3JtLT5mb3JtTWV0aG9kID0gJ0dFVCc7CgkJCQkJfSBlbHNlIHsKCQkJCQkJJHRoaXMtPm1wZGYtPm1wZGZmb3JtLT5mb3JtTWV0aG9kID0gJ1BPU1QnOwoJCQkJCX0KCQkJCQlpZiAoaXNzZXQoJGF0dHJbJ0FDVElPTiddKSkgewoJCQkJCQkkdGhpcy0+bXBkZi0+bXBkZmZvcm0tPmZvcm1BY3Rpb24gPSAkYXR0clsnQUNUSU9OJ107CgkJCQkJfSBlbHNlIHsKCQkJCQkJJHRoaXMtPm1wZGYtPm1wZGZmb3JtLT5mb3JtQWN0aW9uID0gJyc7CgkJCQkJfQoJCQkJfQoJCQkJLyogLS0gRU5EIEZPUk1TIC0tICovCgoKCQkJCS8qIC0tIENTUy1QT1NJVElPTiAtLSAqLwoJCQkJaWYgKChpc3NldCgkcFsnUE9TSVRJT04nXSkgJiYgKHN0cnRvbG93ZXIoJHBbJ1BPU0lUSU9OJ10pID09ICdmaXhlZCcgfHwgc3RydG9sb3dlcigkcFsnUE9TSVRJT04nXSkgPT0gJ2Fic29sdXRlJykpICYmICR0aGlzLT5tcGRmLT5ibGtsdmwgPT0gMCkgewoJCQkJCWlmICgkdGhpcy0+bXBkZi0+aW5GaXhlZFBvc0Jsb2NrKSB7CgkJCQkJCXRocm93IG5ldyBNcGRmRXhjZXB0aW9uKCJDYW5ub3QgbmVzdCBibG9jayB3aXRoIHBvc2l0aW9uOmZpeGVkIG9yIHBvc2l0aW9uOmFic29sdXRlIik7CgkJCQkJfQoJCQkJCSR0aGlzLT5tcGRmLT5pbkZpeGVkUG9zQmxvY2sgPSB0cnVlOwoJCQkJCXJldHVybjsKCQkJCX0KCQkJCS8qIC0tIEVORCBDU1MtUE9TSVRJT04gLS0gKi8KCQkJCS8vIFN0YXJ0IEJsb2NrCgkJCQkkdGhpcy0+bXBkZi0+aWdub3JlZm9sbG93aW5nc3BhY2VzID0gdHJ1ZTsKCgkJCQlpZiAoJHRoaXMtPm1wZGYtPmJsb2NranVzdGZpbmlzaGVkICYmICFjb3VudCgkdGhpcy0+bXBkZi0+dGV4dGJ1ZmZlcikgJiYgJHRoaXMtPm1wZGYtPnkgIT0gJHRoaXMtPm1wZGYtPnRNYXJnaW4gJiYgJHRoaXMtPm1wZGYtPmNvbGxhcHNlQmxvY2tNYXJnaW5zKSB7CgkJCQkJJGxhc3Rib3R0b21tYXJnaW4gPSAkdGhpcy0+bXBkZi0+bGFzdGJsb2NrYm90dG9tbWFyZ2luOwoJCQkJfSBlbHNlIHsKCQkJCQkkbGFzdGJvdHRvbW1hcmdpbiA9IDA7CgkJCQl9CgkJCQkkdGhpcy0+bXBkZi0+bGFzdGJsb2NrYm90dG9tbWFyZ2luID0gMDsKCQkJCSR0aGlzLT5tcGRmLT5ibG9ja2p1c3RmaW5pc2hlZCA9IGZhbHNlOwoKCgkJCQkkdGhpcy0+bXBkZi0+SW5saW5lQkRGID0gYXJyYXkoKTsgLy8gbVBERiA2CgkJCQkkdGhpcy0+bXBkZi0+SW5saW5lQkRGY3RyID0gMDsgLy8gbVBERiA2CgkJCQkkdGhpcy0+bXBkZi0+SW5saW5lUHJvcGVydGllcyA9IGFycmF5KCk7CgkJCQkkdGhpcy0+bXBkZi0+ZGl2YmVnaW4gPSB0cnVlOwoKCQkJCSR0aGlzLT5tcGRmLT5saW5lYnJlYWtqdXN0ZmluaXNoZWQgPSBmYWxzZTsKCgkJCQkvKiAtLSBUQUJMRVMgLS0gKi8KCQkJCWlmICgkdGhpcy0+bXBkZi0+dGFibGVMZXZlbCkgewoJCQkJCS8vIElmIGFscmVhZHkgc29tZXRoaW5nIG9uIHRoZSBsaW5lCgkJCQkJaWYgKCR0aGlzLT5tcGRmLT5jZWxsWyR0aGlzLT5tcGRmLT5yb3ddWyR0aGlzLT5tcGRmLT5jb2xdWydzJ10gPiAwICYmICEkdGhpcy0+bXBkZi0+bmVzdGVkdGFibGVqdXN0ZmluaXNoZWQpIHsKCQkJCQkJJHRoaXMtPm1wZGYtPl9zYXZlQ2VsbFRleHRCdWZmZXIoIlxuIik7CgkJCQkJCWlmICghaXNzZXQoJHRoaXMtPm1wZGYtPmNlbGxbJHRoaXMtPm1wZGYtPnJvd11bJHRoaXMtPm1wZGYtPmNvbF1bJ21heHMnXSkpIHsKCQkJCQkJCSR0aGlzLT5tcGRmLT5jZWxsWyR0aGlzLT5tcGRmLT5yb3ddWyR0aGlzLT5tcGRmLT5jb2xdWydtYXhzJ10gPSAkdGhpcy0+bXBkZi0+Y2VsbFskdGhpcy0+bXBkZi0+cm93XVskdGhpcy0+bXBkZi0+Y29sXVsncyddOwoJCQkJCQl9IGVsc2VpZiAoJHRoaXMtPm1wZGYtPmNlbGxbJHRoaXMtPm1wZGYtPnJvd11bJHRoaXMtPm1wZGYtPmNvbF1bJ21heHMnXSA8ICR0aGlzLT5tcGRmLT5jZWxsWyR0aGlzLT5tcGRmLT5yb3ddWyR0aGlzLT5tcGRmLT5jb2xdWydzJ10pIHsKCQkJCQkJCSR0aGlzLT5tcGRmLT5jZWxsWyR0aGlzLT5tcGRmLT5yb3ddWyR0aGlzLT5tcGRmLT5jb2xdWydtYXhzJ10gPSAkdGhpcy0+bXBkZi0+Y2VsbFskdGhpcy0+bXBkZi0+cm93XVskdGhpcy0+bXBkZi0+Y29sXVsncyddOwoJCQkJCQl9CgkJCQkJCSR0aGlzLT5tcGRmLT5jZWxsWyR0aGlzLT5tcGRmLT5yb3ddWyR0aGlzLT5tcGRmLT5jb2xdWydzJ10gPSAwOyAvLyByZXNldAoJCQkJCX0KCQkJCQkvLyBDYW5ub3Qgc2V0IGJsb2NrIHByb3BlcnRpZXMgaW5zaWRlIHRhYmxlIC0gdXNlIEJvbGQgdG8gaW5kaWNhdGUgaDEtaDYKCQkJCQlpZiAoJHRhZyA9PSAnQ0VOVEVSJyAmJiAkdGhpcy0+bXBkZi0+dGRiZWdpbikgewoJCQkJCQkkdGhpcy0+bXBkZi0+Y2VsbFskdGhpcy0+bXBkZi0+cm93XVskdGhpcy0+bXBkZi0+Y29sXVsnYSddID0gJGFsaWduWydjZW50ZXInXTsKCQkJCQl9CgoJCQkJCSR0aGlzLT5tcGRmLT5JbmxpbmVQcm9wZXJ0aWVzWydCTE9DS0lOVEFCTEUnXSA9ICR0aGlzLT5tcGRmLT5zYXZlSW5saW5lUHJvcGVydGllcygpOwoJCQkJCSRwcm9wZXJ0aWVzID0gJHRoaXMtPm1wZGYtPmNzc21nci0+TWVyZ2VDU1MoJycsICR0YWcsICRhdHRyKTsKCQkJCQlpZiAoIWVtcHR5KCRwcm9wZXJ0aWVzKSkKCQkJCQkJJHRoaXMtPm1wZGYtPnNldENTUygkcHJvcGVydGllcywgJ0lOTElORScpOwoKCQkJCQkvLyBtUERGIDYgIExpc3RzCgkJCQkJaWYgKCR0YWcgPT0gJ1VMJyB8fCAkdGFnID09ICdPTCcpIHsKCQkJCQkJJHRoaXMtPm1wZGYtPmxpc3RsdmwrKzsKCQkJCQkJaWYgKGlzc2V0KCRhdHRyWydTVEFSVCddKSkgewoJCQkJCQkJJHRoaXMtPm1wZGYtPmxpc3Rjb3VudGVyWyR0aGlzLT5tcGRmLT5saXN0bHZsXSA9IGludHZhbCgkYXR0clsnU1RBUlQnXSkgLSAxOwoJCQkJCQl9IGVsc2UgewoJCQkJCQkJJHRoaXMtPm1wZGYtPmxpc3Rjb3VudGVyWyR0aGlzLT5tcGRmLT5saXN0bHZsXSA9IDA7CgkJCQkJCX0KCQkJCQkJJHRoaXMtPm1wZGYtPmxpc3RpdGVtID0gYXJyYXkoKTsKCQkJCQkJaWYgKCR0YWcgPT0gJ09MJykKCQkJCQkJCSR0aGlzLT5tcGRmLT5saXN0dHlwZVskdGhpcy0+bXBkZi0+bGlzdGx2bF0gPSAnZGVjaW1hbCc7CgkJCQkJCWVsc2UgaWYgKCR0YWcgPT0gJ1VMJykgewoJCQkJCQkJaWYgKCR0aGlzLT5tcGRmLT5saXN0bHZsICUgMyA9PSAxKQoJCQkJCQkJCSR0aGlzLT5tcGRmLT5saXN0dHlwZVskdGhpcy0+bXBkZi0+bGlzdGx2bF0gPSAnZGlzYyc7CgkJCQkJCQllbHNlaWYgKCR0aGlzLT5tcGRmLT5saXN0bHZsICUgMyA9PSAyKQoJCQkJCQkJCSR0aGlzLT5tcGRmLT5saXN0dHlwZVskdGhpcy0+bXBkZi0+bGlzdGx2bF0gPSAnY2lyY2xlJzsKCQkJCQkJCWVsc2UKCQkJCQkJCQkkdGhpcy0+bXBkZi0+bGlzdHR5cGVbJHRoaXMtPm1wZGYtPmxpc3RsdmxdID0gJ3NxdWFyZSc7CgkJCQkJCX0KCQkJCQl9CgoJCQkJCS8vIG1QREYgNiAgTGlzdHMgLSBpbiBUYWJsZXMKCQkJCQlpZiAoJHRhZyA9PSAnTEknKSB7CgkJCQkJCWlmICgkdGhpcy0+bXBkZi0+bGlzdGx2bCA9PSAwKSB7IC8vaW4gY2FzZSBvZiBtYWxmb3JtZWQgSFRNTCBjb2RlLiBFeGFtcGxlOiguLi4pPC9wPjxsaT5Db250ZW50PC9saT48cD5QYXJhZ3JhcGgxPC9wPiguLi4pCgkJCQkJCQkkdGhpcy0+bXBkZi0+bGlzdGx2bCsrOyAvLyBmaXJzdCBkZXB0aCBsZXZlbAoJCQkJCQkJJHRoaXMtPm1wZGYtPmxpc3Rjb3VudGVyWyR0aGlzLT5tcGRmLT5saXN0bHZsXSA9IDA7CgkJCQkJCX0KCQkJCQkJJHRoaXMtPm1wZGYtPmxpc3Rjb3VudGVyWyR0aGlzLT5tcGRmLT5saXN0bHZsXSArKzsKCQkJCQkJJHRoaXMtPm1wZGYtPmxpc3RpdGVtID0gYXJyYXkoKTsKCQkJCQkJLy9pZiBpbiB0YWJsZSAtIG91dHB1dCBoZXJlIGFzIGEgdGFibGV0ZXh0YnVmZmVyCgkJCQkJCS8vcG9zaXRpb246aW5zaWRlIE9SIHBvc2l0aW9uOm91dHNpZGUgKGFsd2F5cyBvdXRwdXQgaW4gdGFibGUgYXMgcG9zaXRpb246aW5zaWRlKQoJCQkJCQlzd2l0Y2ggKCR0aGlzLT5tcGRmLT5saXN0dHlwZVskdGhpcy0+bXBkZi0+bGlzdGx2bF0pIHsKCQkJCQkJCWNhc2UgJ3VwcGVyLWFscGhhJzoKCQkJCQkJCWNhc2UgJ3VwcGVyLWxhdGluJzoKCQkJCQkJCWNhc2UgJ0EnOgoJCQkJCQkJCSRibHQgPSAkdGhpcy0+bXBkZi0+ZGVjMmFscGhhKCR0aGlzLT5tcGRmLT5saXN0Y291bnRlclskdGhpcy0+bXBkZi0+bGlzdGx2bF0sIHRydWUpIC4gJHRoaXMtPm1wZGYtPmxpc3RfbnVtYmVyX3N1ZmZpeDsKCQkJCQkJCQlicmVhazsKCQkJCQkJCWNhc2UgJ2xvd2VyLWFscGhhJzoKCQkJCQkJCWNhc2UgJ2xvd2VyLWxhdGluJzoKCQkJCQkJCWNhc2UgJ2EnOgoJCQkJCQkJCSRibHQgPSAkdGhpcy0+bXBkZi0+ZGVjMmFscGhhKCR0aGlzLT5tcGRmLT5saXN0Y291bnRlclskdGhpcy0+bXBkZi0+bGlzdGx2bF0sIGZhbHNlKSAuICR0aGlzLT5tcGRmLT5saXN0X251bWJlcl9zdWZmaXg7CgkJCQkJCQkJYnJlYWs7CgkJCQkJCQljYXNlICd1cHBlci1yb21hbic6CgkJCQkJCQljYXNlICdJJzoKCQkJCQkJCQkkYmx0ID0gJHRoaXMtPm1wZGYtPmRlYzJyb21hbigkdGhpcy0+bXBkZi0+bGlzdGNvdW50ZXJbJHRoaXMtPm1wZGYtPmxpc3RsdmxdLCB0cnVlKSAuICR0aGlzLT5tcGRmLT5saXN0X251bWJlcl9zdWZmaXg7CgkJCQkJCQkJYnJlYWs7CgkJCQkJCQljYXNlICdsb3dlci1yb21hbic6CgkJCQkJCQljYXNlICdpJzoKCQkJCQkJCQkkYmx0ID0gJHRoaXMtPm1wZGYtPmRlYzJyb21hbigkdGhpcy0+bXBkZi0+bGlzdGNvdW50ZXJbJHRoaXMtPm1wZGYtPmxpc3RsdmxdLCBmYWxzZSkgLiAkdGhpcy0+bXBkZi0+bGlzdF9udW1iZXJfc3VmZml4OwoJCQkJCQkJCWJyZWFrOwoJCQkJCQkJY2FzZSAnZGVjaW1hbCc6CgkJCQkJCQljYXNlICcxJzoKCQkJCQkJCQkkYmx0ID0gJHRoaXMtPm1wZGYtPmxpc3Rjb3VudGVyWyR0aGlzLT5tcGRmLT5saXN0bHZsXSAuICR0aGlzLT5tcGRmLT5saXN0X251bWJlcl9zdWZmaXg7CgkJCQkJCQkJYnJlYWs7CgkJCQkJCQlkZWZhdWx0OgoJCQkJCQkJCWlmICgkdGhpcy0+bXBkZi0+bGlzdGx2bCAlIDMgPT0gMSAmJiAkdGhpcy0+bXBkZi0+X2NoYXJEZWZpbmVkKCR0aGlzLT5tcGRmLT5DdXJyZW50Rm9udFsnY3cnXSwgODIyNikpIHsKCQkJCQkJCQkJJGJsdCA9ICJceGUyXHg4MFx4YTIiOwoJCQkJCQkJCX0gIC8vICYjODIyNjsKCQkJCQkJCQllbHNlIGlmICgkdGhpcy0+bXBkZi0+bGlzdGx2bCAlIDMgPT0gMiAmJiAkdGhpcy0+bXBkZi0+X2NoYXJEZWZpbmVkKCR0aGlzLT5tcGRmLT5DdXJyZW50Rm9udFsnY3cnXSwgOTkwMCkpIHsKCQkJCQkJCQkJJGJsdCA9ICJceGUyXHg5YVx4YWMiOwoJCQkJCQkJCX0gLy8gJiM5OTAwOwoJCQkJCQkJCWVsc2UgaWYgKCR0aGlzLT5tcGRmLT5saXN0bHZsICUgMyA9PSAwICYmICR0aGlzLT5tcGRmLT5fY2hhckRlZmluZWQoJHRoaXMtPm1wZGYtPkN1cnJlbnRGb250WydjdyddLCA5NjQyKSkgewoJCQkJCQkJCQkkYmx0ID0gIlx4ZTJceDk2XHhhYSI7CgkJCQkJCQkJfSAvLyAmIzk2NDI7CgkJCQkJCQkJZWxzZSB7CgkJCQkJCQkJCSRibHQgPSAnLSc7CgkJCQkJCQkJfQoJCQkJCQkJCWJyZWFrOwoJCQkJCQl9CgoJCQkJCQkvLyBjaGFuZ2UgdG8gJm5ic3A7IHNwYWNlcwoJCQkJCQlpZiAoJHRoaXMtPm1wZGYtPnVzaW5nQ29yZUZvbnQpIHsKCQkJCQkJCSRscyA9IHN0cl9yZXBlYXQoY2hyKDE2MCkgLiBjaHIoMTYwKSwgKCR0aGlzLT5tcGRmLT5saXN0bHZsIC0gMSkgKiAyKSAuICRibHQgLiAnICc7CgkJCQkJCX0gZWxzZSB7CgkJCQkJCQkkbHMgPSBzdHJfcmVwZWF0KCJceGMyXHhhMFx4YzJceGEwIiwgKCR0aGlzLT5tcGRmLT5saXN0bHZsIC0gMSkgKiAyKSAuICRibHQgLiAnICc7CgkJCQkJCX0KCQkJCQkJJHRoaXMtPm1wZGYtPl9zYXZlQ2VsbFRleHRCdWZmZXIoJGxzKTsKCQkJCQkJJHRoaXMtPm1wZGYtPmNlbGxbJHRoaXMtPm1wZGYtPnJvd11bJHRoaXMtPm1wZGYtPmNvbF1bJ3MnXSArPSAkdGhpcy0+bXBkZi0+R2V0U3RyaW5nV2lkdGgoJGxzKTsKCQkJCQl9CgoJCQkJCWJyZWFrOwoJCQkJfQoJCQkJLyogLS0gRU5EIFRBQkxFUyAtLSAqLwoKCQkJCWlmICgkdGhpcy0+bXBkZi0+bGFzdGJsb2NrbGV2ZWxjaGFuZ2UgPT0gMSkgewoJCQkJCSRibG9ja3N0YXRlID0gMTsKCQkJCX0gLy8gVG9wIG1hcmdpbnMvcGFkZGluZyBvbmx5CgkJCQllbHNlIGlmICgkdGhpcy0+bXBkZi0+bGFzdGJsb2NrbGV2ZWxjaGFuZ2UgPCAxKSB7CgkJCQkJJGJsb2Nrc3RhdGUgPSAwOwoJCQkJfSAvLyBOTyBtYXJnaW5zL3BhZGRpbmcKCQkJCSR0aGlzLT5tcGRmLT5wcmludGJ1ZmZlcigkdGhpcy0+bXBkZi0+dGV4dGJ1ZmZlciwgJGJsb2Nrc3RhdGUpOwoJCQkJJHRoaXMtPm1wZGYtPnRleHRidWZmZXIgPSBhcnJheSgpOwoKCQkJCSRzYXZlX2Jsa2x2bCA9ICR0aGlzLT5tcGRmLT5ibGtsdmw7CgkJCQkkc2F2ZV9ibGsgPSAkdGhpcy0+bXBkZi0+YmxrOwoKCQkJCSR0aGlzLT5tcGRmLT5SZXNldCgpOwoKCQkJCSRwYWdlc2VsID0gJyc7CgkJCQkvKiAtLSBDU1MtUEFHRSAtLSAqLwoJCQkJaWYgKGlzc2V0KCRwWydQQUdFJ10pKSB7CgkJCQkJJHBhZ2VzZWwgPSAkcFsnUEFHRSddOwoJCQkJfSAgLy8gbVBERiA2ICh1c2VzICRwIC0gcHJldmlldyBvZiBwcm9wZXJ0aWVzIHNvIGJsa2x2bCBjYW4gYmUgaW5jcmVtZW50ZWQgYWZ0ZXIgcGFnZS1icmVhaykKCQkJCS8qIC0tIEVORCBDU1MtUEFHRSAtLSAqLwoKCQkJCS8vIElmIHBhZ2UtYm94IGhhcyBjaGFuZ2VkIEFORC9PUiBQQUdFLUJSRUFLLUJFRk9SRQoJCQkJLy8gbVBERiA2ICh1c2VzICRwIC0gcHJldmlldyBvZiBwcm9wZXJ0aWVzIHNvIGJsa2x2bCBjYW4gYmUgaW1jcmVtZW50ZWQgYWZ0ZXIgcGFnZS1icmVhaykKCQkJCWlmICghJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWwgJiYgKCgkcGFnZXNlbCAmJiAoIWlzc2V0KCR0aGlzLT5tcGRmLT5wYWdlX2JveFsnY3VycmVudCddKSB8fCAkcGFnZXNlbCAhPSAkdGhpcy0+bXBkZi0+cGFnZV9ib3hbJ2N1cnJlbnQnXSkpIHx8IChpc3NldCgkcFsnUEFHRS1CUkVBSy1CRUZPUkUnXSkgJiYgJHBbJ1BBR0UtQlJFQUstQkVGT1JFJ10pKSkgewoJCQkJCS8vIG1QREYgNiBwYWdlYnJlYWt0eXBlCgkJCQkJJHN0YXJ0cGFnZSA9ICR0aGlzLT5tcGRmLT5wYWdlOwoJCQkJCSRwYWdlYnJlYWt0eXBlID0gJHRoaXMtPm1wZGYtPmRlZmF1bHRQYWdlYnJlYWtUeXBlOwoJCQkJCSR0aGlzLT5tcGRmLT5sYXN0YmxvY2tsZXZlbGNoYW5nZSA9IC0xOwoJCQkJCWlmICgkdGhpcy0+bXBkZi0+Q29sQWN0aXZlKSB7CgkJCQkJCSRwYWdlYnJlYWt0eXBlID0gJ2Nsb25lYWxsJzsKCQkJCQl9CgkJCQkJaWYgKCRwYWdlc2VsICYmICghaXNzZXQoJHRoaXMtPm1wZGYtPnBhZ2VfYm94WydjdXJyZW50J10pIHx8ICRwYWdlc2VsICE9ICR0aGlzLT5tcGRmLT5wYWdlX2JveFsnY3VycmVudCddKSkgewoJCQkJCQkkcGFnZWJyZWFrdHlwZSA9ICdjbG9uZWFsbCc7CgkJCQkJfQoJCQkJCSR0aGlzLT5tcGRmLT5fcHJlRm9yY2VkUGFnZWJyZWFrKCRwYWdlYnJlYWt0eXBlKTsKCgkJCQkJaWYgKGlzc2V0KCRwWydQQUdFLUJSRUFLLUJFRk9SRSddKSkgewoJCQkJCQlpZiAoc3RydG91cHBlcigkcFsnUEFHRS1CUkVBSy1CRUZPUkUnXSkgPT0gJ1JJR0hUJykgewoJCQkJCQkJJHRoaXMtPm1wZGYtPkFkZFBhZ2UoJHRoaXMtPm1wZGYtPkN1ck9yaWVudGF0aW9uLCAnTkVYVC1PREQnLCAnJywgJycsICcnLCAnJywgJycsICcnLCAnJywgJycsICcnLCAnJywgJycsICcnLCAnJywgMCwgMCwgMCwgMCwgJHBhZ2VzZWwpOwoJCQkJCQl9IGVsc2UgaWYgKHN0cnRvdXBwZXIoJHBbJ1BBR0UtQlJFQUstQkVGT1JFJ10pID09ICdMRUZUJykgewoJCQkJCQkJJHRoaXMtPm1wZGYtPkFkZFBhZ2UoJHRoaXMtPm1wZGYtPkN1ck9yaWVudGF0aW9uLCAnTkVYVC1FVkVOJywgJycsICcnLCAnJywgJycsICcnLCAnJywgJycsICcnLCAnJywgJycsICcnLCAnJywgJycsIDAsIDAsIDAsIDAsICRwYWdlc2VsKTsKCQkJCQkJfSBlbHNlIGlmIChzdHJ0b3VwcGVyKCRwWydQQUdFLUJSRUFLLUJFRk9SRSddKSA9PSAnQUxXQVlTJykgewoJCQkJCQkJJHRoaXMtPm1wZGYtPkFkZFBhZ2UoJHRoaXMtPm1wZGYtPkN1ck9yaWVudGF0aW9uLCAnJywgJycsICcnLCAnJywgJycsICcnLCAnJywgJycsICcnLCAnJywgJycsICcnLCAnJywgJycsIDAsIDAsIDAsIDAsICRwYWdlc2VsKTsKCQkJCQkJfSBlbHNlIGlmICgkdGhpcy0+bXBkZi0+cGFnZV9ib3hbJ2N1cnJlbnQnXSAhPSAkcGFnZXNlbCkgewoJCQkJCQkJJHRoaXMtPm1wZGYtPkFkZFBhZ2UoJHRoaXMtPm1wZGYtPkN1ck9yaWVudGF0aW9uLCAnJywgJycsICcnLCAnJywgJycsICcnLCAnJywgJycsICcnLCAnJywgJycsICcnLCAnJywgJycsIDAsIDAsIDAsIDAsICRwYWdlc2VsKTsKCQkJCQkJfSAvLyAqQ1NTLVBBR0UqCgkJCQkJfQoJCQkJCS8qIC0tIENTUy1QQUdFIC0tICovCgkJCQkJLy8gTXVzdCBBZGQgbmV3IHBhZ2UgaWYgY2hhbmdlZCBwYWdlIHByb3BlcnRpZXMKCQkJCQllbHNlIGlmICghaXNzZXQoJHRoaXMtPm1wZGYtPnBhZ2VfYm94WydjdXJyZW50J10pIHx8ICRwYWdlc2VsICE9ICR0aGlzLT5tcGRmLT5wYWdlX2JveFsnY3VycmVudCddKSB7CgkJCQkJCSR0aGlzLT5tcGRmLT5BZGRQYWdlKCR0aGlzLT5tcGRmLT5DdXJPcmllbnRhdGlvbiwgJycsICcnLCAnJywgJycsICcnLCAnJywgJycsICcnLCAnJywgJycsICcnLCAnJywgJycsICcnLCAwLCAwLCAwLCAwLCAkcGFnZXNlbCk7CgkJCQkJfQoJCQkJCS8qIC0tIEVORCBDU1MtUEFHRSAtLSAqLwoKCQkJCQkvLyBtUERGIDYgcGFnZWJyZWFrdHlwZQoJCQkJCSR0aGlzLT5tcGRmLT5fcG9zdEZvcmNlZFBhZ2VicmVhaygkcGFnZWJyZWFrdHlwZSwgJHN0YXJ0cGFnZSwgJHNhdmVfYmxrLCAkc2F2ZV9ibGtsdmwpOwoJCQkJfQoKCQkJCS8vIG1QREYgNiBwYWdlYnJlYWt0eXBlIC0gbW92ZWQgYWZ0ZXIgcGFnZWJyZWFrCgkJCQkkdGhpcy0+bXBkZi0+YmxrbHZsKys7CgkJCQkkY3VycmJsayA9ICYgJHRoaXMtPm1wZGYtPmJsa1skdGhpcy0+bXBkZi0+YmxrbHZsXTsKCQkJCSR0aGlzLT5tcGRmLT5pbml0aWFsaXNlQmxvY2soJGN1cnJibGspOwoJCQkJJHByZXZibGsgPSAmICR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bCAtIDFdOwoJCQkJJGN1cnJibGtbJ3RhZyddID0gJHRhZzsKCQkJCSRjdXJyYmxrWydhdHRyJ10gPSAkYXR0cjsKCgkJCQkkcHJvcGVydGllcyA9ICR0aGlzLT5tcGRmLT5jc3NtZ3ItPk1lcmdlQ1NTKCdCTE9DSycsICR0YWcsICRhdHRyKTsgLy8gbVBERiA2IC0gbW92ZWQgdG8gYWZ0ZXIgcGFnZS1icmVhay1iZWZvcmUKCQkJCS8vIG1QREYgNiBwYWdlLWJyZWFrLWluc2lkZTphdm9pZAoJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydQQUdFLUJSRUFLLUlOU0lERSddKSAmJiBzdHJ0b3VwcGVyKCRwcm9wZXJ0aWVzWydQQUdFLUJSRUFLLUlOU0lERSddKSA9PSAnQVZPSUQnICYmICEkdGhpcy0+bXBkZi0+Q29sQWN0aXZlICYmICEkdGhpcy0+bXBkZi0+a2VlcF9ibG9ja190b2dldGhlciAmJiAhaXNzZXQoJGF0dHJbJ1BBR0VCUkVBS0FWT0lEQ0hFQ0tFRCddKSkgeyAvLyBhdm9pZCByZS1pdGVyYXRpbmcgdXNpbmcgUEFHRUJSRUFLQVZPSURDSEVDS0VEOyBzZXQgaW4gQ2xvc2VUYWcKCQkJCQkkY3VycmJsa1sna2VlcF9ibG9ja190b2dldGhlciddID0gMTsKCQkJCQkkY3VycmJsa1snYXJyYXlfaSddID0gJGlodG1sOyAvLyBtUERGIDYKCQkJCQkkdGhpcy0+bXBkZi0+a3RfeTAwID0gJHRoaXMtPm1wZGYtPnk7CgkJCQkJJHRoaXMtPm1wZGYtPmt0X3AwMCA9ICR0aGlzLT5tcGRmLT5wYWdlOwoJCQkJCSR0aGlzLT5tcGRmLT5rZWVwX2Jsb2NrX3RvZ2V0aGVyID0gMTsKCQkJCX0KCQkJCWlmICgkbGFzdGJvdHRvbW1hcmdpbiAmJiBpc3NldCgkcHJvcGVydGllc1snTUFSR0lOLVRPUCddKSAmJiAkcHJvcGVydGllc1snTUFSR0lOLVRPUCddICYmIGVtcHR5KCRwcm9wZXJ0aWVzWydGTE9BVCddKSkgewoJCQkJCSRjdXJyYmxrWydsYXN0Ym90dG9tbWFyZ2luJ10gPSAkbGFzdGJvdHRvbW1hcmdpbjsKCQkJCX0KCgkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ1otSU5ERVgnXSkgJiYgJHRoaXMtPm1wZGYtPmN1cnJlbnRfbGF5ZXIgPT0gMCkgewoJCQkJCSR2ID0gaW50dmFsKCRwcm9wZXJ0aWVzWydaLUlOREVYJ10pOwoJCQkJCWlmICgkdiA+IDApIHsKCQkJCQkJJGN1cnJibGtbJ3otaW5kZXgnXSA9ICR2OwoJCQkJCQkkdGhpcy0+bXBkZi0+QmVnaW5MYXllcigkdik7CgkJCQkJfQoJCQkJfQoKCgkJCQkvLyBtUERGIDYgIExpc3RzCgkJCQkvLyBMaXN0LXR5cGUgc2V0IGJ5IGF0dHJpYnV0ZQoJCQkJaWYgKCR0YWcgPT0gJ09MJyB8fCAkdGFnID09ICdVTCcgfHwgJHRhZyA9PSAnTEknKSB7CgkJCQkJaWYgKGlzc2V0KCRhdHRyWydUWVBFJ10pICYmICRhdHRyWydUWVBFJ10pIHsKCQkJCQkJJGxpc3R0eXBlID0gJGF0dHJbJ1RZUEUnXTsKCQkJCQkJc3dpdGNoICgkbGlzdHR5cGUpIHsKCQkJCQkJCWNhc2UgJ0EnOgoJCQkJCQkJCSRsaXN0dHlwZSA9ICd1cHBlci1sYXRpbic7CgkJCQkJCQkJYnJlYWs7CgkJCQkJCQljYXNlICdhJzoKCQkJCQkJCQkkbGlzdHR5cGUgPSAnbG93ZXItbGF0aW4nOwoJCQkJCQkJCWJyZWFrOwoJCQkJCQkJY2FzZSAnSSc6CgkJCQkJCQkJJGxpc3R0eXBlID0gJ3VwcGVyLXJvbWFuJzsKCQkJCQkJCQlicmVhazsKCQkJCQkJCWNhc2UgJ2knOgoJCQkJCQkJCSRsaXN0dHlwZSA9ICdsb3dlci1yb21hbic7CgkJCQkJCQkJYnJlYWs7CgkJCQkJCQljYXNlICcxJzoKCQkJCQkJCQkkbGlzdHR5cGUgPSAnZGVjaW1hbCc7CgkJCQkJCQkJYnJlYWs7CgkJCQkJCX0KCQkJCQkJJGN1cnJibGtbJ2xpc3Rfc3R5bGVfdHlwZSddID0gJGxpc3R0eXBlOwoJCQkJCX0KCQkJCX0KCgkJCQkkdGhpcy0+bXBkZi0+c2V0Q1NTKCRwcm9wZXJ0aWVzLCAnQkxPQ0snLCAkdGFnKTsgLy9uYW1lKGlkL2NsYXNzL3N0eWxlKSBmb3VuZCBpbiB0aGUgQ1NTIGFycmF5IQoJCQkJJGN1cnJibGtbJ0lubGluZVByb3BlcnRpZXMnXSA9ICR0aGlzLT5tcGRmLT5zYXZlSW5saW5lUHJvcGVydGllcygpOwoKCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snVklTSUJJTElUWSddKSkgewoJCQkJCSR2ID0gc3RydG9sb3dlcigkcHJvcGVydGllc1snVklTSUJJTElUWSddKTsKCQkJCQlpZiAoKCR2ID09ICdoaWRkZW4nIHx8ICR2ID09ICdwcmludG9ubHknIHx8ICR2ID09ICdzY3JlZW5vbmx5JykgJiYgJHRoaXMtPm1wZGYtPnZpc2liaWxpdHkgPT0gJ3Zpc2libGUnICYmICEkdGhpcy0+bXBkZi0+dGFibGVMZXZlbCkgewoJCQkJCQkkY3VycmJsa1sndmlzaWJpbGl0eSddID0gJHY7CgkJCQkJCSR0aGlzLT5tcGRmLT5TZXRWaXNpYmlsaXR5KCR2KTsKCQkJCQl9CgkJCQl9CgoJCQkJLy8gbVBERiA2CgkJCQlpZiAoaXNzZXQoJGF0dHJbJ0FMSUdOJ10pICYmICRhdHRyWydBTElHTiddKSB7CgkJCQkJJGN1cnJibGtbJ2Jsb2NrLWFsaWduJ10gPSAkYWxpZ25bc3RydG9sb3dlcigkYXR0clsnQUxJR04nXSldOwoJCQkJfQoKCgkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ0hFSUdIVCddKSkgewoJCQkJCSRjdXJyYmxrWydjc3Nfc2V0X2hlaWdodCddID0gJHRoaXMtPm1wZGYtPkNvbnZlcnRTaXplKCRwcm9wZXJ0aWVzWydIRUlHSFQnXSwgKCR0aGlzLT5tcGRmLT5oIC0gJHRoaXMtPm1wZGYtPnRNYXJnaW4gLSAkdGhpcy0+bXBkZi0+Yk1hcmdpbiksICR0aGlzLT5tcGRmLT5Gb250U2l6ZSwgZmFsc2UpOwoJCQkJCWlmICgoJGN1cnJibGtbJ2Nzc19zZXRfaGVpZ2h0J10gKyAkdGhpcy0+bXBkZi0+eSkgPiAkdGhpcy0+bXBkZi0+UGFnZUJyZWFrVHJpZ2dlciAmJiAkdGhpcy0+bXBkZi0+eSA+ICR0aGlzLT5tcGRmLT50TWFyZ2luICsgNSAmJiAkY3VycmJsa1snY3NzX3NldF9oZWlnaHQnXSA8ICgkdGhpcy0+bXBkZi0+aCAtICgkdGhpcy0+bXBkZi0+dE1hcmdpbiArICR0aGlzLT5tcGRmLT5iTWFyZ2luKSkpIHsKCQkJCQkJJHRoaXMtPm1wZGYtPkFkZFBhZ2UoJHRoaXMtPm1wZGYtPkN1ck9yaWVudGF0aW9uKTsKCQkJCQl9CgkJCQl9IGVsc2UgewoJCQkJCSRjdXJyYmxrWydjc3Nfc2V0X2hlaWdodCddID0gZmFsc2U7CgkJCQl9CgoKCQkJCS8vIEFkZGVkIG1QREYgMy4wIEZsb2F0IERJVgoJCQkJaWYgKGlzc2V0KCRwcmV2YmxrWydibG9ja0NvbnRleHQnXSkpIHsKCQkJCQkkY3VycmJsa1snYmxvY2tDb250ZXh0J10gPSAkcHJldmJsa1snYmxvY2tDb250ZXh0J107CgkJCQl9IC8vICpDU1MtRkxPQVQqCgoJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydDTEVBUiddKSkgewoJCQkJCSR0aGlzLT5tcGRmLT5DbGVhckZsb2F0cyhzdHJ0b3VwcGVyKCRwcm9wZXJ0aWVzWydDTEVBUiddKSwgJHRoaXMtPm1wZGYtPmJsa2x2bCAtIDEpOwoJCQkJfSAvLyAqQ1NTLUZMT0FUKgoKCQkJCSRjb250YWluZXJfdyA9ICRwcmV2YmxrWydpbm5lcl93aWR0aCddOwoJCQkJJGJkciA9ICRjdXJyYmxrWydib3JkZXJfcmlnaHQnXVsndyddOwoJCQkJJGJkbCA9ICRjdXJyYmxrWydib3JkZXJfbGVmdCddWyd3J107CgkJCQkkcGRyID0gJGN1cnJibGtbJ3BhZGRpbmdfcmlnaHQnXTsKCQkJCSRwZGwgPSAkY3VycmJsa1sncGFkZGluZ19sZWZ0J107CgoJCQkJaWYgKGlzc2V0KCRjdXJyYmxrWydjc3Nfc2V0X3dpZHRoJ10pKSB7CgkJCQkJJHNldHdpZHRoID0gJGN1cnJibGtbJ2Nzc19zZXRfd2lkdGgnXTsKCQkJCX0gZWxzZSB7CgkJCQkJJHNldHdpZHRoID0gMDsKCQkJCX0KCgkJCQkvKiAtLSBDU1MtRkxPQVQgLS0gKi8KCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snRkxPQVQnXSkgJiYgc3RydG91cHBlcigkcHJvcGVydGllc1snRkxPQVQnXSkgPT0gJ1JJR0hUJyAmJiAhJHRoaXMtPm1wZGYtPkNvbEFjdGl2ZSkgewoJCQkJCS8vIENhbmNlbCBLZWVwLUJsb2NrLXRvZ2V0aGVyCgkJCQkJJGN1cnJibGtbJ2tlZXBfYmxvY2tfdG9nZXRoZXInXSA9IGZhbHNlOwoJCQkJCSR0aGlzLT5tcGRmLT5rdF95MDAgPSAnJzsKCQkJCQkkdGhpcy0+bXBkZi0+a2VlcF9ibG9ja190b2dldGhlciA9IDA7CgoJCQkJCSR0aGlzLT5tcGRmLT5ibG9ja0NvbnRleHQrKzsKCQkJCQkkY3VycmJsa1snYmxvY2tDb250ZXh0J10gPSAkdGhpcy0+bXBkZi0+YmxvY2tDb250ZXh0OwoKCQkJCQlsaXN0KCRsX2V4aXN0cywgJHJfZXhpc3RzLCAkbF9tYXgsICRyX21heCwgJGxfd2lkdGgsICRyX3dpZHRoKSA9ICR0aGlzLT5tcGRmLT5HZXRGbG9hdERpdkluZm8oJHRoaXMtPm1wZGYtPmJsa2x2bCAtIDEpOwoKCQkJCQkvLyBESVYgaXMgdG9vIG5hcnJvdyBmb3IgdGV4dCB0byBmaXQhCgkJCQkJJG1heHcgPSAkY29udGFpbmVyX3cgLSAkbF93aWR0aCAtICRyX3dpZHRoOwoJCQkJCWlmICgoJHNldHdpZHRoICsgJGN1cnJibGtbJ21hcmdpbl9yaWdodCddICsgJGJkbCArICRwZGwgKyAkYmRyICsgJHBkcikgPiAkbWF4dyB8fCAoJG1heHcgLSAoJGN1cnJibGtbJ21hcmdpbl9yaWdodCddICsgJGJkbCArICRwZGwgKyAkYmRyICsgJHBkcikpIDwgKDIgKiAkdGhpcy0+bXBkZi0+R2V0Q2hhcldpZHRoKCdXJywgZmFsc2UpKSkgewoJCQkJCQkvLyBUb28gbmFycm93IHRvIGZpdCAtIHRyeSB0byBtb3ZlIGRvd24gcGFzdCBMIG9yIFIgZmxvYXQKCQkJCQkJaWYgKCRsX21heCA8ICRyX21heCAmJiAoJHNldHdpZHRoICsgJGN1cnJibGtbJ21hcmdpbl9yaWdodCddICsgJGJkbCArICRwZGwgKyAkYmRyICsgJHBkcikgPD0gKCRjb250YWluZXJfdyAtICRyX3dpZHRoKSAmJiAoKCRjb250YWluZXJfdyAtICRyX3dpZHRoKSAtICgkY3VycmJsa1snbWFyZ2luX3JpZ2h0J10gKyAkYmRsICsgJHBkbCArICRiZHIgKyAkcGRyKSkgPiAoMiAqICR0aGlzLT5tcGRmLT5HZXRDaGFyV2lkdGgoJ1cnLCBmYWxzZSkpKSB7CgkJCQkJCQkkdGhpcy0+bXBkZi0+Q2xlYXJGbG9hdHMoJ0xFRlQnLCAkdGhpcy0+bXBkZi0+YmxrbHZsIC0gMSk7CgkJCQkJCX0gZWxzZSBpZiAoJHJfbWF4IDwgJGxfbWF4ICYmICgkc2V0d2lkdGggKyAkY3VycmJsa1snbWFyZ2luX3JpZ2h0J10gKyAkYmRsICsgJHBkbCArICRiZHIgKyAkcGRyKSA8PSAoJGNvbnRhaW5lcl93IC0gJGxfd2lkdGgpICYmICgoJGNvbnRhaW5lcl93IC0gJGxfd2lkdGgpIC0gKCRjdXJyYmxrWydtYXJnaW5fcmlnaHQnXSArICRiZGwgKyAkcGRsICsgJGJkciArICRwZHIpKSA+ICgyICogJHRoaXMtPm1wZGYtPkdldENoYXJXaWR0aCgnVycsIGZhbHNlKSkpIHsKCQkJCQkJCSR0aGlzLT5tcGRmLT5DbGVhckZsb2F0cygnUklHSFQnLCAkdGhpcy0+bXBkZi0+YmxrbHZsIC0gMSk7CgkJCQkJCX0gZWxzZSB7CgkJCQkJCQkkdGhpcy0+bXBkZi0+Q2xlYXJGbG9hdHMoJ0JPVEgnLCAkdGhpcy0+bXBkZi0+YmxrbHZsIC0gMSk7CgkJCQkJCX0KCQkJCQkJbGlzdCgkbF9leGlzdHMsICRyX2V4aXN0cywgJGxfbWF4LCAkcl9tYXgsICRsX3dpZHRoLCAkcl93aWR0aCkgPSAkdGhpcy0+bXBkZi0+R2V0RmxvYXREaXZJbmZvKCR0aGlzLT5tcGRmLT5ibGtsdmwgLSAxKTsKCQkJCQl9CgoJCQkJCWlmICgkcl9leGlzdHMpIHsKCQkJCQkJJGN1cnJibGtbJ21hcmdpbl9yaWdodCddICs9ICRyX3dpZHRoOwoJCQkJCX0KCgkJCQkJJGN1cnJibGtbJ2Zsb2F0J10gPSAnUic7CgkJCQkJJGN1cnJibGtbJ2Zsb2F0X3N0YXJ0X3knXSA9ICR0aGlzLT5tcGRmLT55OwoJCQkJCWlmICgkY3VycmJsa1snY3NzX3NldF93aWR0aCddKSB7CgkJCQkJCSRjdXJyYmxrWydtYXJnaW5fbGVmdCddID0gJGNvbnRhaW5lcl93IC0gKCRzZXR3aWR0aCArICRiZGwgKyAkcGRsICsgJGJkciArICRwZHIgKyAkY3VycmJsa1snbWFyZ2luX3JpZ2h0J10pOwoJCQkJCQkkY3VycmJsa1snZmxvYXRfd2lkdGgnXSA9ICgkc2V0d2lkdGggKyAkYmRsICsgJHBkbCArICRiZHIgKyAkcGRyICsgJGN1cnJibGtbJ21hcmdpbl9yaWdodCddKTsKCQkJCQl9IGVsc2UgewoJCQkJCQkvLyAqKiogSWYgbm8gd2lkdGggc2V0IC0gd291bGQgbmVlZCB0byBidWZmZXIgYW5kIGtlZXAgdHJhY2sgb2YgbWF4IHdpZHRoLCB0aGVuIFJpZ2h0LWFsaWduIGlmIG5vdCBmdWxsIHdpZHRoCgkJCQkJCS8vIGFuZCBkbyBib3JkZXJzIGFuZCBiYWNrZ3JvdW5kcyAtIEZvciBub3cgLSBqdXN0IHNldCB0byBtYXhpbXVtIHdpZHRoIGxlZnQKCgkJCQkJCWlmICgkbF9leGlzdHMpIHsKCQkJCQkJCSRjdXJyYmxrWydtYXJnaW5fbGVmdCddICs9ICRsX3dpZHRoOwoJCQkJCQl9CgkJCQkJCSRjdXJyYmxrWydjc3Nfc2V0X3dpZHRoJ10gPSAkY29udGFpbmVyX3cgLSAoJGN1cnJibGtbJ21hcmdpbl9sZWZ0J10gKyAkY3VycmJsa1snbWFyZ2luX3JpZ2h0J10gKyAkYmRsICsgJHBkbCArICRiZHIgKyAkcGRyKTsKCgkJCQkJCSRjdXJyYmxrWydmbG9hdF93aWR0aCddID0gKCRjdXJyYmxrWydjc3Nfc2V0X3dpZHRoJ10gKyAkYmRsICsgJHBkbCArICRiZHIgKyAkcGRyICsgJGN1cnJibGtbJ21hcmdpbl9yaWdodCddKTsKCQkJCQl9CgkJCQl9IGVsc2UgaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydGTE9BVCddKSAmJiBzdHJ0b3VwcGVyKCRwcm9wZXJ0aWVzWydGTE9BVCddKSA9PSAnTEVGVCcgJiYgISR0aGlzLT5tcGRmLT5Db2xBY3RpdmUpIHsKCQkJCQkvLyBDYW5jZWwgS2VlcC1CbG9jay10b2dldGhlcgoJCQkJCSRjdXJyYmxrWydrZWVwX2Jsb2NrX3RvZ2V0aGVyJ10gPSBmYWxzZTsKCQkJCQkkdGhpcy0+bXBkZi0+a3RfeTAwID0gJyc7CgkJCQkJJHRoaXMtPm1wZGYtPmtlZXBfYmxvY2tfdG9nZXRoZXIgPSAwOwoKCQkJCQkkdGhpcy0+bXBkZi0+YmxvY2tDb250ZXh0Kys7CgkJCQkJJGN1cnJibGtbJ2Jsb2NrQ29udGV4dCddID0gJHRoaXMtPm1wZGYtPmJsb2NrQ29udGV4dDsKCgkJCQkJbGlzdCgkbF9leGlzdHMsICRyX2V4aXN0cywgJGxfbWF4LCAkcl9tYXgsICRsX3dpZHRoLCAkcl93aWR0aCkgPSAkdGhpcy0+bXBkZi0+R2V0RmxvYXREaXZJbmZvKCR0aGlzLT5tcGRmLT5ibGtsdmwgLSAxKTsKCgkJCQkJLy8gRElWIGlzIHRvbyBuYXJyb3cgZm9yIHRleHQgdG8gZml0IQoJCQkJCSRtYXh3ID0gJGNvbnRhaW5lcl93IC0gJGxfd2lkdGggLSAkcl93aWR0aDsKCQkJCQlpZiAoKCRzZXR3aWR0aCArICRjdXJyYmxrWydtYXJnaW5fbGVmdCddICsgJGJkbCArICRwZGwgKyAkYmRyICsgJHBkcikgPiAkbWF4dyB8fCAoJG1heHcgLSAoJGN1cnJibGtbJ21hcmdpbl9sZWZ0J10gKyAkYmRsICsgJHBkbCArICRiZHIgKyAkcGRyKSkgPCAoMiAqICR0aGlzLT5tcGRmLT5HZXRDaGFyV2lkdGgoJ1cnLCBmYWxzZSkpKSB7CgkJCQkJCS8vIFRvbyBuYXJyb3cgdG8gZml0IC0gdHJ5IHRvIG1vdmUgZG93biBwYXN0IEwgb3IgUiBmbG9hdAoJCQkJCQlpZiAoJGxfbWF4IDwgJHJfbWF4ICYmICgkc2V0d2lkdGggKyAkY3VycmJsa1snbWFyZ2luX3JpZ2h0J10gKyAkYmRsICsgJHBkbCArICRiZHIgKyAkcGRyKSA8PSAoJGNvbnRhaW5lcl93IC0gJHJfd2lkdGgpICYmICgoJGNvbnRhaW5lcl93IC0gJHJfd2lkdGgpIC0gKCRjdXJyYmxrWydtYXJnaW5fcmlnaHQnXSArICRiZGwgKyAkcGRsICsgJGJkciArICRwZHIpKSA+ICgyICogJHRoaXMtPm1wZGYtPkdldENoYXJXaWR0aCgnVycsIGZhbHNlKSkpIHsKCQkJCQkJCSR0aGlzLT5tcGRmLT5DbGVhckZsb2F0cygnTEVGVCcsICR0aGlzLT5tcGRmLT5ibGtsdmwgLSAxKTsKCQkJCQkJfSBlbHNlIGlmICgkcl9tYXggPCAkbF9tYXggJiYgKCRzZXR3aWR0aCArICRjdXJyYmxrWydtYXJnaW5fcmlnaHQnXSArICRiZGwgKyAkcGRsICsgJGJkciArICRwZHIpIDw9ICgkY29udGFpbmVyX3cgLSAkbF93aWR0aCkgJiYgKCgkY29udGFpbmVyX3cgLSAkbF93aWR0aCkgLSAoJGN1cnJibGtbJ21hcmdpbl9yaWdodCddICsgJGJkbCArICRwZGwgKyAkYmRyICsgJHBkcikpID4gKDIgKiAkdGhpcy0+bXBkZi0+R2V0Q2hhcldpZHRoKCdXJywgZmFsc2UpKSkgewoJCQkJCQkJJHRoaXMtPm1wZGYtPkNsZWFyRmxvYXRzKCdSSUdIVCcsICR0aGlzLT5tcGRmLT5ibGtsdmwgLSAxKTsKCQkJCQkJfSBlbHNlIHsKCQkJCQkJCSR0aGlzLT5tcGRmLT5DbGVhckZsb2F0cygnQk9USCcsICR0aGlzLT5tcGRmLT5ibGtsdmwgLSAxKTsKCQkJCQkJfQoJCQkJCQlsaXN0KCRsX2V4aXN0cywgJHJfZXhpc3RzLCAkbF9tYXgsICRyX21heCwgJGxfd2lkdGgsICRyX3dpZHRoKSA9ICR0aGlzLT5tcGRmLT5HZXRGbG9hdERpdkluZm8oJHRoaXMtPm1wZGYtPmJsa2x2bCAtIDEpOwoJCQkJCX0KCgkJCQkJaWYgKCRsX2V4aXN0cykgewoJCQkJCQkkY3VycmJsa1snbWFyZ2luX2xlZnQnXSArPSAkbF93aWR0aDsKCQkJCQl9CgoJCQkJCSRjdXJyYmxrWydmbG9hdCddID0gJ0wnOwoJCQkJCSRjdXJyYmxrWydmbG9hdF9zdGFydF95J10gPSAkdGhpcy0+bXBkZi0+eTsKCQkJCQlpZiAoJHNldHdpZHRoKSB7CgkJCQkJCSRjdXJyYmxrWydtYXJnaW5fcmlnaHQnXSA9ICRjb250YWluZXJfdyAtICgkc2V0d2lkdGggKyAkYmRsICsgJHBkbCArICRiZHIgKyAkcGRyICsgJGN1cnJibGtbJ21hcmdpbl9sZWZ0J10pOwoJCQkJCQkkY3VycmJsa1snZmxvYXRfd2lkdGgnXSA9ICgkc2V0d2lkdGggKyAkYmRsICsgJHBkbCArICRiZHIgKyAkcGRyICsgJGN1cnJibGtbJ21hcmdpbl9sZWZ0J10pOwoJCQkJCX0gZWxzZSB7CgkJCQkJCS8vICoqKiBJZiBubyB3aWR0aCBzZXQgLSB3b3VsZCBuZWVkIHRvIGJ1ZmZlciBhbmQga2VlcCB0cmFjayBvZiBtYXggd2lkdGgsIHRoZW4gUmlnaHQtYWxpZ24gaWYgbm90IGZ1bGwgd2lkdGgKCQkJCQkJLy8gYW5kIGRvIGJvcmRlcnMgYW5kIGJhY2tncm91bmRzIC0gRm9yIG5vdyAtIGp1c3Qgc2V0IHRvIG1heGltdW0gd2lkdGggbGVmdAoKCQkJCQkJaWYgKCRyX2V4aXN0cykgewoJCQkJCQkJJGN1cnJibGtbJ21hcmdpbl9yaWdodCddICs9ICRyX3dpZHRoOwoJCQkJCQl9CgkJCQkJCSRjdXJyYmxrWydjc3Nfc2V0X3dpZHRoJ10gPSAkY29udGFpbmVyX3cgLSAoJGN1cnJibGtbJ21hcmdpbl9sZWZ0J10gKyAkY3VycmJsa1snbWFyZ2luX3JpZ2h0J10gKyAkYmRsICsgJHBkbCArICRiZHIgKyAkcGRyKTsKCgkJCQkJCSRjdXJyYmxrWydmbG9hdF93aWR0aCddID0gKCRjdXJyYmxrWydjc3Nfc2V0X3dpZHRoJ10gKyAkYmRsICsgJHBkbCArICRiZHIgKyAkcGRyICsgJGN1cnJibGtbJ21hcmdpbl9sZWZ0J10pOwoJCQkJCX0KCQkJCX0gZWxzZSB7CgkJCQkJLy8gRG9uJ3QgYWxsb3cgb3ZlcmxhcCAtIGlmIGZsb2F0cyBwcmVzZW50IC0gYWRqdXN0IHBhZGRpbmcgdG8gYXZvaWQgb3ZlcmxhcCB3aXRoIEZsb2F0cwoJCQkJCWxpc3QoJGxfZXhpc3RzLCAkcl9leGlzdHMsICRsX21heCwgJHJfbWF4LCAkbF93aWR0aCwgJHJfd2lkdGgpID0gJHRoaXMtPm1wZGYtPkdldEZsb2F0RGl2SW5mbygkdGhpcy0+bXBkZi0+YmxrbHZsIC0gMSk7CgkJCQkJJG1heHcgPSAkY29udGFpbmVyX3cgLSAkbF93aWR0aCAtICRyX3dpZHRoOwoJCQkJCWlmICgoJHNldHdpZHRoICsgJGN1cnJibGtbJ21hcmdpbl9sZWZ0J10gKyAkY3VycmJsa1snbWFyZ2luX3JpZ2h0J10gKyAkYmRsICsgJHBkbCArICRiZHIgKyAkcGRyKSA+ICRtYXh3IHx8ICgkbWF4dyAtICgkY3VycmJsa1snbWFyZ2luX3JpZ2h0J10gKyAkY3VycmJsa1snbWFyZ2luX2xlZnQnXSArICRiZGwgKyAkcGRsICsgJGJkciArICRwZHIpKSA8ICgyICogJHRoaXMtPm1wZGYtPkdldENoYXJXaWR0aCgnVycsIGZhbHNlKSkpIHsKCQkJCQkJLy8gVG9vIG5hcnJvdyB0byBmaXQgLSB0cnkgdG8gbW92ZSBkb3duIHBhc3QgTCBvciBSIGZsb2F0CgkJCQkJCWlmICgkbF9tYXggPCAkcl9tYXggJiYgKCRzZXR3aWR0aCArICRjdXJyYmxrWydtYXJnaW5fbGVmdCddICsgJGN1cnJibGtbJ21hcmdpbl9yaWdodCddICsgJGJkbCArICRwZGwgKyAkYmRyICsgJHBkcikgPD0gKCRjb250YWluZXJfdyAtICRyX3dpZHRoKSAmJiAoKCRjb250YWluZXJfdyAtICRyX3dpZHRoKSAtICgkY3VycmJsa1snbWFyZ2luX3JpZ2h0J10gKyAkY3VycmJsa1snbWFyZ2luX2xlZnQnXSArICRiZGwgKyAkcGRsICsgJGJkciArICRwZHIpKSA+ICgyICogJHRoaXMtPm1wZGYtPkdldENoYXJXaWR0aCgnVycsIGZhbHNlKSkpIHsKCQkJCQkJCSR0aGlzLT5tcGRmLT5DbGVhckZsb2F0cygnTEVGVCcsICR0aGlzLT5tcGRmLT5ibGtsdmwgLSAxKTsKCQkJCQkJfSBlbHNlIGlmICgkcl9tYXggPCAkbF9tYXggJiYgKCRzZXR3aWR0aCArICRjdXJyYmxrWydtYXJnaW5fbGVmdCddICsgJGN1cnJibGtbJ21hcmdpbl9yaWdodCddICsgJGJkbCArICRwZGwgKyAkYmRyICsgJHBkcikgPD0gKCRjb250YWluZXJfdyAtICRsX3dpZHRoKSAmJiAoKCRjb250YWluZXJfdyAtICRsX3dpZHRoKSAtICgkY3VycmJsa1snbWFyZ2luX3JpZ2h0J10gKyAkY3VycmJsa1snbWFyZ2luX2xlZnQnXSArICRiZGwgKyAkcGRsICsgJGJkciArICRwZHIpKSA+ICgyICogJHRoaXMtPm1wZGYtPkdldENoYXJXaWR0aCgnVycsIGZhbHNlKSkpIHsKCQkJCQkJCSR0aGlzLT5tcGRmLT5DbGVhckZsb2F0cygnUklHSFQnLCAkdGhpcy0+bXBkZi0+YmxrbHZsIC0gMSk7CgkJCQkJCX0gZWxzZSB7CgkJCQkJCQkkdGhpcy0+bXBkZi0+Q2xlYXJGbG9hdHMoJ0JPVEgnLCAkdGhpcy0+bXBkZi0+YmxrbHZsIC0gMSk7CgkJCQkJCX0KCQkJCQkJbGlzdCgkbF9leGlzdHMsICRyX2V4aXN0cywgJGxfbWF4LCAkcl9tYXgsICRsX3dpZHRoLCAkcl93aWR0aCkgPSAkdGhpcy0+bXBkZi0+R2V0RmxvYXREaXZJbmZvKCR0aGlzLT5tcGRmLT5ibGtsdmwgLSAxKTsKCQkJCQl9CgkJCQkJaWYgKCRyX2V4aXN0cykgewoJCQkJCQkkY3VycmJsa1sncGFkZGluZ19yaWdodCddID0gbWF4KCgkcl93aWR0aCAtICRjdXJyYmxrWydtYXJnaW5fcmlnaHQnXSAtICRiZHIpLCAkcGRyKTsKCQkJCQl9CgkJCQkJaWYgKCRsX2V4aXN0cykgewoJCQkJCQkkY3VycmJsa1sncGFkZGluZ19sZWZ0J10gPSBtYXgoKCRsX3dpZHRoIC0gJGN1cnJibGtbJ21hcmdpbl9sZWZ0J10gLSAkYmRsKSwgJHBkbCk7CgkJCQkJfQoJCQkJfQoJCQkJLyogLS0gRU5EIENTUy1GTE9BVCAtLSAqLwoKCgkJCQkvKiAtLSBCT1JERVItUkFESVVTIC0tICovCgkJCQkvLyBBdXRvbWF0aWNhbGx5IGluY3JlYXNlIHBhZGRpbmcgaWYgcmVxdWlyZWQgZm9yIGJvcmRlci1yYWRpdXMKCQkJCWlmICgkdGhpcy0+bXBkZi0+YXV0b1BhZGRpbmcgJiYgISR0aGlzLT5tcGRmLT5Db2xBY3RpdmUpIHsKCQkJCQlpZiAoJGN1cnJibGtbJ2JvcmRlcl9yYWRpdXNfVExfSCddID4gJGN1cnJibGtbJ3BhZGRpbmdfbGVmdCddICYmICRjdXJyYmxrWydib3JkZXJfcmFkaXVzX1RMX1YnXSA+ICRjdXJyYmxrWydwYWRkaW5nX3RvcCddKSB7CgkJCQkJCWlmICgkY3VycmJsa1snYm9yZGVyX3JhZGl1c19UTF9IJ10gPiAkY3VycmJsa1snYm9yZGVyX3JhZGl1c19UTF9WJ10pIHsKCQkJCQkJCSR0aGlzLT5tcGRmLT5fYm9yZGVyUGFkZGluZygkY3VycmJsa1snYm9yZGVyX3JhZGl1c19UTF9IJ10sICRjdXJyYmxrWydib3JkZXJfcmFkaXVzX1RMX1YnXSwgJGN1cnJibGtbJ3BhZGRpbmdfbGVmdCddLCAkY3VycmJsa1sncGFkZGluZ190b3AnXSk7CgkJCQkJCX0gZWxzZSB7CgkJCQkJCQkkdGhpcy0+bXBkZi0+X2JvcmRlclBhZGRpbmcoJGN1cnJibGtbJ2JvcmRlcl9yYWRpdXNfVExfViddLCAkY3VycmJsa1snYm9yZGVyX3JhZGl1c19UTF9IJ10sICRjdXJyYmxrWydwYWRkaW5nX3RvcCddLCAkY3VycmJsa1sncGFkZGluZ19sZWZ0J10pOwoJCQkJCQl9CgkJCQkJfQoJCQkJCWlmICgkY3VycmJsa1snYm9yZGVyX3JhZGl1c19UUl9IJ10gPiAkY3VycmJsa1sncGFkZGluZ19yaWdodCddICYmICRjdXJyYmxrWydib3JkZXJfcmFkaXVzX1RSX1YnXSA+ICRjdXJyYmxrWydwYWRkaW5nX3RvcCddKSB7CgkJCQkJCWlmICgkY3VycmJsa1snYm9yZGVyX3JhZGl1c19UUl9IJ10gPiAkY3VycmJsa1snYm9yZGVyX3JhZGl1c19UUl9WJ10pIHsKCQkJCQkJCSR0aGlzLT5tcGRmLT5fYm9yZGVyUGFkZGluZygkY3VycmJsa1snYm9yZGVyX3JhZGl1c19UUl9IJ10sICRjdXJyYmxrWydib3JkZXJfcmFkaXVzX1RSX1YnXSwgJGN1cnJibGtbJ3BhZGRpbmdfcmlnaHQnXSwgJGN1cnJibGtbJ3BhZGRpbmdfdG9wJ10pOwoJCQkJCQl9IGVsc2UgewoJCQkJCQkJJHRoaXMtPm1wZGYtPl9ib3JkZXJQYWRkaW5nKCRjdXJyYmxrWydib3JkZXJfcmFkaXVzX1RSX1YnXSwgJGN1cnJibGtbJ2JvcmRlcl9yYWRpdXNfVFJfSCddLCAkY3VycmJsa1sncGFkZGluZ190b3AnXSwgJGN1cnJibGtbJ3BhZGRpbmdfcmlnaHQnXSk7CgkJCQkJCX0KCQkJCQl9CgkJCQkJaWYgKCRjdXJyYmxrWydib3JkZXJfcmFkaXVzX0JMX0gnXSA+ICRjdXJyYmxrWydwYWRkaW5nX2xlZnQnXSAmJiAkY3VycmJsa1snYm9yZGVyX3JhZGl1c19CTF9WJ10gPiAkY3VycmJsa1sncGFkZGluZ19ib3R0b20nXSkgewoJCQkJCQlpZiAoJGN1cnJibGtbJ2JvcmRlcl9yYWRpdXNfQkxfSCddID4gJGN1cnJibGtbJ2JvcmRlcl9yYWRpdXNfQkxfViddKSB7CgkJCQkJCQkkdGhpcy0+bXBkZi0+X2JvcmRlclBhZGRpbmcoJGN1cnJibGtbJ2JvcmRlcl9yYWRpdXNfQkxfSCddLCAkY3VycmJsa1snYm9yZGVyX3JhZGl1c19CTF9WJ10sICRjdXJyYmxrWydwYWRkaW5nX2xlZnQnXSwgJGN1cnJibGtbJ3BhZGRpbmdfYm90dG9tJ10pOwoJCQkJCQl9IGVsc2UgewoJCQkJCQkJJHRoaXMtPm1wZGYtPl9ib3JkZXJQYWRkaW5nKCRjdXJyYmxrWydib3JkZXJfcmFkaXVzX0JMX1YnXSwgJGN1cnJibGtbJ2JvcmRlcl9yYWRpdXNfQkxfSCddLCAkY3VycmJsa1sncGFkZGluZ19ib3R0b20nXSwgJGN1cnJibGtbJ3BhZGRpbmdfbGVmdCddKTsKCQkJCQkJfQoJCQkJCX0KCQkJCQlpZiAoJGN1cnJibGtbJ2JvcmRlcl9yYWRpdXNfQlJfSCddID4gJGN1cnJibGtbJ3BhZGRpbmdfcmlnaHQnXSAmJiAkY3VycmJsa1snYm9yZGVyX3JhZGl1c19CUl9WJ10gPiAkY3VycmJsa1sncGFkZGluZ19ib3R0b20nXSkgewoJCQkJCQlpZiAoJGN1cnJibGtbJ2JvcmRlcl9yYWRpdXNfQlJfSCddID4gJGN1cnJibGtbJ2JvcmRlcl9yYWRpdXNfQlJfViddKSB7CgkJCQkJCQkkdGhpcy0+bXBkZi0+X2JvcmRlclBhZGRpbmcoJGN1cnJibGtbJ2JvcmRlcl9yYWRpdXNfQlJfSCddLCAkY3VycmJsa1snYm9yZGVyX3JhZGl1c19CUl9WJ10sICRjdXJyYmxrWydwYWRkaW5nX3JpZ2h0J10sICRjdXJyYmxrWydwYWRkaW5nX2JvdHRvbSddKTsKCQkJCQkJfSBlbHNlIHsKCQkJCQkJCSR0aGlzLT5tcGRmLT5fYm9yZGVyUGFkZGluZygkY3VycmJsa1snYm9yZGVyX3JhZGl1c19CUl9WJ10sICRjdXJyYmxrWydib3JkZXJfcmFkaXVzX0JSX0gnXSwgJGN1cnJibGtbJ3BhZGRpbmdfYm90dG9tJ10sICRjdXJyYmxrWydwYWRkaW5nX3JpZ2h0J10pOwoJCQkJCQl9CgkJCQkJfQoJCQkJfQoJCQkJLyogLS0gRU5EIEJPUkRFUi1SQURJVVMgLS0gKi8KCgoJCQkJLy8gSGFuZ2luZyBpbmRlbnQgLSBpZiBuZWdhdGl2ZSBpbmRlbnQ6IGVuc3VyZSBwYWRkaW5nIGlzID49IGluZGVudAoJCQkJaWYgKCFpc3NldCgkY3VycmJsa1sndGV4dF9pbmRlbnQnXSkpIHsKCQkJCQkkY3VycmJsa1sndGV4dF9pbmRlbnQnXSA9IG51bGw7CgkJCQl9CgkJCQlpZiAoIWlzc2V0KCRjdXJyYmxrWydpbm5lcl93aWR0aCddKSkgewoJCQkJCSRjdXJyYmxrWydpbm5lcl93aWR0aCddID0gbnVsbDsKCQkJCX0KCQkJCSRjYnRpID0gJHRoaXMtPm1wZGYtPkNvbnZlcnRTaXplKCRjdXJyYmxrWyd0ZXh0X2luZGVudCddLCAkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWydpbm5lcl93aWR0aCddLCAkdGhpcy0+bXBkZi0+Rm9udFNpemUsIGZhbHNlKTsKCQkJCWlmICgkY2J0aSA8IDApIHsKCQkJCQkkaGFuZ2luZCA9IC0oJGNidGkpOwoJCQkJCWlmIChpc3NldCgkY3VycmJsa1snZGlyZWN0aW9uJ10pICYmICRjdXJyYmxrWydkaXJlY3Rpb24nXSA9PSAncnRsJykgeyAvLyAqT1RMKgoJCQkJCQkkY3VycmJsa1sncGFkZGluZ19yaWdodCddID0gbWF4KCRjdXJyYmxrWydwYWRkaW5nX3JpZ2h0J10sICRoYW5naW5kKTsgLy8gKk9UTCoKCQkJCQl9IC8vICpPVEwqCgkJCQkJZWxzZSB7IC8vICpPVEwqCgkJCQkJCSRjdXJyYmxrWydwYWRkaW5nX2xlZnQnXSA9IG1heCgkY3VycmJsa1sncGFkZGluZ19sZWZ0J10sICRoYW5naW5kKTsKCQkJCQl9IC8vICpPVEwqCgkJCQl9CgoJCQkJaWYgKGlzc2V0KCRjdXJyYmxrWydjc3Nfc2V0X3dpZHRoJ10pKSB7CgkJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydNQVJHSU4tTEVGVCddKSAmJiBpc3NldCgkcHJvcGVydGllc1snTUFSR0lOLVJJR0hUJ10pICYmIHN0cnRvbG93ZXIoJHByb3BlcnRpZXNbJ01BUkdJTi1MRUZUJ10pID09ICdhdXRvJyAmJiBzdHJ0b2xvd2VyKCRwcm9wZXJ0aWVzWydNQVJHSU4tUklHSFQnXSkgPT0gJ2F1dG8nKSB7CgkJCQkJCS8vIFRyeSB0byByZWR1Y2UgbWFyZ2lucyB0byBhY2NvbW9kYXRlIC0gaWYgc3RpbGwgdG9vIHdpZGUsIHNldCBtYXJnaW4tcmlnaHQvbGVmdD0wIChyZWR1Y2VzIHdpZHRoKQoJCQkJCQkkYW55ZXh0cmEgPSAkcHJldmJsa1snaW5uZXJfd2lkdGgnXSAtICgkY3VycmJsa1snY3NzX3NldF93aWR0aCddICsgJGN1cnJibGtbJ2JvcmRlcl9sZWZ0J11bJ3cnXSArICRjdXJyYmxrWydwYWRkaW5nX2xlZnQnXSArICRjdXJyYmxrWydib3JkZXJfcmlnaHQnXVsndyddICsgJGN1cnJibGtbJ3BhZGRpbmdfcmlnaHQnXSk7CgkJCQkJCWlmICgkYW55ZXh0cmEgPiAwKSB7CgkJCQkJCQkkY3VycmJsa1snbWFyZ2luX2xlZnQnXSA9ICRjdXJyYmxrWydtYXJnaW5fcmlnaHQnXSA9ICRhbnlleHRyYSAvIDI7CgkJCQkJCX0gZWxzZSB7CgkJCQkJCQkkY3VycmJsa1snbWFyZ2luX2xlZnQnXSA9ICRjdXJyYmxrWydtYXJnaW5fcmlnaHQnXSA9IDA7CgkJCQkJCX0KCQkJCQl9IGVsc2UgaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydNQVJHSU4tTEVGVCddKSAmJiBzdHJ0b2xvd2VyKCRwcm9wZXJ0aWVzWydNQVJHSU4tTEVGVCddKSA9PSAnYXV0bycpIHsKCQkJCQkJLy8gVHJ5IHRvIHJlZHVjZSBtYXJnaW4tbGVmdCB0byBhY2NvbW9kYXRlIC0gaWYgc3RpbGwgdG9vIHdpZGUsIHNldCBtYXJnaW4tbGVmdD0wIChyZWR1Y2VzIHdpZHRoKQoJCQkJCQkkY3VycmJsa1snbWFyZ2luX2xlZnQnXSA9ICRwcmV2YmxrWydpbm5lcl93aWR0aCddIC0gKCRjdXJyYmxrWydjc3Nfc2V0X3dpZHRoJ10gKyAkY3VycmJsa1snYm9yZGVyX2xlZnQnXVsndyddICsgJGN1cnJibGtbJ3BhZGRpbmdfbGVmdCddICsgJGN1cnJibGtbJ2JvcmRlcl9yaWdodCddWyd3J10gKyAkY3VycmJsa1sncGFkZGluZ19yaWdodCddICsgJGN1cnJibGtbJ21hcmdpbl9yaWdodCddKTsKCQkJCQkJaWYgKCRjdXJyYmxrWydtYXJnaW5fbGVmdCddIDwgMCkgewoJCQkJCQkJJGN1cnJibGtbJ21hcmdpbl9sZWZ0J10gPSAwOwoJCQkJCQl9CgkJCQkJfSBlbHNlIGlmIChpc3NldCgkcHJvcGVydGllc1snTUFSR0lOLVJJR0hUJ10pICYmIHN0cnRvbG93ZXIoJHByb3BlcnRpZXNbJ01BUkdJTi1SSUdIVCddKSA9PSAnYXV0bycpIHsKCQkJCQkJLy8gVHJ5IHRvIHJlZHVjZSBtYXJnaW4tcmlnaHQgdG8gYWNjb21vZGF0ZSAtIGlmIHN0aWxsIHRvbyB3aWRlLCBzZXQgbWFyZ2luLXJpZ2h0PTAgKHJlZHVjZXMgd2lkdGgpCgkJCQkJCSRjdXJyYmxrWydtYXJnaW5fcmlnaHQnXSA9ICRwcmV2YmxrWydpbm5lcl93aWR0aCddIC0gKCRjdXJyYmxrWydjc3Nfc2V0X3dpZHRoJ10gKyAkY3VycmJsa1snYm9yZGVyX2xlZnQnXVsndyddICsgJGN1cnJibGtbJ3BhZGRpbmdfbGVmdCddICsgJGN1cnJibGtbJ2JvcmRlcl9yaWdodCddWyd3J10gKyAkY3VycmJsa1sncGFkZGluZ19yaWdodCddICsgJGN1cnJibGtbJ21hcmdpbl9sZWZ0J10pOwoJCQkJCQlpZiAoJGN1cnJibGtbJ21hcmdpbl9yaWdodCddIDwgMCkgewoJCQkJCQkJJGN1cnJibGtbJ21hcmdpbl9yaWdodCddID0gMDsKCQkJCQkJfQoJCQkJCX0gZWxzZSB7CgkJCQkJCWlmICgkY3VycmJsa1snZGlyZWN0aW9uJ10gPT0gJ3J0bCcpIHsgLy8gKk9UTCoKCQkJCQkJCS8vIFRyeSB0byByZWR1Y2UgbWFyZ2luLWxlZnQgdG8gYWNjb21vZGF0ZSAtIGlmIHN0aWxsIHRvbyB3aWRlLCBzZXQgbWFyZ2luLWxlZnQ9MCAocmVkdWNlcyB3aWR0aCkKCQkJCQkJCSRjdXJyYmxrWydtYXJnaW5fbGVmdCddID0gJHByZXZibGtbJ2lubmVyX3dpZHRoJ10gLSAoJGN1cnJibGtbJ2Nzc19zZXRfd2lkdGgnXSArICRjdXJyYmxrWydib3JkZXJfbGVmdCddWyd3J10gKyAkY3VycmJsa1sncGFkZGluZ19sZWZ0J10gKyAkY3VycmJsa1snYm9yZGVyX3JpZ2h0J11bJ3cnXSArICRjdXJyYmxrWydwYWRkaW5nX3JpZ2h0J10gKyAkY3VycmJsa1snbWFyZ2luX3JpZ2h0J10pOyAvLyAqT1RMKgoJCQkJCQkJaWYgKCRjdXJyYmxrWydtYXJnaW5fbGVmdCddIDwgMCkgeyAvLyAqT1RMKgoJCQkJCQkJCSRjdXJyYmxrWydtYXJnaW5fbGVmdCddID0gMDsgLy8gKk9UTCoKCQkJCQkJCX0gLy8gKk9UTCoKCQkJCQkJfSAvLyAqT1RMKgoJCQkJCQllbHNlIHsgLy8gKk9UTCoKCQkJCQkJCS8vIFRyeSB0byByZWR1Y2UgbWFyZ2luLXJpZ2h0IHRvIGFjY29tb2RhdGUgLSBpZiBzdGlsbCB0b28gd2lkZSwgc2V0IG1hcmdpbi1yaWdodD0wIChyZWR1Y2VzIHdpZHRoKQoJCQkJCQkJJGN1cnJibGtbJ21hcmdpbl9yaWdodCddID0gJHByZXZibGtbJ2lubmVyX3dpZHRoJ10gLSAoJGN1cnJibGtbJ2Nzc19zZXRfd2lkdGgnXSArICRjdXJyYmxrWydib3JkZXJfbGVmdCddWyd3J10gKyAkY3VycmJsa1sncGFkZGluZ19sZWZ0J10gKyAkY3VycmJsa1snYm9yZGVyX3JpZ2h0J11bJ3cnXSArICRjdXJyYmxrWydwYWRkaW5nX3JpZ2h0J10gKyAkY3VycmJsa1snbWFyZ2luX2xlZnQnXSk7CgkJCQkJCQlpZiAoJGN1cnJibGtbJ21hcmdpbl9yaWdodCddIDwgMCkgewoJCQkJCQkJCSRjdXJyYmxrWydtYXJnaW5fcmlnaHQnXSA9IDA7CgkJCQkJCQl9CgkJCQkJCX0gLy8gKk9UTCoKCQkJCQl9CgkJCQl9CgoJCQkJJGN1cnJibGtbJ291dGVyX2xlZnRfbWFyZ2luJ10gPSAkcHJldmJsa1snb3V0ZXJfbGVmdF9tYXJnaW4nXSArICRjdXJyYmxrWydtYXJnaW5fbGVmdCddICsgJHByZXZibGtbJ2JvcmRlcl9sZWZ0J11bJ3cnXSArICRwcmV2YmxrWydwYWRkaW5nX2xlZnQnXTsKCQkJCSRjdXJyYmxrWydvdXRlcl9yaWdodF9tYXJnaW4nXSA9ICRwcmV2YmxrWydvdXRlcl9yaWdodF9tYXJnaW4nXSArICRjdXJyYmxrWydtYXJnaW5fcmlnaHQnXSArICRwcmV2YmxrWydib3JkZXJfcmlnaHQnXVsndyddICsgJHByZXZibGtbJ3BhZGRpbmdfcmlnaHQnXTsKCgkJCQkkY3VycmJsa1snd2lkdGgnXSA9ICR0aGlzLT5tcGRmLT5wZ3dpZHRoIC0gKCRjdXJyYmxrWydvdXRlcl9yaWdodF9tYXJnaW4nXSArICRjdXJyYmxrWydvdXRlcl9sZWZ0X21hcmdpbiddKTsKCQkJCSRjdXJyYmxrWydpbm5lcl93aWR0aCddID0gJGN1cnJibGtbJ3dpZHRoJ10gLSAoJGN1cnJibGtbJ2JvcmRlcl9sZWZ0J11bJ3cnXSArICRjdXJyYmxrWydwYWRkaW5nX2xlZnQnXSArICRjdXJyYmxrWydib3JkZXJfcmlnaHQnXVsndyddICsgJGN1cnJibGtbJ3BhZGRpbmdfcmlnaHQnXSk7CgoJCQkJLy8gQ2hlY2sgRElWIGlzIG5vdCBub3cgdG9vIG5hcnJvdyB0byBmaXQgdGV4dAoJCQkJJG13ID0gMiAqICR0aGlzLT5tcGRmLT5HZXRDaGFyV2lkdGgoJ1cnLCBmYWxzZSk7CgkJCQlpZiAoJGN1cnJibGtbJ2lubmVyX3dpZHRoJ10gPCAkbXcpIHsKCQkJCQkkY3VycmJsa1sncGFkZGluZ19sZWZ0J10gPSAwOwoJCQkJCSRjdXJyYmxrWydwYWRkaW5nX3JpZ2h0J10gPSAwOwoJCQkJCSRjdXJyYmxrWydib3JkZXJfbGVmdCddWyd3J10gPSAwLjI7CgkJCQkJJGN1cnJibGtbJ2JvcmRlcl9yaWdodCddWyd3J10gPSAwLjI7CgkJCQkJJGN1cnJibGtbJ21hcmdpbl9sZWZ0J10gPSAwOwoJCQkJCSRjdXJyYmxrWydtYXJnaW5fcmlnaHQnXSA9IDA7CgkJCQkJJGN1cnJibGtbJ291dGVyX2xlZnRfbWFyZ2luJ10gPSAkcHJldmJsa1snb3V0ZXJfbGVmdF9tYXJnaW4nXSArICRjdXJyYmxrWydtYXJnaW5fbGVmdCddICsgJHByZXZibGtbJ2JvcmRlcl9sZWZ0J11bJ3cnXSArICRwcmV2YmxrWydwYWRkaW5nX2xlZnQnXTsKCQkJCQkkY3VycmJsa1snb3V0ZXJfcmlnaHRfbWFyZ2luJ10gPSAkcHJldmJsa1snb3V0ZXJfcmlnaHRfbWFyZ2luJ10gKyAkY3VycmJsa1snbWFyZ2luX3JpZ2h0J10gKyAkcHJldmJsa1snYm9yZGVyX3JpZ2h0J11bJ3cnXSArICRwcmV2YmxrWydwYWRkaW5nX3JpZ2h0J107CgkJCQkJJGN1cnJibGtbJ3dpZHRoJ10gPSAkdGhpcy0+bXBkZi0+cGd3aWR0aCAtICgkY3VycmJsa1snb3V0ZXJfcmlnaHRfbWFyZ2luJ10gKyAkY3VycmJsa1snb3V0ZXJfbGVmdF9tYXJnaW4nXSk7CgkJCQkJJGN1cnJibGtbJ2lubmVyX3dpZHRoJ10gPSAkdGhpcy0+bXBkZi0+cGd3aWR0aCAtICgkY3VycmJsa1snb3V0ZXJfcmlnaHRfbWFyZ2luJ10gKyAkY3VycmJsa1snb3V0ZXJfbGVmdF9tYXJnaW4nXSArICRjdXJyYmxrWydib3JkZXJfbGVmdCddWyd3J10gKyAkY3VycmJsa1sncGFkZGluZ19sZWZ0J10gKyAkY3VycmJsa1snYm9yZGVyX3JpZ2h0J11bJ3cnXSArICRjdXJyYmxrWydwYWRkaW5nX3JpZ2h0J10pOwovLwkJaWYgKCRjdXJyYmxrWydpbm5lcl93aWR0aCddIDwgJG13KSB7IHRocm93IG5ldyBNcGRmRXhjZXB0aW9uKCJESVYgaXMgdG9vIG5hcnJvdyBmb3IgdGV4dCB0byBmaXQhIik7IH0KCQkJCX0KCgkJCQkkdGhpcy0+bXBkZi0+eCA9ICR0aGlzLT5tcGRmLT5sTWFyZ2luICsgJGN1cnJibGtbJ291dGVyX2xlZnRfbWFyZ2luJ107CgoJCQkJLyogLS0gQkFDS0dST1VORFMgLS0gKi8KCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snQkFDS0dST1VORC1JTUFHRSddKSAmJiAkcHJvcGVydGllc1snQkFDS0dST1VORC1JTUFHRSddICYmICEkdGhpcy0+bXBkZi0+a3d0ICYmICEkdGhpcy0+bXBkZi0+Q29sQWN0aXZlICYmICEkdGhpcy0+bXBkZi0+a2VlcF9ibG9ja190b2dldGhlcikgewoJCQkJCSRyZXQgPSAkdGhpcy0+bXBkZi0+U2V0QmFja2dyb3VuZCgkcHJvcGVydGllcywgJGN1cnJibGtbJ2lubmVyX3dpZHRoJ10pOwoJCQkJCWlmICgkcmV0KSB7CgkJCQkJCSRjdXJyYmxrWydiYWNrZ3JvdW5kLWltYWdlJ10gPSAkcmV0OwoJCQkJCX0KCQkJCX0KCQkJCS8qIC0tIEVORCBCQUNLR1JPVU5EUyAtLSAqLwoKCQkJCS8qIC0tIFRBQkxFUyAtLSAqLwoJCQkJaWYgKCR0aGlzLT5tcGRmLT51c2Vfa3d0ICYmIGlzc2V0KCRhdHRyWydLRUVQLVdJVEgtVEFCTEUnXSkgJiYgISR0aGlzLT5tcGRmLT5Db2xBY3RpdmUgJiYgISR0aGlzLT5tcGRmLT5rZWVwX2Jsb2NrX3RvZ2V0aGVyKSB7CgkJCQkJJHRoaXMtPm1wZGYtPmt3dCA9IHRydWU7CgkJCQkJJHRoaXMtPm1wZGYtPmt3dF95MCA9ICR0aGlzLT5tcGRmLT55OwoJCQkJCS8vJHRoaXMtPm1wZGYtPmt3dF94MCA9ICR0aGlzLT5tcGRmLT54OwoJCQkJCSR0aGlzLT5tcGRmLT5rd3RfeDAgPSAkdGhpcy0+bXBkZi0+bE1hcmdpbjsgLy8gbVBERiA2CgkJCQkJJHRoaXMtPm1wZGYtPmt3dF9oZWlnaHQgPSAwOwoJCQkJCSR0aGlzLT5tcGRmLT5rd3RfYnVmZmVyID0gYXJyYXkoKTsKCQkJCQkkdGhpcy0+bXBkZi0+a3d0X0xpbmtzID0gYXJyYXkoKTsKCQkJCQkkdGhpcy0+bXBkZi0+a3d0X0Fubm90cyA9IGFycmF5KCk7CgkJCQkJJHRoaXMtPm1wZGYtPmt3dF9tb3ZlZCA9IGZhbHNlOwoJCQkJCSR0aGlzLT5tcGRmLT5rd3Rfc2F2ZWQgPSBmYWxzZTsKCQkJCQkkdGhpcy0+bXBkZi0+a3d0X1JlZmVyZW5jZSA9IGFycmF5KCk7CgkJCQkJJHRoaXMtPm1wZGYtPmt3dF9CTW91dGxpbmVzID0gYXJyYXkoKTsKCQkJCQkkdGhpcy0+bXBkZi0+a3d0X3RvYyA9IGFycmF5KCk7CgkJCQl9IGVsc2UgewoJCQkJCS8qIC0tIEVORCBUQUJMRVMgLS0gKi8KCQkJCQkkdGhpcy0+bXBkZi0+a3d0ID0gZmFsc2U7CgkJCQl9IC8vICpUQUJMRVMqCgkJCQkvL1NhdmUgeCx5IGNvb3JkcyBpbiBjYXNlIHdlIG5lZWQgdG8gcHJpbnQgYm9yZGVycy4uLgoJCQkJJGN1cnJibGtbJ3kwJ10gPSAkdGhpcy0+bXBkZi0+eTsKCQkJCSRjdXJyYmxrWydpbml0aWFsX3kwJ10gPSAkdGhpcy0+bXBkZi0+eTsgLy8gbVBERiA2CgkJCQkkY3VycmJsa1sneDAnXSA9ICR0aGlzLT5tcGRmLT54OwoJCQkJJGN1cnJibGtbJ2luaXRpYWxfeDAnXSA9ICR0aGlzLT5tcGRmLT54OyAvLyBtUERGIDYKCQkJCSRjdXJyYmxrWydpbml0aWFsX3N0YXJ0cGFnZSddID0gJHRoaXMtPm1wZGYtPnBhZ2U7CgkJCQkkY3VycmJsa1snc3RhcnRwYWdlJ10gPSAkdGhpcy0+bXBkZi0+cGFnZTsgLy8gbVBERiA2CgkJCQkkdGhpcy0+bXBkZi0+b2xkeSA9ICR0aGlzLT5tcGRmLT55OwoKCQkJCSR0aGlzLT5tcGRmLT5sYXN0YmxvY2tsZXZlbGNoYW5nZSA9IDE7CgoKCQkJCS8vIG1QREYgNiAgTGlzdHMKCQkJCWlmICgkdGFnID09ICdPTCcgfHwgJHRhZyA9PSAnVUwnKSB7CgkJCQkJJHRoaXMtPm1wZGYtPmxpc3RsdmwrKzsKCQkJCQlpZiAoaXNzZXQoJGF0dHJbJ1NUQVJUJ10pICYmICRhdHRyWydTVEFSVCddKSB7CgkJCQkJCSR0aGlzLT5tcGRmLT5saXN0Y291bnRlclskdGhpcy0+bXBkZi0+bGlzdGx2bF0gPSBpbnR2YWwoJGF0dHJbJ1NUQVJUJ10pIC0gMTsKCQkJCQl9IGVsc2UgewoJCQkJCQkkdGhpcy0+bXBkZi0+bGlzdGNvdW50ZXJbJHRoaXMtPm1wZGYtPmxpc3RsdmxdID0gMDsKCQkJCQl9CgkJCQkJJHRoaXMtPm1wZGYtPmxpc3RpdGVtID0gYXJyYXkoKTsKCgkJCQkJLy8gTGlzdC10eXBlCgkJCQkJaWYgKCFpc3NldCgkY3VycmJsa1snbGlzdF9zdHlsZV90eXBlJ10pIHx8ICEkY3VycmJsa1snbGlzdF9zdHlsZV90eXBlJ10pIHsKCQkJCQkJaWYgKCR0YWcgPT0gJ09MJykKCQkJCQkJCSRjdXJyYmxrWydsaXN0X3N0eWxlX3R5cGUnXSA9ICdkZWNpbWFsJzsKCQkJCQkJZWxzZSBpZiAoJHRhZyA9PSAnVUwnKSB7CgkJCQkJCQlpZiAoJHRoaXMtPm1wZGYtPmxpc3RsdmwgJSAzID09IDEpCgkJCQkJCQkJJGN1cnJibGtbJ2xpc3Rfc3R5bGVfdHlwZSddID0gJ2Rpc2MnOwoJCQkJCQkJZWxzZWlmICgkdGhpcy0+bXBkZi0+bGlzdGx2bCAlIDMgPT0gMikKCQkJCQkJCQkkY3VycmJsa1snbGlzdF9zdHlsZV90eXBlJ10gPSAnY2lyY2xlJzsKCQkJCQkJCWVsc2UKCQkJCQkJCQkkY3VycmJsa1snbGlzdF9zdHlsZV90eXBlJ10gPSAnc3F1YXJlJzsKCQkJCQkJfQoJCQkJCX0KCgkJCQkJLy8gTGlzdC1pbWFnZQoJCQkJCWlmICghaXNzZXQoJGN1cnJibGtbJ2xpc3Rfc3R5bGVfaW1hZ2UnXSkgfHwgISRjdXJyYmxrWydsaXN0X3N0eWxlX2ltYWdlJ10pIHsKCQkJCQkJJGN1cnJibGtbJ2xpc3Rfc3R5bGVfaW1hZ2UnXSA9ICdub25lJzsKCQkJCQl9CgoJCQkJCS8vIExpc3QtcG9zaXRpb24KCQkJCQlpZiAoIWlzc2V0KCRjdXJyYmxrWydsaXN0X3N0eWxlX3Bvc2l0aW9uJ10pIHx8ICEkY3VycmJsa1snbGlzdF9zdHlsZV9wb3NpdGlvbiddKSB7CgkJCQkJCSRjdXJyYmxrWydsaXN0X3N0eWxlX3Bvc2l0aW9uJ10gPSAnb3V0c2lkZSc7CgkJCQkJfQoKCQkJCQkvLyBEZWZhdWx0IGluZGVudGF0aW9uIHVzaW5nIHBhZGRpbmcKCQkJCQlpZiAoc3RydG9sb3dlcigkdGhpcy0+bXBkZi0+bGlzdF9hdXRvX21vZGUpID09ICdtcGRmJyAmJiBpc3NldCgkY3VycmJsa1snbGlzdF9zdHlsZV9wb3NpdGlvbiddKSAmJiAkY3VycmJsa1snbGlzdF9zdHlsZV9wb3NpdGlvbiddID09ICdvdXRzaWRlJyAmJiBpc3NldCgkY3VycmJsa1snbGlzdF9zdHlsZV9pbWFnZSddKSAmJiAkY3VycmJsa1snbGlzdF9zdHlsZV9pbWFnZSddID09ICdub25lJyAmJiAoIWlzc2V0KCRjdXJyYmxrWydsaXN0X3N0eWxlX3R5cGUnXSkgfHwgIXByZWdfbWF0Y2goJy9VXCsoW2EtZkEtRjAtOV0rKS9pJywgJGN1cnJibGtbJ2xpc3Rfc3R5bGVfdHlwZSddKSkpIHsKCQkJCQkJJGF1dG9wYWRkaW5nID0gJHRoaXMtPm1wZGYtPl9nZXRMaXN0TWFya2VyV2lkdGgoJGN1cnJibGssICRhaHRtbCwgJGlodG1sKTsKCQkJCQkJaWYgKCR0aGlzLT5tcGRmLT5saXN0bHZsID4gMSB8fCAkdGhpcy0+bXBkZi0+bGlzdF9pbmRlbnRfZmlyc3RfbGV2ZWwpIHsKCQkJCQkJCSRhdXRvcGFkZGluZyArPSAkdGhpcy0+bXBkZi0+Q29udmVydFNpemUoJHRoaXMtPm1wZGYtPmxpc3RfaW5kZW50X2RlZmF1bHRfbXBkZiwgJGN1cnJibGtbJ2lubmVyX3dpZHRoJ10sICR0aGlzLT5tcGRmLT5Gb250U2l6ZSwgZmFsc2UpOwoJCQkJCQl9CgkJCQkJCS8vIGF1dG9wYWRkaW5nIHZhbHVlIGlzIGFwcGxpZWQgdG8gbGVmdCBvciByaWdodCBhY2NvcmRpbmcKCQkJCQkJLy8gdG8gZGlyIG9mIGJsb2NrLiBPbmNlIGEgQ1NTIHZhbHVlIGlzIHNldCBmb3IgcGFkZGluZyBpdCBvdmVycmlkZXMgdGhpcyBkZWZhdWx0IHZhbHVlLgoJCQkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ1BBRERJTkctUklHSFQnXSkgJiYgJHByb3BlcnRpZXNbJ1BBRERJTkctUklHSFQnXSA9PSAnYXV0bycgJiYgaXNzZXQoJGN1cnJibGtbJ2RpcmVjdGlvbiddKSAmJiAkY3VycmJsa1snZGlyZWN0aW9uJ10gPT0gJ3J0bCcpIHsKCQkJCQkJCSRjdXJyYmxrWydwYWRkaW5nX3JpZ2h0J10gPSAkYXV0b3BhZGRpbmc7CgkJCQkJCX0gZWxzZSBpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ1BBRERJTkctTEVGVCddKSAmJiAkcHJvcGVydGllc1snUEFERElORy1MRUZUJ10gPT0gJ2F1dG8nKSB7CgkJCQkJCQkkY3VycmJsa1sncGFkZGluZ19sZWZ0J10gPSAkYXV0b3BhZGRpbmc7CgkJCQkJCX0KCQkJCQl9IGVsc2UgewoJCQkJCQkvLyBJbml0aWFsIGRlZmF1bHQgdmFsdWUgaXMgc2V0IGJ5ICR0aGlzLT5tcGRmLT5saXN0X2luZGVudF9kZWZhdWx0IGluIGNvbmZpZy5waHA7IHRoaXMgdmFsdWUgaXMgYXBwbGllZCB0byBsZWZ0IG9yIHJpZ2h0IGFjY29yZGluZwoJCQkJCQkvLyB0byBkaXIgb2YgYmxvY2suIE9uY2UgYSBDU1MgdmFsdWUgaXMgc2V0IGZvciBwYWRkaW5nIGl0IG92ZXJyaWRlcyB0aGlzIGRlZmF1bHQgdmFsdWUuCgkJCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snUEFERElORy1SSUdIVCddKSAmJiAkcHJvcGVydGllc1snUEFERElORy1SSUdIVCddID09ICdhdXRvJyAmJiBpc3NldCgkY3VycmJsa1snZGlyZWN0aW9uJ10pICYmICRjdXJyYmxrWydkaXJlY3Rpb24nXSA9PSAncnRsJykgewoJCQkJCQkJJGN1cnJibGtbJ3BhZGRpbmdfcmlnaHQnXSA9ICR0aGlzLT5tcGRmLT5Db252ZXJ0U2l6ZSgkdGhpcy0+bXBkZi0+bGlzdF9pbmRlbnRfZGVmYXVsdCwgJGN1cnJibGtbJ2lubmVyX3dpZHRoJ10sICR0aGlzLT5tcGRmLT5Gb250U2l6ZSwgZmFsc2UpOwoJCQkJCQl9IGVsc2UgaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydQQURESU5HLUxFRlQnXSkgJiYgJHByb3BlcnRpZXNbJ1BBRERJTkctTEVGVCddID09ICdhdXRvJykgewoJCQkJCQkJJGN1cnJibGtbJ3BhZGRpbmdfbGVmdCddID0gJHRoaXMtPm1wZGYtPkNvbnZlcnRTaXplKCR0aGlzLT5tcGRmLT5saXN0X2luZGVudF9kZWZhdWx0LCAkY3VycmJsa1snaW5uZXJfd2lkdGgnXSwgJHRoaXMtPm1wZGYtPkZvbnRTaXplLCBmYWxzZSk7CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgoKCQkJCS8vIG1QREYgNiAgTGlzdHMKCQkJCWlmICgkdGFnID09ICdMSScpIHsKCQkJCQlpZiAoJHRoaXMtPm1wZGYtPmxpc3RsdmwgPT0gMCkgeyAvL2luIGNhc2Ugb2YgbWFsZm9ybWVkIEhUTUwgY29kZS4gRXhhbXBsZTooLi4uKTwvcD48bGk+Q29udGVudDwvbGk+PHA+UGFyYWdyYXBoMTwvcD4oLi4uKQoJCQkJCQkkdGhpcy0+bXBkZi0+bGlzdGx2bCsrOyAvLyBmaXJzdCBkZXB0aCBsZXZlbAoJCQkJCQkkdGhpcy0+bXBkZi0+bGlzdGNvdW50ZXJbJHRoaXMtPm1wZGYtPmxpc3RsdmxdID0gMDsKCQkJCQl9CgkJCQkJJHRoaXMtPm1wZGYtPmxpc3Rjb3VudGVyWyR0aGlzLT5tcGRmLT5saXN0bHZsXSArKzsKCQkJCQkkdGhpcy0+bXBkZi0+bGlzdGl0ZW0gPSBhcnJheSgpOwoKCQkJCQkvLyBMaXN0aXRlbS10eXBlCgkJCQkJJHRoaXMtPm1wZGYtPl9zZXRMaXN0TWFya2VyKCRjdXJyYmxrWydsaXN0X3N0eWxlX3R5cGUnXSwgJGN1cnJibGtbJ2xpc3Rfc3R5bGVfaW1hZ2UnXSwgJGN1cnJibGtbJ2xpc3Rfc3R5bGVfcG9zaXRpb24nXSk7CgkJCQl9CgoJCQkJLy8gbVBERiA2IEJpZGlyZWN0aW9uYWwgZm9ybWF0dGluZyBmb3IgYmxvY2sgZWxlbWVudHMKCQkJCSRiZGYgPSBmYWxzZTsKCQkJCSRiZGYyID0gJyc7CgkJCQkkcG9wZCA9ICcnOwoKCQkJCS8vIEdldCBjdXJyZW50IGRpcmVjdGlvbgoJCQkJaWYgKGlzc2V0KCRjdXJyYmxrWydkaXJlY3Rpb24nXSkpIHsKCQkJCQkkY3VycmRpciA9ICRjdXJyYmxrWydkaXJlY3Rpb24nXTsKCQkJCX0gZWxzZSB7CgkJCQkJJGN1cnJkaXIgPSAnbHRyJzsKCQkJCX0KCQkJCWlmIChpc3NldCgkYXR0clsnRElSJ10pIGFuZCAkYXR0clsnRElSJ10gIT0gJycpIHsKCQkJCQkkY3VycmRpciA9IHN0cnRvbG93ZXIoJGF0dHJbJ0RJUiddKTsKCQkJCX0KCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snRElSRUNUSU9OJ10pKSB7CgkJCQkJJGN1cnJkaXIgPSBzdHJ0b2xvd2VyKCRwcm9wZXJ0aWVzWydESVJFQ1RJT04nXSk7CgkJCQl9CgoJCQkJLy8gbVBERiA2IGJpZGkKCQkJCS8vIGNmLiBodHRwOi8vd3d3LnczLm9yZy9UUi9jc3MzLXdyaXRpbmctbW9kZXMvI3VuaWNvZGUtYmlkaQoJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzIFsnVU5JQ09ERS1CSURJJ10pICYmIChzdHJ0b2xvd2VyKCRwcm9wZXJ0aWVzIFsnVU5JQ09ERS1CSURJJ10pID09ICdiaWRpLW92ZXJyaWRlJyB8fCBzdHJ0b2xvd2VyKCRwcm9wZXJ0aWVzIFsnVU5JQ09ERS1CSURJJ10pID09ICdpc29sYXRlLW92ZXJyaWRlJykpIHsKCQkJCQlpZiAoJGN1cnJkaXIgPT0gJ3J0bCcpIHsKCQkJCQkJJGJkZiA9IDB4MjAyRTsKCQkJCQkJJHBvcGQgPSAnUkxPUERGJzsKCQkJCQl9IC8vIFUrMjAyRSBSTE8KCQkJCQllbHNlIHsKCQkJCQkJJGJkZiA9IDB4MjAyRDsKCQkJCQkJJHBvcGQgPSAnTFJPUERGJzsKCQkJCQl9IC8vIFUrMjAyRCBMUk8KCQkJCX0gZWxzZSBpZiAoaXNzZXQoJHByb3BlcnRpZXMgWydVTklDT0RFLUJJREknXSkgJiYgc3RydG9sb3dlcigkcHJvcGVydGllcyBbJ1VOSUNPREUtQklESSddKSA9PSAncGxhaW50ZXh0JykgewoJCQkJCSRiZGYgPSAweDIwNjg7CgkJCQkJJHBvcGQgPSAnRlNJUERJJzsgLy8gVSsyMDY4IEZTSQoJCQkJfQoJCQkJaWYgKCRiZGYpIHsKCQkJCQlpZiAoJGJkZjIpIHsKCQkJCQkJJGJkZjIgPSBjb2RlMnV0ZigkYmRmKTsKCQkJCQl9CgkJCQkJJHRoaXMtPm1wZGYtPk9UTGRhdGEgPSBhcnJheSgpOwoJCQkJCWlmICgkdGhpcy0+bXBkZi0+dGFibGVMZXZlbCkgewoJCQkJCQkkdGhpcy0+bXBkZi0+X3NhdmVDZWxsVGV4dEJ1ZmZlcihjb2RlMnV0ZigkYmRmKSAuICRiZGYyKTsKCQkJCQl9IGVsc2UgewoJCQkJCQkkdGhpcy0+bXBkZi0+X3NhdmVUZXh0QnVmZmVyKGNvZGUydXRmKCRiZGYpIC4gJGJkZjIpOwoJCQkJCX0KCQkJCQkkdGhpcy0+bXBkZi0+YmlEaXJlY3Rpb25hbCA9IHRydWU7CgkJCQkJJGN1cnJibGtbJ2JpZGljb2RlJ10gPSAkcG9wZDsKCQkJCX0KCgkJCQlicmVhazsKCgkJCWNhc2UgJ0hSJzoKCQkJCS8vIEFkZGVkIG1QREYgMy4wIEZsb2F0IERJViAtIENMRUFSCgkJCQlpZiAoaXNzZXQoJGF0dHJbJ1NUWUxFJ10pKSB7CgkJCQkJJHByb3BlcnRpZXMgPSAkdGhpcy0+bXBkZi0+Y3NzbWdyLT5yZWFkSW5saW5lQ1NTKCRhdHRyWydTVFlMRSddKTsKCQkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ0NMRUFSJ10pKSB7CgkJCQkJCSR0aGlzLT5tcGRmLT5DbGVhckZsb2F0cyhzdHJ0b3VwcGVyKCRwcm9wZXJ0aWVzWydDTEVBUiddKSwgJHRoaXMtPm1wZGYtPmJsa2x2bCk7CgkJCQkJfSAvLyAqQ1NTLUZMT0FUKgoJCQkJfQoKCQkJCSR0aGlzLT5tcGRmLT5pZ25vcmVmb2xsb3dpbmdzcGFjZXMgPSB0cnVlOwoKCQkJCSRvYmphdHRyID0gYXJyYXkoKTsKCQkJCSRvYmphdHRyWydtYXJnaW5fdG9wJ10gPSAwOwoJCQkJJG9iamF0dHJbJ21hcmdpbl9ib3R0b20nXSA9IDA7CgkJCQkkb2JqYXR0clsnbWFyZ2luX2xlZnQnXSA9IDA7CgkJCQkkb2JqYXR0clsnbWFyZ2luX3JpZ2h0J10gPSAwOwoJCQkJJG9iamF0dHJbJ3dpZHRoJ10gPSAwOwoJCQkJJG9iamF0dHJbJ2hlaWdodCddID0gMDsKCQkJCSRvYmphdHRyWydib3JkZXJfdG9wJ11bJ3cnXSA9IDA7CgkJCQkkb2JqYXR0clsnYm9yZGVyX2JvdHRvbSddWyd3J10gPSAwOwoJCQkJJG9iamF0dHJbJ2JvcmRlcl9sZWZ0J11bJ3cnXSA9IDA7CgkJCQkkb2JqYXR0clsnYm9yZGVyX3JpZ2h0J11bJ3cnXSA9IDA7CgkJCQkkcHJvcGVydGllcyA9ICR0aGlzLT5tcGRmLT5jc3NtZ3ItPk1lcmdlQ1NTKCcnLCAkdGFnLCAkYXR0cik7CgkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ01BUkdJTi1UT1AnXSkpIHsKCQkJCQkkb2JqYXR0clsnbWFyZ2luX3RvcCddID0gJHRoaXMtPm1wZGYtPkNvbnZlcnRTaXplKCRwcm9wZXJ0aWVzWydNQVJHSU4tVE9QJ10sICR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ2lubmVyX3dpZHRoJ10sICR0aGlzLT5tcGRmLT5Gb250U2l6ZSwgZmFsc2UpOwoJCQkJfQoJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydNQVJHSU4tQk9UVE9NJ10pKSB7CgkJCQkJJG9iamF0dHJbJ21hcmdpbl9ib3R0b20nXSA9ICR0aGlzLT5tcGRmLT5Db252ZXJ0U2l6ZSgkcHJvcGVydGllc1snTUFSR0lOLUJPVFRPTSddLCAkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWydpbm5lcl93aWR0aCddLCAkdGhpcy0+bXBkZi0+Rm9udFNpemUsIGZhbHNlKTsKCQkJCX0KCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snV0lEVEgnXSkpIHsKCQkJCQkkb2JqYXR0clsnd2lkdGgnXSA9ICR0aGlzLT5tcGRmLT5Db252ZXJ0U2l6ZSgkcHJvcGVydGllc1snV0lEVEgnXSwgJHRoaXMtPm1wZGYtPmJsa1skdGhpcy0+bXBkZi0+YmxrbHZsXVsnaW5uZXJfd2lkdGgnXSk7CgkJCQl9IGVsc2UgaWYgKGlzc2V0KCRhdHRyWydXSURUSCddKSAmJiAkYXR0clsnV0lEVEgnXSAhPSAnJykKCQkJCQkkb2JqYXR0clsnd2lkdGgnXSA9ICR0aGlzLT5tcGRmLT5Db252ZXJ0U2l6ZSgkYXR0clsnV0lEVEgnXSwgJHRoaXMtPm1wZGYtPmJsa1skdGhpcy0+bXBkZi0+YmxrbHZsXVsnaW5uZXJfd2lkdGgnXSk7CgkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ1RFWFQtQUxJR04nXSkpIHsKCQkJCQkkb2JqYXR0clsnYWxpZ24nXSA9ICRhbGlnbltzdHJ0b2xvd2VyKCRwcm9wZXJ0aWVzWydURVhULUFMSUdOJ10pXTsKCQkJCX0gZWxzZSBpZiAoaXNzZXQoJGF0dHJbJ0FMSUdOJ10pICYmICRhdHRyWydBTElHTiddICE9ICcnKQoJCQkJCSRvYmphdHRyWydhbGlnbiddID0gJGFsaWduW3N0cnRvbG93ZXIoJGF0dHJbJ0FMSUdOJ10pXTsKCgkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ01BUkdJTi1MRUZUJ10pICYmIHN0cnRvbG93ZXIoJHByb3BlcnRpZXNbJ01BUkdJTi1MRUZUJ10pID09ICdhdXRvJykgewoJCQkJCSRvYmphdHRyWydhbGlnbiddID0gJ1InOwoJCQkJfQoJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydNQVJHSU4tUklHSFQnXSkgJiYgc3RydG9sb3dlcigkcHJvcGVydGllc1snTUFSR0lOLVJJR0hUJ10pID09ICdhdXRvJykgewoJCQkJCSRvYmphdHRyWydhbGlnbiddID0gJ0wnOwoJCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snTUFSR0lOLVJJR0hUJ10pICYmIHN0cnRvbG93ZXIoJHByb3BlcnRpZXNbJ01BUkdJTi1SSUdIVCddKSA9PSAnYXV0bycgJiYgaXNzZXQoJHByb3BlcnRpZXNbJ01BUkdJTi1MRUZUJ10pICYmIHN0cnRvbG93ZXIoJHByb3BlcnRpZXNbJ01BUkdJTi1MRUZUJ10pID09ICdhdXRvJykgewoJCQkJCQkkb2JqYXR0clsnYWxpZ24nXSA9ICdDJzsKCQkJCQl9CgkJCQl9CgkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ0NPTE9SJ10pKSB7CgkJCQkJJG9iamF0dHJbJ2NvbG9yJ10gPSAkdGhpcy0+bXBkZi0+Q29udmVydENvbG9yKCRwcm9wZXJ0aWVzWydDT0xPUiddKTsKCQkJCX0gZWxzZSBpZiAoaXNzZXQoJGF0dHJbJ0NPTE9SJ10pICYmICRhdHRyWydDT0xPUiddICE9ICcnKQoJCQkJCSRvYmphdHRyWydjb2xvciddID0gJHRoaXMtPm1wZGYtPkNvbnZlcnRDb2xvcigkYXR0clsnQ09MT1InXSk7CgkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ0hFSUdIVCddKSkgewoJCQkJCSRvYmphdHRyWydsaW5ld2lkdGgnXSA9ICR0aGlzLT5tcGRmLT5Db252ZXJ0U2l6ZSgkcHJvcGVydGllc1snSEVJR0hUJ10sICR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ2lubmVyX3dpZHRoJ10sICR0aGlzLT5tcGRmLT5Gb250U2l6ZSwgZmFsc2UpOwoJCQkJfQoKCgkJCQkvKiAtLSBUQUJMRVMgLS0gKi8KCQkJCWlmICgkdGhpcy0+bXBkZi0+dGFibGVMZXZlbCkgewoJCQkJCSRvYmphdHRyWydXLVBFUkNFTlQnXSA9IDEwMDsKCQkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ1dJRFRIJ10pICYmIHN0cmlzdHIoJHByb3BlcnRpZXNbJ1dJRFRIJ10sICclJykpIHsKCQkJCQkJJHByb3BlcnRpZXNbJ1dJRFRIJ10gKz0gMDsgIC8vbWFrZSAiOTAlIiBiZWNvbWUgc2ltcGx5ICI5MCIKCQkJCQkJJG9iamF0dHJbJ1ctUEVSQ0VOVCddID0gJHByb3BlcnRpZXNbJ1dJRFRIJ107CgkJCQkJfQoJCQkJCWlmIChpc3NldCgkYXR0clsnV0lEVEgnXSkgJiYgc3RyaXN0cigkYXR0clsnV0lEVEgnXSwgJyUnKSkgewoJCQkJCQkkYXR0clsnV0lEVEgnXSArPSAwOyAgLy9tYWtlICI5MCUiIGJlY29tZSBzaW1wbHkgIjkwIgoJCQkJCQkkb2JqYXR0clsnVy1QRVJDRU5UJ10gPSAkYXR0clsnV0lEVEgnXTsKCQkJCQl9CgkJCQl9CgkJCQkvKiAtLSBFTkQgVEFCTEVTIC0tICovCgoJCQkJJG9iamF0dHJbJ3R5cGUnXSA9ICdocic7CgkJCQkkb2JqYXR0clsnaGVpZ2h0J10gPSAkb2JqYXR0clsnbGluZXdpZHRoJ10gKyAkb2JqYXR0clsnbWFyZ2luX3RvcCddICsgJG9iamF0dHJbJ21hcmdpbl9ib3R0b20nXTsKCQkJCSRlID0gIlx4YmJceGE0XHhhY3R5cGU9aW1hZ2Usb2JqYXR0cj0iIC4gc2VyaWFsaXplKCRvYmphdHRyKSAuICJceGJiXHhhNFx4YWMiOwoKCQkJCS8vIENsZWFyIHByb3BlcnRpZXMgLSB0aWR5IHVwCgkJCQkkcHJvcGVydGllcyA9IGFycmF5KCk7CgoJCQkJLyogLS0gVEFCTEVTIC0tICovCgkJCQkvLyBPdXRwdXQgaXQgdG8gYnVmZmVycwoJCQkJaWYgKCR0aGlzLT5tcGRmLT50YWJsZUxldmVsKSB7CgkJCQkJaWYgKCFpc3NldCgkdGhpcy0+bXBkZi0+Y2VsbFskdGhpcy0+bXBkZi0+cm93XVskdGhpcy0+bXBkZi0+Y29sXVsnbWF4cyddKSkgewoJCQkJCQkkdGhpcy0+bXBkZi0+Y2VsbFskdGhpcy0+bXBkZi0+cm93XVskdGhpcy0+bXBkZi0+Y29sXVsnbWF4cyddID0gJHRoaXMtPm1wZGYtPmNlbGxbJHRoaXMtPm1wZGYtPnJvd11bJHRoaXMtPm1wZGYtPmNvbF1bJ3MnXTsKCQkJCQl9IGVsc2VpZiAoJHRoaXMtPm1wZGYtPmNlbGxbJHRoaXMtPm1wZGYtPnJvd11bJHRoaXMtPm1wZGYtPmNvbF1bJ21heHMnXSA8ICR0aGlzLT5tcGRmLT5jZWxsWyR0aGlzLT5tcGRmLT5yb3ddWyR0aGlzLT5tcGRmLT5jb2xdWydzJ10pIHsKCQkJCQkJJHRoaXMtPm1wZGYtPmNlbGxbJHRoaXMtPm1wZGYtPnJvd11bJHRoaXMtPm1wZGYtPmNvbF1bJ21heHMnXSA9ICR0aGlzLT5tcGRmLT5jZWxsWyR0aGlzLT5tcGRmLT5yb3ddWyR0aGlzLT5tcGRmLT5jb2xdWydzJ107CgkJCQkJfQoJCQkJCSR0aGlzLT5tcGRmLT5jZWxsWyR0aGlzLT5tcGRmLT5yb3ddWyR0aGlzLT5tcGRmLT5jb2xdWydzJ10gPSAwOyAvLyByZXNldAoJCQkJCSR0aGlzLT5tcGRmLT5fc2F2ZUNlbGxUZXh0QnVmZmVyKCRlLCAkdGhpcy0+bXBkZi0+SFJFRik7CgkJCQl9IGVsc2UgewoJCQkJCS8qIC0tIEVORCBUQUJMRVMgLS0gKi8KCQkJCQkkdGhpcy0+bXBkZi0+X3NhdmVUZXh0QnVmZmVyKCRlLCAkdGhpcy0+bXBkZi0+SFJFRik7CgkJCQl9IC8vICpUQUJMRVMqCgoJCQkJYnJlYWs7CgoKCQkJLyogLS0gQkFSQ09ERVMgLS0gKi8KCgkJCWNhc2UgJ0JBUkNPREUnOgoJCQkJJHRoaXMtPm1wZGYtPmlnbm9yZWZvbGxvd2luZ3NwYWNlcyA9IGZhbHNlOwoJCQkJaWYgKGlzc2V0KCRhdHRyWydDT0RFJ10pICYmICRhdHRyWydDT0RFJ10pIHsKCQkJCQkkb2JqYXR0ciA9IGFycmF5KCk7CgkJCQkJJG9iamF0dHJbJ21hcmdpbl90b3AnXSA9IDA7CgkJCQkJJG9iamF0dHJbJ21hcmdpbl9ib3R0b20nXSA9IDA7CgkJCQkJJG9iamF0dHJbJ21hcmdpbl9sZWZ0J10gPSAwOwoJCQkJCSRvYmphdHRyWydtYXJnaW5fcmlnaHQnXSA9IDA7CgkJCQkJJG9iamF0dHJbJ3BhZGRpbmdfdG9wJ10gPSAwOwoJCQkJCSRvYmphdHRyWydwYWRkaW5nX2JvdHRvbSddID0gMDsKCQkJCQkkb2JqYXR0clsncGFkZGluZ19sZWZ0J10gPSAwOwoJCQkJCSRvYmphdHRyWydwYWRkaW5nX3JpZ2h0J10gPSAwOwoJCQkJCSRvYmphdHRyWyd3aWR0aCddID0gMDsKCQkJCQkkb2JqYXR0clsnaGVpZ2h0J10gPSAwOwoJCQkJCSRvYmphdHRyWydib3JkZXJfdG9wJ11bJ3cnXSA9IDA7CgkJCQkJJG9iamF0dHJbJ2JvcmRlcl9ib3R0b20nXVsndyddID0gMDsKCQkJCQkkb2JqYXR0clsnYm9yZGVyX2xlZnQnXVsndyddID0gMDsKCQkJCQkkb2JqYXR0clsnYm9yZGVyX3JpZ2h0J11bJ3cnXSA9IDA7CgkJCQkJJG9iamF0dHJbJ2NvZGUnXSA9ICRhdHRyWydDT0RFJ107CgoJCQkJCWlmIChpc3NldCgkYXR0clsnVFlQRSddKSkgewoJCQkJCQkkb2JqYXR0clsnYnR5cGUnXSA9IHRyaW0oc3RydG91cHBlcigkYXR0clsnVFlQRSddKSk7CgkJCQkJfSBlbHNlIHsKCQkJCQkJJG9iamF0dHJbJ2J0eXBlJ10gPSAnRUFOMTMnOwoJCQkJCX0gLy8gZGVmYXVsdAoJCQkJCWlmIChwcmVnX21hdGNoKCcvXihFQU4xM3xJU0JOfElTU058RUFOOHxVUENBfFVQQ0UpUChbMjVdKSQvJywgJG9iamF0dHJbJ2J0eXBlJ10sICRtKSkgewoJCQkJCQkkb2JqYXR0clsnYnR5cGUnXSA9ICRtWzFdOwoJCQkJCQkkb2JqYXR0clsnYnN1cHAnXSA9ICRtWzJdOwoJCQkJCQlpZiAocHJlZ19tYXRjaCgnL14oXFMrKVxzKyguKikkLycsICRvYmphdHRyWydjb2RlJ10sICRtbSkpIHsKCQkJCQkJCSRvYmphdHRyWydjb2RlJ10gPSAkbW1bMV07CgkJCQkJCQkkb2JqYXR0clsnYnN1cHBfY29kZSddID0gJG1tWzJdOwoJCQkJCQl9CgkJCQkJfSBlbHNlIHsKCQkJCQkJJG9iamF0dHJbJ2JzdXBwJ10gPSAwOwoJCQkJCX0KCgkJCQkJaWYgKGlzc2V0KCRhdHRyWydURVhUJ10pICYmICRhdHRyWydURVhUJ10gPT0gMSkgewoJCQkJCQkkb2JqYXR0clsnc2hvd3RleHQnXSA9IDE7CgkJCQkJfSBlbHNlIHsKCQkJCQkJJG9iamF0dHJbJ3Nob3d0ZXh0J10gPSAwOwoJCQkJCX0KCQkJCQlpZiAoaXNzZXQoJGF0dHJbJ1NJWkUnXSkgJiYgJGF0dHJbJ1NJWkUnXSA+IDApIHsKCQkJCQkJJG9iamF0dHJbJ2JzaXplJ10gPSAkYXR0clsnU0laRSddOwoJCQkJCX0gZWxzZSB7CgkJCQkJCSRvYmphdHRyWydic2l6ZSddID0gMTsKCQkJCQl9CgkJCQkJaWYgKGlzc2V0KCRhdHRyWydIRUlHSFQnXSkgJiYgJGF0dHJbJ0hFSUdIVCddID4gMCkgewoJCQkJCQkkb2JqYXR0clsnYmhlaWdodCddID0gJGF0dHJbJ0hFSUdIVCddOwoJCQkJCX0gZWxzZSB7CgkJCQkJCSRvYmphdHRyWydiaGVpZ2h0J10gPSAxOwoJCQkJCX0KCQkJCQlpZiAoaXNzZXQoJGF0dHJbJ1BSJ10pICYmICRhdHRyWydQUiddID4gMCkgewoJCQkJCQkkb2JqYXR0clsncHJfcmF0aW8nXSA9ICRhdHRyWydQUiddOwoJCQkJCX0gZWxzZSB7CgkJCQkJCSRvYmphdHRyWydwcl9yYXRpbyddID0gJyc7CgkJCQkJfQoJCQkJCSRwcm9wZXJ0aWVzID0gJHRoaXMtPm1wZGYtPmNzc21nci0+TWVyZ2VDU1MoJycsICR0YWcsICRhdHRyKTsKCQkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXMgWydESVNQTEFZJ10pICYmIHN0cnRvbG93ZXIoJHByb3BlcnRpZXMgWydESVNQTEFZJ10pID09ICdub25lJykgewoJCQkJCQlyZXR1cm47CgkJCQkJfQoJCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snTUFSR0lOLVRPUCddKSkgewoJCQkJCQkkb2JqYXR0clsnbWFyZ2luX3RvcCddID0gJHRoaXMtPm1wZGYtPkNvbnZlcnRTaXplKCRwcm9wZXJ0aWVzWydNQVJHSU4tVE9QJ10sICR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ2lubmVyX3dpZHRoJ10sICR0aGlzLT5tcGRmLT5Gb250U2l6ZSwgZmFsc2UpOwoJCQkJCX0KCQkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ01BUkdJTi1CT1RUT00nXSkpIHsKCQkJCQkJJG9iamF0dHJbJ21hcmdpbl9ib3R0b20nXSA9ICR0aGlzLT5tcGRmLT5Db252ZXJ0U2l6ZSgkcHJvcGVydGllc1snTUFSR0lOLUJPVFRPTSddLCAkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWydpbm5lcl93aWR0aCddLCAkdGhpcy0+bXBkZi0+Rm9udFNpemUsIGZhbHNlKTsKCQkJCQl9CgkJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydNQVJHSU4tTEVGVCddKSkgewoJCQkJCQkkb2JqYXR0clsnbWFyZ2luX2xlZnQnXSA9ICR0aGlzLT5tcGRmLT5Db252ZXJ0U2l6ZSgkcHJvcGVydGllc1snTUFSR0lOLUxFRlQnXSwgJHRoaXMtPm1wZGYtPmJsa1skdGhpcy0+bXBkZi0+YmxrbHZsXVsnaW5uZXJfd2lkdGgnXSwgJHRoaXMtPm1wZGYtPkZvbnRTaXplLCBmYWxzZSk7CgkJCQkJfQoJCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snTUFSR0lOLVJJR0hUJ10pKSB7CgkJCQkJCSRvYmphdHRyWydtYXJnaW5fcmlnaHQnXSA9ICR0aGlzLT5tcGRmLT5Db252ZXJ0U2l6ZSgkcHJvcGVydGllc1snTUFSR0lOLVJJR0hUJ10sICR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ2lubmVyX3dpZHRoJ10sICR0aGlzLT5tcGRmLT5Gb250U2l6ZSwgZmFsc2UpOwoJCQkJCX0KCgkJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydQQURESU5HLVRPUCddKSkgewoJCQkJCQkkb2JqYXR0clsncGFkZGluZ190b3AnXSA9ICR0aGlzLT5tcGRmLT5Db252ZXJ0U2l6ZSgkcHJvcGVydGllc1snUEFERElORy1UT1AnXSwgJHRoaXMtPm1wZGYtPmJsa1skdGhpcy0+bXBkZi0+YmxrbHZsXVsnaW5uZXJfd2lkdGgnXSwgJHRoaXMtPm1wZGYtPkZvbnRTaXplLCBmYWxzZSk7CgkJCQkJfQoJCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snUEFERElORy1CT1RUT00nXSkpIHsKCQkJCQkJJG9iamF0dHJbJ3BhZGRpbmdfYm90dG9tJ10gPSAkdGhpcy0+bXBkZi0+Q29udmVydFNpemUoJHByb3BlcnRpZXNbJ1BBRERJTkctQk9UVE9NJ10sICR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ2lubmVyX3dpZHRoJ10sICR0aGlzLT5tcGRmLT5Gb250U2l6ZSwgZmFsc2UpOwoJCQkJCX0KCQkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ1BBRERJTkctTEVGVCddKSkgewoJCQkJCQkkb2JqYXR0clsncGFkZGluZ19sZWZ0J10gPSAkdGhpcy0+bXBkZi0+Q29udmVydFNpemUoJHByb3BlcnRpZXNbJ1BBRERJTkctTEVGVCddLCAkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWydpbm5lcl93aWR0aCddLCAkdGhpcy0+bXBkZi0+Rm9udFNpemUsIGZhbHNlKTsKCQkJCQl9CgkJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydQQURESU5HLVJJR0hUJ10pKSB7CgkJCQkJCSRvYmphdHRyWydwYWRkaW5nX3JpZ2h0J10gPSAkdGhpcy0+bXBkZi0+Q29udmVydFNpemUoJHByb3BlcnRpZXNbJ1BBRERJTkctUklHSFQnXSwgJHRoaXMtPm1wZGYtPmJsa1skdGhpcy0+bXBkZi0+YmxrbHZsXVsnaW5uZXJfd2lkdGgnXSwgJHRoaXMtPm1wZGYtPkZvbnRTaXplLCBmYWxzZSk7CgkJCQkJfQoKCQkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ0JPUkRFUi1UT1AnXSkpIHsKCQkJCQkJJG9iamF0dHJbJ2JvcmRlcl90b3AnXSA9ICR0aGlzLT5tcGRmLT5ib3JkZXJfZGV0YWlscygkcHJvcGVydGllc1snQk9SREVSLVRPUCddKTsKCQkJCQl9CgkJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydCT1JERVItQk9UVE9NJ10pKSB7CgkJCQkJCSRvYmphdHRyWydib3JkZXJfYm90dG9tJ10gPSAkdGhpcy0+bXBkZi0+Ym9yZGVyX2RldGFpbHMoJHByb3BlcnRpZXNbJ0JPUkRFUi1CT1RUT00nXSk7CgkJCQkJfQoJCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snQk9SREVSLUxFRlQnXSkpIHsKCQkJCQkJJG9iamF0dHJbJ2JvcmRlcl9sZWZ0J10gPSAkdGhpcy0+bXBkZi0+Ym9yZGVyX2RldGFpbHMoJHByb3BlcnRpZXNbJ0JPUkRFUi1MRUZUJ10pOwoJCQkJCX0KCQkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ0JPUkRFUi1SSUdIVCddKSkgewoJCQkJCQkkb2JqYXR0clsnYm9yZGVyX3JpZ2h0J10gPSAkdGhpcy0+bXBkZi0+Ym9yZGVyX2RldGFpbHMoJHByb3BlcnRpZXNbJ0JPUkRFUi1SSUdIVCddKTsKCQkJCQl9CgoJCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snVkVSVElDQUwtQUxJR04nXSkpIHsKCQkJCQkJJG9iamF0dHJbJ3ZlcnRpY2FsLWFsaWduJ10gPSAkYWxpZ25bc3RydG9sb3dlcigkcHJvcGVydGllc1snVkVSVElDQUwtQUxJR04nXSldOwoJCQkJCX0KCQkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ0NPTE9SJ10pICYmICRwcm9wZXJ0aWVzWydDT0xPUiddICE9ICcnKSB7CgkJCQkJCSRvYmphdHRyWydjb2xvciddID0gJHRoaXMtPm1wZGYtPkNvbnZlcnRDb2xvcigkcHJvcGVydGllc1snQ09MT1InXSk7CgkJCQkJfSBlbHNlIHsKCQkJCQkJJG9iamF0dHJbJ2NvbG9yJ10gPSBmYWxzZTsKCQkJCQl9CgkJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydCQUNLR1JPVU5ELUNPTE9SJ10pICYmICRwcm9wZXJ0aWVzWydCQUNLR1JPVU5ELUNPTE9SJ10gIT0gJycpIHsKCQkJCQkJJG9iamF0dHJbJ2JnY29sb3InXSA9ICR0aGlzLT5tcGRmLT5Db252ZXJ0Q29sb3IoJHByb3BlcnRpZXNbJ0JBQ0tHUk9VTkQtQ09MT1InXSk7CgkJCQkJfSBlbHNlIHsKCQkJCQkJJG9iamF0dHJbJ2JnY29sb3InXSA9IGZhbHNlOwoJCQkJCX0KCgkJCQkJaWYgKCFjbGFzc19leGlzdHMoJ1BERkJhcmNvZGUnLCBmYWxzZSkpIHsKCQkJCQkJaW5jbHVkZShfTVBERl9QQVRIIC4gJ2NsYXNzZXMvYmFyY29kZS5waHAnKTsKCQkJCQl9CgkJCQkJJHRoaXMtPm1wZGYtPmJhcmNvZGUgPSBuZXcgUERGQmFyY29kZSgpOwoKCQkJCQlpZiAoJG9iamF0dHJbJ2J0eXBlJ10gPT0gJ0VBTjEzJyB8fCAkb2JqYXR0clsnYnR5cGUnXSA9PSAnSVNCTicgfHwgJG9iamF0dHJbJ2J0eXBlJ10gPT0gJ0lTU04nIHx8ICRvYmphdHRyWydidHlwZSddID09ICdVUENBJyB8fCAkb2JqYXR0clsnYnR5cGUnXSA9PSAnVVBDRScgfHwgJG9iamF0dHJbJ2J0eXBlJ10gPT0gJ0VBTjgnKSB7CgkJCQkJCSRjb2RlID0gcHJlZ19yZXBsYWNlKCcvXC0vJywgJycsICRvYmphdHRyWydjb2RlJ10pOwoJCQkJCQlpZiAoJG9iamF0dHJbJ2J0eXBlJ10gPT0gJ0lTU04nIHx8ICRvYmphdHRyWydidHlwZSddID09ICdJU0JOJykgewoJCQkJCQkJJGFycmNvZGUgPSAkdGhpcy0+bXBkZi0+YmFyY29kZS0+Z2V0QmFyY29kZUFycmF5KCRjb2RlLCAnRUFOMTMnKTsKCQkJCQkJfSBlbHNlIHsKCQkJCQkJCSRhcnJjb2RlID0gJHRoaXMtPm1wZGYtPmJhcmNvZGUtPmdldEJhcmNvZGVBcnJheSgkY29kZSwgJG9iamF0dHJbJ2J0eXBlJ10pOwoJCQkJCQl9CgkJCQkJCWlmICgkYXJyY29kZSA9PT0gZmFsc2UpIHsKCQkJCQkJCXRocm93IG5ldyBNcGRmRXhjZXB0aW9uKCdFcnJvciBpbiBiYXJjb2RlIHN0cmluZy4nKTsKCQkJCQkJfQoKCQkJCQkJaWYgKCRvYmphdHRyWydic3VwcCddID09IDIgfHwgJG9iamF0dHJbJ2JzdXBwJ10gPT0gNSkgeyAvLyBFQU4tMiBvciAtNSBTdXBwbGVtZW50CgkJCQkJCQkkc3VwcGFycmNvZGUgPSAkdGhpcy0+bXBkZi0+YmFyY29kZS0+Z2V0QmFyY29kZUFycmF5KCRvYmphdHRyWydic3VwcF9jb2RlJ10sICdFQU4nIC4gJG9iamF0dHJbJ2JzdXBwJ10pOwoJCQkJCQkJJHcgPSAoJGFycmNvZGVbIm1heHciXSArICRhcnJjb2RlWydsaWdodG1MJ10gKyAkYXJyY29kZVsnbGlnaHRtUiddICsgJHN1cHBhcnJjb2RlWyJtYXh3Il0gKyAkc3VwcGFycmNvZGVbJ3NlcE0nXSkgKiAkYXJyY29kZVsnbm9tLVgnXSAqICRvYmphdHRyWydic2l6ZSddOwoJCQkJCQl9IGVsc2UgewoJCQkJCQkJJHcgPSAoJGFycmNvZGVbIm1heHciXSArICRhcnJjb2RlWydsaWdodG1MJ10gKyAkYXJyY29kZVsnbGlnaHRtUiddKSAqICRhcnJjb2RlWydub20tWCddICogJG9iamF0dHJbJ2JzaXplJ107CgkJCQkJCX0KCQkJCQkJJGggPSAkYXJyY29kZVsnbm9tLUgnXSAqICRvYmphdHRyWydic2l6ZSddICogJG9iamF0dHJbJ2JoZWlnaHQnXTsKCQkJCQkJLy8gQWRkIGhlaWdodCBmb3IgSVNCTiBzdHJpbmcgKyBtYXJnaW4gZnJvbSB0b3Agb2YgYmFycwoJCQkJCQlpZiAoKCRvYmphdHRyWydzaG93dGV4dCddICYmICRvYmphdHRyWydidHlwZSddID09ICdFQU4xMycpIHx8ICRvYmphdHRyWydidHlwZSddID09ICdJU0JOJyB8fCAkb2JqYXR0clsnYnR5cGUnXSA9PSAnSVNTTicpIHsKCQkJCQkJCSR0aXNibm0gPSAxLjUgKiAkb2JqYXR0clsnYnNpemUnXTsgLy8gVG9wIG1hcmdpbiBiZXR3ZWVuIFRPUCBURVhUIChpc2JuIC0gaWYgc2hvd24pICYgYmFycwoJCQkJCQkJJGlzYm5fZm9udHNpemUgPSAyLjEgKiAkb2JqYXR0clsnYnNpemUnXTsKCQkJCQkJCSRoICs9ICRpc2JuX2ZvbnRzaXplICsgJHRpc2JubTsKCQkJCQkJfQoJCQkJCX0KCQkJCQkvLyBRUi1jb2RlCgkJCQkJZWxzZSBpZiAoJG9iamF0dHJbJ2J0eXBlJ10gPT0gJ1FSJykgewoJCQkJCQkkdyA9ICRoID0gJG9iamF0dHJbJ2JzaXplJ10gKiAyNTsgLy8gRmFjdG9yIG9mIDI1bW0gKGRlZmF1bHQpCgkJCQkJCSRvYmphdHRyWydlcnJvcmxldmVsJ10gPSAnTCc7CgkJCQkJCWlmIChpc3NldCgkYXR0clsnRVJST1InXSkpIHsKCQkJCQkJCSRvYmphdHRyWydlcnJvcmxldmVsJ10gPSAkYXR0clsnRVJST1InXTsKCQkJCQkJfQoJCQkJCX0gZWxzZSBpZiAoJG9iamF0dHJbJ2J0eXBlJ10gPT0gJ0lNQicgfHwgJG9iamF0dHJbJ2J0eXBlJ10gPT0gJ1JNNFNDQycgfHwgJG9iamF0dHJbJ2J0eXBlJ10gPT0gJ0tJWCcgfHwgJG9iamF0dHJbJ2J0eXBlJ10gPT0gJ1BPU1RORVQnIHx8ICRvYmphdHRyWydidHlwZSddID09ICdQTEFORVQnKSB7CgkJCQkJCSRhcnJjb2RlID0gJHRoaXMtPm1wZGYtPmJhcmNvZGUtPmdldEJhcmNvZGVBcnJheSgkb2JqYXR0clsnY29kZSddLCAkb2JqYXR0clsnYnR5cGUnXSk7CgkJCQkJCWlmICgkYXJyY29kZSA9PT0gZmFsc2UpIHsKCQkJCQkJCXRocm93IG5ldyBNcGRmRXhjZXB0aW9uKCdFcnJvciBpbiBiYXJjb2RlIHN0cmluZy4nKTsKCQkJCQkJfQoJCQkJCQkkdyA9ICgkYXJyY29kZVsibWF4dyJdICogJGFycmNvZGVbJ25vbS1YJ10gKiAkb2JqYXR0clsnYnNpemUnXSkgKyAkYXJyY29kZVsncXVpZXRMJ10gKyAkYXJyY29kZVsncXVpZXRSJ107CgkJCQkJCSRoID0gKCRhcnJjb2RlWydub20tSCddICogJG9iamF0dHJbJ2JzaXplJ10pICsgKDIgKiAkYXJyY29kZVsncXVpZXRUQiddKTsKCQkJCQl9IGVsc2UgaWYgKGluX2FycmF5KCRvYmphdHRyWydidHlwZSddLCBhcnJheSgnQzEyOEEnLCAnQzEyOEInLCAnQzEyOEMnLCAnRUFOMTI4QScsICdFQU4xMjhCJywgJ0VBTjEyOEMnLCAnQzM5JywgJ0MzOSsnLCAnQzM5RScsICdDMzlFKycsICdTMjUnLCAnUzI1KycsICdJMjUnLCAnSTI1KycsICdJMjVCJywgJ0kyNUIrJywgJ0M5MycsICdNU0knLCAnTVNJKycsICdDT0RBQkFSJywgJ0NPREUxMScpKSkgewoJCQkJCQkkYXJyY29kZSA9ICR0aGlzLT5tcGRmLT5iYXJjb2RlLT5nZXRCYXJjb2RlQXJyYXkoJG9iamF0dHJbJ2NvZGUnXSwgJG9iamF0dHJbJ2J0eXBlJ10sICRvYmphdHRyWydwcl9yYXRpbyddKTsKCQkJCQkJaWYgKCRhcnJjb2RlID09PSBmYWxzZSkgewoJCQkJCQkJdGhyb3cgbmV3IE1wZGZFeGNlcHRpb24oJ0Vycm9yIGluIGJhcmNvZGUgc3RyaW5nLicpOwoJCQkJCQl9CgkJCQkJCSR3ID0gKCRhcnJjb2RlWyJtYXh3Il0gKyAkYXJyY29kZVsnbGlnaHRtTCddICsgJGFycmNvZGVbJ2xpZ2h0bVInXSkgKiAkYXJyY29kZVsnbm9tLVgnXSAqICRvYmphdHRyWydic2l6ZSddOwoJCQkJCQkkaCA9ICgoMiAqICRhcnJjb2RlWydsaWdodFRCJ10gKiAkYXJyY29kZVsnbm9tLVgnXSkgKyAkYXJyY29kZVsnbm9tLUgnXSkgKiAkb2JqYXR0clsnYnNpemUnXSAqICRvYmphdHRyWydiaGVpZ2h0J107CgkJCQkJfSBlbHNlIHsKCQkJCQkJYnJlYWs7CgkJCQkJfQoKCQkJCQkkZXh0cmFoZWlnaHQgPSAkb2JqYXR0clsncGFkZGluZ190b3AnXSArICRvYmphdHRyWydwYWRkaW5nX2JvdHRvbSddICsgJG9iamF0dHJbJ21hcmdpbl90b3AnXSArICRvYmphdHRyWydtYXJnaW5fYm90dG9tJ10gKyAkb2JqYXR0clsnYm9yZGVyX3RvcCddWyd3J10gKyAkb2JqYXR0clsnYm9yZGVyX2JvdHRvbSddWyd3J107CgkJCQkJJGV4dHJhd2lkdGggPSAkb2JqYXR0clsncGFkZGluZ19sZWZ0J10gKyAkb2JqYXR0clsncGFkZGluZ19yaWdodCddICsgJG9iamF0dHJbJ21hcmdpbl9sZWZ0J10gKyAkb2JqYXR0clsnbWFyZ2luX3JpZ2h0J10gKyAkb2JqYXR0clsnYm9yZGVyX2xlZnQnXVsndyddICsgJG9iamF0dHJbJ2JvcmRlcl9yaWdodCddWyd3J107CgoJCQkJCSRvYmphdHRyWyd0eXBlJ10gPSAnYmFyY29kZSc7CgkJCQkJJG9iamF0dHJbJ2hlaWdodCddID0gJGggKyAkZXh0cmFoZWlnaHQ7CgkJCQkJJG9iamF0dHJbJ3dpZHRoJ10gPSAkdyArICRleHRyYXdpZHRoOwoJCQkJCSRvYmphdHRyWydiYXJjb2RlX2hlaWdodCddID0gJGg7CgkJCQkJJG9iamF0dHJbJ2JhcmNvZGVfd2lkdGgnXSA9ICR3OwoJCQkJCS8qIC0tIENTUy1JTUFHRS1GTE9BVCAtLSAqLwoJCQkJCWlmICghJHRoaXMtPm1wZGYtPkNvbEFjdGl2ZSAmJiAhJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWwgJiYgISR0aGlzLT5tcGRmLT5saXN0bHZsICYmICEkdGhpcy0+bXBkZi0+a3d0KSB7CgkJCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snRkxPQVQnXSkgJiYgKHN0cnRvdXBwZXIoJHByb3BlcnRpZXNbJ0ZMT0FUJ10pID09ICdSSUdIVCcgfHwgc3RydG91cHBlcigkcHJvcGVydGllc1snRkxPQVQnXSkgPT0gJ0xFRlQnKSkgewoJCQkJCQkJJG9iamF0dHJbJ2Zsb2F0J10gPSBzdWJzdHIoc3RydG91cHBlcigkcHJvcGVydGllc1snRkxPQVQnXSksIDAsIDEpOwoJCQkJCQl9CgkJCQkJfQoJCQkJCS8qIC0tIEVORCBDU1MtSU1BR0UtRkxPQVQgLS0gKi8KCgkJCQkJJGUgPSAiXHhiYlx4YTRceGFjdHlwZT1iYXJjb2RlLG9iamF0dHI9IiAuIHNlcmlhbGl6ZSgkb2JqYXR0cikgLiAiXHhiYlx4YTRceGFjIjsKCgkJCQkJLy8gQ2xlYXIgcHJvcGVydGllcyAtIHRpZHkgdXAKCQkJCQkkcHJvcGVydGllcyA9IGFycmF5KCk7CgoJCQkJCS8qIC0tIFRBQkxFUyAtLSAqLwoJCQkJCS8vIE91dHB1dCBpdCB0byBidWZmZXJzCgkJCQkJaWYgKCR0aGlzLT5tcGRmLT50YWJsZUxldmVsKSB7CgkJCQkJCSR0aGlzLT5tcGRmLT5fc2F2ZUNlbGxUZXh0QnVmZmVyKCRlLCAkdGhpcy0+bXBkZi0+SFJFRik7CgkJCQkJCSR0aGlzLT5tcGRmLT5jZWxsWyR0aGlzLT5tcGRmLT5yb3ddWyR0aGlzLT5tcGRmLT5jb2xdWydzJ10gKz0gJG9iamF0dHJbJ3dpZHRoJ107CgkJCQkJfSBlbHNlIHsKCQkJCQkJLyogLS0gRU5EIFRBQkxFUyAtLSAqLwoJCQkJCQkkdGhpcy0+bXBkZi0+X3NhdmVUZXh0QnVmZmVyKCRlLCAkdGhpcy0+bXBkZi0+SFJFRik7CgkJCQkJfSAvLyAqVEFCTEVTKgoJCQkJfQoJCQkJYnJlYWs7CgkJCS8qIC0tIEVORCBCQVJDT0RFUyAtLSAqLwoKCgkJCS8vICoqKioqKioqKioqIEZPUk0gRUxFTUVOVFMgKioqKioqKioqKioqKioqKioqKioKCgkJCS8qIC0tIEZPUk1TIC0tICovCgkJCWNhc2UgJ1NFTEVDVCc6CgkJCQkkdGhpcy0+bXBkZi0+bGFzdG9wdGlvbmFsdGFnID0gJyc7IC8vIFNhdmUgY3VycmVudCBIVE1MIHNwZWNpZmllZCBvcHRpb25hbCBlbmR0YWcKCQkJCSR0aGlzLT5tcGRmLT5JbmxpbmVQcm9wZXJ0aWVzWyR0YWddID0gJHRoaXMtPm1wZGYtPnNhdmVJbmxpbmVQcm9wZXJ0aWVzKCk7CgkJCQkkcHJvcGVydGllcyA9ICR0aGlzLT5tcGRmLT5jc3NtZ3ItPk1lcmdlQ1NTKCcnLCAkdGFnLCAkYXR0cik7CgkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ0ZPTlQtRkFNSUxZJ10pKSB7CgkJCQkJJHRoaXMtPm1wZGYtPlNldEZvbnQoJHByb3BlcnRpZXNbJ0ZPTlQtRkFNSUxZJ10sICR0aGlzLT5tcGRmLT5Gb250U3R5bGUsIDAsIGZhbHNlKTsKCQkJCX0KCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snRk9OVC1TSVpFJ10pKSB7CgkJCQkJJG1tc2l6ZSA9ICR0aGlzLT5tcGRmLT5Db252ZXJ0U2l6ZSgkcHJvcGVydGllc1snRk9OVC1TSVpFJ10sICR0aGlzLT5tcGRmLT5kZWZhdWx0X2ZvbnRfc2l6ZSAvIF9NUERGSyk7CgkJCQkJJHRoaXMtPm1wZGYtPlNldEZvbnRTaXplKCRtbXNpemUgKiBfTVBERkssIGZhbHNlKTsKCQkJCX0KCQkJCWlmIChpc3NldCgkYXR0clsnU1BFTExDSEVDSyddKSAmJiBzdHJ0b2xvd2VyKCRhdHRyWydTUEVMTENIRUNLJ10pID09ICd0cnVlJykgewoJCQkJCSR0aGlzLT5tcGRmLT5zZWxlY3RvcHRpb25bJ1NQRUxMQ0hFQ0snXSA9IHRydWU7CgkJCQl9CgoJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydDT0xPUiddKSkgewoJCQkJCSR0aGlzLT5tcGRmLT5zZWxlY3RvcHRpb25bJ0NPTE9SJ10gPSAkdGhpcy0+bXBkZi0+Q29udmVydENvbG9yKCRwcm9wZXJ0aWVzWydDT0xPUiddKTsKCQkJCX0KCQkJCSR0aGlzLT5tcGRmLT5zcGVjaWFsY29udGVudCA9ICJ0eXBlPXNlbGVjdCI7CgkJCQlpZiAoaXNzZXQoJGF0dHJbJ0RJU0FCTEVEJ10pKSB7CgkJCQkJJHRoaXMtPm1wZGYtPnNlbGVjdG9wdGlvblsnRElTQUJMRUQnXSA9ICRhdHRyWydESVNBQkxFRCddOwoJCQkJfQoJCQkJaWYgKGlzc2V0KCRhdHRyWydSRUFET05MWSddKSkgewoJCQkJCSR0aGlzLT5tcGRmLT5zZWxlY3RvcHRpb25bJ1JFQURPTkxZJ10gPSAkYXR0clsnUkVBRE9OTFknXTsKCQkJCX0KCQkJCWlmIChpc3NldCgkYXR0clsnUkVRVUlSRUQnXSkpIHsKCQkJCQkkdGhpcy0+bXBkZi0+c2VsZWN0b3B0aW9uWydSRVFVSVJFRCddID0gJGF0dHJbJ1JFUVVJUkVEJ107CgkJCQl9CgkJCQlpZiAoaXNzZXQoJGF0dHJbJ0VESVRBQkxFJ10pKSB7CgkJCQkJJHRoaXMtPm1wZGYtPnNlbGVjdG9wdGlvblsnRURJVEFCTEUnXSA9ICRhdHRyWydFRElUQUJMRSddOwoJCQkJfQoJCQkJaWYgKGlzc2V0KCRhdHRyWydUSVRMRSddKSkgewoJCQkJCSR0aGlzLT5tcGRmLT5zZWxlY3RvcHRpb25bJ1RJVExFJ10gPSAkYXR0clsnVElUTEUnXTsKCQkJCX0KCQkJCWlmIChpc3NldCgkYXR0clsnTVVMVElQTEUnXSkpIHsKCQkJCQkkdGhpcy0+bXBkZi0+c2VsZWN0b3B0aW9uWydNVUxUSVBMRSddID0gJGF0dHJbJ01VTFRJUExFJ107CgkJCQl9CgkJCQlpZiAoaXNzZXQoJGF0dHJbJ1NJWkUnXSkgJiYgJGF0dHJbJ1NJWkUnXSA+IDEpIHsKCQkJCQkkdGhpcy0+bXBkZi0+c2VsZWN0b3B0aW9uWydTSVpFJ10gPSAkYXR0clsnU0laRSddOwoJCQkJfQoJCQkJaWYgKCR0aGlzLT5tcGRmLT51c2VBY3RpdmVGb3JtcykgewoJCQkJCWlmIChpc3NldCgkYXR0clsnTkFNRSddKSkgewoJCQkJCQkkdGhpcy0+bXBkZi0+c2VsZWN0b3B0aW9uWydOQU1FJ10gPSAkYXR0clsnTkFNRSddOwoJCQkJCX0KCQkJCQlpZiAoaXNzZXQoJGF0dHJbJ09OQ0hBTkdFJ10pKSB7CgkJCQkJCSR0aGlzLT5tcGRmLT5zZWxlY3RvcHRpb25bJ09OQ0hBTkdFJ10gPSAkYXR0clsnT05DSEFOR0UnXTsKCQkJCQl9CgkJCQl9CgoJCQkJJHByb3BlcnRpZXMgPSBhcnJheSgpOwoJCQkJYnJlYWs7CgoJCQljYXNlICdPUFRJT04nOgoJCQkJJHRoaXMtPm1wZGYtPmxhc3RvcHRpb25hbHRhZyA9ICcnOwoJCQkJJHRoaXMtPm1wZGYtPnNlbGVjdG9wdGlvblsnQUNUSVZFJ10gPSB0cnVlOwoJCQkJJHRoaXMtPm1wZGYtPnNlbGVjdG9wdGlvblsnY3VycmVudFNFTCddID0gZmFsc2U7CgkJCQlpZiAoZW1wdHkoJHRoaXMtPm1wZGYtPnNlbGVjdG9wdGlvbikpIHsKCQkJCQkkdGhpcy0+bXBkZi0+c2VsZWN0b3B0aW9uWydNQVhXSURUSCddID0gJyc7CgkJCQkJJHRoaXMtPm1wZGYtPnNlbGVjdG9wdGlvblsnU0VMRUNURUQnXSA9ICcnOwoJCQkJfQoJCQkJaWYgKGlzc2V0KCRhdHRyWydTRUxFQ1RFRCddKSkgewoJCQkJCSR0aGlzLT5tcGRmLT5zZWxlY3RvcHRpb25bJ1NFTEVDVEVEJ10gPSAnJzsKCQkJCQkkdGhpcy0+bXBkZi0+c2VsZWN0b3B0aW9uWydjdXJyZW50U0VMJ10gPSB0cnVlOwoJCQkJfQoJCQkJaWYgKGlzc2V0KCRhdHRyWydWQUxVRSddKSkgewoJCQkJCSRhdHRyWydWQUxVRSddID0gc3RyY29kZTJ1dGYoJGF0dHJbJ1ZBTFVFJ10pOwoJCQkJCSRhdHRyWydWQUxVRSddID0gJHRoaXMtPm1wZGYtPmxlc3Nlcl9lbnRpdHlfZGVjb2RlKCRhdHRyWydWQUxVRSddKTsKCQkJCQlpZiAoJHRoaXMtPm1wZGYtPm9ubHlDb3JlRm9udHMpCgkJCQkJCSRhdHRyWydWQUxVRSddID0gbWJfY29udmVydF9lbmNvZGluZygkYXR0clsnVkFMVUUnXSwgJHRoaXMtPm1wZGYtPm1iX2VuYywgJ1VURi04Jyk7CgkJCQl9CgkJCQkkdGhpcy0+bXBkZi0+c2VsZWN0b3B0aW9uWydjdXJyZW50VkFMJ10gPSAkYXR0clsnVkFMVUUnXTsKCQkJCWJyZWFrOwoKCQkJY2FzZSAnVEVYVEFSRUEnOgoJCQkJJG9iamF0dHIgPSBhcnJheSgpOwoJCQkJJG9iamF0dHJbJ21hcmdpbl90b3AnXSA9IDA7CgkJCQkkb2JqYXR0clsnbWFyZ2luX2JvdHRvbSddID0gMDsKCQkJCSRvYmphdHRyWydtYXJnaW5fbGVmdCddID0gMDsKCQkJCSRvYmphdHRyWydtYXJnaW5fcmlnaHQnXSA9IDA7CgkJCQkkb2JqYXR0clsnd2lkdGgnXSA9IDA7CgkJCQkkb2JqYXR0clsnaGVpZ2h0J10gPSAwOwoJCQkJJG9iamF0dHJbJ2JvcmRlcl90b3AnXVsndyddID0gMDsKCQkJCSRvYmphdHRyWydib3JkZXJfYm90dG9tJ11bJ3cnXSA9IDA7CgkJCQkkb2JqYXR0clsnYm9yZGVyX2xlZnQnXVsndyddID0gMDsKCQkJCSRvYmphdHRyWydib3JkZXJfcmlnaHQnXVsndyddID0gMDsKCQkJCWlmIChpc3NldCgkYXR0clsnRElTQUJMRUQnXSkpIHsKCQkJCQkkb2JqYXR0clsnZGlzYWJsZWQnXSA9IHRydWU7CgkJCQl9CgkJCQlpZiAoaXNzZXQoJGF0dHJbJ1JFQURPTkxZJ10pKSB7CgkJCQkJJG9iamF0dHJbJ3JlYWRvbmx5J10gPSB0cnVlOwoJCQkJfQoJCQkJaWYgKGlzc2V0KCRhdHRyWydSRVFVSVJFRCddKSkgewoJCQkJCSRvYmphdHRyWydyZXF1aXJlZCddID0gdHJ1ZTsKCQkJCX0KCQkJCWlmIChpc3NldCgkYXR0clsnU1BFTExDSEVDSyddKSAmJiBzdHJ0b2xvd2VyKCRhdHRyWydTUEVMTENIRUNLJ10pID09ICd0cnVlJykgewoJCQkJCSRvYmphdHRyWydzcGVsbGNoZWNrJ10gPSB0cnVlOwoJCQkJfQoJCQkJaWYgKGlzc2V0KCRhdHRyWydUSVRMRSddKSkgewoJCQkJCSRvYmphdHRyWyd0aXRsZSddID0gJGF0dHJbJ1RJVExFJ107CgkJCQkJaWYgKCR0aGlzLT5tcGRmLT5vbmx5Q29yZUZvbnRzKQoJCQkJCQkkb2JqYXR0clsndGl0bGUnXSA9IG1iX2NvbnZlcnRfZW5jb2RpbmcoJG9iamF0dHJbJ3RpdGxlJ10sICR0aGlzLT5tcGRmLT5tYl9lbmMsICdVVEYtOCcpOwoJCQkJfQoJCQkJaWYgKCR0aGlzLT5tcGRmLT51c2VBY3RpdmVGb3JtcykgewoJCQkJCWlmIChpc3NldCgkYXR0clsnTkFNRSddKSkgewoJCQkJCQkkb2JqYXR0clsnZmllbGRuYW1lJ10gPSAkYXR0clsnTkFNRSddOwoJCQkJCX0KCQkJCQkkdGhpcy0+bXBkZi0+bXBkZmZvcm0tPmZvcm1fZWxlbWVudF9zcGFjaW5nWyd0ZXh0YXJlYSddWydvdXRlciddWyd2J10gPSAwOwoJCQkJCSR0aGlzLT5tcGRmLT5tcGRmZm9ybS0+Zm9ybV9lbGVtZW50X3NwYWNpbmdbJ3RleHRhcmVhJ11bJ2lubmVyJ11bJ3YnXSA9IDA7CgkJCQkJaWYgKGlzc2V0KCRhdHRyWydPTkNBTENVTEFURSddKSkgewoJCQkJCQkkb2JqYXR0clsnb25DYWxjdWxhdGUnXSA9ICRhdHRyWydPTkNBTENVTEFURSddOwoJCQkJCX0gZWxzZSBpZiAoaXNzZXQoJGF0dHJbJ09OQ0hBTkdFJ10pKSB7CgkJCQkJCSRvYmphdHRyWydvbkNhbGN1bGF0ZSddID0gJGF0dHJbJ09OQ0hBTkdFJ107CgkJCQkJfQoJCQkJCWlmIChpc3NldCgkYXR0clsnT05WQUxJREFURSddKSkgewoJCQkJCQkkb2JqYXR0clsnb25WYWxpZGF0ZSddID0gJGF0dHJbJ09OVkFMSURBVEUnXTsKCQkJCQl9CgkJCQkJaWYgKGlzc2V0KCRhdHRyWydPTktFWVNUUk9LRSddKSkgewoJCQkJCQkkb2JqYXR0clsnb25LZXlzdHJva2UnXSA9ICRhdHRyWydPTktFWVNUUk9LRSddOwoJCQkJCX0KCQkJCQlpZiAoaXNzZXQoJGF0dHJbJ09ORk9STUFUJ10pKSB7CgkJCQkJCSRvYmphdHRyWydvbkZvcm1hdCddID0gJGF0dHJbJ09ORk9STUFUJ107CgkJCQkJfQoJCQkJfQoJCQkJJHRoaXMtPm1wZGYtPklubGluZVByb3BlcnRpZXNbJHRhZ10gPSAkdGhpcy0+bXBkZi0+c2F2ZUlubGluZVByb3BlcnRpZXMoKTsKCQkJCSRwcm9wZXJ0aWVzID0gJHRoaXMtPm1wZGYtPmNzc21nci0+TWVyZ2VDU1MoJycsICR0YWcsICRhdHRyKTsKCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snRk9OVC1GQU1JTFknXSkpIHsKCQkJCQkkdGhpcy0+bXBkZi0+U2V0Rm9udCgkcHJvcGVydGllc1snRk9OVC1GQU1JTFknXSwgJycsIDAsIGZhbHNlKTsKCQkJCX0KCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snRk9OVC1TSVpFJ10pKSB7CgkJCQkJJG1tc2l6ZSA9ICR0aGlzLT5tcGRmLT5Db252ZXJ0U2l6ZSgkcHJvcGVydGllc1snRk9OVC1TSVpFJ10sICR0aGlzLT5tcGRmLT5kZWZhdWx0X2ZvbnRfc2l6ZSAvIF9NUERGSyk7CgkJCQkJJHRoaXMtPm1wZGYtPlNldEZvbnRTaXplKCRtbXNpemUgKiBfTVBERkssIGZhbHNlKTsKCQkJCX0KCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snQ09MT1InXSkpIHsKCQkJCQkkb2JqYXR0clsnY29sb3InXSA9ICR0aGlzLT5tcGRmLT5Db252ZXJ0Q29sb3IoJHByb3BlcnRpZXNbJ0NPTE9SJ10pOwoJCQkJfQoJCQkJJG9iamF0dHJbJ2ZvbnRmYW1pbHknXSA9ICR0aGlzLT5tcGRmLT5Gb250RmFtaWx5OwoJCQkJJG9iamF0dHJbJ2ZvbnRzaXplJ10gPSAkdGhpcy0+bXBkZi0+Rm9udFNpemVQdDsKCQkJCWlmICgkdGhpcy0+bXBkZi0+dXNlQWN0aXZlRm9ybXMpIHsKCQkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ1RFWFQtQUxJR04nXSkpIHsKCQkJCQkJJG9iamF0dHJbJ3RleHRfYWxpZ24nXSA9ICRhbGlnbltzdHJ0b2xvd2VyKCRwcm9wZXJ0aWVzWydURVhULUFMSUdOJ10pXTsKCQkJCQl9IGVsc2UgaWYgKGlzc2V0KCRhdHRyWydBTElHTiddKSkgewoJCQkJCQkkb2JqYXR0clsndGV4dF9hbGlnbiddID0gJGFsaWduW3N0cnRvbG93ZXIoJGF0dHJbJ0FMSUdOJ10pXTsKCQkJCQl9CgkJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydPVkVSRkxPVyddKSAmJiBzdHJ0b2xvd2VyKCRwcm9wZXJ0aWVzWydPVkVSRkxPVyddKSA9PSAnaGlkZGVuJykgewoJCQkJCQkkb2JqYXR0clsnZG9ub3RzY3JvbGwnXSA9IHRydWU7CgkJCQkJfQoJCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snQk9SREVSLVRPUC1DT0xPUiddKSkgewoJCQkJCQkkb2JqYXR0clsnYm9yZGVyLWNvbCddID0gJHRoaXMtPm1wZGYtPkNvbnZlcnRDb2xvcigkcHJvcGVydGllc1snQk9SREVSLVRPUC1DT0xPUiddKTsKCQkJCQl9CgkJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydCQUNLR1JPVU5ELUNPTE9SJ10pKSB7CgkJCQkJCSRvYmphdHRyWydiYWNrZ3JvdW5kLWNvbCddID0gJHRoaXMtPm1wZGYtPkNvbnZlcnRDb2xvcigkcHJvcGVydGllc1snQkFDS0dST1VORC1DT0xPUiddKTsKCQkJCQl9CgkJCQl9CgkJCQkkdGhpcy0+bXBkZi0+U2V0TGluZUhlaWdodCgnJywgJHRoaXMtPm1wZGYtPm1wZGZmb3JtLT50ZXh0YXJlYV9saW5laGVpZ2h0KTsKCgkJCQkkdyA9IDA7CgkJCQkkaCA9IDA7CgkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ1dJRFRIJ10pKQoJCQkJCSR3ID0gJHRoaXMtPm1wZGYtPkNvbnZlcnRTaXplKCRwcm9wZXJ0aWVzWydXSURUSCddLCAkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWydpbm5lcl93aWR0aCddLCAkdGhpcy0+bXBkZi0+Rm9udFNpemUsIGZhbHNlKTsKCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snSEVJR0hUJ10pKQoJCQkJCSRoID0gJHRoaXMtPm1wZGYtPkNvbnZlcnRTaXplKCRwcm9wZXJ0aWVzWydIRUlHSFQnXSwgJHRoaXMtPm1wZGYtPmJsa1skdGhpcy0+bXBkZi0+YmxrbHZsXVsnaW5uZXJfd2lkdGgnXSwgJHRoaXMtPm1wZGYtPkZvbnRTaXplLCBmYWxzZSk7CgkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ1ZFUlRJQ0FMLUFMSUdOJ10pKSB7CgkJCQkJJG9iamF0dHJbJ3ZlcnRpY2FsLWFsaWduJ10gPSAkYWxpZ25bc3RydG9sb3dlcigkcHJvcGVydGllc1snVkVSVElDQUwtQUxJR04nXSldOwoJCQkJfQoKCQkJCSRjb2xzaXplID0gMjA7IC8vSFRNTCBkZWZhdWx0IHZhbHVlCgkJCQkkcm93c2l6ZSA9IDI7IC8vSFRNTCBkZWZhdWx0IHZhbHVlCgkJCQlpZiAoaXNzZXQoJGF0dHJbJ0NPTFMnXSkpCgkJCQkJJGNvbHNpemUgPSBpbnR2YWwoJGF0dHJbJ0NPTFMnXSk7CgkJCQlpZiAoaXNzZXQoJGF0dHJbJ1JPV1MnXSkpCgkJCQkJJHJvd3NpemUgPSBpbnR2YWwoJGF0dHJbJ1JPV1MnXSk7CgoJCQkJJGNoYXJzaXplID0gJHRoaXMtPm1wZGYtPkdldENoYXJXaWR0aCgndycsIGZhbHNlKTsKCQkJCWlmICgkdykgewoJCQkJCSRjb2xzaXplID0gcm91bmQoKCR3IC0gKCR0aGlzLT5tcGRmLT5tcGRmZm9ybS0+Zm9ybV9lbGVtZW50X3NwYWNpbmdbJ3RleHRhcmVhJ11bJ291dGVyJ11bJ2gnXSAqIDIpIC0gKCR0aGlzLT5tcGRmLT5tcGRmZm9ybS0+Zm9ybV9lbGVtZW50X3NwYWNpbmdbJ3RleHRhcmVhJ11bJ2lubmVyJ11bJ2gnXSAqIDIpKSAvICRjaGFyc2l6ZSk7CgkJCQl9CgkJCQlpZiAoJGgpIHsKCQkJCQkkcm93c2l6ZSA9IHJvdW5kKCgkaCAtICgkdGhpcy0+bXBkZi0+bXBkZmZvcm0tPmZvcm1fZWxlbWVudF9zcGFjaW5nWyd0ZXh0YXJlYSddWydvdXRlciddWyd2J10gKiAyKSAtICgkdGhpcy0+bXBkZi0+bXBkZmZvcm0tPmZvcm1fZWxlbWVudF9zcGFjaW5nWyd0ZXh0YXJlYSddWydpbm5lciddWyd2J10gKiAyKSkgLyAkdGhpcy0+bXBkZi0+bGluZWhlaWdodCk7CgkJCQl9CgoJCQkJJG9iamF0dHJbJ3R5cGUnXSA9ICd0ZXh0YXJlYSc7CgkJCQkkb2JqYXR0clsnd2lkdGgnXSA9ICgkY29sc2l6ZSAqICRjaGFyc2l6ZSkgKyAoJHRoaXMtPm1wZGYtPm1wZGZmb3JtLT5mb3JtX2VsZW1lbnRfc3BhY2luZ1sndGV4dGFyZWEnXVsnb3V0ZXInXVsnaCddICogMikgKyAoJHRoaXMtPm1wZGYtPm1wZGZmb3JtLT5mb3JtX2VsZW1lbnRfc3BhY2luZ1sndGV4dGFyZWEnXVsnaW5uZXInXVsnaCddICogMik7CgkJCQkkb2JqYXR0clsnaGVpZ2h0J10gPSAoJHJvd3NpemUgKiAkdGhpcy0+bXBkZi0+bGluZWhlaWdodCkgKyAoJHRoaXMtPm1wZGYtPm1wZGZmb3JtLT5mb3JtX2VsZW1lbnRfc3BhY2luZ1sndGV4dGFyZWEnXVsnb3V0ZXInXVsndiddICogMikgKyAoJHRoaXMtPm1wZGYtPm1wZGZmb3JtLT5mb3JtX2VsZW1lbnRfc3BhY2luZ1sndGV4dGFyZWEnXVsnaW5uZXInXVsndiddICogMik7CgkJCQkkb2JqYXR0clsncm93cyddID0gJHJvd3NpemU7CgkJCQkkb2JqYXR0clsnY29scyddID0gJGNvbHNpemU7CgoJCQkJJHRoaXMtPm1wZGYtPnNwZWNpYWxjb250ZW50ID0gc2VyaWFsaXplKCRvYmphdHRyKTsKCgkJCQlpZiAoJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWwpIHsgLy8gKlRBQkxFUyoKCQkJCQkkdGhpcy0+bXBkZi0+Y2VsbFskdGhpcy0+bXBkZi0+cm93XVskdGhpcy0+bXBkZi0+Y29sXVsncyddICs9ICRvYmphdHRyWyd3aWR0aCddOyAvLyAqVEFCTEVTKgoJCQkJfSAvLyAqVEFCTEVTKgoJCQkJLy8gQ2xlYXIgcHJvcGVydGllcyAtIHRpZHkgdXAKCQkJCSRwcm9wZXJ0aWVzID0gYXJyYXkoKTsKCQkJCWJyZWFrOwoKCgoJCQkvLyAqKioqKioqKioqKiBGT1JNIC0gSU5QVVQgKioqKioqKioqKioqKioqKioqKioKCgkJCWNhc2UgJ0lOUFVUJzoKCQkJCSR0aGlzLT5tcGRmLT5pZ25vcmVmb2xsb3dpbmdzcGFjZXMgPSBmYWxzZTsKCQkJCWlmICghaXNzZXQoJGF0dHJbJ1RZUEUnXSkpCgkJCQkJJGF0dHJbJ1RZUEUnXSA9PSAnVEVYVCc7CgkJCQkkb2JqYXR0ciA9IGFycmF5KCk7CgkJCQkkb2JqYXR0clsnbWFyZ2luX3RvcCddID0gMDsKCQkJCSRvYmphdHRyWydtYXJnaW5fYm90dG9tJ10gPSAwOwoJCQkJJG9iamF0dHJbJ21hcmdpbl9sZWZ0J10gPSAwOwoJCQkJJG9iamF0dHJbJ21hcmdpbl9yaWdodCddID0gMDsKCQkJCSRvYmphdHRyWyd3aWR0aCddID0gMDsKCQkJCSRvYmphdHRyWydoZWlnaHQnXSA9IDA7CgkJCQkkb2JqYXR0clsnYm9yZGVyX3RvcCddWyd3J10gPSAwOwoJCQkJJG9iamF0dHJbJ2JvcmRlcl9ib3R0b20nXVsndyddID0gMDsKCQkJCSRvYmphdHRyWydib3JkZXJfbGVmdCddWyd3J10gPSAwOwoJCQkJJG9iamF0dHJbJ2JvcmRlcl9yaWdodCddWyd3J10gPSAwOwoJCQkJJG9iamF0dHJbJ3R5cGUnXSA9ICdpbnB1dCc7CgkJCQlpZiAoaXNzZXQoJGF0dHJbJ0RJU0FCTEVEJ10pKSB7CgkJCQkJJG9iamF0dHJbJ2Rpc2FibGVkJ10gPSB0cnVlOwoJCQkJfQoJCQkJaWYgKGlzc2V0KCRhdHRyWydSRUFET05MWSddKSkgewoJCQkJCSRvYmphdHRyWydyZWFkb25seSddID0gdHJ1ZTsKCQkJCX0KCQkJCWlmIChpc3NldCgkYXR0clsnUkVRVUlSRUQnXSkpIHsKCQkJCQkkb2JqYXR0clsncmVxdWlyZWQnXSA9IHRydWU7CgkJCQl9CgkJCQlpZiAoaXNzZXQoJGF0dHJbJ1NQRUxMQ0hFQ0snXSkgJiYgc3RydG9sb3dlcigkYXR0clsnU1BFTExDSEVDSyddKSA9PSAndHJ1ZScpIHsKCQkJCQkkb2JqYXR0clsnc3BlbGxjaGVjayddID0gdHJ1ZTsKCQkJCX0KCQkJCWlmIChpc3NldCgkYXR0clsnVElUTEUnXSkpIHsKCQkJCQkkb2JqYXR0clsndGl0bGUnXSA9ICRhdHRyWydUSVRMRSddOwoJCQkJfSBlbHNlIGlmIChpc3NldCgkYXR0clsnQUxUJ10pKSB7CgkJCQkJJG9iamF0dHJbJ3RpdGxlJ10gPSAkYXR0clsnQUxUJ107CgkJCQl9IGVsc2UKCQkJCQkkb2JqYXR0clsndGl0bGUnXSA9ICcnOwoJCQkJJG9iamF0dHJbJ3RpdGxlJ10gPSBzdHJjb2RlMnV0Zigkb2JqYXR0clsndGl0bGUnXSk7CgkJCQkkb2JqYXR0clsndGl0bGUnXSA9ICR0aGlzLT5tcGRmLT5sZXNzZXJfZW50aXR5X2RlY29kZSgkb2JqYXR0clsndGl0bGUnXSk7CgkJCQlpZiAoJHRoaXMtPm1wZGYtPm9ubHlDb3JlRm9udHMpCgkJCQkJJG9iamF0dHJbJ3RpdGxlJ10gPSBtYl9jb252ZXJ0X2VuY29kaW5nKCRvYmphdHRyWyd0aXRsZSddLCAkdGhpcy0+bXBkZi0+bWJfZW5jLCAnVVRGLTgnKTsKCQkJCWlmICgkdGhpcy0+bXBkZi0+dXNlQWN0aXZlRm9ybXMpIHsKCQkJCQlpZiAoaXNzZXQoJGF0dHJbJ05BTUUnXSkpIHsKCQkJCQkJJG9iamF0dHJbJ2ZpZWxkbmFtZSddID0gJGF0dHJbJ05BTUUnXTsKCQkJCQl9CgkJCQl9CgkJCQlpZiAoaXNzZXQoJGF0dHJbJ1ZBTFVFJ10pKSB7CgkJCQkJJGF0dHJbJ1ZBTFVFJ10gPSBzdHJjb2RlMnV0ZigkYXR0clsnVkFMVUUnXSk7CgkJCQkJJGF0dHJbJ1ZBTFVFJ10gPSAkdGhpcy0+bXBkZi0+bGVzc2VyX2VudGl0eV9kZWNvZGUoJGF0dHJbJ1ZBTFVFJ10pOwoJCQkJCWlmICgkdGhpcy0+bXBkZi0+b25seUNvcmVGb250cykKCQkJCQkJJGF0dHJbJ1ZBTFVFJ10gPSBtYl9jb252ZXJ0X2VuY29kaW5nKCRhdHRyWydWQUxVRSddLCAkdGhpcy0+bXBkZi0+bWJfZW5jLCAnVVRGLTgnKTsKCQkJCQkkb2JqYXR0clsndmFsdWUnXSA9ICRhdHRyWydWQUxVRSddOwoJCQkJfQoKCQkJCSR0aGlzLT5tcGRmLT5JbmxpbmVQcm9wZXJ0aWVzWyR0YWddID0gJHRoaXMtPm1wZGYtPnNhdmVJbmxpbmVQcm9wZXJ0aWVzKCk7CgkJCQkkcHJvcGVydGllcyA9ICR0aGlzLT5tcGRmLT5jc3NtZ3ItPk1lcmdlQ1NTKCcnLCAkdGFnLCAkYXR0cik7CgkJCQkkb2JqYXR0clsndmVydGljYWwtYWxpZ24nXSA9ICcnOwoKCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snRk9OVC1GQU1JTFknXSkpIHsKCQkJCQkkdGhpcy0+bXBkZi0+U2V0Rm9udCgkcHJvcGVydGllc1snRk9OVC1GQU1JTFknXSwgJHRoaXMtPm1wZGYtPkZvbnRTdHlsZSwgMCwgZmFsc2UpOwoJCQkJfQoJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydGT05ULVNJWkUnXSkpIHsKCQkJCQkkbW1zaXplID0gJHRoaXMtPm1wZGYtPkNvbnZlcnRTaXplKCRwcm9wZXJ0aWVzWydGT05ULVNJWkUnXSwgKCR0aGlzLT5tcGRmLT5kZWZhdWx0X2ZvbnRfc2l6ZSAvIF9NUERGSykpOwoJCQkJCSR0aGlzLT5tcGRmLT5TZXRGb250U2l6ZSgkbW1zaXplICogX01QREZLLCBmYWxzZSk7CgkJCQl9CgkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ0NPTE9SJ10pKSB7CgkJCQkJJG9iamF0dHJbJ2NvbG9yJ10gPSAkdGhpcy0+bXBkZi0+Q29udmVydENvbG9yKCRwcm9wZXJ0aWVzWydDT0xPUiddKTsKCQkJCX0KCQkJCSRvYmphdHRyWydmb250ZmFtaWx5J10gPSAkdGhpcy0+bXBkZi0+Rm9udEZhbWlseTsKCQkJCSRvYmphdHRyWydmb250c2l6ZSddID0gJHRoaXMtPm1wZGYtPkZvbnRTaXplUHQ7CgkJCQlpZiAoJHRoaXMtPm1wZGYtPnVzZUFjdGl2ZUZvcm1zKSB7CgkJCQkJaWYgKGlzc2V0KCRhdHRyWydBTElHTiddKSkgewoJCQkJCQkkb2JqYXR0clsndGV4dF9hbGlnbiddID0gJGFsaWduW3N0cnRvbG93ZXIoJGF0dHJbJ0FMSUdOJ10pXTsKCQkJCQl9IGVsc2UgaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydURVhULUFMSUdOJ10pKSB7CgkJCQkJCSRvYmphdHRyWyd0ZXh0X2FsaWduJ10gPSAkYWxpZ25bc3RydG9sb3dlcigkcHJvcGVydGllc1snVEVYVC1BTElHTiddKV07CgkJCQkJfQoJCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snQk9SREVSLVRPUC1DT0xPUiddKSkgewoJCQkJCQkkb2JqYXR0clsnYm9yZGVyLWNvbCddID0gJHRoaXMtPm1wZGYtPkNvbnZlcnRDb2xvcigkcHJvcGVydGllc1snQk9SREVSLVRPUC1DT0xPUiddKTsKCQkJCQl9CgkJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydCQUNLR1JPVU5ELUNPTE9SJ10pKSB7CgkJCQkJCSRvYmphdHRyWydiYWNrZ3JvdW5kLWNvbCddID0gJHRoaXMtPm1wZGYtPkNvbnZlcnRDb2xvcigkcHJvcGVydGllc1snQkFDS0dST1VORC1DT0xPUiddKTsKCQkJCQl9CgkJCQl9CgoJCQkJJHR5cGUgPSAnJzsKCQkJCSR0ZXh0byA9ICcnOwoJCQkJJGhlaWdodCA9ICR0aGlzLT5tcGRmLT5Gb250U2l6ZTsKCQkJCSR3aWR0aCA9IDA7CgkJCQkkc3BhY2VzaXplID0gJHRoaXMtPm1wZGYtPkdldENoYXJXaWR0aCgnICcsIGZhbHNlKTsKCgkJCQkkdyA9IDA7CgkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ1dJRFRIJ10pKQoJCQkJCSR3ID0gJHRoaXMtPm1wZGYtPkNvbnZlcnRTaXplKCRwcm9wZXJ0aWVzWydXSURUSCddLCAkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWydpbm5lcl93aWR0aCddKTsKCgkJCQlpZiAoJHByb3BlcnRpZXNbJ1ZFUlRJQ0FMLUFMSUdOJ10pIHsKCQkJCQkkb2JqYXR0clsndmVydGljYWwtYWxpZ24nXSA9ICRhbGlnbltzdHJ0b2xvd2VyKCRwcm9wZXJ0aWVzWydWRVJUSUNBTC1BTElHTiddKV07CgkJCQl9CgoJCQkJc3dpdGNoIChzdHJ0b3VwcGVyKCRhdHRyWydUWVBFJ10pKSB7CgkJCQkJY2FzZSAnSElEREVOJzoKCQkJCQkJJHRoaXMtPm1wZGYtPmlnbm9yZWZvbGxvd2luZ3NwYWNlcyA9IHRydWU7IC8vRWxpbWluYXRlIGV4Y2VlZGluZyBsZWZ0LXNpZGUgc3BhY2VzCgkJCQkJCWlmICgkdGhpcy0+bXBkZi0+dXNlQWN0aXZlRm9ybXMpIHsKCQkJCQkJCSR0aGlzLT5tcGRmLT5tcGRmZm9ybS0+U2V0Rm9ybVRleHQoMCwgMCwgJG9iamF0dHJbJ2ZpZWxkbmFtZSddLCAkb2JqYXR0clsndmFsdWUnXSwgJG9iamF0dHJbJ3ZhbHVlJ10sICcnLCAwLCAnJywgdHJ1ZSk7CgkJCQkJCX0KCQkJCQkJaWYgKCR0aGlzLT5tcGRmLT5JbmxpbmVQcm9wZXJ0aWVzWyR0YWddKSB7CgkJCQkJCQkkdGhpcy0+bXBkZi0+cmVzdG9yZUlubGluZVByb3BlcnRpZXMoJHRoaXMtPm1wZGYtPklubGluZVByb3BlcnRpZXNbJHRhZ10pOwoJCQkJCQl9CgkJCQkJCXVuc2V0KCR0aGlzLT5tcGRmLT5JbmxpbmVQcm9wZXJ0aWVzWyR0YWddKTsKCQkJCQkJYnJlYWsgMjsKCQkJCQljYXNlICdDSEVDS0JPWCc6IC8vRHJhdyBDaGVja2JveAoJCQkJCQkkdHlwZSA9ICdDSEVDS0JPWCc7CgkJCQkJCWlmIChpc3NldCgkYXR0clsnQ0hFQ0tFRCddKSkgewoJCQkJCQkJJG9iamF0dHJbJ2NoZWNrZWQnXSA9IHRydWU7CgkJCQkJCX0gZWxzZSB7CgkJCQkJCQkkb2JqYXR0clsnY2hlY2tlZCddID0gZmFsc2U7CgkJCQkJCX0KCQkJCQkJJHdpZHRoID0gJHRoaXMtPm1wZGYtPkZvbnRTaXplOwoJCQkJCQkkaGVpZ2h0ID0gJHRoaXMtPm1wZGYtPkZvbnRTaXplOwoJCQkJCQlicmVhazsKCgkJCQkJY2FzZSAnUkFESU8nOiAvL0RyYXcgUmFkaW8gYnV0dG9uCgkJCQkJCSR0eXBlID0gJ1JBRElPJzsKCQkJCQkJaWYgKGlzc2V0KCRhdHRyWydDSEVDS0VEJ10pKQoJCQkJCQkJJG9iamF0dHJbJ2NoZWNrZWQnXSA9IHRydWU7CgkJCQkJCSR3aWR0aCA9ICR0aGlzLT5tcGRmLT5Gb250U2l6ZTsKCQkJCQkJJGhlaWdodCA9ICR0aGlzLT5tcGRmLT5Gb250U2l6ZTsKCQkJCQkJYnJlYWs7CgoJCQkJCS8qIC0tIElNQUdFUy1DT1JFIC0tICovCgkJCQkJY2FzZSAnSU1BR0UnOiAvLyBEcmF3IGFuIEltYWdlIGJ1dHRvbgoJCQkJCQlpZiAoaXNzZXQoJGF0dHJbJ1NSQyddKSkgewoJCQkJCQkJJHR5cGUgPSAnSU1BR0UnOwoJCQkJCQkJJHNyY3BhdGggPSAkYXR0clsnU1JDJ107CgkJCQkJCQkkb3JpZ19zcmNwYXRoID0gJGF0dHJbJ09SSUdfU1JDJ107CgkJCQkJCQkvLyBWU1BBQ0UgYW5kIEhTUEFDRSBjb252ZXJ0ZWQgdG8gbWFyZ2lucyBpbiBNZXJnZUNTUwoJCQkJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydNQVJHSU4tVE9QJ10pKSB7CgkJCQkJCQkJJG9iamF0dHJbJ21hcmdpbl90b3AnXSA9ICR0aGlzLT5tcGRmLT5Db252ZXJ0U2l6ZSgkcHJvcGVydGllc1snTUFSR0lOLVRPUCddLCAkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWydpbm5lcl93aWR0aCddLCAkdGhpcy0+bXBkZi0+Rm9udFNpemUsIGZhbHNlKTsKCQkJCQkJCX0KCQkJCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snTUFSR0lOLUJPVFRPTSddKSkgewoJCQkJCQkJCSRvYmphdHRyWydtYXJnaW5fYm90dG9tJ10gPSAkdGhpcy0+bXBkZi0+Q29udmVydFNpemUoJHByb3BlcnRpZXNbJ01BUkdJTi1CT1RUT00nXSwgJHRoaXMtPm1wZGYtPmJsa1skdGhpcy0+bXBkZi0+YmxrbHZsXVsnaW5uZXJfd2lkdGgnXSwgJHRoaXMtPm1wZGYtPkZvbnRTaXplLCBmYWxzZSk7CgkJCQkJCQl9CgkJCQkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ01BUkdJTi1MRUZUJ10pKSB7CgkJCQkJCQkJJG9iamF0dHJbJ21hcmdpbl9sZWZ0J10gPSAkdGhpcy0+bXBkZi0+Q29udmVydFNpemUoJHByb3BlcnRpZXNbJ01BUkdJTi1MRUZUJ10sICR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ2lubmVyX3dpZHRoJ10sICR0aGlzLT5tcGRmLT5Gb250U2l6ZSwgZmFsc2UpOwoJCQkJCQkJfQoJCQkJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydNQVJHSU4tUklHSFQnXSkpIHsKCQkJCQkJCQkkb2JqYXR0clsnbWFyZ2luX3JpZ2h0J10gPSAkdGhpcy0+bXBkZi0+Q29udmVydFNpemUoJHByb3BlcnRpZXNbJ01BUkdJTi1SSUdIVCddLCAkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWydpbm5lcl93aWR0aCddLCAkdGhpcy0+bXBkZi0+Rm9udFNpemUsIGZhbHNlKTsKCQkJCQkJCX0KCgoJCQkJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydCT1JERVItVE9QJ10pKSB7CgkJCQkJCQkJJG9iamF0dHJbJ2JvcmRlcl90b3AnXSA9ICR0aGlzLT5tcGRmLT5ib3JkZXJfZGV0YWlscygkcHJvcGVydGllc1snQk9SREVSLVRPUCddKTsKCQkJCQkJCX0KCQkJCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snQk9SREVSLUJPVFRPTSddKSkgewoJCQkJCQkJCSRvYmphdHRyWydib3JkZXJfYm90dG9tJ10gPSAkdGhpcy0+bXBkZi0+Ym9yZGVyX2RldGFpbHMoJHByb3BlcnRpZXNbJ0JPUkRFUi1CT1RUT00nXSk7CgkJCQkJCQl9CgkJCQkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ0JPUkRFUi1MRUZUJ10pKSB7CgkJCQkJCQkJJG9iamF0dHJbJ2JvcmRlcl9sZWZ0J10gPSAkdGhpcy0+bXBkZi0+Ym9yZGVyX2RldGFpbHMoJHByb3BlcnRpZXNbJ0JPUkRFUi1MRUZUJ10pOwoJCQkJCQkJfQoJCQkJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydCT1JERVItUklHSFQnXSkpIHsKCQkJCQkJCQkkb2JqYXR0clsnYm9yZGVyX3JpZ2h0J10gPSAkdGhpcy0+bXBkZi0+Ym9yZGVyX2RldGFpbHMoJHByb3BlcnRpZXNbJ0JPUkRFUi1SSUdIVCddKTsKCQkJCQkJCX0KCgkJCQkJCQkkb2JqYXR0clsncGFkZGluZ190b3AnXSA9IDA7CgkJCQkJCQkkb2JqYXR0clsncGFkZGluZ19ib3R0b20nXSA9IDA7CgkJCQkJCQkkb2JqYXR0clsncGFkZGluZ19sZWZ0J10gPSAwOwoJCQkJCQkJJG9iamF0dHJbJ3BhZGRpbmdfcmlnaHQnXSA9IDA7CgoJCQkJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydWRVJUSUNBTC1BTElHTiddKSkgewoJCQkJCQkJCSRvYmphdHRyWyd2ZXJ0aWNhbC1hbGlnbiddID0gJGFsaWduW3N0cnRvbG93ZXIoJHByb3BlcnRpZXNbJ1ZFUlRJQ0FMLUFMSUdOJ10pXTsKCQkJCQkJCX0KCgkJCQkJCQkkdyA9IDA7CgkJCQkJCQkkaCA9IDA7CgkJCQkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ1dJRFRIJ10pKQoJCQkJCQkJCSR3ID0gJHRoaXMtPm1wZGYtPkNvbnZlcnRTaXplKCRwcm9wZXJ0aWVzWydXSURUSCddLCAkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWydpbm5lcl93aWR0aCddKTsKCQkJCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snSEVJR0hUJ10pKQoJCQkJCQkJCSRoID0gJHRoaXMtPm1wZGYtPkNvbnZlcnRTaXplKCRwcm9wZXJ0aWVzWydIRUlHSFQnXSwgJHRoaXMtPm1wZGYtPmJsa1skdGhpcy0+bXBkZi0+YmxrbHZsXVsnaW5uZXJfd2lkdGgnXSk7CgoJCQkJCQkJJGV4dHJhaGVpZ2h0ID0gJG9iamF0dHJbJ21hcmdpbl90b3AnXSArICRvYmphdHRyWydtYXJnaW5fYm90dG9tJ10gKyAkb2JqYXR0clsnYm9yZGVyX3RvcCddWyd3J10gKyAkb2JqYXR0clsnYm9yZGVyX2JvdHRvbSddWyd3J107CgkJCQkJCQkkZXh0cmF3aWR0aCA9ICRvYmphdHRyWydtYXJnaW5fbGVmdCddICsgJG9iamF0dHJbJ21hcmdpbl9yaWdodCddICsgJG9iamF0dHJbJ2JvcmRlcl9sZWZ0J11bJ3cnXSArICRvYmphdHRyWydib3JkZXJfcmlnaHQnXVsndyddOwoKCQkJCQkJCS8vIEltYWdlIGZpbGUKCQkJCQkJCSRpbmZvID0gJHRoaXMtPm1wZGYtPl9nZXRJbWFnZSgkc3JjcGF0aCwgdHJ1ZSwgdHJ1ZSwgJG9yaWdfc3JjcGF0aCk7CgkJCQkJCQlpZiAoISRpbmZvKSB7CgkJCQkJCQkJJGluZm8gPSAkdGhpcy0+bXBkZi0+X2dldEltYWdlKCR0aGlzLT5tcGRmLT5ub0ltYWdlRmlsZSk7CgkJCQkJCQkJaWYgKCRpbmZvKSB7CgkJCQkJCQkJCSRzcmNwYXRoID0gJHRoaXMtPm1wZGYtPm5vSW1hZ2VGaWxlOwoJCQkJCQkJCQkkdyA9ICgkaW5mb1sndyddICogKDI1LjQgLyAkdGhpcy0+bXBkZi0+ZHBpKSk7CgkJCQkJCQkJCSRoID0gKCRpbmZvWydoJ10gKiAoMjUuNCAvICR0aGlzLT5tcGRmLT5kcGkpKTsKCQkJCQkJCQl9CgkJCQkJCQl9CgkJCQkJCQlpZiAoISRpbmZvKQoJCQkJCQkJCWJyZWFrOwoJCQkJCQkJaWYgKCRpbmZvWydjcyddID09ICdJbmRleGVkJykgewoJCQkJCQkJCSRvYmphdHRyWydJbmRleGVkJ10gPSB0cnVlOwoJCQkJCQkJfQoJCQkJCQkJJG9iamF0dHJbJ2ZpbGUnXSA9ICRzcmNwYXRoOwoJCQkJCQkJLy9EZWZhdWx0IHdpZHRoIGFuZCBoZWlnaHQgY2FsY3VsYXRpb24gaWYgbmVlZGVkCgkJCQkJCQlpZiAoJHcgPT0gMCBhbmQgJGggPT0gMCkgewoJCQkJCQkJCS8qIC0tIElNQUdFUy1XTUYgLS0gKi8KCQkJCQkJCQlpZiAoJGluZm9bJ3R5cGUnXSA9PSAnd21mJykgewoJCQkJCQkJCQkvLyBXTUYgdW5pdHMgYXJlIHR3aXBzICgxLzIwcHQpCgkJCQkJCQkJCS8vIGRpdmlkZSBieSAyMCB0byBnZXQgcG9pbnRzCgkJCQkJCQkJCS8vIGRpdmlkZSBieSBrIHRvIGdldCB1c2VyIHVuaXRzCgkJCQkJCQkJCSR3ID0gYWJzKCRpbmZvWyd3J10pIC8gKDIwICogX01QREZLKTsKCQkJCQkJCQkJJGggPSBhYnMoJGluZm9bJ2gnXSkgLyAoMjAgKiBfTVBERkspOwoJCQkJCQkJCX0gZWxzZQoJCQkJCQkJCQkvKiAtLSBFTkQgSU1BR0VTLVdNRiAtLSAqLwoJCQkJCQkJCQlpZiAoJGluZm9bJ3R5cGUnXSA9PSAnc3ZnJykgewoJCQkJCQkJCQkJLy8gU1ZHIHVuaXRzIGFyZSBwaXhlbHMKCQkJCQkJCQkJCSR3ID0gYWJzKCRpbmZvWyd3J10pIC8gX01QREZLOwoJCQkJCQkJCQkJJGggPSBhYnMoJGluZm9bJ2gnXSkgLyBfTVBERks7CgkJCQkJCQkJCX0gZWxzZSB7CgkJCQkJCQkJCQkvL1B1dCBpbWFnZSBhdCBkZWZhdWx0IGltYWdlIGRwaQoJCQkJCQkJCQkJJHcgPSAoJGluZm9bJ3cnXSAvIF9NUERGSykgKiAoNzIgLyAkdGhpcy0+bXBkZi0+aW1nX2RwaSk7CgkJCQkJCQkJCQkkaCA9ICgkaW5mb1snaCddIC8gX01QREZLKSAqICg3MiAvICR0aGlzLT5tcGRmLT5pbWdfZHBpKTsKCQkJCQkJCQkJfQoJCQkJCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snSU1BR0UtUkVTT0xVVElPTiddKSkgewoJCQkJCQkJCQlpZiAocHJlZ19tYXRjaCgnL2Zyb20taW1hZ2UvaScsICRwcm9wZXJ0aWVzWydJTUFHRS1SRVNPTFVUSU9OJ10pICYmIGlzc2V0KCRpbmZvWydzZXQtZHBpJ10pICYmICRpbmZvWydzZXQtZHBpJ10gPiAwKSB7CgkJCQkJCQkJCQkkdyAqPSAkdGhpcy0+bXBkZi0+aW1nX2RwaSAvICRpbmZvWydzZXQtZHBpJ107CgkJCQkJCQkJCQkkaCAqPSAkdGhpcy0+bXBkZi0+aW1nX2RwaSAvICRpbmZvWydzZXQtZHBpJ107CgkJCQkJCQkJCX0gZWxzZSBpZiAocHJlZ19tYXRjaCgnLyhcZCspZHBpL2knLCAkcHJvcGVydGllc1snSU1BR0UtUkVTT0xVVElPTiddLCAkbSkpIHsKCQkJCQkJCQkJCSRkcGkgPSAkbVsxXTsKCQkJCQkJCQkJCWlmICgkZHBpID4gMCkgewoJCQkJCQkJCQkJCSR3ICo9ICR0aGlzLT5tcGRmLT5pbWdfZHBpIC8gJGRwaTsKCQkJCQkJCQkJCQkkaCAqPSAkdGhpcy0+bXBkZi0+aW1nX2RwaSAvICRkcGk7CgkJCQkJCQkJCQl9CgkJCQkJCQkJCX0KCQkJCQkJCQl9CgkJCQkJCQl9CgkJCQkJCQkvLyBJRiBXSURUSCBPUiBIRUlHSFQgU1BFQ0lGSUVECgkJCQkJCQlpZiAoJHcgPT0gMCkKCQkJCQkJCQkkdyA9ICRoICogJGluZm9bJ3cnXSAvICRpbmZvWydoJ107CgkJCQkJCQlpZiAoJGggPT0gMCkKCQkJCQkJCQkkaCA9ICR3ICogJGluZm9bJ2gnXSAvICRpbmZvWyd3J107CgkJCQkJCQkvLyBSZXNpemUgdG8gbWF4aW11bSBkaW1lbnNpb25zIG9mIHBhZ2UKCQkJCQkJCSRtYXhXaWR0aCA9ICR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ2lubmVyX3dpZHRoJ107CgkJCQkJCQkkbWF4SGVpZ2h0ID0gJHRoaXMtPm1wZGYtPmggLSAoJHRoaXMtPm1wZGYtPnRNYXJnaW4gKyAkdGhpcy0+bXBkZi0+Yk1hcmdpbiArIDEwKTsKCQkJCQkJCWlmICgkdGhpcy0+bXBkZi0+ZnVsbEltYWdlSGVpZ2h0KSB7CgkJCQkJCQkJJG1heEhlaWdodCA9ICR0aGlzLT5tcGRmLT5mdWxsSW1hZ2VIZWlnaHQ7CgkJCQkJCQl9CgkJCQkJCQlpZiAoKCR3ICsgJGV4dHJhd2lkdGgpID4gKCRtYXhXaWR0aCArIDAuMDAwMSkpIHsgLy8gbVBERiA1LjcuNCAgMC4wMDAxIHRvIGFsbG93IGZvciByb3VuZGluZyBlcnJvcnMgd2hlbiB3PT1tYXhXaWR0aAoJCQkJCQkJCSR3ID0gJG1heFdpZHRoIC0gJGV4dHJhd2lkdGg7CgkJCQkJCQkJJGggPSAkdyAqICRpbmZvWydoJ10gLyAkaW5mb1sndyddOwoJCQkJCQkJfQoJCQkJCQkJaWYgKCRoICsgJGV4dHJhaGVpZ2h0ID4gJG1heEhlaWdodCkgewoJCQkJCQkJCSRoID0gJG1heEhlaWdodCAtICRleHRyYWhlaWdodDsKCQkJCQkJCQkkdyA9ICRoICogJGluZm9bJ3cnXSAvICRpbmZvWydoJ107CgkJCQkJCQl9CgkJCQkJCQkkaGVpZ2h0ID0gJGggKyAkZXh0cmFoZWlnaHQ7CgkJCQkJCQkkd2lkdGggPSAkdyArICRleHRyYXdpZHRoOwoJCQkJCQkJJG9iamF0dHJbJ3R5cGUnXSA9ICdpbWFnZSc7CgkJCQkJCQkkb2JqYXR0clsnaXR5cGUnXSA9ICRpbmZvWyd0eXBlJ107CgkJCQkJCQkkb2JqYXR0clsnb3JpZ19oJ10gPSAkaW5mb1snaCddOwoJCQkJCQkJJG9iamF0dHJbJ29yaWdfdyddID0gJGluZm9bJ3cnXTsKCQkJCQkJCS8qIC0tIElNQUdFUy1XTUYgLS0gKi8KCQkJCQkJCWlmICgkaW5mb1sndHlwZSddID09ICd3bWYnKSB7CgkJCQkJCQkJJG9iamF0dHJbJ3dtZl94J10gPSAkaW5mb1sneCddOwoJCQkJCQkJCSRvYmphdHRyWyd3bWZfeSddID0gJGluZm9bJ3knXTsKCQkJCQkJCX0gZWxzZQoJCQkJCQkJCS8qIC0tIEVORCBJTUFHRVMtV01GIC0tICovCgkJCQkJCQkJaWYgKCRpbmZvWyd0eXBlJ10gPT0gJ3N2ZycpIHsKCQkJCQkJCQkJJG9iamF0dHJbJ3dtZl94J10gPSAkaW5mb1sneCddOwoJCQkJCQkJCQkkb2JqYXR0clsnd21mX3knXSA9ICRpbmZvWyd5J107CgkJCQkJCQkJfQoJCQkJCQkJJG9iamF0dHJbJ2hlaWdodCddID0gJGggKyAkZXh0cmFoZWlnaHQ7CgkJCQkJCQkkb2JqYXR0clsnd2lkdGgnXSA9ICR3ICsgJGV4dHJhd2lkdGg7CgoJCQkJCQkJJG9iamF0dHJbJ2ltYWdlX2hlaWdodCddID0gJGg7CgkJCQkJCQkkb2JqYXR0clsnaW1hZ2Vfd2lkdGgnXSA9ICR3OwoJCQkJCQkJJG9iamF0dHJbJ0lEJ10gPSAkaW5mb1snaSddOwoJCQkJCQkJJHRleHRvID0gJ1gnOwoJCQkJCQkJaWYgKCR0aGlzLT5tcGRmLT51c2VBY3RpdmVGb3JtcykgewoJCQkJCQkJCWlmIChpc3NldCgkYXR0clsnT05DTElDSyddKSkgewoJCQkJCQkJCQkkb2JqYXR0clsnb25DbGljayddID0gJGF0dHJbJ09OQ0xJQ0snXTsKCQkJCQkJCQl9CgkJCQkJCQkJJG9iamF0dHJbJ3R5cGUnXSA9ICdpbnB1dCc7CgkJCQkJCQkJJHR5cGUgPSAnSU1BR0UnOwoJCQkJCQkJfQoJCQkJCQkJYnJlYWs7CgkJCQkJCX0KCQkJCQkvKiAtLSBFTkQgSU1BR0VTLUNPUkUgLS0gKi8KCgkJCQkJY2FzZSAnQlVUVE9OJzogLy8gRHJhdyBhIGJ1dHRvbgoJCQkJCWNhc2UgJ1NVQk1JVCc6CgkJCQkJY2FzZSAnUkVTRVQnOgoJCQkJCQkkdHlwZSA9IHN0cnRvdXBwZXIoJGF0dHJbJ1RZUEUnXSk7CgkJCQkJCWlmICgkdHlwZSA9PSAnSU1BR0UnKSB7CgkJCQkJCQkkdHlwZSA9ICdCVVRUT04nOwoJCQkJCQl9IC8vIHNyYyBwYXRoIG5vdCBmb3VuZAoJCQkJCQlpZiAoaXNzZXQoJGF0dHJbJ05PUFJJTlQnXSkpIHsKCQkJCQkJCSRvYmphdHRyWydub3ByaW50J10gPSB0cnVlOwoJCQkJCQl9CgkJCQkJCWlmICghaXNzZXQoJGF0dHJbJ1ZBTFVFJ10pKSB7CgkJCQkJCQkkb2JqYXR0clsndmFsdWUnXSA9IHVjZmlyc3Qoc3RydG9sb3dlcigkdHlwZSkpOwoJCQkJCQl9CgoJCQkJCQkkdGV4dG8gPSAiICIgLiAkb2JqYXR0clsndmFsdWUnXSAuICIgIjsKCQkJCQkJJHdpZHRoID0gJHRoaXMtPm1wZGYtPkdldFN0cmluZ1dpZHRoKCR0ZXh0bykgKyAoJHRoaXMtPm1wZGYtPm1wZGZmb3JtLT5mb3JtX2VsZW1lbnRfc3BhY2luZ1snYnV0dG9uJ11bJ291dGVyJ11bJ2gnXSAqIDIpICsgKCR0aGlzLT5tcGRmLT5tcGRmZm9ybS0+Zm9ybV9lbGVtZW50X3NwYWNpbmdbJ2J1dHRvbiddWydpbm5lciddWydoJ10gKiAyKTsKCQkJCQkJJGhlaWdodCA9ICR0aGlzLT5tcGRmLT5Gb250U2l6ZSArICgkdGhpcy0+bXBkZi0+bXBkZmZvcm0tPmZvcm1fZWxlbWVudF9zcGFjaW5nWydidXR0b24nXVsnb3V0ZXInXVsndiddICogMikgKyAoJHRoaXMtPm1wZGYtPm1wZGZmb3JtLT5mb3JtX2VsZW1lbnRfc3BhY2luZ1snYnV0dG9uJ11bJ2lubmVyJ11bJ3YnXSAqIDIpOwoJCQkJCQlpZiAoJHRoaXMtPm1wZGYtPnVzZUFjdGl2ZUZvcm1zKSB7CgkJCQkJCQlpZiAoaXNzZXQoJGF0dHJbJ09OQ0xJQ0snXSkpIHsKCQkJCQkJCQkkb2JqYXR0clsnb25DbGljayddID0gJGF0dHJbJ09OQ0xJQ0snXTsKCQkJCQkJCX0KCQkJCQkJfQoJCQkJCQlicmVhazsKCgkJCQkJY2FzZSAnUEFTU1dPUkQnOgoJCQkJCWNhc2UgJ1RFWFQnOgoJCQkJCWRlZmF1bHQ6CgkJCQkJCWlmICgkdHlwZSA9PSAnJykgewoJCQkJCQkJJHR5cGUgPSAnVEVYVCc7CgkJCQkJCX0KCQkJCQkJaWYgKHN0cnRvdXBwZXIoJGF0dHJbJ1RZUEUnXSkgPT0gJ1BBU1NXT1JEJykgewoJCQkJCQkJJHR5cGUgPSAnUEFTU1dPUkQnOwoJCQkJCQl9CgkJCQkJCWlmIChpc3NldCgkYXR0clsnVkFMVUUnXSkpIHsKCQkJCQkJCWlmICgkdHlwZSA9PSAnUEFTU1dPUkQnKSB7CgkJCQkJCQkJJG51bV9zdGFycyA9IG1iX3N0cmxlbigkYXR0clsnVkFMVUUnXSwgJHRoaXMtPm1wZGYtPm1iX2VuYyk7CgkJCQkJCQkJJHRleHRvID0gc3RyX3JlcGVhdCgnKicsICRudW1fc3RhcnMpOwoJCQkJCQkJfSBlbHNlIHsKCQkJCQkJCQkkdGV4dG8gPSAkYXR0clsnVkFMVUUnXTsKCQkJCQkJCX0KCQkJCQkJfQoJCQkJCQkkeHcgPSAoJHRoaXMtPm1wZGYtPm1wZGZmb3JtLT5mb3JtX2VsZW1lbnRfc3BhY2luZ1snaW5wdXQnXVsnb3V0ZXInXVsnaCddICogMikgKyAoJHRoaXMtPm1wZGYtPm1wZGZmb3JtLT5mb3JtX2VsZW1lbnRfc3BhY2luZ1snaW5wdXQnXVsnaW5uZXInXVsnaCddICogMik7CgkJCQkJCSR4aCA9ICgkdGhpcy0+bXBkZi0+bXBkZmZvcm0tPmZvcm1fZWxlbWVudF9zcGFjaW5nWydpbnB1dCddWydvdXRlciddWyd2J10gKiAyKSArICgkdGhpcy0+bXBkZi0+bXBkZmZvcm0tPmZvcm1fZWxlbWVudF9zcGFjaW5nWydpbnB1dCddWydpbm5lciddWyd2J10gKiAyKTsKCQkJCQkJaWYgKCR3KSB7CgkJCQkJCQkkd2lkdGggPSAkdyArICR4dzsKCQkJCQkJfSBlbHNlIHsKCQkJCQkJCSR3aWR0aCA9ICgyMCAqICRzcGFjZXNpemUpICsgJHh3OwoJCQkJCQl9IC8vIERlZmF1bHQgd2lkdGggaW4gY2hhcnMKCQkJCQkJaWYgKGlzc2V0KCRhdHRyWydTSVpFJ10pIGFuZCBjdHlwZV9kaWdpdCgkYXR0clsnU0laRSddKSkKCQkJCQkJCSR3aWR0aCA9ICgkYXR0clsnU0laRSddICogJHNwYWNlc2l6ZSkgKyAkeHc7CgkJCQkJCSRoZWlnaHQgPSAkdGhpcy0+bXBkZi0+Rm9udFNpemUgKyAkeGg7CgkJCQkJCWlmIChpc3NldCgkYXR0clsnTUFYTEVOR1RIJ10pIGFuZCBjdHlwZV9kaWdpdCgkYXR0clsnTUFYTEVOR1RIJ10pKQoJCQkJCQkJJG9iamF0dHJbJ21heGxlbmd0aCddID0gJGF0dHJbJ01BWExFTkdUSCddOwoJCQkJCQlpZiAoJHRoaXMtPm1wZGYtPnVzZUFjdGl2ZUZvcm1zKSB7CgkJCQkJCQlpZiAoaXNzZXQoJGF0dHJbJ09OQ0FMQ1VMQVRFJ10pKSB7CgkJCQkJCQkJJG9iamF0dHJbJ29uQ2FsY3VsYXRlJ10gPSAkYXR0clsnT05DQUxDVUxBVEUnXTsKCQkJCQkJCX0gZWxzZSBpZiAoaXNzZXQoJGF0dHJbJ09OQ0hBTkdFJ10pKSB7CgkJCQkJCQkJJG9iamF0dHJbJ29uQ2FsY3VsYXRlJ10gPSAkYXR0clsnT05DSEFOR0UnXTsKCQkJCQkJCX0KCQkJCQkJCWlmIChpc3NldCgkYXR0clsnT05WQUxJREFURSddKSkgewoJCQkJCQkJCSRvYmphdHRyWydvblZhbGlkYXRlJ10gPSAkYXR0clsnT05WQUxJREFURSddOwoJCQkJCQkJfQoJCQkJCQkJaWYgKGlzc2V0KCRhdHRyWydPTktFWVNUUk9LRSddKSkgewoJCQkJCQkJCSRvYmphdHRyWydvbktleXN0cm9rZSddID0gJGF0dHJbJ09OS0VZU1RST0tFJ107CgkJCQkJCQl9CgkJCQkJCQlpZiAoaXNzZXQoJGF0dHJbJ09ORk9STUFUJ10pKSB7CgkJCQkJCQkJJG9iamF0dHJbJ29uRm9ybWF0J10gPSAkYXR0clsnT05GT1JNQVQnXTsKCQkJCQkJCX0KCQkJCQkJfQoJCQkJCQlicmVhazsKCQkJCX0KCgkJCQkkb2JqYXR0clsnc3VidHlwZSddID0gJHR5cGU7CgkJCQkkb2JqYXR0clsndGV4dCddID0gJHRleHRvOwoJCQkJJG9iamF0dHJbJ3dpZHRoJ10gPSAkd2lkdGg7CgkJCQkkb2JqYXR0clsnaGVpZ2h0J10gPSAkaGVpZ2h0OwoJCQkJJGUgPSAiXHhiYlx4YTRceGFjdHlwZT1pbnB1dCxvYmphdHRyPSIgLiBzZXJpYWxpemUoJG9iamF0dHIpIC4gIlx4YmJceGE0XHhhYyI7CgoJCQkJLy8gQ2xlYXIgcHJvcGVydGllcyAtIHRpZHkgdXAKCQkJCSRwcm9wZXJ0aWVzID0gYXJyYXkoKTsKCgkJCQkvKiAtLSBUQUJMRVMgLS0gKi8KCQkJCS8vIE91dHB1dCBpdCB0byBidWZmZXJzCgkJCQlpZiAoJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWwpIHsKCQkJCQkkdGhpcy0+bXBkZi0+X3NhdmVDZWxsVGV4dEJ1ZmZlcigkZSwgJHRoaXMtPm1wZGYtPkhSRUYpOwoJCQkJCSR0aGlzLT5tcGRmLT5jZWxsWyR0aGlzLT5tcGRmLT5yb3ddWyR0aGlzLT5tcGRmLT5jb2xdWydzJ10gKz0gJG9iamF0dHJbJ3dpZHRoJ107CgkJCQl9IGVsc2UgewoJCQkJCS8qIC0tIEVORCBUQUJMRVMgLS0gKi8KCQkJCQkkdGhpcy0+bXBkZi0+X3NhdmVUZXh0QnVmZmVyKCRlLCAkdGhpcy0+bXBkZi0+SFJFRik7CgkJCQl9IC8vICpUQUJMRVMqCgoJCQkJaWYgKCR0aGlzLT5tcGRmLT5JbmxpbmVQcm9wZXJ0aWVzWyR0YWddKSB7CgkJCQkJJHRoaXMtPm1wZGYtPnJlc3RvcmVJbmxpbmVQcm9wZXJ0aWVzKCR0aGlzLT5tcGRmLT5JbmxpbmVQcm9wZXJ0aWVzWyR0YWddKTsKCQkJCX0KCQkJCXVuc2V0KCR0aGlzLT5tcGRmLT5JbmxpbmVQcm9wZXJ0aWVzWyR0YWddKTsKCgkJCQlicmVhazsgLy8gRU5EIG9mIElOUFVUCgkJCS8qIC0tIEVORCBGT1JNUyAtLSAqLwoKCgkJCS8vICoqKioqKioqKioqIEdSQVBIICAqKioqKioqKioqKioqKioqKioqKgoJCQljYXNlICdKUEdSQVBIJzoKCQkJCWlmICghJHRoaXMtPm1wZGYtPnVzZUdyYXBocykgewoJCQkJCWJyZWFrOwoJCQkJfQoJCQkJaWYgKCRhdHRyWydUQUJMRSddKSB7CgkJCQkJJGdpZCA9IHN0cnRvdXBwZXIoJGF0dHJbJ1RBQkxFJ10pOwoJCQkJfSBlbHNlIHsKCQkJCQkkZ2lkID0gJzAnOwoJCQkJfQoJCQkJaWYgKCFpc19hcnJheSgkdGhpcy0+bXBkZi0+Z3JhcGhzWyRnaWRdKSB8fCBjb3VudCgkdGhpcy0+bXBkZi0+Z3JhcGhzWyRnaWRdKSA9PSAwKSB7CgkJCQkJYnJlYWs7CgkJCQl9CgkJCQkkdGhpcy0+bXBkZi0+aWdub3JlZm9sbG93aW5nc3BhY2VzID0gZmFsc2U7CgkJCQlpbmNsdWRlX29uY2UoX01QREZfUEFUSCAuICdncmFwaC5waHAnKTsKCQkJCSR0aGlzLT5tcGRmLT5ncmFwaHNbJGdpZF1bJ2F0dHInXSA9ICRhdHRyOwoKCgkJCQlpZiAoaXNzZXQoJHRoaXMtPm1wZGYtPmdyYXBoc1skZ2lkXVsnYXR0ciddWydXSURUSCddKSAmJiAkdGhpcy0+bXBkZi0+Z3JhcGhzWyRnaWRdWydhdHRyJ11bJ1dJRFRIJ10pIHsKCQkJCQkkdGhpcy0+bXBkZi0+Z3JhcGhzWyRnaWRdWydhdHRyJ11bJ2NXSURUSCddID0gJHRoaXMtPm1wZGYtPkNvbnZlcnRTaXplKCR0aGlzLT5tcGRmLT5ncmFwaHNbJGdpZF1bJ2F0dHInXVsnV0lEVEgnXSwgJHRoaXMtPm1wZGYtPmJsa1skdGhpcy0+bXBkZi0+YmxrbHZsXVsnaW5uZXJfd2lkdGgnXSk7CgkJCQl9IC8vIG1tCgkJCQlpZiAoaXNzZXQoJHRoaXMtPm1wZGYtPmdyYXBoc1skZ2lkXVsnYXR0ciddWydIRUlHSFQnXSkgJiYgJHRoaXMtPm1wZGYtPmdyYXBoc1skZ2lkXVsnYXR0ciddWydIRUlHSFQnXSkgewoJCQkJCSR0aGlzLT5tcGRmLT5ncmFwaHNbJGdpZF1bJ2F0dHInXVsnY0hFSUdIVCddID0gJHRoaXMtPm1wZGYtPkNvbnZlcnRTaXplKCR0aGlzLT5tcGRmLT5ncmFwaHNbJGdpZF1bJ2F0dHInXVsnSEVJR0hUJ10sICR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ2lubmVyX3dpZHRoJ10pOwoJCQkJfQoKCQkJCSRncmFwaF9pbWcgPSBwcmludF9ncmFwaCgkdGhpcy0+bXBkZi0+Z3JhcGhzWyRnaWRdLCAkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWydpbm5lcl93aWR0aCddKTsKCQkJCWlmICgkZ3JhcGhfaW1nKSB7CgkJCQkJaWYgKGlzc2V0KCRhdHRyWydST1RBVEUnXSkpIHsKCQkJCQkJaWYgKCRhdHRyWydST1RBVEUnXSA9PSA5MCB8fCAkYXR0clsnUk9UQVRFJ10gPT0gLTkwKSB7CgkJCQkJCQkkdG1wdyA9ICRncmFwaF9pbWdbJ3cnXTsKCQkJCQkJCSRncmFwaF9pbWdbJ3cnXSA9ICRncmFwaF9pbWdbJ2gnXTsKCQkJCQkJCSRncmFwaF9pbWdbJ2gnXSA9ICR0bXB3OwoJCQkJCQl9CgkJCQkJfQoJCQkJCSRhdHRyWydTUkMnXSA9ICRncmFwaF9pbWdbJ2ZpbGUnXTsKCQkJCQkkYXR0clsnV0lEVEgnXSA9ICRncmFwaF9pbWdbJ3cnXTsKCQkJCQkkYXR0clsnSEVJR0hUJ10gPSAkZ3JhcGhfaW1nWydoJ107CgkJCQl9IGVsc2UgewoJCQkJCWJyZWFrOwoJCQkJfQoKCQkJLy8gKioqKioqKioqKiogSU1BR0UgICoqKioqKioqKioqKioqKioqKioqCgkJCS8qIC0tIElNQUdFUy1DT1JFIC0tICovCgkJCWNhc2UgJ0lNRyc6CgkJCQkkdGhpcy0+bXBkZi0+aWdub3JlZm9sbG93aW5nc3BhY2VzID0gZmFsc2U7CgkJCQlpZiAoJHRoaXMtPm1wZGYtPnByb2dyZXNzQmFyKSB7CgkJCQkJJHRoaXMtPm1wZGYtPlVwZGF0ZVByb2dyZXNzQmFyKDEsICcnLCAnSU1HJyk7CgkJCQl9IC8vICpQUk9HUkVTUy1CQVIqCgkJCQkkb2JqYXR0ciA9IGFycmF5KCk7CgkJCQkkb2JqYXR0clsnbWFyZ2luX3RvcCddID0gMDsKCQkJCSRvYmphdHRyWydtYXJnaW5fYm90dG9tJ10gPSAwOwoJCQkJJG9iamF0dHJbJ21hcmdpbl9sZWZ0J10gPSAwOwoJCQkJJG9iamF0dHJbJ21hcmdpbl9yaWdodCddID0gMDsKCQkJCSRvYmphdHRyWydwYWRkaW5nX3RvcCddID0gMDsKCQkJCSRvYmphdHRyWydwYWRkaW5nX2JvdHRvbSddID0gMDsKCQkJCSRvYmphdHRyWydwYWRkaW5nX2xlZnQnXSA9IDA7CgkJCQkkb2JqYXR0clsncGFkZGluZ19yaWdodCddID0gMDsKCQkJCSRvYmphdHRyWyd3aWR0aCddID0gMDsKCQkJCSRvYmphdHRyWydoZWlnaHQnXSA9IDA7CgkJCQkkb2JqYXR0clsnYm9yZGVyX3RvcCddWyd3J10gPSAwOwoJCQkJJG9iamF0dHJbJ2JvcmRlcl9ib3R0b20nXVsndyddID0gMDsKCQkJCSRvYmphdHRyWydib3JkZXJfbGVmdCddWyd3J10gPSAwOwoJCQkJJG9iamF0dHJbJ2JvcmRlcl9yaWdodCddWyd3J10gPSAwOwoJCQkJaWYgKGlzc2V0KCRhdHRyWydTUkMnXSkpIHsKCQkJCQkkc3JjcGF0aCA9ICRhdHRyWydTUkMnXTsKCQkJCQkkb3JpZ19zcmNwYXRoID0gKGlzc2V0KCRhdHRyWydPUklHX1NSQyddKSA/ICRhdHRyWydPUklHX1NSQyddIDogJycpOwoJCQkJCSRwcm9wZXJ0aWVzID0gJHRoaXMtPm1wZGYtPmNzc21nci0+TWVyZ2VDU1MoJycsICR0YWcsICRhdHRyKTsKCQkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXMgWydESVNQTEFZJ10pICYmIHN0cnRvbG93ZXIoJHByb3BlcnRpZXMgWydESVNQTEFZJ10pID09ICdub25lJykgewoJCQkJCQlyZXR1cm47CgkJCQkJfQoJCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snWi1JTkRFWCddKSAmJiAkdGhpcy0+bXBkZi0+Y3VycmVudF9sYXllciA9PSAwKSB7CgkJCQkJCSR2ID0gaW50dmFsKCRwcm9wZXJ0aWVzWydaLUlOREVYJ10pOwoJCQkJCQlpZiAoJHYgPiAwKSB7CgkJCQkJCQkkb2JqYXR0clsnei1pbmRleCddID0gJHY7CgkJCQkJCX0KCQkJCQl9CgoJCQkJCSRvYmphdHRyWyd2aXNpYmlsaXR5J10gPSAndmlzaWJsZSc7CgkJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydWSVNJQklMSVRZJ10pKSB7CgkJCQkJCSR2ID0gc3RydG9sb3dlcigkcHJvcGVydGllc1snVklTSUJJTElUWSddKTsKCQkJCQkJaWYgKCgkdiA9PSAnaGlkZGVuJyB8fCAkdiA9PSAncHJpbnRvbmx5JyB8fCAkdiA9PSAnc2NyZWVub25seScpICYmICR0aGlzLT5tcGRmLT52aXNpYmlsaXR5ID09ICd2aXNpYmxlJykgewoJCQkJCQkJJG9iamF0dHJbJ3Zpc2liaWxpdHknXSA9ICR2OwoJCQkJCQl9CgkJCQkJfQoKCQkJCQkvLyBWU1BBQ0UgYW5kIEhTUEFDRSBjb252ZXJ0ZWQgdG8gbWFyZ2lucyBpbiBNZXJnZUNTUwoJCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snTUFSR0lOLVRPUCddKSkgewoJCQkJCQkkb2JqYXR0clsnbWFyZ2luX3RvcCddID0gJHRoaXMtPm1wZGYtPkNvbnZlcnRTaXplKCRwcm9wZXJ0aWVzWydNQVJHSU4tVE9QJ10sICR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ2lubmVyX3dpZHRoJ10sICR0aGlzLT5tcGRmLT5Gb250U2l6ZSwgZmFsc2UpOwoJCQkJCX0KCQkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ01BUkdJTi1CT1RUT00nXSkpIHsKCQkJCQkJJG9iamF0dHJbJ21hcmdpbl9ib3R0b20nXSA9ICR0aGlzLT5tcGRmLT5Db252ZXJ0U2l6ZSgkcHJvcGVydGllc1snTUFSR0lOLUJPVFRPTSddLCAkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWydpbm5lcl93aWR0aCddLCAkdGhpcy0+bXBkZi0+Rm9udFNpemUsIGZhbHNlKTsKCQkJCQl9CgkJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydNQVJHSU4tTEVGVCddKSkgewoJCQkJCQkkb2JqYXR0clsnbWFyZ2luX2xlZnQnXSA9ICR0aGlzLT5tcGRmLT5Db252ZXJ0U2l6ZSgkcHJvcGVydGllc1snTUFSR0lOLUxFRlQnXSwgJHRoaXMtPm1wZGYtPmJsa1skdGhpcy0+bXBkZi0+YmxrbHZsXVsnaW5uZXJfd2lkdGgnXSwgJHRoaXMtPm1wZGYtPkZvbnRTaXplLCBmYWxzZSk7CgkJCQkJfQoJCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snTUFSR0lOLVJJR0hUJ10pKSB7CgkJCQkJCSRvYmphdHRyWydtYXJnaW5fcmlnaHQnXSA9ICR0aGlzLT5tcGRmLT5Db252ZXJ0U2l6ZSgkcHJvcGVydGllc1snTUFSR0lOLVJJR0hUJ10sICR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ2lubmVyX3dpZHRoJ10sICR0aGlzLT5tcGRmLT5Gb250U2l6ZSwgZmFsc2UpOwoJCQkJCX0KCgkJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydQQURESU5HLVRPUCddKSkgewoJCQkJCQkkb2JqYXR0clsncGFkZGluZ190b3AnXSA9ICR0aGlzLT5tcGRmLT5Db252ZXJ0U2l6ZSgkcHJvcGVydGllc1snUEFERElORy1UT1AnXSwgJHRoaXMtPm1wZGYtPmJsa1skdGhpcy0+bXBkZi0+YmxrbHZsXVsnaW5uZXJfd2lkdGgnXSwgJHRoaXMtPm1wZGYtPkZvbnRTaXplLCBmYWxzZSk7CgkJCQkJfQoJCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snUEFERElORy1CT1RUT00nXSkpIHsKCQkJCQkJJG9iamF0dHJbJ3BhZGRpbmdfYm90dG9tJ10gPSAkdGhpcy0+bXBkZi0+Q29udmVydFNpemUoJHByb3BlcnRpZXNbJ1BBRERJTkctQk9UVE9NJ10sICR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ2lubmVyX3dpZHRoJ10sICR0aGlzLT5tcGRmLT5Gb250U2l6ZSwgZmFsc2UpOwoJCQkJCX0KCQkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ1BBRERJTkctTEVGVCddKSkgewoJCQkJCQkkb2JqYXR0clsncGFkZGluZ19sZWZ0J10gPSAkdGhpcy0+bXBkZi0+Q29udmVydFNpemUoJHByb3BlcnRpZXNbJ1BBRERJTkctTEVGVCddLCAkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWydpbm5lcl93aWR0aCddLCAkdGhpcy0+bXBkZi0+Rm9udFNpemUsIGZhbHNlKTsKCQkJCQl9CgkJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydQQURESU5HLVJJR0hUJ10pKSB7CgkJCQkJCSRvYmphdHRyWydwYWRkaW5nX3JpZ2h0J10gPSAkdGhpcy0+bXBkZi0+Q29udmVydFNpemUoJHByb3BlcnRpZXNbJ1BBRERJTkctUklHSFQnXSwgJHRoaXMtPm1wZGYtPmJsa1skdGhpcy0+bXBkZi0+YmxrbHZsXVsnaW5uZXJfd2lkdGgnXSwgJHRoaXMtPm1wZGYtPkZvbnRTaXplLCBmYWxzZSk7CgkJCQkJfQoKCQkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ0JPUkRFUi1UT1AnXSkpIHsKCQkJCQkJJG9iamF0dHJbJ2JvcmRlcl90b3AnXSA9ICR0aGlzLT5tcGRmLT5ib3JkZXJfZGV0YWlscygkcHJvcGVydGllc1snQk9SREVSLVRPUCddKTsKCQkJCQl9CgkJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydCT1JERVItQk9UVE9NJ10pKSB7CgkJCQkJCSRvYmphdHRyWydib3JkZXJfYm90dG9tJ10gPSAkdGhpcy0+bXBkZi0+Ym9yZGVyX2RldGFpbHMoJHByb3BlcnRpZXNbJ0JPUkRFUi1CT1RUT00nXSk7CgkJCQkJfQoJCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snQk9SREVSLUxFRlQnXSkpIHsKCQkJCQkJJG9iamF0dHJbJ2JvcmRlcl9sZWZ0J10gPSAkdGhpcy0+bXBkZi0+Ym9yZGVyX2RldGFpbHMoJHByb3BlcnRpZXNbJ0JPUkRFUi1MRUZUJ10pOwoJCQkJCX0KCQkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ0JPUkRFUi1SSUdIVCddKSkgewoJCQkJCQkkb2JqYXR0clsnYm9yZGVyX3JpZ2h0J10gPSAkdGhpcy0+bXBkZi0+Ym9yZGVyX2RldGFpbHMoJHByb3BlcnRpZXNbJ0JPUkRFUi1SSUdIVCddKTsKCQkJCQl9CgoJCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snVkVSVElDQUwtQUxJR04nXSkpIHsKCQkJCQkJJG9iamF0dHJbJ3ZlcnRpY2FsLWFsaWduJ10gPSAkYWxpZ25bc3RydG9sb3dlcigkcHJvcGVydGllc1snVkVSVElDQUwtQUxJR04nXSldOwoJCQkJCX0KCQkJCQkkdyA9IDA7CgkJCQkJJGggPSAwOwoJCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snV0lEVEgnXSkpCgkJCQkJCSR3ID0gJHRoaXMtPm1wZGYtPkNvbnZlcnRTaXplKCRwcm9wZXJ0aWVzWydXSURUSCddLCAkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWydpbm5lcl93aWR0aCddLCAkdGhpcy0+bXBkZi0+Rm9udFNpemUsIGZhbHNlKTsKCQkJCQllbHNlIGlmIChpc3NldCgkYXR0clsnV0lEVEgnXSkpCgkJCQkJCSR3ID0gJHRoaXMtPm1wZGYtPkNvbnZlcnRTaXplKCRhdHRyWydXSURUSCddLCAkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWydpbm5lcl93aWR0aCddLCAkdGhpcy0+bXBkZi0+Rm9udFNpemUsIGZhbHNlKTsKCQkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ0hFSUdIVCddKSkKCQkJCQkJJGggPSAkdGhpcy0+bXBkZi0+Q29udmVydFNpemUoJHByb3BlcnRpZXNbJ0hFSUdIVCddLCAkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWydpbm5lcl93aWR0aCddLCAkdGhpcy0+bXBkZi0+Rm9udFNpemUsIGZhbHNlKTsKCQkJCQllbHNlIGlmIChpc3NldCgkYXR0clsnSEVJR0hUJ10pKQoJCQkJCQkkaCA9ICR0aGlzLT5tcGRmLT5Db252ZXJ0U2l6ZSgkYXR0clsnSEVJR0hUJ10sICR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ2lubmVyX3dpZHRoJ10sICR0aGlzLT5tcGRmLT5Gb250U2l6ZSwgZmFsc2UpOwoJCQkJCSRtYXh3ID0gJG1heGggPSAkbWludyA9ICRtaW5oID0gZmFsc2U7CgkJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydNQVgtV0lEVEgnXSkpCgkJCQkJCSRtYXh3ID0gJHRoaXMtPm1wZGYtPkNvbnZlcnRTaXplKCRwcm9wZXJ0aWVzWydNQVgtV0lEVEgnXSwgJHRoaXMtPm1wZGYtPmJsa1skdGhpcy0+bXBkZi0+YmxrbHZsXVsnaW5uZXJfd2lkdGgnXSwgJHRoaXMtPm1wZGYtPkZvbnRTaXplLCBmYWxzZSk7CgkJCQkJZWxzZSBpZiAoaXNzZXQoJGF0dHJbJ01BWC1XSURUSCddKSkKCQkJCQkJJG1heHcgPSAkdGhpcy0+bXBkZi0+Q29udmVydFNpemUoJGF0dHJbJ01BWC1XSURUSCddLCAkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWydpbm5lcl93aWR0aCddLCAkdGhpcy0+bXBkZi0+Rm9udFNpemUsIGZhbHNlKTsKCQkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ01BWC1IRUlHSFQnXSkpCgkJCQkJCSRtYXhoID0gJHRoaXMtPm1wZGYtPkNvbnZlcnRTaXplKCRwcm9wZXJ0aWVzWydNQVgtSEVJR0hUJ10sICR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ2lubmVyX3dpZHRoJ10sICR0aGlzLT5tcGRmLT5Gb250U2l6ZSwgZmFsc2UpOwoJCQkJCWVsc2UgaWYgKGlzc2V0KCRhdHRyWydNQVgtSEVJR0hUJ10pKQoJCQkJCQkkbWF4aCA9ICR0aGlzLT5tcGRmLT5Db252ZXJ0U2l6ZSgkYXR0clsnTUFYLUhFSUdIVCddLCAkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWydpbm5lcl93aWR0aCddLCAkdGhpcy0+bXBkZi0+Rm9udFNpemUsIGZhbHNlKTsKCQkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ01JTi1XSURUSCddKSkKCQkJCQkJJG1pbncgPSAkdGhpcy0+bXBkZi0+Q29udmVydFNpemUoJHByb3BlcnRpZXNbJ01JTi1XSURUSCddLCAkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWydpbm5lcl93aWR0aCddLCAkdGhpcy0+bXBkZi0+Rm9udFNpemUsIGZhbHNlKTsKCQkJCQllbHNlIGlmIChpc3NldCgkYXR0clsnTUlOLVdJRFRIJ10pKQoJCQkJCQkkbWludyA9ICR0aGlzLT5tcGRmLT5Db252ZXJ0U2l6ZSgkYXR0clsnTUlOLVdJRFRIJ10sICR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ2lubmVyX3dpZHRoJ10sICR0aGlzLT5tcGRmLT5Gb250U2l6ZSwgZmFsc2UpOwoJCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snTUlOLUhFSUdIVCddKSkKCQkJCQkJJG1pbmggPSAkdGhpcy0+bXBkZi0+Q29udmVydFNpemUoJHByb3BlcnRpZXNbJ01JTi1IRUlHSFQnXSwgJHRoaXMtPm1wZGYtPmJsa1skdGhpcy0+bXBkZi0+YmxrbHZsXVsnaW5uZXJfd2lkdGgnXSwgJHRoaXMtPm1wZGYtPkZvbnRTaXplLCBmYWxzZSk7CgkJCQkJZWxzZSBpZiAoaXNzZXQoJGF0dHJbJ01JTi1IRUlHSFQnXSkpCgkJCQkJCSRtaW5oID0gJHRoaXMtPm1wZGYtPkNvbnZlcnRTaXplKCRhdHRyWydNSU4tSEVJR0hUJ10sICR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ2lubmVyX3dpZHRoJ10sICR0aGlzLT5tcGRmLT5Gb250U2l6ZSwgZmFsc2UpOwoKCQkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ09QQUNJVFknXSkgJiYgJHByb3BlcnRpZXNbJ09QQUNJVFknXSA+IDAgJiYgJHByb3BlcnRpZXNbJ09QQUNJVFknXSA8PSAxKSB7CgkJCQkJCSRvYmphdHRyWydvcGFjaXR5J10gPSAkcHJvcGVydGllc1snT1BBQ0lUWSddOwoJCQkJCX0KCQkJCQlpZiAoJHRoaXMtPm1wZGYtPkhSRUYpIHsKCQkJCQkJaWYgKHN0cnBvcygkdGhpcy0+bXBkZi0+SFJFRiwgIi4iKSA9PT0gZmFsc2UgJiYgc3RycG9zKCR0aGlzLT5tcGRmLT5IUkVGLCAiQCIpICE9PSAwKSB7CgkJCQkJCQkkaHJlZiA9ICR0aGlzLT5tcGRmLT5IUkVGOwoJCQkJCQkJd2hpbGUgKGFycmF5X2tleV9leGlzdHMoJGhyZWYsICR0aGlzLT5tcGRmLT5pbnRlcm5hbGxpbmspKQoJCQkJCQkJCSRocmVmID0gIiMiIC4gJGhyZWY7CgkJCQkJCQkkdGhpcy0+bXBkZi0+aW50ZXJuYWxsaW5rWyRocmVmXSA9ICR0aGlzLT5tcGRmLT5BZGRMaW5rKCk7CgkJCQkJCQkkb2JqYXR0clsnbGluayddID0gJHRoaXMtPm1wZGYtPmludGVybmFsbGlua1skaHJlZl07CgkJCQkJCX0gZWxzZSB7CgkJCQkJCQkkb2JqYXR0clsnbGluayddID0gJHRoaXMtPm1wZGYtPkhSRUY7CgkJCQkJCX0KCQkJCQl9CgkJCQkJJGV4dHJhaGVpZ2h0ID0gJG9iamF0dHJbJ3BhZGRpbmdfdG9wJ10gKyAkb2JqYXR0clsncGFkZGluZ19ib3R0b20nXSArICRvYmphdHRyWydtYXJnaW5fdG9wJ10gKyAkb2JqYXR0clsnbWFyZ2luX2JvdHRvbSddICsgJG9iamF0dHJbJ2JvcmRlcl90b3AnXVsndyddICsgJG9iamF0dHJbJ2JvcmRlcl9ib3R0b20nXVsndyddOwoJCQkJCSRleHRyYXdpZHRoID0gJG9iamF0dHJbJ3BhZGRpbmdfbGVmdCddICsgJG9iamF0dHJbJ3BhZGRpbmdfcmlnaHQnXSArICRvYmphdHRyWydtYXJnaW5fbGVmdCddICsgJG9iamF0dHJbJ21hcmdpbl9yaWdodCddICsgJG9iamF0dHJbJ2JvcmRlcl9sZWZ0J11bJ3cnXSArICRvYmphdHRyWydib3JkZXJfcmlnaHQnXVsndyddOwoKCQkJCQkvLyBtUERGIDUuNy4zIFRSQU5TRk9STVMKCQkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ0JBQ0tHUk9VTkQtQ09MT1InXSkgJiYgJHByb3BlcnRpZXNbJ0JBQ0tHUk9VTkQtQ09MT1InXSAhPSAnJykgewoJCQkJCQkkb2JqYXR0clsnYmdjb2xvciddID0gJHRoaXMtPm1wZGYtPkNvbnZlcnRDb2xvcigkcHJvcGVydGllc1snQkFDS0dST1VORC1DT0xPUiddKTsKCQkJCQl9CgoJCQkJCS8qIC0tIEJBQ0tHUk9VTkRTIC0tICovCgkJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydHUkFESUVOVC1NQVNLJ10pICYmIHByZWdfbWF0Y2goJy8oLW1vei0pKihyZXBlYXRpbmctKSoobGluZWFyfHJhZGlhbCktZ3JhZGllbnQvJywgJHByb3BlcnRpZXNbJ0dSQURJRU5ULU1BU0snXSkpIHsKCQkJCQkJJG9iamF0dHJbJ0dSQURJRU5ULU1BU0snXSA9ICRwcm9wZXJ0aWVzWydHUkFESUVOVC1NQVNLJ107CgkJCQkJfQoJCQkJCS8qIC0tIEVORCBCQUNLR1JPVU5EUyAtLSAqLwoKCQkJCQkvLyBtUERGIDYKCQkJCQkkaW50ZXJwb2xhdGlvbiA9IGZhbHNlOwoJCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snSU1BR0UtUkVOREVSSU5HJ10pICYmICRwcm9wZXJ0aWVzWydJTUFHRS1SRU5ERVJJTkcnXSkgewoJCQkJCQlpZiAoc3RydG9sb3dlcigkcHJvcGVydGllc1snSU1BR0UtUkVOREVSSU5HJ10pID09ICdjcmlzcC1lZGdlcycpIHsKCQkJCQkJCSRpbnRlcnBvbGF0aW9uID0gZmFsc2U7CgkJCQkJCX0gZWxzZSBpZiAoc3RydG9sb3dlcigkcHJvcGVydGllc1snSU1BR0UtUkVOREVSSU5HJ10pID09ICdvcHRpbWl6ZXF1YWxpdHknKSB7CgkJCQkJCQkkaW50ZXJwb2xhdGlvbiA9IHRydWU7CgkJCQkJCX0gZWxzZSBpZiAoc3RydG9sb3dlcigkcHJvcGVydGllc1snSU1BR0UtUkVOREVSSU5HJ10pID09ICdzbW9vdGgnKSB7CgkJCQkJCQkkaW50ZXJwb2xhdGlvbiA9IHRydWU7CgkJCQkJCX0gZWxzZSBpZiAoc3RydG9sb3dlcigkcHJvcGVydGllc1snSU1BR0UtUkVOREVSSU5HJ10pID09ICdhdXRvJykgewoJCQkJCQkJJGludGVycG9sYXRpb24gPSAkdGhpcy0+bXBkZi0+aW50ZXJwb2xhdGVJbWFnZXM7CgkJCQkJCX0gZWxzZSB7CgkJCQkJCQkkaW50ZXJwb2xhdGlvbiA9IGZhbHNlOwoJCQkJCQl9CgkJCQkJCSRpbmZvWydpbnRlcnBvbGF0aW9uJ10gPSAkaW50ZXJwb2xhdGlvbjsKCQkJCQl9CgoJCQkJCS8vIEltYWdlIGZpbGUKCQkJCQkkaW5mbyA9ICR0aGlzLT5tcGRmLT5fZ2V0SW1hZ2UoJHNyY3BhdGgsIHRydWUsIHRydWUsICRvcmlnX3NyY3BhdGgsICRpbnRlcnBvbGF0aW9uKTsgLy8gbVBERiA2CgkJCQkJaWYgKCEkaW5mbykgewoJCQkJCQkkaW5mbyA9ICR0aGlzLT5tcGRmLT5fZ2V0SW1hZ2UoJHRoaXMtPm1wZGYtPm5vSW1hZ2VGaWxlKTsKCQkJCQkJaWYgKCRpbmZvKSB7CgkJCQkJCQkkc3JjcGF0aCA9ICR0aGlzLT5tcGRmLT5ub0ltYWdlRmlsZTsKCQkJCQkJCSR3ID0gKCRpbmZvWyd3J10gKiAoMjUuNCAvICR0aGlzLT5tcGRmLT5kcGkpKTsKCQkJCQkJCSRoID0gKCRpbmZvWydoJ10gKiAoMjUuNCAvICR0aGlzLT5tcGRmLT5kcGkpKTsKCQkJCQkJfQoJCQkJCX0KCQkJCQlpZiAoISRpbmZvKQoJCQkJCQlicmVhazsKCgkJCQkJaWYgKGlzc2V0KCRhdHRyWydST1RBVEUnXSkpIHsKCQkJCQkJJGltYWdlX29yaWVudGF0aW9uID0gJGF0dHJbJ1JPVEFURSddOwoJCQkJCX0gZWxzZSBpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ0lNQUdFLU9SSUVOVEFUSU9OJ10pKSB7CgkJCQkJCSRpbWFnZV9vcmllbnRhdGlvbiA9ICRwcm9wZXJ0aWVzWydJTUFHRS1PUklFTlRBVElPTiddOwoJCQkJCX0gZWxzZSB7CgkJCQkJCSRpbWFnZV9vcmllbnRhdGlvbiA9IDA7CgkJCQkJfQoJCQkJCWlmICgkaW1hZ2Vfb3JpZW50YXRpb24pIHsKCQkJCQkJaWYgKCRpbWFnZV9vcmllbnRhdGlvbiA9PSA5MCB8fCAkaW1hZ2Vfb3JpZW50YXRpb24gPT0gLTkwIHx8ICRpbWFnZV9vcmllbnRhdGlvbiA9PSAyNzApIHsKCQkJCQkJCSR0bXB3ID0gJGluZm9bJ3cnXTsKCQkJCQkJCSRpbmZvWyd3J10gPSAkaW5mb1snaCddOwoJCQkJCQkJJGluZm9bJ2gnXSA9ICR0bXB3OwoJCQkJCQl9CgkJCQkJCSRvYmphdHRyWydST1RBVEUnXSA9ICRpbWFnZV9vcmllbnRhdGlvbjsKCQkJCQl9CgoJCQkJCSRvYmphdHRyWydmaWxlJ10gPSAkc3JjcGF0aDsKCQkJCQkvL0RlZmF1bHQgd2lkdGggYW5kIGhlaWdodCBjYWxjdWxhdGlvbiBpZiBuZWVkZWQKCQkJCQlpZiAoJHcgPT0gMCBhbmQgJGggPT0gMCkgewoJCQkJCQkvKiAtLSBJTUFHRVMtV01GIC0tICovCgkJCQkJCWlmICgkaW5mb1sndHlwZSddID09ICd3bWYnKSB7CgkJCQkJCQkvLyBXTUYgdW5pdHMgYXJlIHR3aXBzICgxLzIwcHQpCgkJCQkJCQkvLyBkaXZpZGUgYnkgMjAgdG8gZ2V0IHBvaW50cwoJCQkJCQkJLy8gZGl2aWRlIGJ5IGsgdG8gZ2V0IHVzZXIgdW5pdHMKCQkJCQkJCSR3ID0gYWJzKCRpbmZvWyd3J10pIC8gKDIwICogX01QREZLKTsKCQkJCQkJCSRoID0gYWJzKCRpbmZvWydoJ10pIC8gKDIwICogX01QREZLKTsKCQkJCQkJfSBlbHNlCgkJCQkJCQkvKiAtLSBFTkQgSU1BR0VTLVdNRiAtLSAqLwoJCQkJCQkJaWYgKCRpbmZvWyd0eXBlJ10gPT0gJ3N2ZycpIHsKCQkJCQkJCQkvLyBTVkcgdW5pdHMgYXJlIHBpeGVscwoJCQkJCQkJCSR3ID0gYWJzKCRpbmZvWyd3J10pIC8gX01QREZLOwoJCQkJCQkJCSRoID0gYWJzKCRpbmZvWydoJ10pIC8gX01QREZLOwoJCQkJCQkJfSBlbHNlIHsKCQkJCQkJCQkvL1B1dCBpbWFnZSBhdCBkZWZhdWx0IGltYWdlIGRwaQoJCQkJCQkJCSR3ID0gKCRpbmZvWyd3J10gLyBfTVBERkspICogKDcyIC8gJHRoaXMtPm1wZGYtPmltZ19kcGkpOwoJCQkJCQkJCSRoID0gKCRpbmZvWydoJ10gLyBfTVBERkspICogKDcyIC8gJHRoaXMtPm1wZGYtPmltZ19kcGkpOwoJCQkJCQkJfQoJCQkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ0lNQUdFLVJFU09MVVRJT04nXSkpIHsKCQkJCQkJCWlmIChwcmVnX21hdGNoKCcvZnJvbS1pbWFnZS9pJywgJHByb3BlcnRpZXNbJ0lNQUdFLVJFU09MVVRJT04nXSkgJiYgaXNzZXQoJGluZm9bJ3NldC1kcGknXSkgJiYgJGluZm9bJ3NldC1kcGknXSA+IDApIHsKCQkJCQkJCQkkdyAqPSAkdGhpcy0+bXBkZi0+aW1nX2RwaSAvICRpbmZvWydzZXQtZHBpJ107CgkJCQkJCQkJJGggKj0gJHRoaXMtPm1wZGYtPmltZ19kcGkgLyAkaW5mb1snc2V0LWRwaSddOwoJCQkJCQkJfSBlbHNlIGlmIChwcmVnX21hdGNoKCcvKFxkKylkcGkvaScsICRwcm9wZXJ0aWVzWydJTUFHRS1SRVNPTFVUSU9OJ10sICRtKSkgewoJCQkJCQkJCSRkcGkgPSAkbVsxXTsKCQkJCQkJCQlpZiAoJGRwaSA+IDApIHsKCQkJCQkJCQkJJHcgKj0gJHRoaXMtPm1wZGYtPmltZ19kcGkgLyAkZHBpOwoJCQkJCQkJCQkkaCAqPSAkdGhpcy0+bXBkZi0+aW1nX2RwaSAvICRkcGk7CgkJCQkJCQkJfQoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJfQoJCQkJCS8vIElGIFdJRFRIIE9SIEhFSUdIVCBTUEVDSUZJRUQKCQkJCQlpZiAoJHcgPT0gMCkKCQkJCQkJJHcgPSBhYnMoJGggKiAkaW5mb1sndyddIC8gJGluZm9bJ2gnXSk7CgkJCQkJaWYgKCRoID09IDApCgkJCQkJCSRoID0gYWJzKCR3ICogJGluZm9bJ2gnXSAvICRpbmZvWyd3J10pOwoKCQkJCQlpZiAoJG1pbncgJiYgJHcgPCAkbWludykgewoJCQkJCQkkdyA9ICRtaW53OwoJCQkJCQkkaCA9IGFicygkdyAqICRpbmZvWydoJ10gLyAkaW5mb1sndyddKTsKCQkJCQl9CgkJCQkJaWYgKCRtYXh3ICYmICR3ID4gJG1heHcpIHsKCQkJCQkJJHcgPSAkbWF4dzsKCQkJCQkJJGggPSBhYnMoJHcgKiAkaW5mb1snaCddIC8gJGluZm9bJ3cnXSk7CgkJCQkJfQoJCQkJCWlmICgkbWluaCAmJiAkaCA8ICRtaW5oKSB7CgkJCQkJCSRoID0gJG1pbmg7CgkJCQkJCSR3ID0gYWJzKCRoICogJGluZm9bJ3cnXSAvICRpbmZvWydoJ10pOwoJCQkJCX0KCQkJCQlpZiAoJG1heGggJiYgJGggPiAkbWF4aCkgewoJCQkJCQkkaCA9ICRtYXhoOwoJCQkJCQkkdyA9IGFicygkaCAqICRpbmZvWyd3J10gLyAkaW5mb1snaCddKTsKCQkJCQl9CgoJCQkJCS8vIFJlc2l6ZSB0byBtYXhpbXVtIGRpbWVuc2lvbnMgb2YgcGFnZQoJCQkJCSRtYXhXaWR0aCA9ICR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ2lubmVyX3dpZHRoJ107CgkJCQkJJG1heEhlaWdodCA9ICR0aGlzLT5tcGRmLT5oIC0gKCR0aGlzLT5tcGRmLT50TWFyZ2luICsgJHRoaXMtPm1wZGYtPmJNYXJnaW4gKyAxKTsKCQkJCQlpZiAoJHRoaXMtPm1wZGYtPmZ1bGxJbWFnZUhlaWdodCkgewoJCQkJCQkkbWF4SGVpZ2h0ID0gJHRoaXMtPm1wZGYtPmZ1bGxJbWFnZUhlaWdodDsKCQkJCQl9CgkJCQkJaWYgKCgkdyArICRleHRyYXdpZHRoKSA+ICgkbWF4V2lkdGggKyAwLjAwMDEpKSB7IC8vIG1QREYgNS43LjQgIDAuMDAwMSB0byBhbGxvdyBmb3Igcm91bmRpbmcgZXJyb3JzIHdoZW4gdz09bWF4V2lkdGgKCQkJCQkJJHcgPSAkbWF4V2lkdGggLSAkZXh0cmF3aWR0aDsKCQkJCQkJJGggPSBhYnMoJHcgKiAkaW5mb1snaCddIC8gJGluZm9bJ3cnXSk7CgkJCQkJfQoKCQkJCQlpZiAoJGggKyAkZXh0cmFoZWlnaHQgPiAkbWF4SGVpZ2h0KSB7CgkJCQkJCSRoID0gJG1heEhlaWdodCAtICRleHRyYWhlaWdodDsKCQkJCQkJJHcgPSBhYnMoJGggKiAkaW5mb1sndyddIC8gJGluZm9bJ2gnXSk7CgkJCQkJfQoJCQkJCSRvYmphdHRyWyd0eXBlJ10gPSAnaW1hZ2UnOwoJCQkJCSRvYmphdHRyWydpdHlwZSddID0gJGluZm9bJ3R5cGUnXTsKCgkJCQkJJG9iamF0dHJbJ29yaWdfaCddID0gJGluZm9bJ2gnXTsKCQkJCQkkb2JqYXR0clsnb3JpZ193J10gPSAkaW5mb1sndyddOwoJCQkJCS8qIC0tIElNQUdFUy1XTUYgLS0gKi8KCQkJCQlpZiAoJGluZm9bJ3R5cGUnXSA9PSAnd21mJykgewoJCQkJCQkkb2JqYXR0clsnd21mX3gnXSA9ICRpbmZvWyd4J107CgkJCQkJCSRvYmphdHRyWyd3bWZfeSddID0gJGluZm9bJ3knXTsKCQkJCQl9IGVsc2UKCQkJCQkJLyogLS0gRU5EIElNQUdFUy1XTUYgLS0gKi8KCQkJCQkJaWYgKCRpbmZvWyd0eXBlJ10gPT0gJ3N2ZycpIHsKCQkJCQkJCSRvYmphdHRyWyd3bWZfeCddID0gJGluZm9bJ3gnXTsKCQkJCQkJCSRvYmphdHRyWyd3bWZfeSddID0gJGluZm9bJ3knXTsKCQkJCQkJfQoJCQkJCSRvYmphdHRyWydoZWlnaHQnXSA9ICRoICsgJGV4dHJhaGVpZ2h0OwoJCQkJCSRvYmphdHRyWyd3aWR0aCddID0gJHcgKyAkZXh0cmF3aWR0aDsKCQkJCQkkb2JqYXR0clsnaW1hZ2VfaGVpZ2h0J10gPSAkaDsKCQkJCQkkb2JqYXR0clsnaW1hZ2Vfd2lkdGgnXSA9ICR3OwoJCQkJCS8qIC0tIENTUy1JTUFHRS1GTE9BVCAtLSAqLwoJCQkJCWlmICghJHRoaXMtPm1wZGYtPkNvbEFjdGl2ZSAmJiAhJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWwgJiYgISR0aGlzLT5tcGRmLT5saXN0bHZsICYmICEkdGhpcy0+bXBkZi0+a3d0KSB7CgkJCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snRkxPQVQnXSkgJiYgKHN0cnRvdXBwZXIoJHByb3BlcnRpZXNbJ0ZMT0FUJ10pID09ICdSSUdIVCcgfHwgc3RydG91cHBlcigkcHJvcGVydGllc1snRkxPQVQnXSkgPT0gJ0xFRlQnKSkgewoJCQkJCQkJJG9iamF0dHJbJ2Zsb2F0J10gPSBzdWJzdHIoc3RydG91cHBlcigkcHJvcGVydGllc1snRkxPQVQnXSksIDAsIDEpOwoJCQkJCQl9CgkJCQkJfQoJCQkJCS8qIC0tIEVORCBDU1MtSU1BR0UtRkxPQVQgLS0gKi8KCQkJCQkvLyBtUERGIDUuNy4zIFRSQU5TRk9STVMKCQkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ1RSQU5TRk9STSddKSAmJiAhJHRoaXMtPm1wZGYtPkNvbEFjdGl2ZSAmJiAhJHRoaXMtPm1wZGYtPmt3dCkgewoJCQkJCQkkb2JqYXR0clsndHJhbnNmb3JtJ10gPSAkcHJvcGVydGllc1snVFJBTlNGT1JNJ107CgkJCQkJfQoKCQkJCQkkZSA9ICJceGJiXHhhNFx4YWN0eXBlPWltYWdlLG9iamF0dHI9IiAuIHNlcmlhbGl6ZSgkb2JqYXR0cikgLiAiXHhiYlx4YTRceGFjIjsKCgkJCQkJLy8gQ2xlYXIgcHJvcGVydGllcyAtIHRpZHkgdXAKCQkJCQkkcHJvcGVydGllcyA9IGFycmF5KCk7CgoJCQkJCS8qIC0tIFRBQkxFUyAtLSAqLwoJCQkJCS8vIE91dHB1dCBpdCB0byBidWZmZXJzCgkJCQkJaWYgKCR0aGlzLT5tcGRmLT50YWJsZUxldmVsKSB7CgkJCQkJCSR0aGlzLT5tcGRmLT5fc2F2ZUNlbGxUZXh0QnVmZmVyKCRlLCAkdGhpcy0+bXBkZi0+SFJFRik7CgkJCQkJCSR0aGlzLT5tcGRmLT5jZWxsWyR0aGlzLT5tcGRmLT5yb3ddWyR0aGlzLT5tcGRmLT5jb2xdWydzJ10gKz0gJG9iamF0dHJbJ3dpZHRoJ107CgkJCQkJfSBlbHNlIHsKCQkJCQkJLyogLS0gRU5EIFRBQkxFUyAtLSAqLwoJCQkJCQkkdGhpcy0+bXBkZi0+X3NhdmVUZXh0QnVmZmVyKCRlLCAkdGhpcy0+bXBkZi0+SFJFRik7CgkJCQkJfSAvLyAqVEFCTEVTKgoJCQkJCS8qIC0tIEFOTk9UQVRJT05TIC0tICovCgkJCQkJaWYgKCR0aGlzLT5tcGRmLT50aXRsZTJhbm5vdHMgJiYgaXNzZXQoJGF0dHJbJ1RJVExFJ10pKSB7CgkJCQkJCSRvYmphdHRyID0gYXJyYXkoKTsKCQkJCQkJJG9iamF0dHJbJ21hcmdpbl90b3AnXSA9IDA7CgkJCQkJCSRvYmphdHRyWydtYXJnaW5fYm90dG9tJ10gPSAwOwoJCQkJCQkkb2JqYXR0clsnbWFyZ2luX2xlZnQnXSA9IDA7CgkJCQkJCSRvYmphdHRyWydtYXJnaW5fcmlnaHQnXSA9IDA7CgkJCQkJCSRvYmphdHRyWyd3aWR0aCddID0gMDsKCQkJCQkJJG9iamF0dHJbJ2hlaWdodCddID0gMDsKCQkJCQkJJG9iamF0dHJbJ2JvcmRlcl90b3AnXVsndyddID0gMDsKCQkJCQkJJG9iamF0dHJbJ2JvcmRlcl9ib3R0b20nXVsndyddID0gMDsKCQkJCQkJJG9iamF0dHJbJ2JvcmRlcl9sZWZ0J11bJ3cnXSA9IDA7CgkJCQkJCSRvYmphdHRyWydib3JkZXJfcmlnaHQnXVsndyddID0gMDsKCQkJCQkJJG9iamF0dHJbJ0NPTlRFTlQnXSA9ICRhdHRyWydUSVRMRSddOwoJCQkJCQkkb2JqYXR0clsndHlwZSddID0gJ2Fubm90JzsKCQkJCQkJJG9iamF0dHJbJ1BPUy1YJ10gPSAwOwoJCQkJCQkkb2JqYXR0clsnUE9TLVknXSA9IDA7CgkJCQkJCSRvYmphdHRyWydJQ09OJ10gPSAnQ29tbWVudCc7CgkJCQkJCSRvYmphdHRyWydBVVRIT1InXSA9ICcnOwoJCQkJCQkkb2JqYXR0clsnU1VCSkVDVCddID0gJyc7CgkJCQkJCSRvYmphdHRyWydPUEFDSVRZJ10gPSAkdGhpcy0+bXBkZi0+YW5ub3RPcGFjaXR5OwoJCQkJCQkkb2JqYXR0clsnQ09MT1InXSA9ICR0aGlzLT5tcGRmLT5Db252ZXJ0Q29sb3IoJ3llbGxvdycpOwoJCQkJCQkkZSA9ICJceGJiXHhhNFx4YWN0eXBlPWFubm90LG9iamF0dHI9IiAuIHNlcmlhbGl6ZSgkb2JqYXR0cikgLiAiXHhiYlx4YTRceGFjIjsKCQkJCQkJaWYgKCR0aGlzLT5tcGRmLT50YWJsZUxldmVsKSB7IC8vICpUQUJMRVMqCgkJCQkJCQkkdGhpcy0+bXBkZi0+Y2VsbFskdGhpcy0+bXBkZi0+cm93XVskdGhpcy0+bXBkZi0+Y29sXVsndGV4dGJ1ZmZlciddW10gPSBhcnJheSgkZSk7IC8vICpUQUJMRVMqCgkJCQkJCX0gLy8gKlRBQkxFUyoKCQkJCQkJZWxzZSB7IC8vICpUQUJMRVMqCgkJCQkJCQkkdGhpcy0+bXBkZi0+dGV4dGJ1ZmZlcltdID0gYXJyYXkoJGUpOwoJCQkJCQl9IC8vICpUQUJMRVMqCgkJCQkJfQoJCQkJCS8qIC0tIEVORCBBTk5PVEFUSU9OUyAtLSAqLwoJCQkJfQoJCQkJYnJlYWs7CgkJCS8qIC0tIEVORCBJTUFHRVMtQ09SRSAtLSAqLwoKCgkJCS8vICoqKioqKioqKioqIENJUkNVTEFSIFRFWFQgPSBURVhUQ0lSQ0xFICAqKioqKioqKioqKioqKioqKioqKgoJCQljYXNlICdURVhUQ0lSQ0xFJzoKCQkJCSRvYmphdHRyID0gYXJyYXkoKTsKCQkJCSRvYmphdHRyWydtYXJnaW5fdG9wJ10gPSAwOwoJCQkJJG9iamF0dHJbJ21hcmdpbl9ib3R0b20nXSA9IDA7CgkJCQkkb2JqYXR0clsnbWFyZ2luX2xlZnQnXSA9IDA7CgkJCQkkb2JqYXR0clsnbWFyZ2luX3JpZ2h0J10gPSAwOwoJCQkJJG9iamF0dHJbJ3BhZGRpbmdfdG9wJ10gPSAwOwoJCQkJJG9iamF0dHJbJ3BhZGRpbmdfYm90dG9tJ10gPSAwOwoJCQkJJG9iamF0dHJbJ3BhZGRpbmdfbGVmdCddID0gMDsKCQkJCSRvYmphdHRyWydwYWRkaW5nX3JpZ2h0J10gPSAwOwoJCQkJJG9iamF0dHJbJ3dpZHRoJ10gPSAwOwoJCQkJJG9iamF0dHJbJ2hlaWdodCddID0gMDsKCQkJCSRvYmphdHRyWydib3JkZXJfdG9wJ11bJ3cnXSA9IDA7CgkJCQkkb2JqYXR0clsnYm9yZGVyX2JvdHRvbSddWyd3J10gPSAwOwoJCQkJJG9iamF0dHJbJ2JvcmRlcl9sZWZ0J11bJ3cnXSA9IDA7CgkJCQkkb2JqYXR0clsnYm9yZGVyX3JpZ2h0J11bJ3cnXSA9IDA7CgkJCQkkb2JqYXR0clsndG9wLXRleHQnXSA9ICcnOwoJCQkJJG9iamF0dHJbJ2JvdHRvbS10ZXh0J10gPSAnJzsKCQkJCSRvYmphdHRyWydyJ10gPSAyMDsgLy8gcmFkaXVzIChkZWZhdWx0IHZhbHVlIGhlcmUgZm9yIHNhZmV0eSkKCQkJCSRvYmphdHRyWydzcGFjZS13aWR0aCddID0gMTIwOwoJCQkJJG9iamF0dHJbJ2NoYXItd2lkdGgnXSA9IDEwMDsKCgkJCQkkdGhpcy0+bXBkZi0+SW5saW5lUHJvcGVydGllc1skdGFnXSA9ICR0aGlzLT5tcGRmLT5zYXZlSW5saW5lUHJvcGVydGllcygpOwoJCQkJJHByb3BlcnRpZXMgPSAkdGhpcy0+bXBkZi0+Y3NzbWdyLT5NZXJnZUNTUygnSU5MSU5FJywgJHRhZywgJGF0dHIpOwoKCQkJCWlmIChpc3NldCgkcHJvcGVydGllcyBbJ0RJU1BMQVknXSkgJiYgc3RydG9sb3dlcigkcHJvcGVydGllcyBbJ0RJU1BMQVknXSkgPT0gJ25vbmUnKSB7CgkJCQkJcmV0dXJuOwoJCQkJfQoJCQkJaWYgKGlzc2V0KCRhdHRyWydSJ10pKSB7CgkJCQkJJG9iamF0dHJbJ3InXSA9ICR0aGlzLT5tcGRmLT5Db252ZXJ0U2l6ZSgkYXR0clsnUiddLCAkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWydpbm5lcl93aWR0aCddLCAkdGhpcy0+bXBkZi0+Rm9udFNpemUsIGZhbHNlKTsKCQkJCX0KCQkJCWlmIChpc3NldCgkYXR0clsnVE9QLVRFWFQnXSkpIHsKCQkJCQkkb2JqYXR0clsndG9wLXRleHQnXSA9IHN0cmNvZGUydXRmKCRhdHRyWydUT1AtVEVYVCddKTsKCQkJCQkkb2JqYXR0clsndG9wLXRleHQnXSA9ICR0aGlzLT5tcGRmLT5sZXNzZXJfZW50aXR5X2RlY29kZSgkb2JqYXR0clsndG9wLXRleHQnXSk7CgkJCQkJaWYgKCR0aGlzLT5tcGRmLT5vbmx5Q29yZUZvbnRzKQoJCQkJCQkkb2JqYXR0clsndG9wLXRleHQnXSA9IG1iX2NvbnZlcnRfZW5jb2RpbmcoJG9iamF0dHJbJ3RvcC10ZXh0J10sICR0aGlzLT5tcGRmLT5tYl9lbmMsICdVVEYtOCcpOwoJCQkJfQoJCQkJaWYgKGlzc2V0KCRhdHRyWydCT1RUT00tVEVYVCddKSkgewoJCQkJCSRvYmphdHRyWydib3R0b20tdGV4dCddID0gc3RyY29kZTJ1dGYoJGF0dHJbJ0JPVFRPTS1URVhUJ10pOwoJCQkJCSRvYmphdHRyWydib3R0b20tdGV4dCddID0gJHRoaXMtPm1wZGYtPmxlc3Nlcl9lbnRpdHlfZGVjb2RlKCRvYmphdHRyWydib3R0b20tdGV4dCddKTsKCQkJCQlpZiAoJHRoaXMtPm1wZGYtPm9ubHlDb3JlRm9udHMpCgkJCQkJCSRvYmphdHRyWydib3R0b20tdGV4dCddID0gbWJfY29udmVydF9lbmNvZGluZygkb2JqYXR0clsnYm90dG9tLXRleHQnXSwgJHRoaXMtPm1wZGYtPm1iX2VuYywgJ1VURi04Jyk7CgkJCQl9CgkJCQlpZiAoaXNzZXQoJGF0dHJbJ1NQQUNFLVdJRFRIJ10pICYmICRhdHRyWydTUEFDRS1XSURUSCddKSB7CgkJCQkJJG9iamF0dHJbJ3NwYWNlLXdpZHRoJ10gPSAkYXR0clsnU1BBQ0UtV0lEVEgnXTsKCQkJCX0KCQkJCWlmIChpc3NldCgkYXR0clsnQ0hBUi1XSURUSCddKSAmJiAkYXR0clsnQ0hBUi1XSURUSCddKSB7CgkJCQkJJG9iamF0dHJbJ2NoYXItd2lkdGgnXSA9ICRhdHRyWydDSEFSLVdJRFRIJ107CgkJCQl9CgoJCQkJLy8gVklTSUJJTElUWQoJCQkJJG9iamF0dHJbJ3Zpc2liaWxpdHknXSA9ICd2aXNpYmxlJzsKCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snVklTSUJJTElUWSddKSkgewoJCQkJCSR2ID0gc3RydG9sb3dlcigkcHJvcGVydGllc1snVklTSUJJTElUWSddKTsKCQkJCQlpZiAoKCR2ID09ICdoaWRkZW4nIHx8ICR2ID09ICdwcmludG9ubHknIHx8ICR2ID09ICdzY3JlZW5vbmx5JykgJiYgJHRoaXMtPm1wZGYtPnZpc2liaWxpdHkgPT0gJ3Zpc2libGUnKSB7CgkJCQkJCSRvYmphdHRyWyd2aXNpYmlsaXR5J10gPSAkdjsKCQkJCQl9CgkJCQl9CgkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ0ZPTlQtU0laRSddKSkgewoJCQkJCWlmIChzdHJ0b2xvd2VyKCRwcm9wZXJ0aWVzWydGT05ULVNJWkUnXSkgPT0gJ2F1dG8nKSB7CgkJCQkJCWlmICgkb2JqYXR0clsndG9wLXRleHQnXSAmJiAkb2JqYXR0clsnYm90dG9tLXRleHQnXSkgewoJCQkJCQkJJG9iamF0dHJbJ2ZvbnRzaXplJ10gPSAtMjsKCQkJCQkJfSBlbHNlIHsKCQkJCQkJCSRvYmphdHRyWydmb250c2l6ZSddID0gLTE7CgkJCQkJCX0KCQkJCQl9IGVsc2UgewoJCQkJCQkkbW1zaXplID0gJHRoaXMtPm1wZGYtPkNvbnZlcnRTaXplKCRwcm9wZXJ0aWVzWydGT05ULVNJWkUnXSwgKCR0aGlzLT5tcGRmLT5kZWZhdWx0X2ZvbnRfc2l6ZSAvIF9NUERGSykpOwoJCQkJCQkkdGhpcy0+bXBkZi0+U2V0Rm9udFNpemUoJG1tc2l6ZSAqIF9NUERGSywgZmFsc2UpOwoJCQkJCQkkb2JqYXR0clsnZm9udHNpemUnXSA9ICR0aGlzLT5tcGRmLT5Gb250U2l6ZVB0OwoJCQkJCX0KCQkJCX0KCQkJCWlmIChpc3NldCgkYXR0clsnRElWSURFUiddKSkgewoJCQkJCSRvYmphdHRyWydkaXZpZGVyJ10gPSBzdHJjb2RlMnV0ZigkYXR0clsnRElWSURFUiddKTsKCQkJCQkkb2JqYXR0clsnZGl2aWRlciddID0gJHRoaXMtPm1wZGYtPmxlc3Nlcl9lbnRpdHlfZGVjb2RlKCRvYmphdHRyWydkaXZpZGVyJ10pOwoJCQkJCWlmICgkdGhpcy0+bXBkZi0+b25seUNvcmVGb250cykKCQkJCQkJJG9iamF0dHJbJ2RpdmlkZXInXSA9IG1iX2NvbnZlcnRfZW5jb2RpbmcoJG9iamF0dHJbJ2RpdmlkZXInXSwgJHRoaXMtPm1wZGYtPm1iX2VuYywgJ1VURi04Jyk7CgkJCQl9CgoJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydDT0xPUiddKSkgewoJCQkJCSRvYmphdHRyWydjb2xvciddID0gJHRoaXMtPm1wZGYtPkNvbnZlcnRDb2xvcigkcHJvcGVydGllc1snQ09MT1InXSk7CgkJCQl9CgoJCQkJJG9iamF0dHJbJ2ZvbnRzdHlsZSddID0gJyc7CgkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ0ZPTlQtV0VJR0hUJ10pKSB7CgkJCQkJaWYgKHN0cnRvdXBwZXIoJHByb3BlcnRpZXNbJ0ZPTlQtV0VJR0hUJ10pID09ICdCT0xEJykgewoJCQkJCQkkb2JqYXR0clsnZm9udHN0eWxlJ10gLj0gJ0InOwoJCQkJCX0KCQkJCX0KCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snRk9OVC1TVFlMRSddKSkgewoJCQkJCWlmIChzdHJ0b3VwcGVyKCRwcm9wZXJ0aWVzWydGT05ULVNUWUxFJ10pID09ICdJVEFMSUMnKSB7CgkJCQkJCSRvYmphdHRyWydmb250c3R5bGUnXSAuPSAnSSc7CgkJCQkJfQoJCQkJfQoKCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snRk9OVC1GQU1JTFknXSkpIHsKCQkJCQkkdGhpcy0+bXBkZi0+U2V0Rm9udCgkcHJvcGVydGllc1snRk9OVC1GQU1JTFknXSwgJHRoaXMtPm1wZGYtPkZvbnRTdHlsZSwgMCwgZmFsc2UpOwoJCQkJfQoJCQkJJG9iamF0dHJbJ2ZvbnRmYW1pbHknXSA9ICR0aGlzLT5tcGRmLT5Gb250RmFtaWx5OwoKCQkJCS8vIFZTUEFDRSBhbmQgSFNQQUNFIGNvbnZlcnRlZCB0byBtYXJnaW5zIGluIE1lcmdlQ1NTCgkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ01BUkdJTi1UT1AnXSkpIHsKCQkJCQkkb2JqYXR0clsnbWFyZ2luX3RvcCddID0gJHRoaXMtPm1wZGYtPkNvbnZlcnRTaXplKCRwcm9wZXJ0aWVzWydNQVJHSU4tVE9QJ10sICR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ2lubmVyX3dpZHRoJ10sICR0aGlzLT5tcGRmLT5Gb250U2l6ZSwgZmFsc2UpOwoJCQkJfQoJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydNQVJHSU4tQk9UVE9NJ10pKSB7CgkJCQkJJG9iamF0dHJbJ21hcmdpbl9ib3R0b20nXSA9ICR0aGlzLT5tcGRmLT5Db252ZXJ0U2l6ZSgkcHJvcGVydGllc1snTUFSR0lOLUJPVFRPTSddLCAkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWydpbm5lcl93aWR0aCddLCAkdGhpcy0+bXBkZi0+Rm9udFNpemUsIGZhbHNlKTsKCQkJCX0KCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snTUFSR0lOLUxFRlQnXSkpIHsKCQkJCQkkb2JqYXR0clsnbWFyZ2luX2xlZnQnXSA9ICR0aGlzLT5tcGRmLT5Db252ZXJ0U2l6ZSgkcHJvcGVydGllc1snTUFSR0lOLUxFRlQnXSwgJHRoaXMtPm1wZGYtPmJsa1skdGhpcy0+bXBkZi0+YmxrbHZsXVsnaW5uZXJfd2lkdGgnXSwgJHRoaXMtPm1wZGYtPkZvbnRTaXplLCBmYWxzZSk7CgkJCQl9CgkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ01BUkdJTi1SSUdIVCddKSkgewoJCQkJCSRvYmphdHRyWydtYXJnaW5fcmlnaHQnXSA9ICR0aGlzLT5tcGRmLT5Db252ZXJ0U2l6ZSgkcHJvcGVydGllc1snTUFSR0lOLVJJR0hUJ10sICR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ2lubmVyX3dpZHRoJ10sICR0aGlzLT5tcGRmLT5Gb250U2l6ZSwgZmFsc2UpOwoJCQkJfQoKCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snUEFERElORy1UT1AnXSkpIHsKCQkJCQkkb2JqYXR0clsncGFkZGluZ190b3AnXSA9ICR0aGlzLT5tcGRmLT5Db252ZXJ0U2l6ZSgkcHJvcGVydGllc1snUEFERElORy1UT1AnXSwgJHRoaXMtPm1wZGYtPmJsa1skdGhpcy0+bXBkZi0+YmxrbHZsXVsnaW5uZXJfd2lkdGgnXSwgJHRoaXMtPm1wZGYtPkZvbnRTaXplLCBmYWxzZSk7CgkJCQl9CgkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ1BBRERJTkctQk9UVE9NJ10pKSB7CgkJCQkJJG9iamF0dHJbJ3BhZGRpbmdfYm90dG9tJ10gPSAkdGhpcy0+bXBkZi0+Q29udmVydFNpemUoJHByb3BlcnRpZXNbJ1BBRERJTkctQk9UVE9NJ10sICR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ2lubmVyX3dpZHRoJ10sICR0aGlzLT5tcGRmLT5Gb250U2l6ZSwgZmFsc2UpOwoJCQkJfQoJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydQQURESU5HLUxFRlQnXSkpIHsKCQkJCQkkb2JqYXR0clsncGFkZGluZ19sZWZ0J10gPSAkdGhpcy0+bXBkZi0+Q29udmVydFNpemUoJHByb3BlcnRpZXNbJ1BBRERJTkctTEVGVCddLCAkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWydpbm5lcl93aWR0aCddLCAkdGhpcy0+bXBkZi0+Rm9udFNpemUsIGZhbHNlKTsKCQkJCX0KCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snUEFERElORy1SSUdIVCddKSkgewoJCQkJCSRvYmphdHRyWydwYWRkaW5nX3JpZ2h0J10gPSAkdGhpcy0+bXBkZi0+Q29udmVydFNpemUoJHByb3BlcnRpZXNbJ1BBRERJTkctUklHSFQnXSwgJHRoaXMtPm1wZGYtPmJsa1skdGhpcy0+bXBkZi0+YmxrbHZsXVsnaW5uZXJfd2lkdGgnXSwgJHRoaXMtPm1wZGYtPkZvbnRTaXplLCBmYWxzZSk7CgkJCQl9CgoJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydCT1JERVItVE9QJ10pKSB7CgkJCQkJJG9iamF0dHJbJ2JvcmRlcl90b3AnXSA9ICR0aGlzLT5tcGRmLT5ib3JkZXJfZGV0YWlscygkcHJvcGVydGllc1snQk9SREVSLVRPUCddKTsKCQkJCX0KCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snQk9SREVSLUJPVFRPTSddKSkgewoJCQkJCSRvYmphdHRyWydib3JkZXJfYm90dG9tJ10gPSAkdGhpcy0+bXBkZi0+Ym9yZGVyX2RldGFpbHMoJHByb3BlcnRpZXNbJ0JPUkRFUi1CT1RUT00nXSk7CgkJCQl9CgkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ0JPUkRFUi1MRUZUJ10pKSB7CgkJCQkJJG9iamF0dHJbJ2JvcmRlcl9sZWZ0J10gPSAkdGhpcy0+bXBkZi0+Ym9yZGVyX2RldGFpbHMoJHByb3BlcnRpZXNbJ0JPUkRFUi1MRUZUJ10pOwoJCQkJfQoJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydCT1JERVItUklHSFQnXSkpIHsKCQkJCQkkb2JqYXR0clsnYm9yZGVyX3JpZ2h0J10gPSAkdGhpcy0+bXBkZi0+Ym9yZGVyX2RldGFpbHMoJHByb3BlcnRpZXNbJ0JPUkRFUi1SSUdIVCddKTsKCQkJCX0KCgkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ09QQUNJVFknXSkgJiYgJHByb3BlcnRpZXNbJ09QQUNJVFknXSA+IDAgJiYgJHByb3BlcnRpZXNbJ09QQUNJVFknXSA8PSAxKSB7CgkJCQkJJG9iamF0dHJbJ29wYWNpdHknXSA9ICRwcm9wZXJ0aWVzWydPUEFDSVRZJ107CgkJCQl9CgkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ0JBQ0tHUk9VTkQtQ09MT1InXSkgJiYgJHByb3BlcnRpZXNbJ0JBQ0tHUk9VTkQtQ09MT1InXSAhPSAnJykgewoJCQkJCSRvYmphdHRyWydiZ2NvbG9yJ10gPSAkdGhpcy0+bXBkZi0+Q29udmVydENvbG9yKCRwcm9wZXJ0aWVzWydCQUNLR1JPVU5ELUNPTE9SJ10pOwoJCQkJfSBlbHNlIHsKCQkJCQkkb2JqYXR0clsnYmdjb2xvciddID0gZmFsc2U7CgkJCQl9CgkJCQlpZiAoJHRoaXMtPm1wZGYtPkhSRUYpIHsKCQkJCQlpZiAoc3RycG9zKCR0aGlzLT5tcGRmLT5IUkVGLCAiLiIpID09PSBmYWxzZSAmJiBzdHJwb3MoJHRoaXMtPm1wZGYtPkhSRUYsICJAIikgIT09IDApIHsKCQkJCQkJJGhyZWYgPSAkdGhpcy0+bXBkZi0+SFJFRjsKCQkJCQkJd2hpbGUgKGFycmF5X2tleV9leGlzdHMoJGhyZWYsICR0aGlzLT5tcGRmLT5pbnRlcm5hbGxpbmspKQoJCQkJCQkJJGhyZWYgPSAiIyIgLiAkaHJlZjsKCQkJCQkJJHRoaXMtPm1wZGYtPmludGVybmFsbGlua1skaHJlZl0gPSAkdGhpcy0+bXBkZi0+QWRkTGluaygpOwoJCQkJCQkkb2JqYXR0clsnbGluayddID0gJHRoaXMtPm1wZGYtPmludGVybmFsbGlua1skaHJlZl07CgkJCQkJfSBlbHNlIHsKCQkJCQkJJG9iamF0dHJbJ2xpbmsnXSA9ICR0aGlzLT5tcGRmLT5IUkVGOwoJCQkJCX0KCQkJCX0KCQkJCSRleHRyYWhlaWdodCA9ICRvYmphdHRyWydwYWRkaW5nX3RvcCddICsgJG9iamF0dHJbJ3BhZGRpbmdfYm90dG9tJ10gKyAkb2JqYXR0clsnbWFyZ2luX3RvcCddICsgJG9iamF0dHJbJ21hcmdpbl9ib3R0b20nXSArICRvYmphdHRyWydib3JkZXJfdG9wJ11bJ3cnXSArICRvYmphdHRyWydib3JkZXJfYm90dG9tJ11bJ3cnXTsKCQkJCSRleHRyYXdpZHRoID0gJG9iamF0dHJbJ3BhZGRpbmdfbGVmdCddICsgJG9iamF0dHJbJ3BhZGRpbmdfcmlnaHQnXSArICRvYmphdHRyWydtYXJnaW5fbGVmdCddICsgJG9iamF0dHJbJ21hcmdpbl9yaWdodCddICsgJG9iamF0dHJbJ2JvcmRlcl9sZWZ0J11bJ3cnXSArICRvYmphdHRyWydib3JkZXJfcmlnaHQnXVsndyddOwoKCgkJCQkkdyA9ICRvYmphdHRyWydyJ10gKiAyOwoJCQkJJGggPSAkdzsKCQkJCSRvYmphdHRyWydoZWlnaHQnXSA9ICRoICsgJGV4dHJhaGVpZ2h0OwoJCQkJJG9iamF0dHJbJ3dpZHRoJ10gPSAkdyArICRleHRyYXdpZHRoOwoJCQkJJG9iamF0dHJbJ3R5cGUnXSA9ICd0ZXh0Y2lyY2xlJzsKCgkJCQkkZSA9ICJceGJiXHhhNFx4YWN0eXBlPWltYWdlLG9iamF0dHI9IiAuIHNlcmlhbGl6ZSgkb2JqYXR0cikgLiAiXHhiYlx4YTRceGFjIjsKCgkJCQkvLyBDbGVhciBwcm9wZXJ0aWVzIC0gdGlkeSB1cAoJCQkJJHByb3BlcnRpZXMgPSBhcnJheSgpOwoKCQkJCS8qIC0tIFRBQkxFUyAtLSAqLwoJCQkJLy8gT3V0cHV0IGl0IHRvIGJ1ZmZlcnMKCQkJCWlmICgkdGhpcy0+bXBkZi0+dGFibGVMZXZlbCkgewoJCQkJCSR0aGlzLT5tcGRmLT5fc2F2ZUNlbGxUZXh0QnVmZmVyKCRlLCAkdGhpcy0+bXBkZi0+SFJFRik7CgkJCQkJJHRoaXMtPm1wZGYtPmNlbGxbJHRoaXMtPm1wZGYtPnJvd11bJHRoaXMtPm1wZGYtPmNvbF1bJ3MnXSArPSAkb2JqYXR0clsnd2lkdGgnXTsKCQkJCX0gZWxzZSB7CgkJCQkJLyogLS0gRU5EIFRBQkxFUyAtLSAqLwoJCQkJCSR0aGlzLT5tcGRmLT5fc2F2ZVRleHRCdWZmZXIoJGUsICR0aGlzLT5tcGRmLT5IUkVGKTsKCQkJCX0gLy8gKlRBQkxFUyoKCgkJCQlpZiAoJHRoaXMtPm1wZGYtPklubGluZVByb3BlcnRpZXNbJHRhZ10pIHsKCQkJCQkkdGhpcy0+bXBkZi0+cmVzdG9yZUlubGluZVByb3BlcnRpZXMoJHRoaXMtPm1wZGYtPklubGluZVByb3BlcnRpZXNbJHRhZ10pOwoJCQkJfQoJCQkJdW5zZXQoJHRoaXMtPm1wZGYtPklubGluZVByb3BlcnRpZXNbJHRhZ10pOwoKCQkJCWJyZWFrOwoKCgkJCS8qIC0tIFRBQkxFUyAtLSAqLwoKCQkJY2FzZSAnVEFCTEUnOiAvLyBUQUJMRS1CRUdJTgoJCQkJJHRoaXMtPm1wZGYtPnRkYmVnaW4gPSBmYWxzZTsKCQkJCSR0aGlzLT5tcGRmLT5sYXN0b3B0aW9uYWx0YWcgPSAnJzsKCQkJCS8vIERpc2FibGUgdmVydGljYWwganVzdGlmaWNhdGlvbiBpbiBjb2x1bW5zCgkJCQlpZiAoJHRoaXMtPm1wZGYtPkNvbEFjdGl2ZSkgewoJCQkJCSR0aGlzLT5tcGRmLT5jb2x2QWxpZ24gPSAnJzsKCQkJCX0gLy8gKkNPTFVNTlMqCgkJCQlpZiAoJHRoaXMtPm1wZGYtPmxhc3RibG9ja2xldmVsY2hhbmdlID09IDEpIHsKCQkJCQkkYmxvY2tzdGF0ZSA9IDE7CgkJCQl9IC8vIFRvcCBtYXJnaW5zL3BhZGRpbmcgb25seQoJCQkJZWxzZSBpZiAoJHRoaXMtPm1wZGYtPmxhc3RibG9ja2xldmVsY2hhbmdlIDwgMSkgewoJCQkJCSRibG9ja3N0YXRlID0gMDsKCQkJCX0gLy8gTk8gbWFyZ2lucy9wYWRkaW5nCgkJCQkvLyBjYWxsZWQgZnJvbSBibG9jayBhZnRlciBuZXcgZGl2IGUuZy4gPGRpdj4gLi4uIDx0YWJsZT4gLi4uICAgIE91dHB1dHMgYmxvY2sgdG9wIG1hcmdpbi9ib3JkZXIgYW5kIHBhZGRpbmcKCQkJCWlmIChjb3VudCgkdGhpcy0+bXBkZi0+dGV4dGJ1ZmZlcikgPT0gMCAmJiAkdGhpcy0+bXBkZi0+bGFzdGJsb2NrbGV2ZWxjaGFuZ2UgPT0gMSAmJiAhJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWwgJiYgISR0aGlzLT5tcGRmLT5rd3QpIHsKCQkJCQkkdGhpcy0+bXBkZi0+bmV3Rmxvd2luZ0Jsb2NrKCR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ3dpZHRoJ10sICR0aGlzLT5tcGRmLT5saW5laGVpZ2h0LCAnJywgZmFsc2UsIDEsIHRydWUsICR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ2RpcmVjdGlvbiddKTsKCQkJCQkkdGhpcy0+bXBkZi0+ZmluaXNoRmxvd2luZ0Jsb2NrKHRydWUpOyAvLyB0cnVlID0gRU5EIG9mIGZsb3dpbmcgYmxvY2sKCQkJCX0gZWxzZSBpZiAoISR0aGlzLT5tcGRmLT50YWJsZUxldmVsICYmIGNvdW50KCR0aGlzLT5tcGRmLT50ZXh0YnVmZmVyKSkgewoJCQkJCSR0aGlzLT5tcGRmLT5wcmludGJ1ZmZlcigkdGhpcy0+bXBkZi0+dGV4dGJ1ZmZlciwgJGJsb2Nrc3RhdGUpOwoJCQkJfQoKCQkJCSR0aGlzLT5tcGRmLT50ZXh0YnVmZmVyID0gYXJyYXkoKTsKCQkJCSR0aGlzLT5tcGRmLT5sYXN0YmxvY2tsZXZlbGNoYW5nZSA9IC0xOwoKCgoJCQkJaWYgKCR0aGlzLT5tcGRmLT50YWJsZUxldmVsKSB7IC8vIGkuZS4gbm93IGEgbmVzdGVkIHRhYmxlIGNvbWluZy4uLgoJCQkJCS8vIFNhdmUgY3VycmVudCBsZXZlbCB0YWJsZQoJCQkJCSR0aGlzLT5tcGRmLT5jZWxsWydQQVJFTlRDRUxMJ10gPSAkdGhpcy0+bXBkZi0+c2F2ZUlubGluZVByb3BlcnRpZXMoKTsKCQkJCQkkdGhpcy0+bXBkZi0+dGFibGVbJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWxdWyR0aGlzLT5tcGRmLT50YmN0clskdGhpcy0+bXBkZi0+dGFibGVMZXZlbF1dWydiYXNlUHJvcGVydGllcyddID0gJHRoaXMtPm1wZGYtPmJhc2VfdGFibGVfcHJvcGVydGllczsKCQkJCQkkdGhpcy0+bXBkZi0+dGFibGVbJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWxdWyR0aGlzLT5tcGRmLT50YmN0clskdGhpcy0+bXBkZi0+dGFibGVMZXZlbF1dWydjZWxscyddID0gJHRoaXMtPm1wZGYtPmNlbGw7CgkJCQkJJHRoaXMtPm1wZGYtPnRhYmxlWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXVskdGhpcy0+bXBkZi0+dGJjdHJbJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWxdXVsnY3VycnJvdyddID0gJHRoaXMtPm1wZGYtPnJvdzsKCQkJCQkkdGhpcy0+bXBkZi0+dGFibGVbJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWxdWyR0aGlzLT5tcGRmLT50YmN0clskdGhpcy0+bXBkZi0+dGFibGVMZXZlbF1dWydjdXJyY29sJ10gPSAkdGhpcy0+bXBkZi0+Y29sOwoJCQkJfQoJCQkJJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWwrKzsKCQkJCSR0aGlzLT5tcGRmLT5jc3NtZ3ItPnRiQ1NTbHZsKys7CgoJCQkJaWYgKCR0aGlzLT5tcGRmLT50YWJsZUxldmVsID4gMSkgeyAvLyBpbmhlcml0IHRhYmxlIHByb3BlcnRpZXMgZnJvbSBjZWxsIGluIHdoaWNoIG5lc3RlZAoJCQkJCS8vJHRoaXMtPm1wZGYtPmJhc2VfdGFibGVfcHJvcGVydGllc1snRk9OVC1LRVJOSU5HJ10gPSAoJHRoaXMtPm1wZGYtPnRleHR2YXIgJiBGQ19LRVJOSU5HKTsJLy8gbVBERiA2CgkJCQkJJHRoaXMtPm1wZGYtPmJhc2VfdGFibGVfcHJvcGVydGllc1snTEVUVEVSLVNQQUNJTkcnXSA9ICR0aGlzLT5tcGRmLT5sU3BhY2luZ0NTUzsKCQkJCQkkdGhpcy0+bXBkZi0+YmFzZV90YWJsZV9wcm9wZXJ0aWVzWydXT1JELVNQQUNJTkcnXSA9ICR0aGlzLT5tcGRmLT53U3BhY2luZ0NTUzsKCQkJCQkvLyBtUERGIDYKCQkJCQkkZGlyZWN0aW9uID0gJHRoaXMtPm1wZGYtPmNlbGxbJHRoaXMtPm1wZGYtPnJvd11bJHRoaXMtPm1wZGYtPmNvbF1bJ2RpcmVjdGlvbiddOwoJCQkJCSR0eHRhID0gJHRoaXMtPm1wZGYtPmNlbGxbJHRoaXMtPm1wZGYtPnJvd11bJHRoaXMtPm1wZGYtPmNvbF1bJ2EnXTsKCQkJCQkkY2VsbExpbmVIZWlnaHQgPSAkdGhpcy0+bXBkZi0+Y2VsbFskdGhpcy0+bXBkZi0+cm93XVskdGhpcy0+bXBkZi0+Y29sXVsnY2VsbExpbmVIZWlnaHQnXTsKCQkJCQkkY2VsbExpbmVTdGFja2luZ1N0cmF0ZWd5ID0gJHRoaXMtPm1wZGYtPmNlbGxbJHRoaXMtPm1wZGYtPnJvd11bJHRoaXMtPm1wZGYtPmNvbF1bJ2NlbGxMaW5lU3RhY2tpbmdTdHJhdGVneSddOwoJCQkJCSRjZWxsTGluZVN0YWNraW5nU2hpZnQgPSAkdGhpcy0+bXBkZi0+Y2VsbFskdGhpcy0+bXBkZi0+cm93XVskdGhpcy0+bXBkZi0+Y29sXVsnY2VsbExpbmVTdGFja2luZ1NoaWZ0J107CgkJCQl9CgoJCQkJaWYgKGlzc2V0KCR0aGlzLT5tcGRmLT50YmN0clskdGhpcy0+bXBkZi0+dGFibGVMZXZlbF0pKSB7CgkJCQkJJHRoaXMtPm1wZGYtPnRiY3RyWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXSArKzsKCQkJCX0gZWxzZSB7CgkJCQkJJHRoaXMtPm1wZGYtPnRiY3RyWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXSA9IDE7CgkJCQl9CgoJCQkJJHRoaXMtPm1wZGYtPnRhYmxlWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXVskdGhpcy0+bXBkZi0+dGJjdHJbJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWxdXVsnbGV2ZWwnXSA9ICR0aGlzLT5tcGRmLT50YWJsZUxldmVsOwoJCQkJJHRoaXMtPm1wZGYtPnRhYmxlWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXVskdGhpcy0+bXBkZi0+dGJjdHJbJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWxdXVsnbGV2ZWxpZCddID0gJHRoaXMtPm1wZGYtPnRiY3RyWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXTsKCgkJCQlpZiAoJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWwgPiAkdGhpcy0+bXBkZi0+aW5uZXJtb3N0VGFibGVMZXZlbCkgewoJCQkJCSR0aGlzLT5tcGRmLT5pbm5lcm1vc3RUYWJsZUxldmVsID0gJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWw7CgkJCQl9CgkJCQlpZiAoJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWwgPiAxKSB7CgkJCQkJJHRoaXMtPm1wZGYtPnRhYmxlWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXVskdGhpcy0+bXBkZi0+dGJjdHJbJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWxdXVsnbmVzdGVkcG9zJ10gPSBhcnJheSgkdGhpcy0+bXBkZi0+cm93LCAkdGhpcy0+bXBkZi0+Y29sLCAkdGhpcy0+bXBkZi0+dGJjdHJbKCR0aGlzLT5tcGRmLT50YWJsZUxldmVsIC0gMSldKTsKCQkJCX0KCQkJCS8vKysrKysrKysrKysrKysrKysrKysrKysrKysrKwoKCQkJCSR0aGlzLT5tcGRmLT5jZWxsID0gYXJyYXkoKTsKCQkJCSR0aGlzLT5tcGRmLT5jb2wgPSAtMTsgLy9pbnQKCQkJCSR0aGlzLT5tcGRmLT5yb3cgPSAtMTsgLy9pbnQKCQkJCSR0YWJsZSA9ICYkdGhpcy0+bXBkZi0+dGFibGVbJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWxdWyR0aGlzLT5tcGRmLT50YmN0clskdGhpcy0+bXBkZi0+dGFibGVMZXZlbF1dOwoKCQkJCS8vIE5ldyB0YWJsZSAtIGFueSBsZXZlbAoJCQkJJHRhYmxlWydkaXJlY3Rpb24nXSA9ICR0aGlzLT5tcGRmLT5kaXJlY3Rpb25hbGl0eTsKCQkJCSR0YWJsZVsnYmdjb2xvciddID0gZmFsc2U7CgkJCQkkdGFibGVbJ3ZhJ10gPSBmYWxzZTsKCQkJCSR0YWJsZVsndHh0YSddID0gZmFsc2U7CgkJCQkkdGFibGVbJ3RvcG50YWlsJ10gPSBmYWxzZTsKCQkJCSR0YWJsZVsndGhlYWQtdW5kZXJsaW5lJ10gPSBmYWxzZTsKCQkJCSR0YWJsZVsnYm9yZGVyJ10gPSBmYWxzZTsKCQkJCSR0YWJsZVsnYm9yZGVyX2RldGFpbHMnXVsnUiddWyd3J10gPSAwOwoJCQkJJHRhYmxlWydib3JkZXJfZGV0YWlscyddWydMJ11bJ3cnXSA9IDA7CgkJCQkkdGFibGVbJ2JvcmRlcl9kZXRhaWxzJ11bJ1QnXVsndyddID0gMDsKCQkJCSR0YWJsZVsnYm9yZGVyX2RldGFpbHMnXVsnQiddWyd3J10gPSAwOwoJCQkJJHRhYmxlWydib3JkZXJfZGV0YWlscyddWydSJ11bJ3N0eWxlJ10gPSAnJzsKCQkJCSR0YWJsZVsnYm9yZGVyX2RldGFpbHMnXVsnTCddWydzdHlsZSddID0gJyc7CgkJCQkkdGFibGVbJ2JvcmRlcl9kZXRhaWxzJ11bJ1QnXVsnc3R5bGUnXSA9ICcnOwoJCQkJJHRhYmxlWydib3JkZXJfZGV0YWlscyddWydCJ11bJ3N0eWxlJ10gPSAnJzsKCQkJCSR0YWJsZVsnbWF4X2NlbGxfYm9yZGVyX3dpZHRoJ11bJ1InXSA9IDA7CgkJCQkkdGFibGVbJ21heF9jZWxsX2JvcmRlcl93aWR0aCddWydMJ10gPSAwOwoJCQkJJHRhYmxlWydtYXhfY2VsbF9ib3JkZXJfd2lkdGgnXVsnVCddID0gMDsKCQkJCSR0YWJsZVsnbWF4X2NlbGxfYm9yZGVyX3dpZHRoJ11bJ0InXSA9IDA7CgkJCQkkdGFibGVbJ3BhZGRpbmcnXVsnTCddID0gZmFsc2U7CgkJCQkkdGFibGVbJ3BhZGRpbmcnXVsnUiddID0gZmFsc2U7CgkJCQkkdGFibGVbJ3BhZGRpbmcnXVsnVCddID0gZmFsc2U7CgkJCQkkdGFibGVbJ3BhZGRpbmcnXVsnQiddID0gZmFsc2U7CgkJCQkkdGFibGVbJ21hcmdpbiddWydMJ10gPSBmYWxzZTsKCQkJCSR0YWJsZVsnbWFyZ2luJ11bJ1InXSA9IGZhbHNlOwoJCQkJJHRhYmxlWydtYXJnaW4nXVsnVCddID0gZmFsc2U7CgkJCQkkdGFibGVbJ21hcmdpbiddWydCJ10gPSBmYWxzZTsKCQkJCSR0YWJsZVsnYSddID0gZmFsc2U7CgkJCQkkdGFibGVbJ2JvcmRlcl9zcGFjaW5nX0gnXSA9IGZhbHNlOwoJCQkJJHRhYmxlWydib3JkZXJfc3BhY2luZ19WJ10gPSBmYWxzZTsKCQkJCSR0YWJsZVsnZGVjaW1hbF9hbGlnbiddID0gZmFsc2U7CgkJCQkkdGhpcy0+bXBkZi0+UmVzZXQoKTsKCQkJCSR0aGlzLT5tcGRmLT5JbmxpbmVQcm9wZXJ0aWVzID0gYXJyYXkoKTsKCQkJCSR0aGlzLT5tcGRmLT5JbmxpbmVCREYgPSBhcnJheSgpOyAvLyBtUERGIDYKCQkJCSR0aGlzLT5tcGRmLT5JbmxpbmVCREZjdHIgPSAwOyAvLyBtUERGIDYKCQkJCSR0YWJsZVsnbmMnXSA9ICR0YWJsZVsnbnInXSA9IDA7CgkJCQkkdGhpcy0+bXBkZi0+dGFibGV0aGVhZCA9IDA7CgkJCQkkdGhpcy0+bXBkZi0+dGFibGV0Zm9vdCA9IDA7CgkJCQkkdGhpcy0+bXBkZi0+dGFibGV0aGVhZGp1c3RmaW5pc2hlZCA9IGZhbHNlOwoKCQkJCS8vIG1QREYgNgoJCQkJaWYgKCR0aGlzLT5tcGRmLT50YWJsZUxldmVsID4gMSkgeyAvLyBpbmhlcml0IHRhYmxlIHByb3BlcnRpZXMgZnJvbSBjZWxsIGluIHdoaWNoIG5lc3RlZAoJCQkJCSR0YWJsZVsnZGlyZWN0aW9uJ10gPSAkZGlyZWN0aW9uOwoJCQkJCSR0YWJsZVsndHh0YSddID0gJHR4dGE7CgkJCQkJJHRhYmxlWydjZWxsTGluZUhlaWdodCddID0gJGNlbGxMaW5lSGVpZ2h0OwoJCQkJCSR0YWJsZVsnY2VsbExpbmVTdGFja2luZ1N0cmF0ZWd5J10gPSAkY2VsbExpbmVTdGFja2luZ1N0cmF0ZWd5OwoJCQkJCSR0YWJsZVsnY2VsbExpbmVTdGFja2luZ1NoaWZ0J10gPSAkY2VsbExpbmVTdGFja2luZ1NoaWZ0OwoJCQkJfQoKCgkJCQlpZiAoJHRoaXMtPm1wZGYtPmJsb2NranVzdGZpbmlzaGVkICYmICFjb3VudCgkdGhpcy0+bXBkZi0+dGV4dGJ1ZmZlcikgJiYgJHRoaXMtPm1wZGYtPnkgIT0gJHRoaXMtPm1wZGYtPnRNYXJnaW4gJiYgJHRoaXMtPm1wZGYtPmNvbGxhcHNlQmxvY2tNYXJnaW5zICYmICR0aGlzLT5tcGRmLT50YWJsZUxldmVsID09IDEpIHsKCQkJCQkkbGFzdGJvdHRvbW1hcmdpbiA9ICR0aGlzLT5tcGRmLT5sYXN0YmxvY2tib3R0b21tYXJnaW47CgkJCQl9IGVsc2UgewoJCQkJCSRsYXN0Ym90dG9tbWFyZ2luID0gMDsKCQkJCX0KCQkJCSR0aGlzLT5tcGRmLT5sYXN0YmxvY2tib3R0b21tYXJnaW4gPSAwOwoJCQkJJHRoaXMtPm1wZGYtPmJsb2NranVzdGZpbmlzaGVkID0gZmFsc2U7CgoJCQkJaWYgKCR0aGlzLT5tcGRmLT50YWJsZUxldmVsID09IDEpIHsKCQkJCQkkdGFibGVbJ2hlYWRlcm5yb3dzJ10gPSAwOwoJCQkJCSR0YWJsZVsnZm9vdGVybnJvd3MnXSA9IDA7CgkJCQkJJHRoaXMtPm1wZGYtPmJhc2VfdGFibGVfcHJvcGVydGllcyA9IGFycmF5KCk7CgkJCQl9CgoJCQkJLy8gQURERUQgQ1NTIEZVTkNJT05TIEZPUiBUQUJMRQoJCQkJaWYgKCR0aGlzLT5tcGRmLT5jc3NtZ3ItPnRiQ1NTbHZsID09IDEpIHsKCQkJCQkkcHJvcGVydGllcyA9ICR0aGlzLT5tcGRmLT5jc3NtZ3ItPk1lcmdlQ1NTKCdUT1BUQUJMRScsICR0YWcsICRhdHRyKTsKCQkJCX0gZWxzZSB7CgkJCQkJJHByb3BlcnRpZXMgPSAkdGhpcy0+bXBkZi0+Y3NzbWdyLT5NZXJnZUNTUygnVEFCTEUnLCAkdGFnLCAkYXR0cik7CgkJCQl9CgoJCQkJJHcgPSAnJzsKCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snV0lEVEgnXSkpIHsKCQkJCQkkdyA9ICRwcm9wZXJ0aWVzWydXSURUSCddOwoJCQkJfSBlbHNlIGlmIChpc3NldCgkYXR0clsnV0lEVEgnXSkgJiYgJGF0dHJbJ1dJRFRIJ10pIHsKCQkJCQkkdyA9ICRhdHRyWydXSURUSCddOwoJCQkJfQoKCQkJCWlmIChpc3NldCgkYXR0clsnQUxJR04nXSkgJiYgaXNzZXQoJGFsaWduW3N0cnRvbG93ZXIoJGF0dHJbJ0FMSUdOJ10pXSkpIHsKCQkJCQkkdGFibGVbJ2EnXSA9ICRhbGlnbltzdHJ0b2xvd2VyKCRhdHRyWydBTElHTiddKV07CgkJCQl9CgkJCQlpZiAoISR0YWJsZVsnYSddKSB7CgkJCQkJaWYgKCR0YWJsZVsnZGlyZWN0aW9uJ10gPT0gJ3J0bCcpIHsKCQkJCQkJJHRhYmxlWydhJ10gPSAnUic7CgkJCQkJfSBlbHNlIHsKCQkJCQkJJHRhYmxlWydhJ10gPSAnTCc7CgkJCQkJfQoJCQkJfQoKCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snRElSRUNUSU9OJ10pICYmICRwcm9wZXJ0aWVzWydESVJFQ1RJT04nXSkgewoJCQkJCSR0YWJsZVsnZGlyZWN0aW9uJ10gPSBzdHJ0b2xvd2VyKCRwcm9wZXJ0aWVzWydESVJFQ1RJT04nXSk7CgkJCQl9IGVsc2UgaWYgKGlzc2V0KCRhdHRyWydESVInXSkgJiYgJGF0dHJbJ0RJUiddKSB7CgkJCQkJJHRhYmxlWydkaXJlY3Rpb24nXSA9IHN0cnRvbG93ZXIoJGF0dHJbJ0RJUiddKTsKCQkJCX0gZWxzZSBpZiAoJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWwgPT0gMSkgewoJCQkJCSR0YWJsZVsnZGlyZWN0aW9uJ10gPSAkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWydkaXJlY3Rpb24nXTsKCQkJCX0KCgkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ0JBQ0tHUk9VTkQtQ09MT1InXSkpIHsKCQkJCQkkdGFibGVbJ2JnY29sb3InXVstMV0gPSAkcHJvcGVydGllc1snQkFDS0dST1VORC1DT0xPUiddOwoJCQkJfSBlbHNlIGlmIChpc3NldCgkcHJvcGVydGllc1snQkFDS0dST1VORCddKSkgewoJCQkJCSR0YWJsZVsnYmdjb2xvciddWy0xXSA9ICRwcm9wZXJ0aWVzWydCQUNLR1JPVU5EJ107CgkJCQl9IGVsc2UgaWYgKGlzc2V0KCRhdHRyWydCR0NPTE9SJ10pKSB7CgkJCQkJJHRhYmxlWydiZ2NvbG9yJ11bLTFdID0gJGF0dHJbJ0JHQ09MT1InXTsKCQkJCX0KCgkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ1ZFUlRJQ0FMLUFMSUdOJ10pICYmIGlzc2V0KCRhbGlnbltzdHJ0b2xvd2VyKCRwcm9wZXJ0aWVzWydWRVJUSUNBTC1BTElHTiddKV0pKSB7CgkJCQkJJHRhYmxlWyd2YSddID0gJGFsaWduW3N0cnRvbG93ZXIoJHByb3BlcnRpZXNbJ1ZFUlRJQ0FMLUFMSUdOJ10pXTsKCQkJCX0KCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snVEVYVC1BTElHTiddKSAmJiBpc3NldCgkYWxpZ25bc3RydG9sb3dlcigkcHJvcGVydGllc1snVEVYVC1BTElHTiddKV0pKSB7CgkJCQkJJHRhYmxlWyd0eHRhJ10gPSAkYWxpZ25bc3RydG9sb3dlcigkcHJvcGVydGllc1snVEVYVC1BTElHTiddKV07CgkJCQl9CgoJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydBVVRPU0laRSddKSAmJiAkcHJvcGVydGllc1snQVVUT1NJWkUnXSAmJiAkdGhpcy0+bXBkZi0+dGFibGVMZXZlbCA9PSAxKSB7CgkJCQkJJHRoaXMtPm1wZGYtPnNocmlua190aGlzX3RhYmxlX3RvX2ZpdCA9ICRwcm9wZXJ0aWVzWydBVVRPU0laRSddOwoJCQkJCWlmICgkdGhpcy0+bXBkZi0+c2hyaW5rX3RoaXNfdGFibGVfdG9fZml0IDwgMSkgewoJCQkJCQkkdGhpcy0+bXBkZi0+c2hyaW5rX3RoaXNfdGFibGVfdG9fZml0ID0gMDsKCQkJCQl9CgkJCQl9CgkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ1JPVEFURSddKSAmJiAkcHJvcGVydGllc1snUk9UQVRFJ10gJiYgJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWwgPT0gMSkgewoJCQkJCSR0aGlzLT5tcGRmLT50YWJsZV9yb3RhdGUgPSAkcHJvcGVydGllc1snUk9UQVRFJ107CgkJCQl9CgkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ1RPUE5UQUlMJ10pKSB7CgkJCQkJJHRhYmxlWyd0b3BudGFpbCddID0gJHByb3BlcnRpZXNbJ1RPUE5UQUlMJ107CgkJCQl9CgkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ1RIRUFELVVOREVSTElORSddKSkgewoJCQkJCSR0YWJsZVsndGhlYWQtdW5kZXJsaW5lJ10gPSAkcHJvcGVydGllc1snVEhFQUQtVU5ERVJMSU5FJ107CgkJCQl9CgoJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydCT1JERVInXSkpIHsKCQkJCQkkYm9yZCA9ICR0aGlzLT5tcGRmLT5ib3JkZXJfZGV0YWlscygkcHJvcGVydGllc1snQk9SREVSJ10pOwoJCQkJCWlmICgkYm9yZFsncyddKSB7CgkJCQkJCSR0YWJsZVsnYm9yZGVyJ10gPSBfQk9SREVSX0FMTDsKCQkJCQkJJHRhYmxlWydib3JkZXJfZGV0YWlscyddWydSJ10gPSAkYm9yZDsKCQkJCQkJJHRhYmxlWydib3JkZXJfZGV0YWlscyddWydMJ10gPSAkYm9yZDsKCQkJCQkJJHRhYmxlWydib3JkZXJfZGV0YWlscyddWydUJ10gPSAkYm9yZDsKCQkJCQkJJHRhYmxlWydib3JkZXJfZGV0YWlscyddWydCJ10gPSAkYm9yZDsKCQkJCQl9CgkJCQl9CgkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ0JPUkRFUi1SSUdIVCddKSkgewoJCQkJCWlmICgkdGFibGVbJ2RpcmVjdGlvbiddID09ICdydGwnKSB7ICAvLyAqT1RMKgoJCQkJCQkkdGFibGVbJ2JvcmRlcl9kZXRhaWxzJ11bJ1InXSA9ICR0aGlzLT5tcGRmLT5ib3JkZXJfZGV0YWlscygkcHJvcGVydGllc1snQk9SREVSLUxFRlQnXSk7IC8vICpPVEwqCgkJCQkJfSAvLyAqT1RMKgoJCQkJCWVsc2UgeyAvLyAqT1RMKgoJCQkJCQkkdGFibGVbJ2JvcmRlcl9kZXRhaWxzJ11bJ1InXSA9ICR0aGlzLT5tcGRmLT5ib3JkZXJfZGV0YWlscygkcHJvcGVydGllc1snQk9SREVSLVJJR0hUJ10pOwoJCQkJCX0gLy8gKk9UTCoKCQkJCQkkdGhpcy0+bXBkZi0+c2V0Qm9yZGVyKCR0YWJsZVsnYm9yZGVyJ10sIF9CT1JERVJfUklHSFQsICR0YWJsZVsnYm9yZGVyX2RldGFpbHMnXVsnUiddWydzJ10pOwoJCQkJfQoJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydCT1JERVItTEVGVCddKSkgewoJCQkJCWlmICgkdGFibGVbJ2RpcmVjdGlvbiddID09ICdydGwnKSB7ICAvLyAqT1RMKgoJCQkJCQkkdGFibGVbJ2JvcmRlcl9kZXRhaWxzJ11bJ0wnXSA9ICR0aGlzLT5tcGRmLT5ib3JkZXJfZGV0YWlscygkcHJvcGVydGllc1snQk9SREVSLVJJR0hUJ10pOyAvLyAqT1RMKgoJCQkJCX0gLy8gKk9UTCoKCQkJCQllbHNlIHsgLy8gKk9UTCoKCQkJCQkJJHRhYmxlWydib3JkZXJfZGV0YWlscyddWydMJ10gPSAkdGhpcy0+bXBkZi0+Ym9yZGVyX2RldGFpbHMoJHByb3BlcnRpZXNbJ0JPUkRFUi1MRUZUJ10pOwoJCQkJCX0gLy8gKk9UTCoKCQkJCQkkdGhpcy0+bXBkZi0+c2V0Qm9yZGVyKCR0YWJsZVsnYm9yZGVyJ10sIF9CT1JERVJfTEVGVCwgJHRhYmxlWydib3JkZXJfZGV0YWlscyddWydMJ11bJ3MnXSk7CgkJCQl9CgkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ0JPUkRFUi1CT1RUT00nXSkpIHsKCQkJCQkkdGFibGVbJ2JvcmRlcl9kZXRhaWxzJ11bJ0InXSA9ICR0aGlzLT5tcGRmLT5ib3JkZXJfZGV0YWlscygkcHJvcGVydGllc1snQk9SREVSLUJPVFRPTSddKTsKCQkJCQkkdGhpcy0+bXBkZi0+c2V0Qm9yZGVyKCR0YWJsZVsnYm9yZGVyJ10sIF9CT1JERVJfQk9UVE9NLCAkdGFibGVbJ2JvcmRlcl9kZXRhaWxzJ11bJ0InXVsncyddKTsKCQkJCX0KCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snQk9SREVSLVRPUCddKSkgewoJCQkJCSR0YWJsZVsnYm9yZGVyX2RldGFpbHMnXVsnVCddID0gJHRoaXMtPm1wZGYtPmJvcmRlcl9kZXRhaWxzKCRwcm9wZXJ0aWVzWydCT1JERVItVE9QJ10pOwoJCQkJCSR0aGlzLT5tcGRmLT5zZXRCb3JkZXIoJHRhYmxlWydib3JkZXInXSwgX0JPUkRFUl9UT1AsICR0YWJsZVsnYm9yZGVyX2RldGFpbHMnXVsnVCddWydzJ10pOwoJCQkJfQoJCQkJaWYgKCR0YWJsZVsnYm9yZGVyJ10pIHsKCQkJCQkkdGhpcy0+bXBkZi0+dGFibGVfYm9yZGVyX2Nzc19zZXQgPSAxOwoJCQkJfSBlbHNlIHsKCQkJCQkkdGhpcy0+bXBkZi0+dGFibGVfYm9yZGVyX2Nzc19zZXQgPSAwOwoJCQkJfQoKCQkJCS8vIG1QREYgNgoJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydMQU5HJ10pICYmICRwcm9wZXJ0aWVzWydMQU5HJ10pIHsKCQkJCQlpZiAoJHRoaXMtPm1wZGYtPmF1dG9MYW5nVG9Gb250ICYmICEkdGhpcy0+bXBkZi0+dXNpbmdDb3JlRm9udCkgewoJCQkJCQlpZiAoJHByb3BlcnRpZXNbJ0xBTkcnXSAhPSAkdGhpcy0+bXBkZi0+ZGVmYXVsdF9sYW5nICYmICRwcm9wZXJ0aWVzWydMQU5HJ10gIT0gJ1VURi04JykgewoJCQkJCQkJbGlzdCAoJGNvcmVTdWl0YWJsZSwgJG1wZGZfcGRmX3VuaWZvbnQpID0gR2V0TGFuZ09wdHMoJHByb3BlcnRpZXNbJ0xBTkcnXSwgJHRoaXMtPm1wZGYtPnVzZUFkb2JlQ0pLLCAkdGhpcy0+bXBkZi0+Zm9udGRhdGEpOwoJCQkJCQkJaWYgKCRtcGRmX3BkZl91bmlmb250KSB7CgkJCQkJCQkJJHByb3BlcnRpZXNbJ0ZPTlQtRkFNSUxZJ10gPSAkbXBkZl9wZGZfdW5pZm9udDsKCQkJCQkJCX0KCQkJCQkJfQoJCQkJCX0KCQkJCQkkdGhpcy0+bXBkZi0+Y3VycmVudExhbmcgPSAkcHJvcGVydGllc1snTEFORyddOwoJCQkJfQoKCgkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ0ZPTlQtRkFNSUxZJ10pKSB7CgkJCQkJJHRoaXMtPm1wZGYtPmRlZmF1bHRfZm9udCA9ICRwcm9wZXJ0aWVzWydGT05ULUZBTUlMWSddOwoJCQkJCSR0aGlzLT5tcGRmLT5TZXRGb250KCR0aGlzLT5tcGRmLT5kZWZhdWx0X2ZvbnQsICcnLCAwLCBmYWxzZSk7CgkJCQl9CgkJCQkkdGhpcy0+bXBkZi0+YmFzZV90YWJsZV9wcm9wZXJ0aWVzWydGT05ULUZBTUlMWSddID0gJHRoaXMtPm1wZGYtPkZvbnRGYW1pbHk7CgoJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydGT05ULVNJWkUnXSkpIHsKCQkJCQlpZiAoJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWwgPiAxKSB7CgkJCQkJCSRtbXNpemUgPSAkdGhpcy0+bXBkZi0+Q29udmVydFNpemUoJHByb3BlcnRpZXNbJ0ZPTlQtU0laRSddLCAkdGhpcy0+bXBkZi0+YmFzZV90YWJsZV9wcm9wZXJ0aWVzWydGT05ULVNJWkUnXSk7CgkJCQkJfSBlbHNlIHsKCQkJCQkJJG1tc2l6ZSA9ICR0aGlzLT5tcGRmLT5Db252ZXJ0U2l6ZSgkcHJvcGVydGllc1snRk9OVC1TSVpFJ10sICR0aGlzLT5tcGRmLT5kZWZhdWx0X2ZvbnRfc2l6ZSAvIF9NUERGSyk7CgkJCQkJfQoJCQkJCWlmICgkbW1zaXplKSB7CgkJCQkJCSR0aGlzLT5tcGRmLT5kZWZhdWx0X2ZvbnRfc2l6ZSA9ICRtbXNpemUgKiAoX01QREZLKTsKCQkJCQkJJHRoaXMtPm1wZGYtPlNldEZvbnRTaXplKCR0aGlzLT5tcGRmLT5kZWZhdWx0X2ZvbnRfc2l6ZSwgZmFsc2UpOwoJCQkJCX0KCQkJCX0KCQkJCSR0aGlzLT5tcGRmLT5iYXNlX3RhYmxlX3Byb3BlcnRpZXNbJ0ZPTlQtU0laRSddID0gJHRoaXMtPm1wZGYtPkZvbnRTaXplIC4gJ21tJzsKCgkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ0ZPTlQtV0VJR0hUJ10pKSB7CgkJCQkJaWYgKHN0cnRvdXBwZXIoJHByb3BlcnRpZXNbJ0ZPTlQtV0VJR0hUJ10pID09ICdCT0xEJykgewoJCQkJCQkkdGhpcy0+bXBkZi0+YmFzZV90YWJsZV9wcm9wZXJ0aWVzWydGT05ULVdFSUdIVCddID0gJ0JPTEQnOwoJCQkJCX0KCQkJCX0KCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snRk9OVC1TVFlMRSddKSkgewoJCQkJCWlmIChzdHJ0b3VwcGVyKCRwcm9wZXJ0aWVzWydGT05ULVNUWUxFJ10pID09ICdJVEFMSUMnKSB7CgkJCQkJCSR0aGlzLT5tcGRmLT5iYXNlX3RhYmxlX3Byb3BlcnRpZXNbJ0ZPTlQtU1RZTEUnXSA9ICdJVEFMSUMnOwoJCQkJCX0KCQkJCX0KCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snQ09MT1InXSkpIHsKCQkJCQkkdGhpcy0+bXBkZi0+YmFzZV90YWJsZV9wcm9wZXJ0aWVzWydDT0xPUiddID0gJHByb3BlcnRpZXNbJ0NPTE9SJ107CgkJCQl9CgkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ0ZPTlQtS0VSTklORyddKSkgewoJCQkJCSR0aGlzLT5tcGRmLT5iYXNlX3RhYmxlX3Byb3BlcnRpZXNbJ0ZPTlQtS0VSTklORyddID0gJHByb3BlcnRpZXNbJ0ZPTlQtS0VSTklORyddOwoJCQkJfQoJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydMRVRURVItU1BBQ0lORyddKSkgewoJCQkJCSR0aGlzLT5tcGRmLT5iYXNlX3RhYmxlX3Byb3BlcnRpZXNbJ0xFVFRFUi1TUEFDSU5HJ10gPSAkcHJvcGVydGllc1snTEVUVEVSLVNQQUNJTkcnXTsKCQkJCX0KCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snV09SRC1TUEFDSU5HJ10pKSB7CgkJCQkJJHRoaXMtPm1wZGYtPmJhc2VfdGFibGVfcHJvcGVydGllc1snV09SRC1TUEFDSU5HJ10gPSAkcHJvcGVydGllc1snV09SRC1TUEFDSU5HJ107CgkJCQl9CgkJCQkvLyBtUERGIDYKCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snSFlQSEVOUyddKSkgewoJCQkJCSR0aGlzLT5tcGRmLT5iYXNlX3RhYmxlX3Byb3BlcnRpZXNbJ0hZUEhFTlMnXSA9ICRwcm9wZXJ0aWVzWydIWVBIRU5TJ107CgkJCQl9CgkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ0xJTkUtSEVJR0hUJ10pICYmICRwcm9wZXJ0aWVzWydMSU5FLUhFSUdIVCddKSB7CgkJCQkJJHRhYmxlWydjZWxsTGluZUhlaWdodCddID0gJHRoaXMtPm1wZGYtPmZpeExpbmVoZWlnaHQoJHByb3BlcnRpZXNbJ0xJTkUtSEVJR0hUJ10pOwoJCQkJfSBlbHNlIGlmICgkdGhpcy0+bXBkZi0+dGFibGVMZXZlbCA9PSAxKSB7CgkJCQkJJHRhYmxlWydjZWxsTGluZUhlaWdodCddID0gJHRoaXMtPm1wZGYtPmJsa1skdGhpcy0+bXBkZi0+YmxrbHZsXVsnbGluZV9oZWlnaHQnXTsKCQkJCX0KCgkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ0xJTkUtU1RBQ0tJTkctU1RSQVRFR1knXSkgJiYgJHByb3BlcnRpZXNbJ0xJTkUtU1RBQ0tJTkctU1RSQVRFR1knXSkgewoJCQkJCSR0YWJsZVsnY2VsbExpbmVTdGFja2luZ1N0cmF0ZWd5J10gPSBzdHJ0b2xvd2VyKCRwcm9wZXJ0aWVzWydMSU5FLVNUQUNLSU5HLVNUUkFURUdZJ10pOwoJCQkJfSBlbHNlIGlmICgkdGhpcy0+bXBkZi0+dGFibGVMZXZlbCA9PSAxICYmIGlzc2V0KCR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ2xpbmVfc3RhY2tpbmdfc3RyYXRlZ3knXSkpIHsKCQkJCQkkdGFibGVbJ2NlbGxMaW5lU3RhY2tpbmdTdHJhdGVneSddID0gJHRoaXMtPm1wZGYtPmJsa1skdGhpcy0+bXBkZi0+YmxrbHZsXVsnbGluZV9zdGFja2luZ19zdHJhdGVneSddOwoJCQkJfSBlbHNlIHsKCQkJCQkkdGFibGVbJ2NlbGxMaW5lU3RhY2tpbmdTdHJhdGVneSddID0gJ2lubGluZS1saW5lLWhlaWdodCc7CgkJCQl9CgoJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydMSU5FLVNUQUNLSU5HLVNISUZUJ10pICYmICRwcm9wZXJ0aWVzWydMSU5FLVNUQUNLSU5HLVNISUZUJ10pIHsKCQkJCQkkdGFibGVbJ2NlbGxMaW5lU3RhY2tpbmdTaGlmdCddID0gc3RydG9sb3dlcigkcHJvcGVydGllc1snTElORS1TVEFDS0lORy1TSElGVCddKTsKCQkJCX0gZWxzZSBpZiAoJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWwgPT0gMSAmJiBpc3NldCgkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWydsaW5lX3N0YWNraW5nX3NoaWZ0J10pKSB7CgkJCQkJJHRhYmxlWydjZWxsTGluZVN0YWNraW5nU2hpZnQnXSA9ICR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ2xpbmVfc3RhY2tpbmdfc2hpZnQnXTsKCQkJCX0gZWxzZSB7CgkJCQkJJHRhYmxlWydjZWxsTGluZVN0YWNraW5nU2hpZnQnXSA9ICdjb25zaWRlci1zaGlmdHMnOwoJCQkJfQoKCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snUEFERElORy1MRUZUJ10pKSB7CgkJCQkJJHRhYmxlWydwYWRkaW5nJ11bJ0wnXSA9ICR0aGlzLT5tcGRmLT5Db252ZXJ0U2l6ZSgkcHJvcGVydGllc1snUEFERElORy1MRUZUJ10sICR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ2lubmVyX3dpZHRoJ10sICR0aGlzLT5tcGRmLT5Gb250U2l6ZSwgZmFsc2UpOwoJCQkJfQoJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydQQURESU5HLVJJR0hUJ10pKSB7CgkJCQkJJHRhYmxlWydwYWRkaW5nJ11bJ1InXSA9ICR0aGlzLT5tcGRmLT5Db252ZXJ0U2l6ZSgkcHJvcGVydGllc1snUEFERElORy1SSUdIVCddLCAkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWydpbm5lcl93aWR0aCddLCAkdGhpcy0+bXBkZi0+Rm9udFNpemUsIGZhbHNlKTsKCQkJCX0KCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snUEFERElORy1UT1AnXSkpIHsKCQkJCQkkdGFibGVbJ3BhZGRpbmcnXVsnVCddID0gJHRoaXMtPm1wZGYtPkNvbnZlcnRTaXplKCRwcm9wZXJ0aWVzWydQQURESU5HLVRPUCddLCAkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWydpbm5lcl93aWR0aCddLCAkdGhpcy0+bXBkZi0+Rm9udFNpemUsIGZhbHNlKTsKCQkJCX0KCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snUEFERElORy1CT1RUT00nXSkpIHsKCQkJCQkkdGFibGVbJ3BhZGRpbmcnXVsnQiddID0gJHRoaXMtPm1wZGYtPkNvbnZlcnRTaXplKCRwcm9wZXJ0aWVzWydQQURESU5HLUJPVFRPTSddLCAkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWydpbm5lcl93aWR0aCddLCAkdGhpcy0+bXBkZi0+Rm9udFNpemUsIGZhbHNlKTsKCQkJCX0KCgkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ01BUkdJTi1UT1AnXSkpIHsKCQkJCQlpZiAoJGxhc3Rib3R0b21tYXJnaW4pIHsKCQkJCQkJJHRtcCA9ICR0aGlzLT5tcGRmLT5Db252ZXJ0U2l6ZSgkcHJvcGVydGllc1snTUFSR0lOLVRPUCddLCAkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWydpbm5lcl93aWR0aCddLCAkdGhpcy0+bXBkZi0+Rm9udFNpemUsIGZhbHNlKTsKCQkJCQkJaWYgKCR0bXAgPiAkbGFzdGJvdHRvbW1hcmdpbikgewoJCQkJCQkJJHByb3BlcnRpZXNbJ01BUkdJTi1UT1AnXSAtPSAkbGFzdGJvdHRvbW1hcmdpbjsKCQkJCQkJfSBlbHNlIHsKCQkJCQkJCSRwcm9wZXJ0aWVzWydNQVJHSU4tVE9QJ10gPSAwOwoJCQkJCQl9CgkJCQkJfQoJCQkJCSR0YWJsZVsnbWFyZ2luJ11bJ1QnXSA9ICR0aGlzLT5tcGRmLT5Db252ZXJ0U2l6ZSgkcHJvcGVydGllc1snTUFSR0lOLVRPUCddLCAkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWydpbm5lcl93aWR0aCddLCAkdGhpcy0+bXBkZi0+Rm9udFNpemUsIGZhbHNlKTsKCQkJCX0KCgkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ01BUkdJTi1CT1RUT00nXSkpIHsKCQkJCQkkdGFibGVbJ21hcmdpbiddWydCJ10gPSAkdGhpcy0+bXBkZi0+Q29udmVydFNpemUoJHByb3BlcnRpZXNbJ01BUkdJTi1CT1RUT00nXSwgJHRoaXMtPm1wZGYtPmJsa1skdGhpcy0+bXBkZi0+YmxrbHZsXVsnaW5uZXJfd2lkdGgnXSwgJHRoaXMtPm1wZGYtPkZvbnRTaXplLCBmYWxzZSk7CgkJCQl9CgkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ01BUkdJTi1MRUZUJ10pKSB7CgkJCQkJJHRhYmxlWydtYXJnaW4nXVsnTCddID0gJHRoaXMtPm1wZGYtPkNvbnZlcnRTaXplKCRwcm9wZXJ0aWVzWydNQVJHSU4tTEVGVCddLCAkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWydpbm5lcl93aWR0aCddLCAkdGhpcy0+bXBkZi0+Rm9udFNpemUsIGZhbHNlKTsKCQkJCX0KCgkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ01BUkdJTi1SSUdIVCddKSkgewoJCQkJCSR0YWJsZVsnbWFyZ2luJ11bJ1InXSA9ICR0aGlzLT5tcGRmLT5Db252ZXJ0U2l6ZSgkcHJvcGVydGllc1snTUFSR0lOLVJJR0hUJ10sICR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ2lubmVyX3dpZHRoJ10sICR0aGlzLT5tcGRmLT5Gb250U2l6ZSwgZmFsc2UpOwoJCQkJfQoJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydNQVJHSU4tTEVGVCddKSAmJiBpc3NldCgkcHJvcGVydGllc1snTUFSR0lOLVJJR0hUJ10pICYmIHN0cnRvbG93ZXIoJHByb3BlcnRpZXNbJ01BUkdJTi1MRUZUJ10pID09ICdhdXRvJyAmJiBzdHJ0b2xvd2VyKCRwcm9wZXJ0aWVzWydNQVJHSU4tUklHSFQnXSkgPT0gJ2F1dG8nKSB7CgkJCQkJJHRhYmxlWydhJ10gPSAnQyc7CgkJCQl9IGVsc2UgaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydNQVJHSU4tTEVGVCddKSAmJiBzdHJ0b2xvd2VyKCRwcm9wZXJ0aWVzWydNQVJHSU4tTEVGVCddKSA9PSAnYXV0bycpIHsKCQkJCQkkdGFibGVbJ2EnXSA9ICdSJzsKCQkJCX0gZWxzZSBpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ01BUkdJTi1SSUdIVCddKSAmJiBzdHJ0b2xvd2VyKCRwcm9wZXJ0aWVzWydNQVJHSU4tUklHSFQnXSkgPT0gJ2F1dG8nKSB7CgkJCQkJJHRhYmxlWydhJ10gPSAnTCc7CgkJCQl9CgoJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydCT1JERVItQ09MTEFQU0UnXSkgJiYgc3RydG91cHBlcigkcHJvcGVydGllc1snQk9SREVSLUNPTExBUFNFJ10pID09ICdTRVBBUkFURScpIHsKCQkJCQkkdGFibGVbJ2JvcmRlcnNfc2VwYXJhdGUnXSA9IHRydWU7CgkJCQl9IGVsc2UgewoJCQkJCSR0YWJsZVsnYm9yZGVyc19zZXBhcmF0ZSddID0gZmFsc2U7CgkJCQl9CgoJCQkJLy8gbVBERiA1LjcuMwoKCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snQk9SREVSLVNQQUNJTkctSCddKSkgewoJCQkJCSR0YWJsZVsnYm9yZGVyX3NwYWNpbmdfSCddID0gJHRoaXMtPm1wZGYtPkNvbnZlcnRTaXplKCRwcm9wZXJ0aWVzWydCT1JERVItU1BBQ0lORy1IJ10sICR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ2lubmVyX3dpZHRoJ10sICR0aGlzLT5tcGRmLT5Gb250U2l6ZSwgZmFsc2UpOwoJCQkJfQoJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydCT1JERVItU1BBQ0lORy1WJ10pKSB7CgkJCQkJJHRhYmxlWydib3JkZXJfc3BhY2luZ19WJ10gPSAkdGhpcy0+bXBkZi0+Q29udmVydFNpemUoJHByb3BlcnRpZXNbJ0JPUkRFUi1TUEFDSU5HLVYnXSwgJHRoaXMtPm1wZGYtPmJsa1skdGhpcy0+bXBkZi0+YmxrbHZsXVsnaW5uZXJfd2lkdGgnXSwgJHRoaXMtPm1wZGYtPkZvbnRTaXplLCBmYWxzZSk7CgkJCQl9CgkJCQkvLyBtUERGIDUuNy4zCgkJCQlpZiAoISR0YWJsZVsnYm9yZGVyc19zZXBhcmF0ZSddKSB7CgkJCQkJJHRhYmxlWydib3JkZXJfc3BhY2luZ19IJ10gPSAkdGFibGVbJ2JvcmRlcl9zcGFjaW5nX1YnXSA9IDA7CgkJCQl9CgoJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydFTVBUWS1DRUxMUyddKSkgewoJCQkJCSR0YWJsZVsnZW1wdHlfY2VsbHMnXSA9IHN0cnRvbG93ZXIoJHByb3BlcnRpZXNbJ0VNUFRZLUNFTExTJ10pOyAgLy8gJ2hpZGUnICBvciAnc2hvdycKCQkJCX0gZWxzZSB7CgkJCQkJJHRhYmxlWydlbXB0eV9jZWxscyddID0gJyc7CgkJCQl9CgoJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydQQUdFLUJSRUFLLUlOU0lERSddKSAmJiBzdHJ0b3VwcGVyKCRwcm9wZXJ0aWVzWydQQUdFLUJSRUFLLUlOU0lERSddKSA9PSAnQVZPSUQnICYmICR0aGlzLT5tcGRmLT50YWJsZUxldmVsID09IDEgJiYgISR0aGlzLT5tcGRmLT53cml0aW5nSFRNTGZvb3RlcikgewoJCQkJCSR0aGlzLT5tcGRmLT50YWJsZV9rZWVwX3RvZ2V0aGVyID0gdHJ1ZTsKCQkJCX0gZWxzZSBpZiAoJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWwgPT0gMSkgewoJCQkJCSR0aGlzLT5tcGRmLT50YWJsZV9rZWVwX3RvZ2V0aGVyID0gZmFsc2U7CgkJCQl9CgkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ1BBR0UtQlJFQUstQUZURVInXSkgJiYgJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWwgPT0gMSkgewoJCQkJCSR0YWJsZVsncGFnZV9icmVha19hZnRlciddID0gc3RydG91cHBlcigkcHJvcGVydGllc1snUEFHRS1CUkVBSy1BRlRFUiddKTsKCQkJCX0KCgkJCQkvKiAtLSBCQUNLR1JPVU5EUyAtLSAqLwoJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydCQUNLR1JPVU5ELUdSQURJRU5UJ10pICYmICEkdGhpcy0+bXBkZi0+a3d0ICYmICEkdGhpcy0+bXBkZi0+Q29sQWN0aXZlKSB7CgkJCQkJJHRhYmxlWydncmFkaWVudCddID0gJHByb3BlcnRpZXNbJ0JBQ0tHUk9VTkQtR1JBRElFTlQnXTsKCQkJCX0KCgkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ0JBQ0tHUk9VTkQtSU1BR0UnXSkgJiYgJHByb3BlcnRpZXNbJ0JBQ0tHUk9VTkQtSU1BR0UnXSAmJiAhJHRoaXMtPm1wZGYtPmt3dCAmJiAhJHRoaXMtPm1wZGYtPkNvbEFjdGl2ZSkgewoJCQkJCSRyZXQgPSAkdGhpcy0+bXBkZi0+U2V0QmFja2dyb3VuZCgkcHJvcGVydGllcywgJGN1cnJibGtbJ2lubmVyX3dpZHRoJ10pOwoJCQkJCWlmICgkcmV0KSB7CgkJCQkJCSR0YWJsZVsnYmFja2dyb3VuZC1pbWFnZSddID0gJHJldDsKCQkJCQl9CgkJCQl9CgkJCQkvKiAtLSBFTkQgQkFDS0dST1VORFMgLS0gKi8KCgkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ09WRVJGTE9XJ10pKSB7CgkJCQkJJHRhYmxlWydvdmVyZmxvdyddID0gc3RydG9sb3dlcigkcHJvcGVydGllc1snT1ZFUkZMT1cnXSk7ICAvLyAnaGlkZGVuJyAnd3JhcCcgb3IgJ3Zpc2libGUnIG9yICdhdXRvJwoJCQkJCWlmICgoJHRoaXMtPm1wZGYtPkNvbEFjdGl2ZSB8fCAkdGhpcy0+bXBkZi0+dGFibGVMZXZlbCA+IDEpICYmICR0YWJsZVsnb3ZlcmZsb3cnXSA9PSAndmlzaWJsZScpIHsKCQkJCQkJdW5zZXQoJHRhYmxlWydvdmVyZmxvdyddKTsKCQkJCQl9CgkJCQl9CgoJCQkJJHByb3BlcnRpZXMgPSBhcnJheSgpOwoKCgkJCQlpZiAoaXNzZXQoJGF0dHJbJ0NFTExQQURESU5HJ10pKSB7CgkJCQkJJHRhYmxlWydjZWxsX3BhZGRpbmcnXSA9ICRhdHRyWydDRUxMUEFERElORyddOwoJCQkJfSBlbHNlIHsKCQkJCQkkdGFibGVbJ2NlbGxfcGFkZGluZyddID0gZmFsc2U7CgkJCQl9CgoJCQkJaWYgKGlzc2V0KCRhdHRyWydCT1JERVInXSkgJiYgJGF0dHJbJ0JPUkRFUiddID09ICcxJykgewoJCQkJCSR0aGlzLT5tcGRmLT50YWJsZV9ib3JkZXJfYXR0cl9zZXQgPSAxOwoJCQkJCSRib3JkID0gJHRoaXMtPm1wZGYtPmJvcmRlcl9kZXRhaWxzKCcjMDAwMDAwIDFweCBzb2xpZCcpOwoJCQkJCWlmICgkYm9yZFsncyddKSB7CgkJCQkJCSR0YWJsZVsnYm9yZGVyJ10gPSBfQk9SREVSX0FMTDsKCQkJCQkJJHRhYmxlWydib3JkZXJfZGV0YWlscyddWydSJ10gPSAkYm9yZDsKCQkJCQkJJHRhYmxlWydib3JkZXJfZGV0YWlscyddWydMJ10gPSAkYm9yZDsKCQkJCQkJJHRhYmxlWydib3JkZXJfZGV0YWlscyddWydUJ10gPSAkYm9yZDsKCQkJCQkJJHRhYmxlWydib3JkZXJfZGV0YWlscyddWydCJ10gPSAkYm9yZDsKCQkJCQl9CgkJCQl9IGVsc2UgewoJCQkJCSR0aGlzLT5tcGRmLT50YWJsZV9ib3JkZXJfYXR0cl9zZXQgPSAwOwoJCQkJfQoKCQkJCWlmICgkdykgewoJCQkJCSRtYXh3aWR0aCA9ICR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ2lubmVyX3dpZHRoJ107CgkJCQkJaWYgKCR0YWJsZVsnYm9yZGVyc19zZXBhcmF0ZSddKSB7CgkJCQkJCSR0YmxibHcgPSAkdGFibGVbJ21hcmdpbiddWydMJ10gKyAkdGFibGVbJ21hcmdpbiddWydSJ10gKyAkdGFibGVbJ2JvcmRlcl9kZXRhaWxzJ11bJ0wnXVsndyddIC8gMiArICR0YWJsZVsnYm9yZGVyX2RldGFpbHMnXVsnUiddWyd3J10gLyAyOwoJCQkJCX0gZWxzZSB7CgkJCQkJCSR0YmxibHcgPSAkdGFibGVbJ21hcmdpbiddWydMJ10gKyAkdGFibGVbJ21hcmdpbiddWydSJ10gKyAkdGFibGVbJ21heF9jZWxsX2JvcmRlcl93aWR0aCddWydMJ10gLyAyICsgJHRhYmxlWydtYXhfY2VsbF9ib3JkZXJfd2lkdGgnXVsnUiddIC8gMjsKCQkJCQl9CgkJCQkJaWYgKHN0cnBvcygkdywgJyUnKSAmJiAkdGhpcy0+bXBkZi0+dGFibGVMZXZlbCA9PSAxICYmICEkdGhpcy0+bXBkZi0+aWdub3JlX3RhYmxlX3BlcmNlbnRzKSB7CgkJCQkJCS8vICUgbmVlZHMgdG8gYmUgb2YgaW5uZXIgYm94IHdpdGhvdXQgdGFibGUgbWFyZ2lucyBldGMuCgkJCQkJCSRtYXh3aWR0aCAtPSAkdGJsYmx3OwoJCQkJCQkkd21tID0gJHRoaXMtPm1wZGYtPkNvbnZlcnRTaXplKCR3LCAkbWF4d2lkdGgsICR0aGlzLT5tcGRmLT5Gb250U2l6ZSwgZmFsc2UpOwoJCQkJCQkkdGFibGVbJ3cnXSA9ICR3bW0gKyAkdGJsYmx3OwoJCQkJCX0KCQkJCQlpZiAoc3RycG9zKCR3LCAnJScpICYmICR0aGlzLT5tcGRmLT50YWJsZUxldmVsID4gMSAmJiAhJHRoaXMtPm1wZGYtPmlnbm9yZV90YWJsZV9wZXJjZW50cyAmJiAkdGhpcy0+bXBkZi0+a2VlcF90YWJsZV9wcm9wb3J0aW9ucykgewoJCQkJCQkkdGFibGVbJ3dwZXJjZW50J10gPSAkdyArIDA7ICAvLyBtYWtlcyA4MCUgLT4gODAKCQkJCQl9CgkJCQkJaWYgKCFzdHJwb3MoJHcsICclJykgJiYgISR0aGlzLT5tcGRmLT5pZ25vcmVfdGFibGVfd2lkdGhzKSB7CgkJCQkJCSR3bW0gPSAkdGhpcy0+bXBkZi0+Q29udmVydFNpemUoJHcsICR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ2lubmVyX3dpZHRoJ10sICR0aGlzLT5tcGRmLT5Gb250U2l6ZSwgZmFsc2UpOwoJCQkJCQkkdGFibGVbJ3cnXSA9ICR3bW0gKyAkdGJsYmx3OwoJCQkJCX0KCQkJCQlpZiAoISR0aGlzLT5tcGRmLT5rZWVwX3RhYmxlX3Byb3BvcnRpb25zKSB7CgkJCQkJCWlmIChpc3NldCgkdGFibGVbJ3cnXSkgJiYgJHRhYmxlWyd3J10gPiAkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWydpbm5lcl93aWR0aCddKSB7CgkJCQkJCQkkdGFibGVbJ3cnXSA9ICR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ2lubmVyX3dpZHRoJ107CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgoJCQkJaWYgKGlzc2V0KCRhdHRyWydBVVRPU0laRSddKSAmJiAkdGhpcy0+bXBkZi0+dGFibGVMZXZlbCA9PSAxKSB7CgkJCQkJJHRoaXMtPm1wZGYtPnNocmlua190aGlzX3RhYmxlX3RvX2ZpdCA9ICRhdHRyWydBVVRPU0laRSddOwoJCQkJCWlmICgkdGhpcy0+bXBkZi0+c2hyaW5rX3RoaXNfdGFibGVfdG9fZml0IDwgMSkgewoJCQkJCQkkdGhpcy0+bXBkZi0+c2hyaW5rX3RoaXNfdGFibGVfdG9fZml0ID0gMTsKCQkJCQl9CgkJCQl9CgkJCQlpZiAoaXNzZXQoJGF0dHJbJ1JPVEFURSddKSAmJiAkdGhpcy0+bXBkZi0+dGFibGVMZXZlbCA9PSAxKSB7CgkJCQkJJHRoaXMtPm1wZGYtPnRhYmxlX3JvdGF0ZSA9ICRhdHRyWydST1RBVEUnXTsKCQkJCX0KCgkJCQkvLysrKysrKysrKysrKysrKysrKysrKysrKysrKysKCQkJCWlmICgkdGhpcy0+bXBkZi0+dGFibGVfcm90YXRlKSB7CgkJCQkJJHRoaXMtPm1wZGYtPnRicm90X0xpbmtzID0gYXJyYXkoKTsKCQkJCQkkdGhpcy0+bXBkZi0+dGJyb3RfQW5ub3RzID0gYXJyYXkoKTsKCQkJCQkkdGhpcy0+bXBkZi0+dGJyb3RGb3JtcyA9IGFycmF5KCk7CgkJCQkJJHRoaXMtPm1wZGYtPnRicm90X0JNb3V0bGluZXMgPSBhcnJheSgpOwoJCQkJCSR0aGlzLT5tcGRmLT50YnJvdF90b2MgPSBhcnJheSgpOwoJCQkJfQoKCQkJCWlmICgkdGhpcy0+bXBkZi0+a3d0KSB7CgkJCQkJaWYgKCR0aGlzLT5tcGRmLT50YWJsZV9yb3RhdGUpIHsKCQkJCQkJJHRoaXMtPm1wZGYtPnRhYmxlX2tlZXBfdG9nZXRoZXIgPSB0cnVlOwoJCQkJCX0KCQkJCQkkdGhpcy0+bXBkZi0+a3d0ID0gZmFsc2U7CgkJCQkJJHRoaXMtPm1wZGYtPmt3dF9zYXZlZCA9IHRydWU7CgkJCQl9CgoJCQkJaWYgKCR0aGlzLT5tcGRmLT50YWJsZUxldmVsID09IDEgJiYgJHRoaXMtPm1wZGYtPnVzZUdyYXBocykgewoJCQkJCWlmIChpc3NldCgkYXR0clsnSUQnXSkgJiYgJGF0dHJbJ0lEJ10pIHsKCQkJCQkJJHRoaXMtPm1wZGYtPmN1cnJlbnRHcmFwaElkID0gc3RydG91cHBlcigkYXR0clsnSUQnXSk7CgkJCQkJfSBlbHNlIHsKCQkJCQkJJHRoaXMtPm1wZGYtPmN1cnJlbnRHcmFwaElkID0gJzAnOwoJCQkJCX0KCQkJCQkkdGhpcy0+bXBkZi0+Z3JhcGhzWyR0aGlzLT5tcGRmLT5jdXJyZW50R3JhcGhJZF0gPSBhcnJheSgpOwoJCQkJfQoJCQkJLy8rKysrKysrKysrKysrKysrKysrKysrKysrKysrCgkJCQkkdGhpcy0+bXBkZi0+cGxhaW5DZWxsX3Byb3BlcnRpZXMgPSBhcnJheSgpOwoJCQkJdW5zZXQoJHRhYmxlKTsKCQkJCWJyZWFrOwoKCQkJY2FzZSAnVEhFQUQnOgoJCQkJJHRoaXMtPm1wZGYtPmxhc3RvcHRpb25hbHRhZyA9ICR0YWc7IC8vIFNhdmUgY3VycmVudCBIVE1MIHNwZWNpZmllZCBvcHRpb25hbCBlbmR0YWcKCQkJCSR0aGlzLT5tcGRmLT5jc3NtZ3ItPnRiQ1NTbHZsKys7CgkJCQkkdGhpcy0+bXBkZi0+dGFibGV0aGVhZCA9IDE7CgkJCQkkdGhpcy0+bXBkZi0+dGFibGV0Zm9vdCA9IDA7CgkJCQkkcHJvcGVydGllcyA9ICR0aGlzLT5tcGRmLT5jc3NtZ3ItPk1lcmdlQ1NTKCdUQUJMRScsICR0YWcsICRhdHRyKTsKCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snRk9OVC1XRUlHSFQnXSkpIHsKCQkJCQlpZiAoc3RydG91cHBlcigkcHJvcGVydGllc1snRk9OVC1XRUlHSFQnXSkgPT0gJ0JPTEQnKSB7CgkJCQkJCSR0aGlzLT5tcGRmLT50aGVhZF9mb250X3dlaWdodCA9ICdCJzsKCQkJCQl9IGVsc2UgewoJCQkJCQkkdGhpcy0+bXBkZi0+dGhlYWRfZm9udF93ZWlnaHQgPSAnJzsKCQkJCQl9CgkJCQl9CgoJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydGT05ULVNUWUxFJ10pKSB7CgkJCQkJaWYgKHN0cnRvdXBwZXIoJHByb3BlcnRpZXNbJ0ZPTlQtU1RZTEUnXSkgPT0gJ0lUQUxJQycpIHsKCQkJCQkJJHRoaXMtPm1wZGYtPnRoZWFkX2ZvbnRfc3R5bGUgPSAnSSc7CgkJCQkJfSBlbHNlIHsKCQkJCQkJJHRoaXMtPm1wZGYtPnRoZWFkX2ZvbnRfc3R5bGUgPSAnJzsKCQkJCQl9CgkJCQl9CgkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ0ZPTlQtVkFSSUFOVCddKSkgewoJCQkJCWlmIChzdHJ0b3VwcGVyKCRwcm9wZXJ0aWVzWydGT05ULVZBUklBTlQnXSkgPT0gJ1NNQUxMLUNBUFMnKSB7CgkJCQkJCSR0aGlzLT5tcGRmLT50aGVhZF9mb250X3NtQ2FwcyA9ICdTJzsKCQkJCQl9IGVsc2UgewoJCQkJCQkkdGhpcy0+bXBkZi0+dGhlYWRfZm9udF9zbUNhcHMgPSAnJzsKCQkJCQl9CgkJCQl9CgoJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydWRVJUSUNBTC1BTElHTiddKSkgewoJCQkJCSR0aGlzLT5tcGRmLT50aGVhZF92YWxpZ25fZGVmYXVsdCA9ICRwcm9wZXJ0aWVzWydWRVJUSUNBTC1BTElHTiddOwoJCQkJfQoJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydURVhULUFMSUdOJ10pKSB7CgkJCQkJJHRoaXMtPm1wZGYtPnRoZWFkX3RleHRhbGlnbl9kZWZhdWx0ID0gJHByb3BlcnRpZXNbJ1RFWFQtQUxJR04nXTsKCQkJCX0KCQkJCSRwcm9wZXJ0aWVzID0gYXJyYXkoKTsKCQkJCWJyZWFrOwoKCQkJY2FzZSAnVEZPT1QnOgoJCQkJJHRoaXMtPm1wZGYtPmxhc3RvcHRpb25hbHRhZyA9ICR0YWc7IC8vIFNhdmUgY3VycmVudCBIVE1MIHNwZWNpZmllZCBvcHRpb25hbCBlbmR0YWcKCQkJCSR0aGlzLT5tcGRmLT5jc3NtZ3ItPnRiQ1NTbHZsKys7CgkJCQkkdGhpcy0+bXBkZi0+dGFibGV0Zm9vdCA9IDE7CgkJCQkkdGhpcy0+bXBkZi0+dGFibGV0aGVhZCA9IDA7CgkJCQkkcHJvcGVydGllcyA9ICR0aGlzLT5tcGRmLT5jc3NtZ3ItPk1lcmdlQ1NTKCdUQUJMRScsICR0YWcsICRhdHRyKTsKCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snRk9OVC1XRUlHSFQnXSkpIHsKCQkJCQlpZiAoc3RydG91cHBlcigkcHJvcGVydGllc1snRk9OVC1XRUlHSFQnXSkgPT0gJ0JPTEQnKSB7CgkJCQkJCSR0aGlzLT5tcGRmLT50Zm9vdF9mb250X3dlaWdodCA9ICdCJzsKCQkJCQl9IGVsc2UgewoJCQkJCQkkdGhpcy0+bXBkZi0+dGZvb3RfZm9udF93ZWlnaHQgPSAnJzsKCQkJCQl9CgkJCQl9CgoJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydGT05ULVNUWUxFJ10pKSB7CgkJCQkJaWYgKHN0cnRvdXBwZXIoJHByb3BlcnRpZXNbJ0ZPTlQtU1RZTEUnXSkgPT0gJ0lUQUxJQycpIHsKCQkJCQkJJHRoaXMtPm1wZGYtPnRmb290X2ZvbnRfc3R5bGUgPSAnSSc7CgkJCQkJfSBlbHNlIHsKCQkJCQkJJHRoaXMtPm1wZGYtPnRmb290X2ZvbnRfc3R5bGUgPSAnJzsKCQkJCQl9CgkJCQl9CgkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ0ZPTlQtVkFSSUFOVCddKSkgewoJCQkJCWlmIChzdHJ0b3VwcGVyKCRwcm9wZXJ0aWVzWydGT05ULVZBUklBTlQnXSkgPT0gJ1NNQUxMLUNBUFMnKSB7CgkJCQkJCSR0aGlzLT5tcGRmLT50Zm9vdF9mb250X3NtQ2FwcyA9ICdTJzsKCQkJCQl9IGVsc2UgewoJCQkJCQkkdGhpcy0+bXBkZi0+dGZvb3RfZm9udF9zbUNhcHMgPSAnJzsKCQkJCQl9CgkJCQl9CgoJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydWRVJUSUNBTC1BTElHTiddKSkgewoJCQkJCSR0aGlzLT5tcGRmLT50Zm9vdF92YWxpZ25fZGVmYXVsdCA9ICRwcm9wZXJ0aWVzWydWRVJUSUNBTC1BTElHTiddOwoJCQkJfQoJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydURVhULUFMSUdOJ10pKSB7CgkJCQkJJHRoaXMtPm1wZGYtPnRmb290X3RleHRhbGlnbl9kZWZhdWx0ID0gJHByb3BlcnRpZXNbJ1RFWFQtQUxJR04nXTsKCQkJCX0KCQkJCSRwcm9wZXJ0aWVzID0gYXJyYXkoKTsKCQkJCWJyZWFrOwoKCgkJCWNhc2UgJ1RCT0RZJzoKCQkJCSR0aGlzLT5tcGRmLT50YWJsZXRoZWFkID0gMDsKCQkJCSR0aGlzLT5tcGRmLT50YWJsZXRmb290ID0gMDsKCQkJCSR0aGlzLT5tcGRmLT5sYXN0b3B0aW9uYWx0YWcgPSAkdGFnOyAvLyBTYXZlIGN1cnJlbnQgSFRNTCBzcGVjaWZpZWQgb3B0aW9uYWwgZW5kdGFnCgkJCQkkdGhpcy0+bXBkZi0+Y3NzbWdyLT50YkNTU2x2bCsrOwoJCQkJJHRoaXMtPm1wZGYtPmNzc21nci0+TWVyZ2VDU1MoJ1RBQkxFJywgJHRhZywgJGF0dHIpOwoJCQkJYnJlYWs7CgoKCQkJY2FzZSAnVFInOgoJCQkJJHRoaXMtPm1wZGYtPmxhc3RvcHRpb25hbHRhZyA9ICR0YWc7IC8vIFNhdmUgY3VycmVudCBIVE1MIHNwZWNpZmllZCBvcHRpb25hbCBlbmR0YWcKCQkJCSR0aGlzLT5tcGRmLT5jc3NtZ3ItPnRiQ1NTbHZsKys7CgkJCQkkdGhpcy0+bXBkZi0+cm93Kys7CgkJCQkkdGhpcy0+bXBkZi0+dGFibGVbJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWxdWyR0aGlzLT5tcGRmLT50YmN0clskdGhpcy0+bXBkZi0+dGFibGVMZXZlbF1dWyduciddICsrOwoJCQkJJHRoaXMtPm1wZGYtPmNvbCA9IC0xOwoJCQkJJHByb3BlcnRpZXMgPSAkdGhpcy0+bXBkZi0+Y3NzbWdyLT5NZXJnZUNTUygnVEFCTEUnLCAkdGFnLCAkYXR0cik7CgoJCQkJaWYgKCEkdGhpcy0+bXBkZi0+c2ltcGxlVGFibGVzICYmICghaXNzZXQoJHRoaXMtPm1wZGYtPnRhYmxlWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXVskdGhpcy0+bXBkZi0+dGJjdHJbJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWxdXVsnYm9yZGVyc19zZXBhcmF0ZSddKSB8fCAhJHRoaXMtPm1wZGYtPnRhYmxlWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXVskdGhpcy0+bXBkZi0+dGJjdHJbJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWxdXVsnYm9yZGVyc19zZXBhcmF0ZSddKSkgewoJCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snQk9SREVSLUxFRlQnXSkgJiYgJHByb3BlcnRpZXNbJ0JPUkRFUi1MRUZUJ10pIHsKCQkJCQkJJHRoaXMtPm1wZGYtPnRhYmxlWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXVskdGhpcy0+bXBkZi0+dGJjdHJbJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWxdXVsndHJib3JkZXItbGVmdCddWyR0aGlzLT5tcGRmLT5yb3ddID0gJHByb3BlcnRpZXNbJ0JPUkRFUi1MRUZUJ107CgkJCQkJfQoJCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snQk9SREVSLVJJR0hUJ10pICYmICRwcm9wZXJ0aWVzWydCT1JERVItUklHSFQnXSkgewoJCQkJCQkkdGhpcy0+bXBkZi0+dGFibGVbJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWxdWyR0aGlzLT5tcGRmLT50YmN0clskdGhpcy0+bXBkZi0+dGFibGVMZXZlbF1dWyd0cmJvcmRlci1yaWdodCddWyR0aGlzLT5tcGRmLT5yb3ddID0gJHByb3BlcnRpZXNbJ0JPUkRFUi1SSUdIVCddOwoJCQkJCX0KCQkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ0JPUkRFUi1UT1AnXSkgJiYgJHByb3BlcnRpZXNbJ0JPUkRFUi1UT1AnXSkgewoJCQkJCQkkdGhpcy0+bXBkZi0+dGFibGVbJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWxdWyR0aGlzLT5tcGRmLT50YmN0clskdGhpcy0+bXBkZi0+dGFibGVMZXZlbF1dWyd0cmJvcmRlci10b3AnXVskdGhpcy0+bXBkZi0+cm93XSA9ICRwcm9wZXJ0aWVzWydCT1JERVItVE9QJ107CgkJCQkJfQoJCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snQk9SREVSLUJPVFRPTSddKSAmJiAkcHJvcGVydGllc1snQk9SREVSLUJPVFRPTSddKSB7CgkJCQkJCSR0aGlzLT5tcGRmLT50YWJsZVskdGhpcy0+bXBkZi0+dGFibGVMZXZlbF1bJHRoaXMtPm1wZGYtPnRiY3RyWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXV1bJ3RyYm9yZGVyLWJvdHRvbSddWyR0aGlzLT5tcGRmLT5yb3ddID0gJHByb3BlcnRpZXNbJ0JPUkRFUi1CT1RUT00nXTsKCQkJCQl9CgkJCQl9CgoJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydCQUNLR1JPVU5ELUNPTE9SJ10pKSB7CgkJCQkJJHRoaXMtPm1wZGYtPnRhYmxlWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXVskdGhpcy0+bXBkZi0+dGJjdHJbJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWxdXVsnYmdjb2xvciddWyR0aGlzLT5tcGRmLT5yb3ddID0gJHByb3BlcnRpZXNbJ0JBQ0tHUk9VTkQtQ09MT1InXTsKCQkJCX0gZWxzZSBpZiAoaXNzZXQoJGF0dHJbJ0JHQ09MT1InXSkpCgkJCQkJJHRoaXMtPm1wZGYtPnRhYmxlWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXVskdGhpcy0+bXBkZi0+dGJjdHJbJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWxdXVsnYmdjb2xvciddWyR0aGlzLT5tcGRmLT5yb3ddID0gJGF0dHJbJ0JHQ09MT1InXTsKCgkJCQkvKiAtLSBCQUNLR1JPVU5EUyAtLSAqLwoJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydCQUNLR1JPVU5ELUdSQURJRU5UJ10pICYmICEkdGhpcy0+bXBkZi0+a3d0ICYmICEkdGhpcy0+bXBkZi0+Q29sQWN0aXZlKSB7CgkJCQkJJHRoaXMtPm1wZGYtPnRhYmxlWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXVskdGhpcy0+bXBkZi0+dGJjdHJbJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWxdXVsndHJncmFkaWVudHMnXVskdGhpcy0+bXBkZi0+cm93XSA9ICRwcm9wZXJ0aWVzWydCQUNLR1JPVU5ELUdSQURJRU5UJ107CgkJCQl9CgoJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydCQUNLR1JPVU5ELUlNQUdFJ10pICYmICRwcm9wZXJ0aWVzWydCQUNLR1JPVU5ELUlNQUdFJ10gJiYgISR0aGlzLT5tcGRmLT5rd3QgJiYgISR0aGlzLT5tcGRmLT5Db2xBY3RpdmUpIHsKCQkJCQkkcmV0ID0gJHRoaXMtPm1wZGYtPlNldEJhY2tncm91bmQoJHByb3BlcnRpZXMsICRjdXJyYmxrWydpbm5lcl93aWR0aCddKTsKCQkJCQlpZiAoJHJldCkgewoJCQkJCQkkdGhpcy0+bXBkZi0+dGFibGVbJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWxdWyR0aGlzLT5tcGRmLT50YmN0clskdGhpcy0+bXBkZi0+dGFibGVMZXZlbF1dWyd0cmJhY2tncm91bmQtaW1hZ2VzJ11bJHRoaXMtPm1wZGYtPnJvd10gPSAkcmV0OwoJCQkJCX0KCQkJCX0KCQkJCS8qIC0tIEVORCBCQUNLR1JPVU5EUyAtLSAqLwoKCgoKCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snVEVYVC1ST1RBVEUnXSkpIHsKCQkJCQkkdGhpcy0+bXBkZi0+dHJvd190ZXh0X3JvdGF0ZSA9ICRwcm9wZXJ0aWVzWydURVhULVJPVEFURSddOwoJCQkJfQoJCQkJaWYgKGlzc2V0KCRhdHRyWydURVhULVJPVEFURSddKSkKCQkJCQkkdGhpcy0+bXBkZi0+dHJvd190ZXh0X3JvdGF0ZSA9ICRhdHRyWydURVhULVJPVEFURSddOwoKCQkJCWlmICgkdGhpcy0+bXBkZi0+dGFibGV0aGVhZCkgewoJCQkJCSR0aGlzLT5tcGRmLT50YWJsZVskdGhpcy0+bXBkZi0+dGFibGVMZXZlbF1bJHRoaXMtPm1wZGYtPnRiY3RyWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXV1bJ2lzX3RoZWFkJ11bJHRoaXMtPm1wZGYtPnJvd10gPSB0cnVlOwoJCQkJfQoJCQkJaWYgKCR0aGlzLT5tcGRmLT50YWJsZXRmb290KSB7CgkJCQkJJHRoaXMtPm1wZGYtPnRhYmxlWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXVskdGhpcy0+bXBkZi0+dGJjdHJbJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWxdXVsnaXNfdGZvb3QnXVskdGhpcy0+bXBkZi0+cm93XSA9IHRydWU7CgkJCQl9CgkJCQkkcHJvcGVydGllcyA9IGFycmF5KCk7CgkJCQlicmVhazsKCgoJCQljYXNlICdUSCc6CgkJCWNhc2UgJ1REJzoKCQkJCSR0aGlzLT5tcGRmLT5pZ25vcmVmb2xsb3dpbmdzcGFjZXMgPSB0cnVlOwoJCQkJJHRoaXMtPm1wZGYtPmxhc3RvcHRpb25hbHRhZyA9ICR0YWc7IC8vIFNhdmUgY3VycmVudCBIVE1MIHNwZWNpZmllZCBvcHRpb25hbCBlbmR0YWcKCQkJCSR0aGlzLT5tcGRmLT5jc3NtZ3ItPnRiQ1NTbHZsKys7CgkJCQkkdGhpcy0+bXBkZi0+SW5saW5lUHJvcGVydGllcyA9IGFycmF5KCk7CgkJCQkkdGhpcy0+bXBkZi0+SW5saW5lQkRGID0gYXJyYXkoKTsgLy8gbVBERiA2CgkJCQkkdGhpcy0+bXBkZi0+SW5saW5lQkRGY3RyID0gMDsgLy8gbVBERiA2CgkJCQkkdGhpcy0+bXBkZi0+dGRiZWdpbiA9IHRydWU7CgkJCQkkdGhpcy0+bXBkZi0+Y29sKys7CgkJCQl3aGlsZSAoaXNzZXQoJHRoaXMtPm1wZGYtPmNlbGxbJHRoaXMtPm1wZGYtPnJvd11bJHRoaXMtPm1wZGYtPmNvbF0pKSB7CgkJCQkJJHRoaXMtPm1wZGYtPmNvbCsrOwoJCQkJfQoKCQkJCS8vVXBkYXRlIG51bWJlciBjb2x1bW4KCQkJCWlmICgkdGhpcy0+bXBkZi0+dGFibGVbJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWxdWyR0aGlzLT5tcGRmLT50YmN0clskdGhpcy0+bXBkZi0+dGFibGVMZXZlbF1dWyduYyddIDwgJHRoaXMtPm1wZGYtPmNvbCArIDEpIHsKCQkJCQkkdGhpcy0+bXBkZi0+dGFibGVbJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWxdWyR0aGlzLT5tcGRmLT50YmN0clskdGhpcy0+bXBkZi0+dGFibGVMZXZlbF1dWyduYyddID0gJHRoaXMtPm1wZGYtPmNvbCArIDE7CgkJCQl9CgoJCQkJJHRhYmxlID0gJiR0aGlzLT5tcGRmLT50YWJsZVskdGhpcy0+bXBkZi0+dGFibGVMZXZlbF1bJHRoaXMtPm1wZGYtPnRiY3RyWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXV07CgoJCQkJJGMgPSBhcnJheSgnYScgPT4gZmFsc2UsCgkJCQkJJ1InID0+IGZhbHNlLAoJCQkJCSdub3dyYXAnID0+IGZhbHNlLAoJCQkJCSdiZ2NvbG9yJyA9PiBmYWxzZSwKCQkJCQkncGFkZGluZycgPT4gYXJyYXkoJ0wnID0+IGZhbHNlLAoJCQkJCQknUicgPT4gZmFsc2UsCgkJCQkJCSdUJyA9PiBmYWxzZSwKCQkJCQkJJ0InID0+IGZhbHNlCgkJCQkJKQoJCQkJKTsKCgkJCQlpZiAoJHRoaXMtPm1wZGYtPnNpbXBsZVRhYmxlcyAmJiAkdGhpcy0+bXBkZi0+cm93ID09IDAgJiYgJHRoaXMtPm1wZGYtPmNvbCA9PSAwKSB7CgkJCQkJJHRhYmxlWydzaW1wbGUnXVsnYm9yZGVyJ10gPSBmYWxzZTsKCQkJCQkkdGFibGVbJ3NpbXBsZSddWydib3JkZXJfZGV0YWlscyddWydSJ11bJ3cnXSA9IDA7CgkJCQkJJHRhYmxlWydzaW1wbGUnXVsnYm9yZGVyX2RldGFpbHMnXVsnTCddWyd3J10gPSAwOwoJCQkJCSR0YWJsZVsnc2ltcGxlJ11bJ2JvcmRlcl9kZXRhaWxzJ11bJ1QnXVsndyddID0gMDsKCQkJCQkkdGFibGVbJ3NpbXBsZSddWydib3JkZXJfZGV0YWlscyddWydCJ11bJ3cnXSA9IDA7CgkJCQkJJHRhYmxlWydzaW1wbGUnXVsnYm9yZGVyX2RldGFpbHMnXVsnUiddWydzdHlsZSddID0gJyc7CgkJCQkJJHRhYmxlWydzaW1wbGUnXVsnYm9yZGVyX2RldGFpbHMnXVsnTCddWydzdHlsZSddID0gJyc7CgkJCQkJJHRhYmxlWydzaW1wbGUnXVsnYm9yZGVyX2RldGFpbHMnXVsnVCddWydzdHlsZSddID0gJyc7CgkJCQkJJHRhYmxlWydzaW1wbGUnXVsnYm9yZGVyX2RldGFpbHMnXVsnQiddWydzdHlsZSddID0gJyc7CgkJCQl9IGVsc2UgaWYgKCEkdGhpcy0+bXBkZi0+c2ltcGxlVGFibGVzKSB7CgkJCQkJJGNbJ2JvcmRlciddID0gZmFsc2U7CgkJCQkJJGNbJ2JvcmRlcl9kZXRhaWxzJ11bJ1InXVsndyddID0gMDsKCQkJCQkkY1snYm9yZGVyX2RldGFpbHMnXVsnTCddWyd3J10gPSAwOwoJCQkJCSRjWydib3JkZXJfZGV0YWlscyddWydUJ11bJ3cnXSA9IDA7CgkJCQkJJGNbJ2JvcmRlcl9kZXRhaWxzJ11bJ0InXVsndyddID0gMDsKCQkJCQkkY1snYm9yZGVyX2RldGFpbHMnXVsnbWJ3J11bJ0JMJ10gPSAwOwoJCQkJCSRjWydib3JkZXJfZGV0YWlscyddWydtYncnXVsnQlInXSA9IDA7CgkJCQkJJGNbJ2JvcmRlcl9kZXRhaWxzJ11bJ21idyddWydSVCddID0gMDsKCQkJCQkkY1snYm9yZGVyX2RldGFpbHMnXVsnbWJ3J11bJ1JCJ10gPSAwOwoJCQkJCSRjWydib3JkZXJfZGV0YWlscyddWydtYncnXVsnVEwnXSA9IDA7CgkJCQkJJGNbJ2JvcmRlcl9kZXRhaWxzJ11bJ21idyddWydUUiddID0gMDsKCQkJCQkkY1snYm9yZGVyX2RldGFpbHMnXVsnbWJ3J11bJ0xUJ10gPSAwOwoJCQkJCSRjWydib3JkZXJfZGV0YWlscyddWydtYncnXVsnTEInXSA9IDA7CgkJCQkJJGNbJ2JvcmRlcl9kZXRhaWxzJ11bJ1InXVsnc3R5bGUnXSA9ICcnOwoJCQkJCSRjWydib3JkZXJfZGV0YWlscyddWydMJ11bJ3N0eWxlJ10gPSAnJzsKCQkJCQkkY1snYm9yZGVyX2RldGFpbHMnXVsnVCddWydzdHlsZSddID0gJyc7CgkJCQkJJGNbJ2JvcmRlcl9kZXRhaWxzJ11bJ0InXVsnc3R5bGUnXSA9ICcnOwoJCQkJCSRjWydib3JkZXJfZGV0YWlscyddWydSJ11bJ3MnXSA9IDA7CgkJCQkJJGNbJ2JvcmRlcl9kZXRhaWxzJ11bJ0wnXVsncyddID0gMDsKCQkJCQkkY1snYm9yZGVyX2RldGFpbHMnXVsnVCddWydzJ10gPSAwOwoJCQkJCSRjWydib3JkZXJfZGV0YWlscyddWydCJ11bJ3MnXSA9IDA7CgkJCQkJJGNbJ2JvcmRlcl9kZXRhaWxzJ11bJ1InXVsnYyddID0gJHRoaXMtPm1wZGYtPkNvbnZlcnRDb2xvcigwKTsKCQkJCQkkY1snYm9yZGVyX2RldGFpbHMnXVsnTCddWydjJ10gPSAkdGhpcy0+bXBkZi0+Q29udmVydENvbG9yKDApOwoJCQkJCSRjWydib3JkZXJfZGV0YWlscyddWydUJ11bJ2MnXSA9ICR0aGlzLT5tcGRmLT5Db252ZXJ0Q29sb3IoMCk7CgkJCQkJJGNbJ2JvcmRlcl9kZXRhaWxzJ11bJ0InXVsnYyddID0gJHRoaXMtPm1wZGYtPkNvbnZlcnRDb2xvcigwKTsKCQkJCQkkY1snYm9yZGVyX2RldGFpbHMnXVsnUiddWydkb20nXSA9IDA7CgkJCQkJJGNbJ2JvcmRlcl9kZXRhaWxzJ11bJ0wnXVsnZG9tJ10gPSAwOwoJCQkJCSRjWydib3JkZXJfZGV0YWlscyddWydUJ11bJ2RvbSddID0gMDsKCQkJCQkkY1snYm9yZGVyX2RldGFpbHMnXVsnQiddWydkb20nXSA9IDA7CgkJCQkJJGNbJ2JvcmRlcl9kZXRhaWxzJ11bJ2NlbGxwb3Nkb20nXSA9IDA7CgkJCQl9CgoKCQkJCWlmICgkdGFibGVbJ3ZhJ10pIHsKCQkJCQkkY1sndmEnXSA9ICR0YWJsZVsndmEnXTsKCQkJCX0KCQkJCWlmICgkdGFibGVbJ3R4dGEnXSkgewoJCQkJCSRjWydhJ10gPSAkdGFibGVbJ3R4dGEnXTsKCQkJCX0KCQkJCWlmICgkdGhpcy0+bXBkZi0+dGFibGVfYm9yZGVyX2F0dHJfc2V0KSB7CgkJCQkJaWYgKCR0YWJsZVsnYm9yZGVyX2RldGFpbHMnXSkgewoJCQkJCQlpZiAoISR0aGlzLT5tcGRmLT5zaW1wbGVUYWJsZXMpIHsKCQkJCQkJCSRjWydib3JkZXJfZGV0YWlscyddWydSJ10gPSAkdGFibGVbJ2JvcmRlcl9kZXRhaWxzJ11bJ1InXTsKCQkJCQkJCSRjWydib3JkZXJfZGV0YWlscyddWydMJ10gPSAkdGFibGVbJ2JvcmRlcl9kZXRhaWxzJ11bJ0wnXTsKCQkJCQkJCSRjWydib3JkZXJfZGV0YWlscyddWydUJ10gPSAkdGFibGVbJ2JvcmRlcl9kZXRhaWxzJ11bJ1QnXTsKCQkJCQkJCSRjWydib3JkZXJfZGV0YWlscyddWydCJ10gPSAkdGFibGVbJ2JvcmRlcl9kZXRhaWxzJ11bJ0InXTsKCQkJCQkJCSRjWydib3JkZXInXSA9ICR0YWJsZVsnYm9yZGVyJ107CgkJCQkJCQkkY1snYm9yZGVyX2RldGFpbHMnXVsnTCddWydkb20nXSA9IDE7CgkJCQkJCQkkY1snYm9yZGVyX2RldGFpbHMnXVsnUiddWydkb20nXSA9IDE7CgkJCQkJCQkkY1snYm9yZGVyX2RldGFpbHMnXVsnVCddWydkb20nXSA9IDE7CgkJCQkJCQkkY1snYm9yZGVyX2RldGFpbHMnXVsnQiddWydkb20nXSA9IDE7CgkJCQkJCX0gZWxzZSBpZiAoJHRoaXMtPm1wZGYtPnNpbXBsZVRhYmxlcyAmJiAkdGhpcy0+bXBkZi0+cm93ID09IDAgJiYgJHRoaXMtPm1wZGYtPmNvbCA9PSAwKSB7CgkJCQkJCQkkdGFibGVbJ3NpbXBsZSddWydib3JkZXJfZGV0YWlscyddWydSJ10gPSAkdGFibGVbJ2JvcmRlcl9kZXRhaWxzJ11bJ1InXTsKCQkJCQkJCSR0YWJsZVsnc2ltcGxlJ11bJ2JvcmRlcl9kZXRhaWxzJ11bJ0wnXSA9ICR0YWJsZVsnYm9yZGVyX2RldGFpbHMnXVsnTCddOwoJCQkJCQkJJHRhYmxlWydzaW1wbGUnXVsnYm9yZGVyX2RldGFpbHMnXVsnVCddID0gJHRhYmxlWydib3JkZXJfZGV0YWlscyddWydUJ107CgkJCQkJCQkkdGFibGVbJ3NpbXBsZSddWydib3JkZXJfZGV0YWlscyddWydCJ10gPSAkdGFibGVbJ2JvcmRlcl9kZXRhaWxzJ11bJ0InXTsKCQkJCQkJCSR0YWJsZVsnc2ltcGxlJ11bJ2JvcmRlciddID0gJHRhYmxlWydib3JkZXInXTsKCQkJCQkJfQoJCQkJCX0KCQkJCX0KCQkJCS8vIElOSEVSSVRFRCBUSEVBRCBDU1MgUHJvcGVydGllcwoJCQkJaWYgKCR0aGlzLT5tcGRmLT50YWJsZXRoZWFkKSB7CgkJCQkJaWYgKCR0aGlzLT5tcGRmLT50aGVhZF92YWxpZ25fZGVmYXVsdCkKCQkJCQkJJGNbJ3ZhJ10gPSAkYWxpZ25bc3RydG9sb3dlcigkdGhpcy0+bXBkZi0+dGhlYWRfdmFsaWduX2RlZmF1bHQpXTsKCQkJCQlpZiAoJHRoaXMtPm1wZGYtPnRoZWFkX3RleHRhbGlnbl9kZWZhdWx0KQoJCQkJCQkkY1snYSddID0gJGFsaWduW3N0cnRvbG93ZXIoJHRoaXMtPm1wZGYtPnRoZWFkX3RleHRhbGlnbl9kZWZhdWx0KV07CgkJCQkJaWYgKCR0aGlzLT5tcGRmLT50aGVhZF9mb250X3dlaWdodCA9PSAnQicpIHsKCQkJCQkJJHRoaXMtPm1wZGYtPlNldFN0eWxlKCdCJywgdHJ1ZSk7CgkJCQkJfQoJCQkJCWlmICgkdGhpcy0+bXBkZi0+dGhlYWRfZm9udF9zdHlsZSA9PSAnSScpIHsKCQkJCQkJJHRoaXMtPm1wZGYtPlNldFN0eWxlKCdJJywgdHJ1ZSk7CgkJCQkJfQoJCQkJCWlmICgkdGhpcy0+bXBkZi0+dGhlYWRfZm9udF9zbUNhcHMgPT0gJ1MnKSB7CgkJCQkJCSR0aGlzLT5tcGRmLT50ZXh0dmFyID0gKCR0aGlzLT5tcGRmLT50ZXh0dmFyIHwgRkNfU01BTExDQVBTKTsKCQkJCQl9IC8vIG1QREYgNS43LjEKCQkJCX0KCgkJCQkvLyBJTkhFUklURUQgVEZPT1QgQ1NTIFByb3BlcnRpZXMKCQkJCWlmICgkdGhpcy0+bXBkZi0+dGFibGV0Zm9vdCkgewoJCQkJCWlmICgkdGhpcy0+bXBkZi0+dGZvb3RfdmFsaWduX2RlZmF1bHQpCgkJCQkJCSRjWyd2YSddID0gJGFsaWduW3N0cnRvbG93ZXIoJHRoaXMtPm1wZGYtPnRmb290X3ZhbGlnbl9kZWZhdWx0KV07CgkJCQkJaWYgKCR0aGlzLT5tcGRmLT50Zm9vdF90ZXh0YWxpZ25fZGVmYXVsdCkKCQkJCQkJJGNbJ2EnXSA9ICRhbGlnbltzdHJ0b2xvd2VyKCR0aGlzLT5tcGRmLT50Zm9vdF90ZXh0YWxpZ25fZGVmYXVsdCldOwoJCQkJCWlmICgkdGhpcy0+bXBkZi0+dGZvb3RfZm9udF93ZWlnaHQgPT0gJ0InKSB7CgkJCQkJCSR0aGlzLT5tcGRmLT5TZXRTdHlsZSgnQicsIHRydWUpOwoJCQkJCX0KCQkJCQlpZiAoJHRoaXMtPm1wZGYtPnRmb290X2ZvbnRfc3R5bGUgPT0gJ0knKSB7CgkJCQkJCSR0aGlzLT5tcGRmLT5TZXRTdHlsZSgnSScsIHRydWUpOwoJCQkJCX0KCQkJCQlpZiAoJHRoaXMtPm1wZGYtPnRmb290X2ZvbnRfc3R5bGUgPT0gJ1MnKSB7CgkJCQkJCSR0aGlzLT5tcGRmLT50ZXh0dmFyID0gKCR0aGlzLT5tcGRmLT50ZXh0dmFyIHwgRkNfU01BTExDQVBTKTsKCQkJCQl9IC8vIG1QREYgNS43LjEKCQkJCX0KCgoJCQkJaWYgKCR0aGlzLT5tcGRmLT50cm93X3RleHRfcm90YXRlKSB7CgkJCQkJJGNbJ1InXSA9ICR0aGlzLT5tcGRmLT50cm93X3RleHRfcm90YXRlOwoJCQkJfQoKCQkJCSR0aGlzLT5tcGRmLT5jZWxsX2JvcmRlcl9kb21pbmFuY2VfTCA9IDA7CgkJCQkkdGhpcy0+bXBkZi0+Y2VsbF9ib3JkZXJfZG9taW5hbmNlX1IgPSAwOwoJCQkJJHRoaXMtPm1wZGYtPmNlbGxfYm9yZGVyX2RvbWluYW5jZV9UID0gMDsKCQkJCSR0aGlzLT5tcGRmLT5jZWxsX2JvcmRlcl9kb21pbmFuY2VfQiA9IDA7CgoJCQkJJHByb3BlcnRpZXMgPSAkdGhpcy0+bXBkZi0+Y3NzbWdyLT5NZXJnZUNTUygnVEFCTEUnLCAkdGFnLCAkYXR0cik7CgoJCQkJJHByb3BlcnRpZXMgPSAkdGhpcy0+bXBkZi0+Y3NzbWdyLT5hcnJheV9tZXJnZV9yZWN1cnNpdmVfdW5pcXVlKCR0aGlzLT5tcGRmLT5iYXNlX3RhYmxlX3Byb3BlcnRpZXMsICRwcm9wZXJ0aWVzKTsKCgkJCQkkdGhpcy0+bXBkZi0+UmVzZXQoKTsgLy8gbVBERiA2ICAgPz8/Pz8/Pz8/Pz8/Pz8/Pz8/Pz8/CgoJCQkJJHRoaXMtPm1wZGYtPnNldENTUygkcHJvcGVydGllcywgJ1RBQkxFQ0VMTCcsICR0YWcpOwoKCQkJCSRjWydkZnMnXSA9ICR0aGlzLT5tcGRmLT5Gb250U2l6ZTsgLy8gRGVmYXVsdCBGb250IHNpemUKCgoJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydCQUNLR1JPVU5ELUNPTE9SJ10pKSB7CgkJCQkJJGNbJ2JnY29sb3InXSA9ICRwcm9wZXJ0aWVzWydCQUNLR1JPVU5ELUNPTE9SJ107CgkJCQl9IGVsc2UgaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydCQUNLR1JPVU5EJ10pKSB7CgkJCQkJJGNbJ2JnY29sb3InXSA9ICRwcm9wZXJ0aWVzWydCQUNLR1JPVU5EJ107CgkJCQl9IGVsc2UgaWYgKGlzc2V0KCRhdHRyWydCR0NPTE9SJ10pKQoJCQkJCSRjWydiZ2NvbG9yJ10gPSAkYXR0clsnQkdDT0xPUiddOwoKCgoJCQkJLyogLS0gQkFDS0dST1VORFMgLS0gKi8KCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snQkFDS0dST1VORC1HUkFESUVOVCddKSkgewoJCQkJCSRjWydncmFkaWVudCddID0gJHByb3BlcnRpZXNbJ0JBQ0tHUk9VTkQtR1JBRElFTlQnXTsKCQkJCX0gZWxzZSB7CgkJCQkJJGNbJ2dyYWRpZW50J10gPSBmYWxzZTsKCQkJCX0KCgkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ0JBQ0tHUk9VTkQtSU1BR0UnXSkgJiYgJHByb3BlcnRpZXNbJ0JBQ0tHUk9VTkQtSU1BR0UnXSAmJiAhJHRoaXMtPm1wZGYtPmtlZXBfYmxvY2tfdG9nZXRoZXIpIHsKCQkJCQkkcmV0ID0gJHRoaXMtPm1wZGYtPlNldEJhY2tncm91bmQoJHByb3BlcnRpZXMsICR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ2lubmVyX3dpZHRoJ10pOwoJCQkJCWlmICgkcmV0KSB7CgkJCQkJCSRjWydiYWNrZ3JvdW5kLWltYWdlJ10gPSAkcmV0OwoJCQkJCX0KCQkJCX0KCQkJCS8qIC0tIEVORCBCQUNLR1JPVU5EUyAtLSAqLwoJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydWRVJUSUNBTC1BTElHTiddKSkgewoJCQkJCSRjWyd2YSddID0gJGFsaWduW3N0cnRvbG93ZXIoJHByb3BlcnRpZXNbJ1ZFUlRJQ0FMLUFMSUdOJ10pXTsKCQkJCX0gZWxzZSBpZiAoaXNzZXQoJGF0dHJbJ1ZBTElHTiddKSkKCQkJCQkkY1sndmEnXSA9ICRhbGlnbltzdHJ0b2xvd2VyKCRhdHRyWydWQUxJR04nXSldOwoKCgkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ1RFWFQtQUxJR04nXSkgJiYgJHByb3BlcnRpZXNbJ1RFWFQtQUxJR04nXSkgewoJCQkJCWlmIChzdWJzdHIoJHByb3BlcnRpZXNbJ1RFWFQtQUxJR04nXSwgMCwgMSkgPT0gJ0QnKSB7CgkJCQkJCSRjWydhJ10gPSAkcHJvcGVydGllc1snVEVYVC1BTElHTiddOwoJCQkJCX0gZWxzZSB7CgkJCQkJCSRjWydhJ10gPSAkYWxpZ25bc3RydG9sb3dlcigkcHJvcGVydGllc1snVEVYVC1BTElHTiddKV07CgkJCQkJfQoJCQkJfQoJCQkJaWYgKGlzc2V0KCRhdHRyWydBTElHTiddKSAmJiAkYXR0clsnQUxJR04nXSkgewoJCQkJCWlmIChzdHJ0b2xvd2VyKCRhdHRyWydBTElHTiddKSA9PSAnY2hhcicpIHsKCQkJCQkJaWYgKGlzc2V0KCRhdHRyWydDSEFSJ10pICYmICRhdHRyWydDSEFSJ10pIHsKCQkJCQkJCSRjaGFyID0gaHRtbF9lbnRpdHlfZGVjb2RlKCRhdHRyWydDSEFSJ10pOwoJCQkJCQkJJGNoYXIgPSBzdHJjb2RlMnV0ZigkY2hhcik7CgkJCQkJCQkkZCA9IGFycmF5X3NlYXJjaCgkY2hhciwgJHRoaXMtPm1wZGYtPmRlY2ltYWxfYWxpZ24pOwoJCQkJCQkJaWYgKCRkICE9PSBmYWxzZSkgewoJCQkJCQkJCSRjWydhJ10gPSAkZCAuICdSJzsKCQkJCQkJCX0KCQkJCQkJfSBlbHNlIHsKCQkJCQkJCSRjWydhJ10gPSAnRFBSJzsKCQkJCQkJfQoJCQkJCX0gZWxzZSB7CgkJCQkJCSRjWydhJ10gPSAkYWxpZ25bc3RydG9sb3dlcigkYXR0clsnQUxJR04nXSldOwoJCQkJCX0KCQkJCX0KCgkJCQkvLyBtUERGIDYKCQkJCSRjWydkaXJlY3Rpb24nXSA9ICR0YWJsZVsnZGlyZWN0aW9uJ107CgkJCQlpZiAoaXNzZXQoJGF0dHJbJ0RJUiddKSBhbmQgJGF0dHJbJ0RJUiddICE9ICcnKSB7CgkJCQkJJGNbJ2RpcmVjdGlvbiddID0gc3RydG9sb3dlcigkYXR0clsnRElSJ10pOwoJCQkJfQoJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydESVJFQ1RJT04nXSkpIHsKCQkJCQkkY1snZGlyZWN0aW9uJ10gPSBzdHJ0b2xvd2VyKCRwcm9wZXJ0aWVzWydESVJFQ1RJT04nXSk7CgkJCQl9CgoJCQkJaWYgKCEkY1snYSddKSB7CgkJCQkJaWYgKGlzc2V0KCRjWydkaXJlY3Rpb24nXSkgJiYgJGNbJ2RpcmVjdGlvbiddID09ICdydGwnKSB7CgkJCQkJCSRjWydhJ10gPSAnUic7CgkJCQkJfSBlbHNlIHsKCQkJCQkJJGNbJ2EnXSA9ICdMJzsKCQkJCQl9CgkJCQl9CgoJCQkJJGNbJ2NlbGxMaW5lSGVpZ2h0J10gPSAkdGFibGVbJ2NlbGxMaW5lSGVpZ2h0J107CgkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ0xJTkUtSEVJR0hUJ10pKSB7CgkJCQkJJGNbJ2NlbGxMaW5lSGVpZ2h0J10gPSAkdGhpcy0+bXBkZi0+Zml4TGluZWhlaWdodCgkcHJvcGVydGllc1snTElORS1IRUlHSFQnXSk7CgkJCQl9CgoJCQkJJGNbJ2NlbGxMaW5lU3RhY2tpbmdTdHJhdGVneSddID0gJHRhYmxlWydjZWxsTGluZVN0YWNraW5nU3RyYXRlZ3knXTsKCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snTElORS1TVEFDS0lORy1TVFJBVEVHWSddKSkgewoJCQkJCSRjWydjZWxsTGluZVN0YWNraW5nU3RyYXRlZ3knXSA9IHN0cnRvbG93ZXIoJHByb3BlcnRpZXNbJ0xJTkUtU1RBQ0tJTkctU1RSQVRFR1knXSk7CgkJCQl9CgoJCQkJJGNbJ2NlbGxMaW5lU3RhY2tpbmdTaGlmdCddID0gJHRhYmxlWydjZWxsTGluZVN0YWNraW5nU2hpZnQnXTsKCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snTElORS1TVEFDS0lORy1TSElGVCddKSkgewoJCQkJCSRjWydjZWxsTGluZVN0YWNraW5nU2hpZnQnXSA9IHN0cnRvbG93ZXIoJHByb3BlcnRpZXNbJ0xJTkUtU1RBQ0tJTkctU0hJRlQnXSk7CgkJCQl9CgoJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydURVhULVJPVEFURSddKSAmJiAoJHByb3BlcnRpZXNbJ1RFWFQtUk9UQVRFJ10gfHwgJHByb3BlcnRpZXNbJ1RFWFQtUk9UQVRFJ10gPT09ICIwIikpIHsKCQkJCQkkY1snUiddID0gJHByb3BlcnRpZXNbJ1RFWFQtUk9UQVRFJ107CgkJCQl9CgkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ0JPUkRFUiddKSkgewoJCQkJCSRib3JkID0gJHRoaXMtPm1wZGYtPmJvcmRlcl9kZXRhaWxzKCRwcm9wZXJ0aWVzWydCT1JERVInXSk7CgkJCQkJaWYgKCRib3JkWydzJ10pIHsKCQkJCQkJaWYgKCEkdGhpcy0+bXBkZi0+c2ltcGxlVGFibGVzKSB7CgkJCQkJCQkkY1snYm9yZGVyJ10gPSBfQk9SREVSX0FMTDsKCQkJCQkJCSRjWydib3JkZXJfZGV0YWlscyddWydSJ10gPSAkYm9yZDsKCQkJCQkJCSRjWydib3JkZXJfZGV0YWlscyddWydMJ10gPSAkYm9yZDsKCQkJCQkJCSRjWydib3JkZXJfZGV0YWlscyddWydUJ10gPSAkYm9yZDsKCQkJCQkJCSRjWydib3JkZXJfZGV0YWlscyddWydCJ10gPSAkYm9yZDsKCQkJCQkJCSRjWydib3JkZXJfZGV0YWlscyddWydMJ11bJ2RvbSddID0gJHRoaXMtPm1wZGYtPmNlbGxfYm9yZGVyX2RvbWluYW5jZV9MOwoJCQkJCQkJJGNbJ2JvcmRlcl9kZXRhaWxzJ11bJ1InXVsnZG9tJ10gPSAkdGhpcy0+bXBkZi0+Y2VsbF9ib3JkZXJfZG9taW5hbmNlX1I7CgkJCQkJCQkkY1snYm9yZGVyX2RldGFpbHMnXVsnVCddWydkb20nXSA9ICR0aGlzLT5tcGRmLT5jZWxsX2JvcmRlcl9kb21pbmFuY2VfVDsKCQkJCQkJCSRjWydib3JkZXJfZGV0YWlscyddWydCJ11bJ2RvbSddID0gJHRoaXMtPm1wZGYtPmNlbGxfYm9yZGVyX2RvbWluYW5jZV9COwoJCQkJCQl9IGVsc2UgaWYgKCR0aGlzLT5tcGRmLT5zaW1wbGVUYWJsZXMgJiYgJHRoaXMtPm1wZGYtPnJvdyA9PSAwICYmICR0aGlzLT5tcGRmLT5jb2wgPT0gMCkgewoJCQkJCQkJJHRhYmxlWydzaW1wbGUnXVsnYm9yZGVyJ10gPSBfQk9SREVSX0FMTDsKCQkJCQkJCSR0YWJsZVsnc2ltcGxlJ11bJ2JvcmRlcl9kZXRhaWxzJ11bJ1InXSA9ICRib3JkOwoJCQkJCQkJJHRhYmxlWydzaW1wbGUnXVsnYm9yZGVyX2RldGFpbHMnXVsnTCddID0gJGJvcmQ7CgkJCQkJCQkkdGFibGVbJ3NpbXBsZSddWydib3JkZXJfZGV0YWlscyddWydUJ10gPSAkYm9yZDsKCQkJCQkJCSR0YWJsZVsnc2ltcGxlJ11bJ2JvcmRlcl9kZXRhaWxzJ11bJ0InXSA9ICRib3JkOwoJCQkJCQl9CgkJCQkJfQoJCQkJfQoJCQkJaWYgKCEkdGhpcy0+bXBkZi0+c2ltcGxlVGFibGVzKSB7CgkJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydCT1JERVItUklHSFQnXSkgJiYgJHByb3BlcnRpZXNbJ0JPUkRFUi1SSUdIVCddKSB7CgkJCQkJCSRjWydib3JkZXJfZGV0YWlscyddWydSJ10gPSAkdGhpcy0+bXBkZi0+Ym9yZGVyX2RldGFpbHMoJHByb3BlcnRpZXNbJ0JPUkRFUi1SSUdIVCddKTsKCQkJCQkJJHRoaXMtPm1wZGYtPnNldEJvcmRlcigkY1snYm9yZGVyJ10sIF9CT1JERVJfUklHSFQsICRjWydib3JkZXJfZGV0YWlscyddWydSJ11bJ3MnXSk7CgkJCQkJCSRjWydib3JkZXJfZGV0YWlscyddWydSJ11bJ2RvbSddID0gJHRoaXMtPm1wZGYtPmNlbGxfYm9yZGVyX2RvbWluYW5jZV9SOwoJCQkJCX0KCQkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ0JPUkRFUi1MRUZUJ10pICYmICRwcm9wZXJ0aWVzWydCT1JERVItTEVGVCddKSB7CgkJCQkJCSRjWydib3JkZXJfZGV0YWlscyddWydMJ10gPSAkdGhpcy0+bXBkZi0+Ym9yZGVyX2RldGFpbHMoJHByb3BlcnRpZXNbJ0JPUkRFUi1MRUZUJ10pOwoJCQkJCQkkdGhpcy0+bXBkZi0+c2V0Qm9yZGVyKCRjWydib3JkZXInXSwgX0JPUkRFUl9MRUZULCAkY1snYm9yZGVyX2RldGFpbHMnXVsnTCddWydzJ10pOwoJCQkJCQkkY1snYm9yZGVyX2RldGFpbHMnXVsnTCddWydkb20nXSA9ICR0aGlzLT5tcGRmLT5jZWxsX2JvcmRlcl9kb21pbmFuY2VfTDsKCQkJCQl9CgkJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydCT1JERVItQk9UVE9NJ10pICYmICRwcm9wZXJ0aWVzWydCT1JERVItQk9UVE9NJ10pIHsKCQkJCQkJJGNbJ2JvcmRlcl9kZXRhaWxzJ11bJ0InXSA9ICR0aGlzLT5tcGRmLT5ib3JkZXJfZGV0YWlscygkcHJvcGVydGllc1snQk9SREVSLUJPVFRPTSddKTsKCQkJCQkJJHRoaXMtPm1wZGYtPnNldEJvcmRlcigkY1snYm9yZGVyJ10sIF9CT1JERVJfQk9UVE9NLCAkY1snYm9yZGVyX2RldGFpbHMnXVsnQiddWydzJ10pOwoJCQkJCQkkY1snYm9yZGVyX2RldGFpbHMnXVsnQiddWydkb20nXSA9ICR0aGlzLT5tcGRmLT5jZWxsX2JvcmRlcl9kb21pbmFuY2VfQjsKCQkJCQl9CgkJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydCT1JERVItVE9QJ10pICYmICRwcm9wZXJ0aWVzWydCT1JERVItVE9QJ10pIHsKCQkJCQkJJGNbJ2JvcmRlcl9kZXRhaWxzJ11bJ1QnXSA9ICR0aGlzLT5tcGRmLT5ib3JkZXJfZGV0YWlscygkcHJvcGVydGllc1snQk9SREVSLVRPUCddKTsKCQkJCQkJJHRoaXMtPm1wZGYtPnNldEJvcmRlcigkY1snYm9yZGVyJ10sIF9CT1JERVJfVE9QLCAkY1snYm9yZGVyX2RldGFpbHMnXVsnVCddWydzJ10pOwoJCQkJCQkkY1snYm9yZGVyX2RldGFpbHMnXVsnVCddWydkb20nXSA9ICR0aGlzLT5tcGRmLT5jZWxsX2JvcmRlcl9kb21pbmFuY2VfVDsKCQkJCQl9CgkJCQl9IGVsc2UgaWYgKCR0aGlzLT5tcGRmLT5zaW1wbGVUYWJsZXMgJiYgJHRoaXMtPm1wZGYtPnJvdyA9PSAwICYmICR0aGlzLT5tcGRmLT5jb2wgPT0gMCkgewoJCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snQk9SREVSLUxFRlQnXSkgJiYgJHByb3BlcnRpZXNbJ0JPUkRFUi1MRUZUJ10pIHsKCQkJCQkJJGJvcmQgPSAkdGhpcy0+bXBkZi0+Ym9yZGVyX2RldGFpbHMoJHByb3BlcnRpZXNbJ0JPUkRFUi1MRUZUJ10pOwoJCQkJCQlpZiAoJGJvcmRbJ3MnXSkgewoJCQkJCQkJJHRhYmxlWydzaW1wbGUnXVsnYm9yZGVyJ10gPSBfQk9SREVSX0FMTDsKCQkJCQkJfSBlbHNlIHsKCQkJCQkJCSR0YWJsZVsnc2ltcGxlJ11bJ2JvcmRlciddID0gMDsKCQkJCQkJfQoJCQkJCQkkdGFibGVbJ3NpbXBsZSddWydib3JkZXJfZGV0YWlscyddWydSJ10gPSAkYm9yZDsKCQkJCQkJJHRhYmxlWydzaW1wbGUnXVsnYm9yZGVyX2RldGFpbHMnXVsnTCddID0gJGJvcmQ7CgkJCQkJCSR0YWJsZVsnc2ltcGxlJ11bJ2JvcmRlcl9kZXRhaWxzJ11bJ1QnXSA9ICRib3JkOwoJCQkJCQkkdGFibGVbJ3NpbXBsZSddWydib3JkZXJfZGV0YWlscyddWydCJ10gPSAkYm9yZDsKCQkJCQl9CgkJCQl9CgoJCQkJaWYgKCR0aGlzLT5tcGRmLT5zaW1wbGVUYWJsZXMgJiYgJHRoaXMtPm1wZGYtPnJvdyA9PSAwICYmICR0aGlzLT5tcGRmLT5jb2wgPT0gMCAmJiAhJHRhYmxlWydib3JkZXJzX3NlcGFyYXRlJ10gJiYgJHRhYmxlWydzaW1wbGUnXVsnYm9yZGVyJ10pIHsKCQkJCQkkdGFibGVbJ2JvcmRlcl9kZXRhaWxzJ10gPSAkdGFibGVbJ3NpbXBsZSddWydib3JkZXJfZGV0YWlscyddOwoJCQkJCSR0YWJsZVsnYm9yZGVyJ10gPSAkdGFibGVbJ3NpbXBsZSddWydib3JkZXInXTsKCQkJCX0KCgkJCQkvLyBCb3JkZXIgc2V0IG9uIFRSIChpZiBjb2xsYXBzZWQgb25seSkKCQkJCWlmICghJHRhYmxlWydib3JkZXJzX3NlcGFyYXRlJ10gJiYgISR0aGlzLT5tcGRmLT5zaW1wbGVUYWJsZXMgJiYgaXNzZXQoJHRhYmxlWyd0cmJvcmRlci1sZWZ0J11bJHRoaXMtPm1wZGYtPnJvd10pKSB7CgkJCQkJaWYgKCR0aGlzLT5tcGRmLT5jb2wgPT0gMCkgewoJCQkJCQkkbGVmdCA9ICR0aGlzLT5tcGRmLT5ib3JkZXJfZGV0YWlscygkdGFibGVbJ3RyYm9yZGVyLWxlZnQnXVskdGhpcy0+bXBkZi0+cm93XSk7CgkJCQkJCSRjWydib3JkZXJfZGV0YWlscyddWydMJ10gPSAkbGVmdDsKCQkJCQkJJHRoaXMtPm1wZGYtPnNldEJvcmRlcigkY1snYm9yZGVyJ10sIF9CT1JERVJfTEVGVCwgJGNbJ2JvcmRlcl9kZXRhaWxzJ11bJ0wnXVsncyddKTsKCQkJCQl9CgkJCQkJJGNbJ2JvcmRlcl9kZXRhaWxzJ11bJ0InXSA9ICR0aGlzLT5tcGRmLT5ib3JkZXJfZGV0YWlscygkdGFibGVbJ3RyYm9yZGVyLWJvdHRvbSddWyR0aGlzLT5tcGRmLT5yb3ddKTsKCQkJCQkkdGhpcy0+bXBkZi0+c2V0Qm9yZGVyKCRjWydib3JkZXInXSwgX0JPUkRFUl9CT1RUT00sICRjWydib3JkZXJfZGV0YWlscyddWydCJ11bJ3MnXSk7CgkJCQkJJGNbJ2JvcmRlcl9kZXRhaWxzJ11bJ1QnXSA9ICR0aGlzLT5tcGRmLT5ib3JkZXJfZGV0YWlscygkdGFibGVbJ3RyYm9yZGVyLXRvcCddWyR0aGlzLT5tcGRmLT5yb3ddKTsKCQkJCQkkdGhpcy0+bXBkZi0+c2V0Qm9yZGVyKCRjWydib3JkZXInXSwgX0JPUkRFUl9UT1AsICRjWydib3JkZXJfZGV0YWlscyddWydUJ11bJ3MnXSk7CgkJCQl9CgoJCQkJaWYgKCR0aGlzLT5tcGRmLT5wYWNrVGFibGVEYXRhICYmICEkdGhpcy0+bXBkZi0+c2ltcGxlVGFibGVzKSB7CgkJCQkJJGNbJ2JvcmRlcmJpbiddID0gJHRoaXMtPm1wZGYtPl9wYWNrQ2VsbEJvcmRlcigkYyk7CgkJCQkJdW5zZXQoJGNbJ2JvcmRlciddKTsKCQkJCQl1bnNldCgkY1snYm9yZGVyX2RldGFpbHMnXSk7CgkJCQl9CgoJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydQQURESU5HLUxFRlQnXSkpIHsKCQkJCQkkY1sncGFkZGluZyddWydMJ10gPSAkdGhpcy0+bXBkZi0+Q29udmVydFNpemUoJHByb3BlcnRpZXNbJ1BBRERJTkctTEVGVCddLCAkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWydpbm5lcl93aWR0aCddLCAkdGhpcy0+bXBkZi0+Rm9udFNpemUsIGZhbHNlKTsKCQkJCX0KCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snUEFERElORy1SSUdIVCddKSkgewoJCQkJCSRjWydwYWRkaW5nJ11bJ1InXSA9ICR0aGlzLT5tcGRmLT5Db252ZXJ0U2l6ZSgkcHJvcGVydGllc1snUEFERElORy1SSUdIVCddLCAkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWydpbm5lcl93aWR0aCddLCAkdGhpcy0+bXBkZi0+Rm9udFNpemUsIGZhbHNlKTsKCQkJCX0KCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snUEFERElORy1CT1RUT00nXSkpIHsKCQkJCQkkY1sncGFkZGluZyddWydCJ10gPSAkdGhpcy0+bXBkZi0+Q29udmVydFNpemUoJHByb3BlcnRpZXNbJ1BBRERJTkctQk9UVE9NJ10sICR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ2lubmVyX3dpZHRoJ10sICR0aGlzLT5tcGRmLT5Gb250U2l6ZSwgZmFsc2UpOwoJCQkJfQoJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydQQURESU5HLVRPUCddKSkgewoJCQkJCSRjWydwYWRkaW5nJ11bJ1QnXSA9ICR0aGlzLT5tcGRmLT5Db252ZXJ0U2l6ZSgkcHJvcGVydGllc1snUEFERElORy1UT1AnXSwgJHRoaXMtPm1wZGYtPmJsa1skdGhpcy0+bXBkZi0+YmxrbHZsXVsnaW5uZXJfd2lkdGgnXSwgJHRoaXMtPm1wZGYtPkZvbnRTaXplLCBmYWxzZSk7CgkJCQl9CgoJCQkJJHcgPSAnJzsKCQkJCWlmIChpc3NldCgkcHJvcGVydGllc1snV0lEVEgnXSkpIHsKCQkJCQkkdyA9ICRwcm9wZXJ0aWVzWydXSURUSCddOwoJCQkJfSBlbHNlIGlmIChpc3NldCgkYXR0clsnV0lEVEgnXSkpIHsKCQkJCQkkdyA9ICRhdHRyWydXSURUSCddOwoJCQkJfQoJCQkJaWYgKCR3KSB7CgkJCQkJaWYgKHN0cnBvcygkdywgJyUnKSAmJiAhJHRoaXMtPm1wZGYtPmlnbm9yZV90YWJsZV9wZXJjZW50cykgewoJCQkJCQkkY1snd3BlcmNlbnQnXSA9ICR3ICsgMDsKCQkJCQl9IC8vIG1ha2VzIDgwJSAtPiA4MAoJCQkJCWVsc2UgaWYgKCFzdHJwb3MoJHcsICclJykgJiYgISR0aGlzLT5tcGRmLT5pZ25vcmVfdGFibGVfd2lkdGhzKSB7CgkJCQkJCSRjWyd3J10gPSAkdGhpcy0+bXBkZi0+Q29udmVydFNpemUoJHcsICR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ2lubmVyX3dpZHRoJ10sICR0aGlzLT5tcGRmLT5Gb250U2l6ZSwgZmFsc2UpOwoJCQkJCX0KCQkJCX0KCgkJCQlpZiAoaXNzZXQoJHByb3BlcnRpZXNbJ0hFSUdIVCddKSAmJiAhc3RycG9zKCRwcm9wZXJ0aWVzWydIRUlHSFQnXSwgJyUnKSkgewoJCQkJCSRjWydoJ10gPSAkdGhpcy0+bXBkZi0+Q29udmVydFNpemUoJHByb3BlcnRpZXNbJ0hFSUdIVCddLCAkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWydpbm5lcl93aWR0aCddLCAkdGhpcy0+bXBkZi0+Rm9udFNpemUsIGZhbHNlKTsKCQkJCX0gZWxzZSBpZiAoaXNzZXQoJGF0dHJbJ0hFSUdIVCddKSAmJiAhc3RycG9zKCRhdHRyWydIRUlHSFQnXSwgJyUnKSkKCQkJCQkkY1snaCddID0gJHRoaXMtPm1wZGYtPkNvbnZlcnRTaXplKCRhdHRyWydIRUlHSFQnXSwgJHRoaXMtPm1wZGYtPmJsa1skdGhpcy0+bXBkZi0+YmxrbHZsXVsnaW5uZXJfd2lkdGgnXSwgJHRoaXMtPm1wZGYtPkZvbnRTaXplLCBmYWxzZSk7CgoJCQkJaWYgKGlzc2V0KCRwcm9wZXJ0aWVzWydXSElURS1TUEFDRSddKSkgewoJCQkJCWlmIChzdHJ0b3VwcGVyKCRwcm9wZXJ0aWVzWydXSElURS1TUEFDRSddKSA9PSAnTk9XUkFQJykgewoJCQkJCQkkY1snbm93cmFwJ10gPSAxOwoJCQkJCX0KCQkJCX0KCQkJCSRwcm9wZXJ0aWVzID0gYXJyYXkoKTsKCgoJCQkJaWYgKGlzc2V0KCRhdHRyWydURVhULVJPVEFURSddKSkgewoJCQkJCSRjWydSJ10gPSAkYXR0clsnVEVYVC1ST1RBVEUnXTsKCQkJCX0KCQkJCWlmIChpc3NldCgkYXR0clsnTk9XUkFQJ10pICYmICRhdHRyWydOT1dSQVAnXSkKCQkJCQkkY1snbm93cmFwJ10gPSAxOwoKCQkJCSR0aGlzLT5tcGRmLT5jZWxsWyR0aGlzLT5tcGRmLT5yb3ddWyR0aGlzLT5tcGRmLT5jb2xdID0gJGM7CgkJCQl1bnNldCgkYyk7CgkJCQkkdGhpcy0+bXBkZi0+Y2VsbFskdGhpcy0+bXBkZi0+cm93XVskdGhpcy0+bXBkZi0+Y29sXVsncyddID0gMDsKCgkJCQkkY3MgPSAkcnMgPSAxOwoJCQkJaWYgKGlzc2V0KCRhdHRyWydDT0xTUEFOJ10pICYmICRhdHRyWydDT0xTUEFOJ10gPiAxKQoJCQkJCSRjcyA9ICR0aGlzLT5tcGRmLT5jZWxsWyR0aGlzLT5tcGRmLT5yb3ddWyR0aGlzLT5tcGRmLT5jb2xdWydjb2xzcGFuJ10gPSAkYXR0clsnQ09MU1BBTiddOwoJCQkJaWYgKCR0aGlzLT5tcGRmLT50YWJsZVskdGhpcy0+bXBkZi0+dGFibGVMZXZlbF1bJHRoaXMtPm1wZGYtPnRiY3RyWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXV1bJ25jJ10gPCAkdGhpcy0+bXBkZi0+Y29sICsgJGNzKSB7CgkJCQkJJHRoaXMtPm1wZGYtPnRhYmxlWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXVskdGhpcy0+bXBkZi0+dGJjdHJbJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWxdXVsnbmMnXSA9ICR0aGlzLT5tcGRmLT5jb2wgKyAkY3M7CgkJCQl9IC8vIGZvbGxvd2luZyBjb2RlIG1vdmVkIG91dHNpZGUgaWYuLi4KCQkJCWZvciAoJGwgPSAkdGhpcy0+bXBkZi0+Y29sOyAkbCA8ICR0aGlzLT5tcGRmLT5jb2wgKyAkY3M7ICRsKyspIHsKCQkJCQlpZiAoJGwgLSAkdGhpcy0+bXBkZi0+Y29sKQoJCQkJCQkkdGhpcy0+bXBkZi0+Y2VsbFskdGhpcy0+bXBkZi0+cm93XVskbF0gPSAwOwoJCQkJfQoJCQkJaWYgKGlzc2V0KCRhdHRyWydST1dTUEFOJ10pICYmICRhdHRyWydST1dTUEFOJ10gPiAxKQoJCQkJCSRycyA9ICR0aGlzLT5tcGRmLT5jZWxsWyR0aGlzLT5tcGRmLT5yb3ddWyR0aGlzLT5tcGRmLT5jb2xdWydyb3dzcGFuJ10gPSAkYXR0clsnUk9XU1BBTiddOwoJCQkJZm9yICgkayA9ICR0aGlzLT5tcGRmLT5yb3c7ICRrIDwgJHRoaXMtPm1wZGYtPnJvdyArICRyczsgJGsrKykgewoJCQkJCWZvciAoJGwgPSAkdGhpcy0+bXBkZi0+Y29sOyAkbCA8ICR0aGlzLT5tcGRmLT5jb2wgKyAkY3M7ICRsKyspIHsKCQkJCQkJaWYgKCRrIC0gJHRoaXMtPm1wZGYtPnJvdyB8fCAkbCAtICR0aGlzLT5tcGRmLT5jb2wpCgkJCQkJCQkkdGhpcy0+bXBkZi0+Y2VsbFska11bJGxdID0gMDsKCQkJCQl9CgkJCQl9CgkJCQl1bnNldCgkdGFibGUpOwoJCQkJYnJlYWs7CgkJCS8qIC0tIEVORCBUQUJMRVMgLS0gKi8KCQl9Ly9lbmQgb2Ygc3dpdGNoCgl9CgoJZnVuY3Rpb24gQ2xvc2VUYWcoJHRhZywgJiRhaHRtbCwgJiRpaHRtbCkKCXsgLy8gbVBERiA2CgkJLy9DbG9zaW5nIHRhZwoJCWlmICgkdGFnID09ICdPUFRJT04nKSB7CgkJCSR0aGlzLT5tcGRmLT5zZWxlY3RvcHRpb25bJ0FDVElWRSddID0gZmFsc2U7CgkJCSR0aGlzLT5tcGRmLT5sYXN0b3B0aW9uYWx0YWcgPSAnJzsKCQl9CgoJCWlmICgkdGFnID09ICdUVFMnIG9yICR0YWcgPT0gJ1RUQScgb3IgJHRhZyA9PSAnVFRaJykgewoJCQlpZiAoJHRoaXMtPm1wZGYtPklubGluZVByb3BlcnRpZXNbJHRhZ10pIHsKCQkJCSR0aGlzLT5tcGRmLT5yZXN0b3JlSW5saW5lUHJvcGVydGllcygkdGhpcy0+bXBkZi0+SW5saW5lUHJvcGVydGllc1skdGFnXSk7CgkJCX0KCQkJdW5zZXQoJHRoaXMtPm1wZGYtPklubGluZVByb3BlcnRpZXNbJHRhZ10pOwoJCQkkbHRhZyA9IHN0cnRvbG93ZXIoJHRhZyk7CgkJCSR0aGlzLT5tcGRmLT4kbHRhZyA9IGZhbHNlOwoJCX0KCgoJCWlmICgkdGFnID09ICdGT05UJyB8fCAkdGFnID09ICdTUEFOJyB8fCAkdGFnID09ICdDT0RFJyB8fCAkdGFnID09ICdLQkQnIHx8ICR0YWcgPT0gJ1NBTVAnIHx8ICR0YWcgPT0gJ1RUJyB8fCAkdGFnID09ICdWQVInIHx8ICR0YWcgPT0gJ0lOUycgfHwgJHRhZyA9PSAnU1RST05HJyB8fCAkdGFnID09ICdDSVRFJyB8fCAkdGFnID09ICdTVUInIHx8ICR0YWcgPT0gJ1NVUCcgfHwgJHRhZyA9PSAnUycgfHwgJHRhZyA9PSAnU1RSSUtFJyB8fCAkdGFnID09ICdERUwnIHx8ICR0YWcgPT0gJ1EnIHx8ICR0YWcgPT0gJ0VNJyB8fCAkdGFnID09ICdCJyB8fCAkdGFnID09ICdJJyB8fCAkdGFnID09ICdVJyB8ICR0YWcgPT0gJ1NNQUxMJyB8fCAkdGFnID09ICdCSUcnIHx8ICR0YWcgPT0gJ0FDUk9OWU0nIHx8ICR0YWcgPT0gJ01BUksnIHx8ICR0YWcgPT0gJ1RJTUUnIHx8ICR0YWcgPT0gJ1BST0dSRVNTJyB8fCAkdGFnID09ICdNRVRFUicgfHwgJHRhZyA9PSAnQkRPJyB8fCAkdGFnID09ICdCREknCgkJKSB7CgoJCQkkYW5ub3QgPSBmYWxzZTsgLy8gbVBERiA2CgkJCSRiZGYgPSBmYWxzZTsgLy8gbVBERiA2CgkJCS8vIG1QREYgNS43LjMgSW5saW5lIHRhZ3MKCQkJaWYgKCR0YWcgPT0gJ1BST0dSRVNTJyB8fCAkdGFnID09ICdNRVRFUicpIHsKCQkJCWlmIChpc3NldCgkdGhpcy0+bXBkZi0+SW5saW5lUHJvcGVydGllc1skdGFnXSkgJiYgJHRoaXMtPm1wZGYtPklubGluZVByb3BlcnRpZXNbJHRhZ10pIHsKCQkJCQkkdGhpcy0+bXBkZi0+cmVzdG9yZUlubGluZVByb3BlcnRpZXMoJHRoaXMtPm1wZGYtPklubGluZVByb3BlcnRpZXNbJHRhZ10pOwoJCQkJfQoJCQkJdW5zZXQoJHRoaXMtPm1wZGYtPklubGluZVByb3BlcnRpZXNbJHRhZ10pOwoJCQkJaWYgKGlzc2V0KCR0aGlzLT5tcGRmLT5JbmxpbmVBbm5vdHNbJHRhZ10pICYmICR0aGlzLT5tcGRmLT5JbmxpbmVBbm5vdHNbJHRhZ10pIHsKCQkJCQkkYW5ub3QgPSAkdGhpcy0+bXBkZi0+SW5saW5lQW5ub3RzWyR0YWddOwoJCQkJfSAvLyAqQU5OT1RBVElPTlMqCgkJCQl1bnNldCgkdGhpcy0+bXBkZi0+SW5saW5lQW5ub3RzWyR0YWddKTsgLy8gKkFOTk9UQVRJT05TKgoJCQl9IGVsc2UgewoJCQkJaWYgKGlzc2V0KCR0aGlzLT5tcGRmLT5JbmxpbmVQcm9wZXJ0aWVzWyR0YWddKSAmJiBjb3VudCgkdGhpcy0+bXBkZi0+SW5saW5lUHJvcGVydGllc1skdGFnXSkpIHsKCQkJCQkkdG1wUHJvcHMgPSBhcnJheV9wb3AoJHRoaXMtPm1wZGYtPklubGluZVByb3BlcnRpZXNbJHRhZ10pOyAvLyBtUERGIDUuNy40CgkJCQkJJHRoaXMtPm1wZGYtPnJlc3RvcmVJbmxpbmVQcm9wZXJ0aWVzKCR0bXBQcm9wcyk7CgkJCQl9CgkJCQlpZiAoaXNzZXQoJHRoaXMtPm1wZGYtPklubGluZUFubm90c1skdGFnXSkgJiYgY291bnQoJHRoaXMtPm1wZGYtPklubGluZUFubm90c1skdGFnXSkpIHsgIC8vICpBTk5PVEFUSU9OUyoKCQkJCQkkYW5ub3QgPSBhcnJheV9wb3AoJHRoaXMtPm1wZGYtPklubGluZUFubm90c1skdGFnXSk7ICAvLyAqQU5OT1RBVElPTlMqCgkJCQl9IC8vICpBTk5PVEFUSU9OUyoKCQkJCWlmIChpc3NldCgkdGhpcy0+bXBkZi0+SW5saW5lQkRGWyR0YWddKSAmJiBjb3VudCgkdGhpcy0+bXBkZi0+SW5saW5lQkRGWyR0YWddKSkgeyAgLy8gbVBERiA2CgkJCQkJJGJkZmFyciA9IGFycmF5X3BvcCgkdGhpcy0+bXBkZi0+SW5saW5lQkRGWyR0YWddKTsKCQkJCQkkYmRmID0gJGJkZmFyclswXTsKCQkJCX0KCQkJfQoKCQkJLyogLS0gQU5OT1RBVElPTlMgLS0gKi8KCQkJaWYgKCRhbm5vdCkgeyAvLyBtUERGIDYKCQkJCWlmICgkdGhpcy0+bXBkZi0+dGFibGVMZXZlbCkgeyAvLyAqVEFCTEVTKgoJCQkJCSR0aGlzLT5tcGRmLT5jZWxsWyR0aGlzLT5tcGRmLT5yb3ddWyR0aGlzLT5tcGRmLT5jb2xdWyd0ZXh0YnVmZmVyJ11bXSA9IGFycmF5KCRhbm5vdCk7IC8vICpUQUJMRVMqCgkJCQl9IC8vICpUQUJMRVMqCgkJCQllbHNlIHsgLy8gKlRBQkxFUyoKCQkJCQkkdGhpcy0+bXBkZi0+dGV4dGJ1ZmZlcltdID0gYXJyYXkoJGFubm90KTsKCQkJCX0gLy8gKlRBQkxFUyoKCQkJfQoJCQkvKiAtLSBFTkQgQU5OT1RBVElPTlMgLS0gKi8KCgkJCS8vIG1QREYgNiBiaWRpCgkJCS8vIG1QREYgNiBCaWRpcmVjdGlvbmFsIGZvcm1hdHRpbmcgZm9yIGlubGluZSBlbGVtZW50cwoJCQlpZiAoJGJkZikgewoJCQkJJHBvcGYgPSAkdGhpcy0+bXBkZi0+X3NldEJpZGlDb2RlcygnZW5kJywgJGJkZik7CgkJCQkkdGhpcy0+bXBkZi0+T1RMZGF0YSA9IGFycmF5KCk7CgkJCQlpZiAoJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWwpIHsKCQkJCQkkdGhpcy0+bXBkZi0+X3NhdmVDZWxsVGV4dEJ1ZmZlcigkcG9wZik7CgkJCQl9IGVsc2UgewoJCQkJCSR0aGlzLT5tcGRmLT5fc2F2ZVRleHRCdWZmZXIoJHBvcGYpOwoJCQkJfQoJCQl9CgkJfSAvLyBFbmQgb2YgKG1vc3QpIElubGluZSBlbGVtZW50cyBlZyBTUEFOCgoKCQlpZiAoJHRhZyA9PSAnTUVURVInIHx8ICR0YWcgPT0gJ1BST0dSRVNTJykgewoJCQkkdGhpcy0+bXBkZi0+aWdub3JlZm9sbG93aW5nc3BhY2VzID0gZmFsc2U7CgkJCSR0aGlzLT5tcGRmLT5pbk1ldGVyID0gZmFsc2U7CgkJfQoKCgkJaWYgKCR0YWcgPT0gJ0EnKSB7CgkJCSR0aGlzLT5tcGRmLT5IUkVGID0gJyc7CgkJCWlmIChpc3NldCgkdGhpcy0+bXBkZi0+SW5saW5lUHJvcGVydGllc1snQSddKSkgewoJCQkJJHRoaXMtPm1wZGYtPnJlc3RvcmVJbmxpbmVQcm9wZXJ0aWVzKCR0aGlzLT5tcGRmLT5JbmxpbmVQcm9wZXJ0aWVzWydBJ10pOwoJCQl9CgkJCXVuc2V0KCR0aGlzLT5tcGRmLT5JbmxpbmVQcm9wZXJ0aWVzWydBJ10pOwoJCX0KCgkJaWYgKCR0YWcgPT0gJ0xFR0VORCcpIHsKCQkJaWYgKGNvdW50KCR0aGlzLT5tcGRmLT50ZXh0YnVmZmVyKSAmJiAhJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWwpIHsKCQkJCSRsZWcgPSAkdGhpcy0+bXBkZi0+dGV4dGJ1ZmZlclsoY291bnQoJHRoaXMtPm1wZGYtPnRleHRidWZmZXIpIC0gMSldOwoJCQkJdW5zZXQoJHRoaXMtPm1wZGYtPnRleHRidWZmZXJbKGNvdW50KCR0aGlzLT5tcGRmLT50ZXh0YnVmZmVyKSAtIDEpXSk7CgkJCQkkdGhpcy0+bXBkZi0+dGV4dGJ1ZmZlciA9IGFycmF5X3ZhbHVlcygkdGhpcy0+bXBkZi0+dGV4dGJ1ZmZlcik7CgkJCQkkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWydib3JkZXJfbGVnZW5kJ10gPSAkbGVnOwoJCQkJJHRoaXMtPm1wZGYtPmJsa1skdGhpcy0+bXBkZi0+YmxrbHZsXVsnbWFyZ2luX3RvcCddICs9ICgkbGVnWzExXSAvIDIpIC8gX01QREZLOwoJCQkJJHRoaXMtPm1wZGYtPmJsa1skdGhpcy0+bXBkZi0+YmxrbHZsXVsncGFkZGluZ190b3AnXSArPSAoJGxlZ1sxMV0gLyAyKSAvIF9NUERGSzsKCQkJfQoJCQlpZiAoaXNzZXQoJHRoaXMtPm1wZGYtPklubGluZVByb3BlcnRpZXNbJ0xFR0VORCddKSkgewoJCQkJJHRoaXMtPm1wZGYtPnJlc3RvcmVJbmxpbmVQcm9wZXJ0aWVzKCR0aGlzLT5tcGRmLT5JbmxpbmVQcm9wZXJ0aWVzWydMRUdFTkQnXSk7CgkJCX0KCQkJdW5zZXQoJHRoaXMtPm1wZGYtPklubGluZVByb3BlcnRpZXNbJ0xFR0VORCddKTsKCQkJJHRoaXMtPm1wZGYtPmlnbm9yZWZvbGxvd2luZ3NwYWNlcyA9IHRydWU7IC8vRWxpbWluYXRlIGV4Y2VlZGluZyBsZWZ0LXNpZGUgc3BhY2VzCgkJfQoKCQkvKiAtLSBGT1JNUyAtLSAqLwoJCS8vICoqKioqKioqKioqIEZPUk0gRUxFTUVOVFMgKioqKioqKioqKioqKioqKioqKioKCgkJaWYgKCR0YWcgPT0gJ1RFWFRBUkVBJykgewoJCQkkdGhpcy0+bXBkZi0+aWdub3JlZm9sbG93aW5nc3BhY2VzID0gZmFsc2U7CgkJCSR0aGlzLT5tcGRmLT5zcGVjaWFsY29udGVudCA9ICcnOwoJCQlpZiAoJHRoaXMtPm1wZGYtPklubGluZVByb3BlcnRpZXNbJHRhZ10pIHsKCQkJCSR0aGlzLT5tcGRmLT5yZXN0b3JlSW5saW5lUHJvcGVydGllcygkdGhpcy0+bXBkZi0+SW5saW5lUHJvcGVydGllc1skdGFnXSk7CgkJCX0KCQkJdW5zZXQoJHRoaXMtPm1wZGYtPklubGluZVByb3BlcnRpZXNbJHRhZ10pOwoJCX0KCgoJCWlmICgkdGFnID09ICdTRUxFQ1QnKSB7CgkJCSR0aGlzLT5tcGRmLT5pZ25vcmVmb2xsb3dpbmdzcGFjZXMgPSBmYWxzZTsKCQkJJHRoaXMtPm1wZGYtPmxhc3RvcHRpb25hbHRhZyA9ICcnOwoJCQkkdGV4dG8gPSAnJzsKCQkJJE9UTGRhdGEgPSBmYWxzZTsKCQkJaWYgKGlzc2V0KCR0aGlzLT5tcGRmLT5zZWxlY3RvcHRpb25bJ1NFTEVDVEVEJ10pKSB7CgkJCQkkdGV4dG8gPSAkdGhpcy0+bXBkZi0+c2VsZWN0b3B0aW9uWydTRUxFQ1RFRCddOwoJCQl9CgkJCWlmIChpc3NldCgkdGhpcy0+bXBkZi0+c2VsZWN0b3B0aW9uWydTRUxFQ1RFRC1PVExEQVRBJ10pKSB7CgkJCQkkT1RMZGF0YSA9ICR0aGlzLT5tcGRmLT5zZWxlY3RvcHRpb25bJ1NFTEVDVEVELU9UTERBVEEnXTsKCQkJfQoKCQkJaWYgKCR0aGlzLT5tcGRmLT51c2VBY3RpdmVGb3JtcykgewoJCQkJJHcgPSAkdGhpcy0+bXBkZi0+c2VsZWN0b3B0aW9uWydNQVhXSURUSCddOwoJCQl9IGVsc2UgewoJCQkJJHcgPSAkdGhpcy0+bXBkZi0+R2V0U3RyaW5nV2lkdGgoJHRleHRvLCB0cnVlLCAkT1RMZGF0YSk7CgkJCX0KCQkJaWYgKCR3ID09IDApIHsKCQkJCSR3ID0gNTsKCQkJfQoJCQkkb2JqYXR0clsndHlwZSddID0gJ3NlbGVjdCc7CgkJCSRvYmphdHRyWyd0ZXh0J10gPSAkdGV4dG87CgkJCSRvYmphdHRyWydPVExkYXRhJ10gPSAkT1RMZGF0YTsKCQkJaWYgKGlzc2V0KCR0aGlzLT5tcGRmLT5zZWxlY3RvcHRpb25bJ05BTUUnXSkpIHsKCQkJCSRvYmphdHRyWydmaWVsZG5hbWUnXSA9ICR0aGlzLT5tcGRmLT5zZWxlY3RvcHRpb25bJ05BTUUnXTsKCQkJfQoJCQlpZiAoaXNzZXQoJHRoaXMtPm1wZGYtPnNlbGVjdG9wdGlvblsnUkVBRE9OTFknXSkpIHsKCQkJCSRvYmphdHRyWydyZWFkb25seSddID0gdHJ1ZTsKCQkJfQoJCQlpZiAoaXNzZXQoJHRoaXMtPm1wZGYtPnNlbGVjdG9wdGlvblsnUkVRVUlSRUQnXSkpIHsKCQkJCSRvYmphdHRyWydyZXF1aXJlZCddID0gdHJ1ZTsKCQkJfQoJCQlpZiAoaXNzZXQoJHRoaXMtPm1wZGYtPnNlbGVjdG9wdGlvblsnU1BFTExDSEVDSyddKSkgewoJCQkJJG9iamF0dHJbJ3NwZWxsY2hlY2snXSA9IHRydWU7CgkJCX0KCQkJaWYgKGlzc2V0KCR0aGlzLT5tcGRmLT5zZWxlY3RvcHRpb25bJ0VESVRBQkxFJ10pKSB7CgkJCQkkb2JqYXR0clsnZWRpdGFibGUnXSA9IHRydWU7CgkJCX0KCQkJaWYgKGlzc2V0KCR0aGlzLT5tcGRmLT5zZWxlY3RvcHRpb25bJ09OQ0hBTkdFJ10pKSB7CgkJCQkkb2JqYXR0clsnb25DaGFuZ2UnXSA9ICR0aGlzLT5tcGRmLT5zZWxlY3RvcHRpb25bJ09OQ0hBTkdFJ107CgkJCX0KCQkJaWYgKGlzc2V0KCR0aGlzLT5tcGRmLT5zZWxlY3RvcHRpb25bJ0lURU1TJ10pKSB7CgkJCQkkb2JqYXR0clsnaXRlbXMnXSA9ICR0aGlzLT5tcGRmLT5zZWxlY3RvcHRpb25bJ0lURU1TJ107CgkJCX0KCQkJaWYgKGlzc2V0KCR0aGlzLT5tcGRmLT5zZWxlY3RvcHRpb25bJ01VTFRJUExFJ10pKSB7CgkJCQkkb2JqYXR0clsnbXVsdGlwbGUnXSA9ICR0aGlzLT5tcGRmLT5zZWxlY3RvcHRpb25bJ01VTFRJUExFJ107CgkJCX0KCQkJaWYgKGlzc2V0KCR0aGlzLT5tcGRmLT5zZWxlY3RvcHRpb25bJ0RJU0FCTEVEJ10pKSB7CgkJCQkkb2JqYXR0clsnZGlzYWJsZWQnXSA9ICR0aGlzLT5tcGRmLT5zZWxlY3RvcHRpb25bJ0RJU0FCTEVEJ107CgkJCX0KCQkJaWYgKGlzc2V0KCR0aGlzLT5tcGRmLT5zZWxlY3RvcHRpb25bJ1RJVExFJ10pKSB7CgkJCQkkb2JqYXR0clsndGl0bGUnXSA9ICR0aGlzLT5tcGRmLT5zZWxlY3RvcHRpb25bJ1RJVExFJ107CgkJCX0KCQkJaWYgKGlzc2V0KCR0aGlzLT5tcGRmLT5zZWxlY3RvcHRpb25bJ0NPTE9SJ10pKSB7CgkJCQkkb2JqYXR0clsnY29sb3InXSA9ICR0aGlzLT5tcGRmLT5zZWxlY3RvcHRpb25bJ0NPTE9SJ107CgkJCX0KCQkJaWYgKGlzc2V0KCR0aGlzLT5tcGRmLT5zZWxlY3RvcHRpb25bJ1NJWkUnXSkpIHsKCQkJCSRvYmphdHRyWydzaXplJ10gPSAkdGhpcy0+bXBkZi0+c2VsZWN0b3B0aW9uWydTSVpFJ107CgkJCX0KCQkJaWYgKGlzc2V0KCRvYmphdHRyWydzaXplJ10pICYmICRvYmphdHRyWydzaXplJ10gPiAxKSB7CgkJCQkkcm93cyA9ICRvYmphdHRyWydzaXplJ107CgkJCX0gZWxzZSB7CgkJCQkkcm93cyA9IDE7CgkJCX0KCgkJCSRvYmphdHRyWydmb250ZmFtaWx5J10gPSAkdGhpcy0+bXBkZi0+Rm9udEZhbWlseTsKCQkJJG9iamF0dHJbJ2ZvbnRzaXplJ10gPSAkdGhpcy0+bXBkZi0+Rm9udFNpemVQdDsKCgkJCSRvYmphdHRyWyd3aWR0aCddID0gJHcgKyAoJHRoaXMtPm1wZGYtPm1wZGZmb3JtLT5mb3JtX2VsZW1lbnRfc3BhY2luZ1snc2VsZWN0J11bJ291dGVyJ11bJ2gnXSAqIDIpICsgKCR0aGlzLT5tcGRmLT5tcGRmZm9ybS0+Zm9ybV9lbGVtZW50X3NwYWNpbmdbJ3NlbGVjdCddWydpbm5lciddWydoJ10gKiAyKSArICgkdGhpcy0+bXBkZi0+Rm9udFNpemUgKiAxLjQpOwoJCQkkb2JqYXR0clsnaGVpZ2h0J10gPSAoJHRoaXMtPm1wZGYtPkZvbnRTaXplICogJHJvd3MpICsgKCR0aGlzLT5tcGRmLT5tcGRmZm9ybS0+Zm9ybV9lbGVtZW50X3NwYWNpbmdbJ3NlbGVjdCddWydvdXRlciddWyd2J10gKiAyKSArICgkdGhpcy0+bXBkZi0+bXBkZmZvcm0tPmZvcm1fZWxlbWVudF9zcGFjaW5nWydzZWxlY3QnXVsnaW5uZXInXVsndiddICogMik7CgkJCSRlID0gIlx4YmJceGE0XHhhY3R5cGU9c2VsZWN0LG9iamF0dHI9IiAuIHNlcmlhbGl6ZSgkb2JqYXR0cikgLiAiXHhiYlx4YTRceGFjIjsKCgkJCS8vIENsZWFyIHByb3BlcnRpZXMgLSB0aWR5IHVwCgkJCSRwcm9wZXJ0aWVzID0gYXJyYXkoKTsKCgkJCS8vIE91dHB1dCBpdCB0byBidWZmZXJzCgkJCWlmICgkdGhpcy0+bXBkZi0+dGFibGVMZXZlbCkgeyAvLyAqVEFCTEVTKgoJCQkJJHRoaXMtPm1wZGYtPl9zYXZlQ2VsbFRleHRCdWZmZXIoJGUsICR0aGlzLT5tcGRmLT5IUkVGKTsKCQkJCSR0aGlzLT5tcGRmLT5jZWxsWyR0aGlzLT5tcGRmLT5yb3ddWyR0aGlzLT5tcGRmLT5jb2xdWydzJ10gKz0gJG9iamF0dHJbJ3dpZHRoJ107IC8vICpUQUJMRVMqCgkJCX0gLy8gKlRBQkxFUyoKCQkJZWxzZSB7IC8vICpUQUJMRVMqCgkJCQkkdGhpcy0+bXBkZi0+X3NhdmVUZXh0QnVmZmVyKCRlLCAkdGhpcy0+bXBkZi0+SFJFRik7CgkJCX0gLy8gKlRBQkxFUyoKCgkJCSR0aGlzLT5tcGRmLT5zZWxlY3RvcHRpb24gPSBhcnJheSgpOwoJCQkkdGhpcy0+bXBkZi0+c3BlY2lhbGNvbnRlbnQgPSAnJzsKCgkJCWlmICgkdGhpcy0+bXBkZi0+SW5saW5lUHJvcGVydGllc1skdGFnXSkgewoJCQkJJHRoaXMtPm1wZGYtPnJlc3RvcmVJbmxpbmVQcm9wZXJ0aWVzKCR0aGlzLT5tcGRmLT5JbmxpbmVQcm9wZXJ0aWVzWyR0YWddKTsKCQkJfQoJCQl1bnNldCgkdGhpcy0+bXBkZi0+SW5saW5lUHJvcGVydGllc1skdGFnXSk7CgkJfQoJCS8qIC0tIEVORCBGT1JNUyAtLSAqLwoKCgkJLy8gKioqKioqKioqKiogQkxPQ0tTICoqKioqKioqKioqKioqKioqKioqCgkJLy8gbVBERiA2ICBMaXN0cwoJCWlmICgkdGFnID09ICdQJyB8fCAkdGFnID09ICdESVYnIHx8ICR0YWcgPT0gJ0gxJyB8fCAkdGFnID09ICdIMicgfHwgJHRhZyA9PSAnSDMnIHx8ICR0YWcgPT0gJ0g0JyB8fCAkdGFnID09ICdINScgfHwgJHRhZyA9PSAnSDYnIHx8ICR0YWcgPT0gJ1BSRScgfHwgJHRhZyA9PSAnRk9STScgfHwgJHRhZyA9PSAnQUREUkVTUycgfHwgJHRhZyA9PSAnQkxPQ0tRVU9URScgfHwgJHRhZyA9PSAnQ0VOVEVSJyB8fCAkdGFnID09ICdEVCcgfHwgJHRhZyA9PSAnREQnIHx8ICR0YWcgPT0gJ0RMJyB8fCAkdGFnID09ICdDQVBUSU9OJyB8fCAkdGFnID09ICdGSUVMRFNFVCcgfHwgJHRhZyA9PSAnVUwnIHx8ICR0YWcgPT0gJ09MJyB8fCAkdGFnID09ICdMSScgfHwgJHRhZyA9PSAnQVJUSUNMRScgfHwgJHRhZyA9PSAnQVNJREUnIHx8ICR0YWcgPT0gJ0ZJR1VSRScgfHwgJHRhZyA9PSAnRklHQ0FQVElPTicgfHwgJHRhZyA9PSAnRk9PVEVSJyB8fCAkdGFnID09ICdIRUFERVInIHx8ICR0YWcgPT0gJ0hHUk9VUCcgfHwgJHRhZyA9PSAnTUFJTicgfHwgJHRhZyA9PSAnTkFWJyB8fCAkdGFnID09ICdTRUNUSU9OJyB8fCAkdGFnID09ICdERVRBSUxTJyB8fCAkdGFnID09ICdTVU1NQVJZJwoJCSkgewoKCQkJLy8gbVBERiA2IGJpZGkKCQkJLy8gQmxvY2sKCQkJLy8gSWYgdW5pY29kZS1iaWRpIHNldCwgYW55IGVtYmVkZGluZyBsZXZlbHMsIGlzb2xhdGVzLCBvciBvdmVycmlkZXMgc3RhcnRlZCBieSB0aGlzIGJveCBhcmUgY2xvc2VkCgkJCWlmIChpc3NldCgkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWydiaWRpY29kZSddKSkgewoJCQkJJGJsb2NrcG9zdCA9ICR0aGlzLT5tcGRmLT5fc2V0QmlkaUNvZGVzKCdlbmQnLCAkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWydiaWRpY29kZSddKTsKCQkJCWlmICgkYmxvY2twb3N0KSB7CgkJCQkJJHRoaXMtPm1wZGYtPk9UTGRhdGEgPSBhcnJheSgpOwoJCQkJCWlmICgkdGhpcy0+bXBkZi0+dGFibGVMZXZlbCkgewoJCQkJCQkkdGhpcy0+bXBkZi0+X3NhdmVDZWxsVGV4dEJ1ZmZlcigkYmxvY2twb3N0KTsKCQkJCQl9IGVsc2UgewoJCQkJCQkkdGhpcy0+bXBkZi0+X3NhdmVUZXh0QnVmZmVyKCRibG9ja3Bvc3QpOwoJCQkJCX0KCQkJCX0KCQkJfQoKCQkJJHRoaXMtPm1wZGYtPmlnbm9yZWZvbGxvd2luZ3NwYWNlcyA9IHRydWU7IC8vRWxpbWluYXRlIGV4Y2VlZGluZyBsZWZ0LXNpZGUgc3BhY2VzCgkJCSR0aGlzLT5tcGRmLT5ibG9ja2p1c3RmaW5pc2hlZCA9IHRydWU7CgoJCQkkdGhpcy0+bXBkZi0+bGFzdGJsb2NrYm90dG9tbWFyZ2luID0gJHRoaXMtPm1wZGYtPmJsa1skdGhpcy0+bXBkZi0+YmxrbHZsXVsnbWFyZ2luX2JvdHRvbSddOwoJCQkvLyBtUERGIDYgIExpc3RzCgkJCWlmICgkdGFnID09ICdVTCcgfHwgJHRhZyA9PSAnT0wnKSB7CgkJCQlpZiAoJHRoaXMtPm1wZGYtPmxpc3RsdmwgPiAwICYmICR0aGlzLT5tcGRmLT50YWJsZUxldmVsKSB7CgkJCQkJaWYgKGlzc2V0KCR0aGlzLT5tcGRmLT5saXN0dHlwZVskdGhpcy0+bXBkZi0+bGlzdGx2bF0pKQoJCQkJCQl1bnNldCgkdGhpcy0+bXBkZi0+bGlzdHR5cGVbJHRoaXMtPm1wZGYtPmxpc3RsdmxdKTsKCQkJCX0KCQkJCSR0aGlzLT5tcGRmLT5saXN0bHZsLS07CgkJCQkkdGhpcy0+bXBkZi0+bGlzdGl0ZW0gPSBhcnJheSgpOwoJCQl9CgkJCWlmICgkdGFnID09ICdMSScpIHsKCQkJCSR0aGlzLT5tcGRmLT5saXN0aXRlbSA9IGFycmF5KCk7CgkJCX0KCgkJCWlmIChwcmVnX21hdGNoKCcvXkhcZC8nLCAkdGFnKSAmJiAhJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWwgJiYgISR0aGlzLT5tcGRmLT53cml0aW5nVG9DKSB7CgkJCQlpZiAoaXNzZXQoJHRoaXMtPm1wZGYtPmgydG9jWyR0YWddKSB8fCBpc3NldCgkdGhpcy0+bXBkZi0+aDJib29rbWFya3NbJHRhZ10pKSB7CgkJCQkJJGNvbnRlbnQgPSAnJzsKCQkJCQlpZiAoY291bnQoJHRoaXMtPm1wZGYtPnRleHRidWZmZXIpID09IDEpIHsKCQkJCQkJJGNvbnRlbnQgPSAkdGhpcy0+bXBkZi0+dGV4dGJ1ZmZlclswXVswXTsKCQkJCQl9IGVsc2UgewoJCQkJCQlmb3IgKCRpID0gMDsgJGkgPCBjb3VudCgkdGhpcy0+bXBkZi0+dGV4dGJ1ZmZlcik7ICRpKyspIHsKCQkJCQkJCWlmIChzdWJzdHIoJHRoaXMtPm1wZGYtPnRleHRidWZmZXJbJGldWzBdLCAwLCAzKSAhPSAiXHhiYlx4YTRceGFjIikgeyAvL2lubGluZSBvYmplY3QKCQkJCQkJCQkkY29udGVudCAuPSAkdGhpcy0+bXBkZi0+dGV4dGJ1ZmZlclskaV1bMF07CgkJCQkJCQl9CgkJCQkJCX0KCQkJCQl9CgkJCQkJLyogLS0gVE9DIC0tICovCgkJCQkJaWYgKGlzc2V0KCR0aGlzLT5tcGRmLT5oMnRvY1skdGFnXSkpIHsKCQkJCQkJJG9iamF0dHIgPSBhcnJheSgpOwoJCQkJCQkkb2JqYXR0clsndHlwZSddID0gJ3RvYyc7CgkJCQkJCSRvYmphdHRyWyd0b2NsZXZlbCddID0gJHRoaXMtPm1wZGYtPmgydG9jWyR0YWddOwoJCQkJCQkkb2JqYXR0clsnQ09OVEVOVCddID0gaHRtbHNwZWNpYWxjaGFycygkY29udGVudCk7CgkJCQkJCSRlID0gIlx4YmJceGE0XHhhY3R5cGU9dG9jLG9iamF0dHI9IiAuIHNlcmlhbGl6ZSgkb2JqYXR0cikgLiAiXHhiYlx4YTRceGFjIjsKCQkJCQkJYXJyYXlfdW5zaGlmdCgkdGhpcy0+bXBkZi0+dGV4dGJ1ZmZlciwgYXJyYXkoJGUpKTsKCQkJCQl9CgkJCQkJLyogLS0gRU5EIFRPQyAtLSAqLwoJCQkJCS8qIC0tIEJPT0tNQVJLUyAtLSAqLwoJCQkJCWlmIChpc3NldCgkdGhpcy0+bXBkZi0+aDJib29rbWFya3NbJHRhZ10pKSB7CgkJCQkJCSRvYmphdHRyID0gYXJyYXkoKTsKCQkJCQkJJG9iamF0dHJbJ3R5cGUnXSA9ICdib29rbWFyayc7CgkJCQkJCSRvYmphdHRyWydia2xldmVsJ10gPSAkdGhpcy0+bXBkZi0+aDJib29rbWFya3NbJHRhZ107CgkJCQkJCSRvYmphdHRyWydDT05URU5UJ10gPSAkY29udGVudDsKCQkJCQkJJGUgPSAiXHhiYlx4YTRceGFjdHlwZT10b2Msb2JqYXR0cj0iIC4gc2VyaWFsaXplKCRvYmphdHRyKSAuICJceGJiXHhhNFx4YWMiOwoJCQkJCQlhcnJheV91bnNoaWZ0KCR0aGlzLT5tcGRmLT50ZXh0YnVmZmVyLCBhcnJheSgkZSkpOwoJCQkJCX0KCQkJCQkvKiAtLSBFTkQgQk9PS01BUktTIC0tICovCgkJCQl9CgkJCX0KCgkJCS8qIC0tIFRBQkxFUyAtLSAqLwoJCQlpZiAoJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWwpIHsKCQkJCWlmICgkdGhpcy0+bXBkZi0+bGluZWJyZWFranVzdGZpbmlzaGVkKSB7CgkJCQkJJHRoaXMtPm1wZGYtPmJsb2NranVzdGZpbmlzaGVkID0gZmFsc2U7CgkJCQl9CgkJCQlpZiAoaXNzZXQoJHRoaXMtPm1wZGYtPklubGluZVByb3BlcnRpZXNbJ0JMT0NLSU5UQUJMRSddKSkgewoJCQkJCWlmICgkdGhpcy0+bXBkZi0+SW5saW5lUHJvcGVydGllc1snQkxPQ0tJTlRBQkxFJ10pIHsKCQkJCQkJJHRoaXMtPm1wZGYtPnJlc3RvcmVJbmxpbmVQcm9wZXJ0aWVzKCR0aGlzLT5tcGRmLT5JbmxpbmVQcm9wZXJ0aWVzWydCTE9DS0lOVEFCTEUnXSk7CgkJCQkJfQoJCQkJCXVuc2V0KCR0aGlzLT5tcGRmLT5JbmxpbmVQcm9wZXJ0aWVzWydCTE9DS0lOVEFCTEUnXSk7CgkJCQl9CgkJCQlpZiAoJHRhZyA9PSAnUFJFJykgewoJCQkJCSR0aGlzLT5tcGRmLT5pc3ByZSA9IGZhbHNlOwoJCQkJfQoJCQkJcmV0dXJuOwoJCQl9CgkJCS8qIC0tIEVORCBUQUJMRVMgLS0gKi8KCQkJJHRoaXMtPm1wZGYtPmxhc3RvcHRpb25hbHRhZyA9ICcnOwoJCQkkdGhpcy0+bXBkZi0+ZGl2YmVnaW4gPSBmYWxzZTsKCgkJCSR0aGlzLT5tcGRmLT5saW5lYnJlYWtqdXN0ZmluaXNoZWQgPSBmYWxzZTsKCgkJCSR0aGlzLT5tcGRmLT54ID0gJHRoaXMtPm1wZGYtPmxNYXJnaW4gKyAkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWydvdXRlcl9sZWZ0X21hcmdpbiddOwoKCQkJLyogLS0gQ1NTLUZMT0FUIC0tICovCgkJCS8vIElmIGZsb2F0IGNvbnRhaW5lZCBpbiBhIGZsb2F0LCBuZWVkIHRvIGV4dGVuZCBib3R0b20gdG8gYWxsb3cgZm9yIGl0CgkJCSRjdXJycG9zID0gJHRoaXMtPm1wZGYtPnBhZ2UgKiAxMDAwICsgJHRoaXMtPm1wZGYtPnk7CgkJCWlmIChpc3NldCgkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWydmbG9hdF9lbmRwb3MnXSkgJiYgJHRoaXMtPm1wZGYtPmJsa1skdGhpcy0+bXBkZi0+YmxrbHZsXVsnZmxvYXRfZW5kcG9zJ10gPiAkY3VycnBvcykgewoJCQkJJG9sZF9wYWdlID0gJHRoaXMtPm1wZGYtPnBhZ2U7CgkJCQkkbmV3X3BhZ2UgPSBpbnR2YWwoJHRoaXMtPm1wZGYtPmJsa1skdGhpcy0+bXBkZi0+YmxrbHZsXVsnZmxvYXRfZW5kcG9zJ10gLyAxMDAwKTsKCQkJCWlmICgkb2xkX3BhZ2UgIT0gJG5ld19wYWdlKSB7CgkJCQkJJHMgPSAkdGhpcy0+bXBkZi0+UHJpbnRQYWdlQmFja2dyb3VuZHMoKTsKCQkJCQkvLyBXcml0ZXMgYWZ0ZXIgdGhlIG1hcmtlciBzbyBub3Qgb3ZlcndyaXR0ZW4gbGF0ZXIgYnkgcGFnZSBiYWNrZ3JvdW5kIGV0Yy4KCQkJCQkkdGhpcy0+bXBkZi0+cGFnZXNbJHRoaXMtPm1wZGYtPnBhZ2VdID0gcHJlZ19yZXBsYWNlKCcvKF9fX0JBQ0tHUk9VTkRfX19QQVRURVJOUycgLiAkdGhpcy0+bXBkZi0+dW5pcXN0ciAuICcpLycsICdcXDEnIC4gIlxuIiAuICRzIC4gIlxuIiwgJHRoaXMtPm1wZGYtPnBhZ2VzWyR0aGlzLT5tcGRmLT5wYWdlXSk7CgkJCQkJJHRoaXMtPm1wZGYtPnBhZ2VCYWNrZ3JvdW5kcyA9IGFycmF5KCk7CgkJCQkJJHRoaXMtPm1wZGYtPnBhZ2UgPSAkbmV3X3BhZ2U7CgkJCQkJJHRoaXMtPm1wZGYtPlJlc2V0TWFyZ2lucygpOwoJCQkJCSR0aGlzLT5tcGRmLT5SZXNldCgpOwoJCQkJCSR0aGlzLT5tcGRmLT5wYWdlb3V0cHV0WyR0aGlzLT5tcGRmLT5wYWdlXSA9IGFycmF5KCk7CgkJCQl9CgkJCQkkdGhpcy0+bXBkZi0+eSA9ICgoJHRoaXMtPm1wZGYtPmJsa1skdGhpcy0+bXBkZi0+YmxrbHZsXVsnZmxvYXRfZW5kcG9zJ10gKiAxMDAwKSAlIDEwMDAwMDApIC8gMTAwMDsgLy8gbW9kIGNoYW5nZXMgb3BlcmFuZHMgdG8gaW50ZWdlcnMgYmVmb3JlIHByb2Nlc3NpbmcKCQkJfQoJCQkvKiAtLSBFTkQgQ1NTLUZMT0FUIC0tICovCgoKCQkJLy9QcmludCBjb250ZW50CgkJCWlmICgkdGhpcy0+bXBkZi0+bGFzdGJsb2NrbGV2ZWxjaGFuZ2UgPT0gMSkgewoJCQkJJGJsb2Nrc3RhdGUgPSAzOwoJCQl9IC8vIFRvcCAmIGJvdHRvbSBtYXJnaW5zL3BhZGRpbmcKCQkJZWxzZSBpZiAoJHRoaXMtPm1wZGYtPmxhc3RibG9ja2xldmVsY2hhbmdlID09IC0xKSB7CgkJCQkkYmxvY2tzdGF0ZSA9IDI7CgkJCX0gLy8gQm90dG9tIG1hcmdpbnMvcGFkZGluZyBvbmx5CgkJCWVsc2UgewoJCQkJJGJsb2Nrc3RhdGUgPSAwOwoJCQl9CgkJCS8vIGNhbGxlZCBmcm9tIGFmdGVyIGUuZy4gPC90YWJsZT4gPC9kaXY+IDwvZGl2PiAuLi4gICAgT3V0cHV0cyBibG9jayBtYXJnaW4vYm9yZGVyIGFuZCBwYWRkaW5nCgkJCWlmIChjb3VudCgkdGhpcy0+bXBkZi0+dGV4dGJ1ZmZlcikgJiYgJHRoaXMtPm1wZGYtPnRleHRidWZmZXJbY291bnQoJHRoaXMtPm1wZGYtPnRleHRidWZmZXIpIC0gMV0pIHsKCQkJCWlmIChzdWJzdHIoJHRoaXMtPm1wZGYtPnRleHRidWZmZXJbY291bnQoJHRoaXMtPm1wZGYtPnRleHRidWZmZXIpIC0gMV1bMF0sIDAsIDMpICE9ICJceGJiXHhhNFx4YWMiKSB7IC8vIG5vdCBzcGVjaWFsIGNvbnRlbnQKCQkJCQkvLyBSaWdodCB0cmltIGxhc3QgY29udGVudCBhbmQgYWRqdXN0IE9UTGRhdGEKCQkJCQlpZiAocHJlZ19tYXRjaCgnL1sgXSskLycsICR0aGlzLT5tcGRmLT50ZXh0YnVmZmVyW2NvdW50KCR0aGlzLT5tcGRmLT50ZXh0YnVmZmVyKSAtIDFdWzBdLCAkbSkpIHsKCQkJCQkJJHN0cmlwID0gc3RybGVuKCRtWzBdKTsKCQkJCQkJJHRoaXMtPm1wZGYtPnRleHRidWZmZXJbY291bnQoJHRoaXMtPm1wZGYtPnRleHRidWZmZXIpIC0gMV1bMF0gPSBzdWJzdHIoJHRoaXMtPm1wZGYtPnRleHRidWZmZXJbY291bnQoJHRoaXMtPm1wZGYtPnRleHRidWZmZXIpIC0gMV1bMF0sIDAsIChzdHJsZW4oJHRoaXMtPm1wZGYtPnRleHRidWZmZXJbY291bnQoJHRoaXMtPm1wZGYtPnRleHRidWZmZXIpIC0gMV1bMF0pIC0gJHN0cmlwKSk7CgkJCQkJCS8qIC0tIE9UTCAtLSAqLwoJCQkJCQlpZiAoaXNzZXQoJHRoaXMtPm1wZGYtPkN1cnJlbnRGb250Wyd1c2VPVEwnXSkgJiYgJHRoaXMtPm1wZGYtPkN1cnJlbnRGb250Wyd1c2VPVEwnXSkgewoJCQkJCQkJJHRoaXMtPm1wZGYtPm90bC0+dHJpbU9UTGRhdGEoJHRoaXMtPm1wZGYtPnRleHRidWZmZXJbY291bnQoJHRoaXMtPm1wZGYtPnRleHRidWZmZXIpIC0gMV1bMThdLCBmYWxzZSwgdHJ1ZSk7IC8vIG1QREYgNiAgWlpaOTlLCgkJCQkJCX0KCQkJCQkJLyogLS0gRU5EIE9UTCAtLSAqLwoJCQkJCX0KCQkJCX0KCQkJfQoKCQkJaWYgKGNvdW50KCR0aGlzLT5tcGRmLT50ZXh0YnVmZmVyKSA9PSAwICYmICR0aGlzLT5tcGRmLT5sYXN0YmxvY2tsZXZlbGNoYW5nZSAhPSAwKSB7CgkJCQkvLyR0aGlzLT5tcGRmLT5uZXdGbG93aW5nQmxvY2soICR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ3dpZHRoJ10sJHRoaXMtPm1wZGYtPmxpbmVoZWlnaHQsJycsZmFsc2UsMix0cnVlLCAoaXNzZXQoJHRoaXMtPm1wZGYtPmJsa1skdGhpcy0+bXBkZi0+YmxrbHZsXVsnZGlyZWN0aW9uJ10pID8gJHRoaXMtPm1wZGYtPmJsa1skdGhpcy0+bXBkZi0+YmxrbHZsXVsnZGlyZWN0aW9uJ10gOiAnbHRyJykpOwoJCQkJJHRoaXMtPm1wZGYtPm5ld0Zsb3dpbmdCbG9jaygkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWyd3aWR0aCddLCAkdGhpcy0+bXBkZi0+bGluZWhlaWdodCwgJycsIGZhbHNlLCAkYmxvY2tzdGF0ZSwgdHJ1ZSwgKGlzc2V0KCR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ2RpcmVjdGlvbiddKSA/ICR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ2RpcmVjdGlvbiddIDogJ2x0cicpKTsKCQkJCSR0aGlzLT5tcGRmLT5maW5pc2hGbG93aW5nQmxvY2sodHJ1ZSk7IC8vIHRydWUgPSBFTkQgb2YgZmxvd2luZyBibG9jawoJCQkJJHRoaXMtPm1wZGYtPlBhaW50RGl2QkIoJycsICRibG9ja3N0YXRlKTsKCQkJfSBlbHNlIHsKCQkJCSR0aGlzLT5tcGRmLT5wcmludGJ1ZmZlcigkdGhpcy0+bXBkZi0+dGV4dGJ1ZmZlciwgJGJsb2Nrc3RhdGUpOwoJCQl9CgoKCQkJJHRoaXMtPm1wZGYtPnRleHRidWZmZXIgPSBhcnJheSgpOwoKCQkJaWYgKCR0aGlzLT5tcGRmLT5rd3QpIHsKCQkJCSR0aGlzLT5tcGRmLT5rd3RfaGVpZ2h0ID0gJHRoaXMtPm1wZGYtPnkgLSAkdGhpcy0+bXBkZi0+a3d0X3kwOwoJCQl9CgoJCQkvKiAtLSBDU1MtSU1BR0UtRkxPQVQgLS0gKi8KCQkJJHRoaXMtPm1wZGYtPnByaW50ZmxvYXRidWZmZXIoKTsKCQkJLyogLS0gRU5EIENTUy1JTUFHRS1GTE9BVCAtLSAqLwoKCQkJaWYgKCR0YWcgPT0gJ1BSRScpIHsKCQkJCSR0aGlzLT5tcGRmLT5pc3ByZSA9IGZhbHNlOwoJCQl9CgoJCQkvKiAtLSBDU1MtRkxPQVQgLS0gKi8KCQkJaWYgKCR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ2Zsb2F0J10gPT0gJ1InKSB7CgkJCQkvLyBJZiB3aWR0aCBub3Qgc2V0LCBoZXJlIHdvdWxkIG5lZWQgdG8gYWRqdXN0IGFuZCBvdXRwdXQgYnVmZmVyCgkJCQkkcyA9ICR0aGlzLT5tcGRmLT5QcmludFBhZ2VCYWNrZ3JvdW5kcygpOwoJCQkJLy8gV3JpdGVzIGFmdGVyIHRoZSBtYXJrZXIgc28gbm90IG92ZXJ3cml0dGVuIGxhdGVyIGJ5IHBhZ2UgYmFja2dyb3VuZCBldGMuCgkJCQkkdGhpcy0+bXBkZi0+cGFnZXNbJHRoaXMtPm1wZGYtPnBhZ2VdID0gcHJlZ19yZXBsYWNlKCcvKF9fX0JBQ0tHUk9VTkRfX19QQVRURVJOUycgLiAkdGhpcy0+bXBkZi0+dW5pcXN0ciAuICcpLycsICdcXDEnIC4gIlxuIiAuICRzIC4gIlxuIiwgJHRoaXMtPm1wZGYtPnBhZ2VzWyR0aGlzLT5tcGRmLT5wYWdlXSk7CgkJCQkkdGhpcy0+bXBkZi0+cGFnZUJhY2tncm91bmRzID0gYXJyYXkoKTsKCQkJCSR0aGlzLT5tcGRmLT5SZXNldCgpOwoJCQkJJHRoaXMtPm1wZGYtPnBhZ2VvdXRwdXRbJHRoaXMtPm1wZGYtPnBhZ2VdID0gYXJyYXkoKTsKCgkJCQlmb3IgKCRpID0gKCR0aGlzLT5tcGRmLT5ibGtsdmwgLSAxKTsgJGkgPj0gMDsgJGktLSkgewoJCQkJCWlmIChpc3NldCgkdGhpcy0+bXBkZi0+YmxrWyRpXVsnZmxvYXRfZW5kcG9zJ10pKSB7CgkJCQkJCSR0aGlzLT5tcGRmLT5ibGtbJGldWydmbG9hdF9lbmRwb3MnXSA9IG1heCgkdGhpcy0+bXBkZi0+YmxrWyRpXVsnZmxvYXRfZW5kcG9zJ10sICgkdGhpcy0+bXBkZi0+cGFnZSAqIDEwMDAgKyAkdGhpcy0+bXBkZi0+eSkpOwoJCQkJCX0gZWxzZSB7CgkJCQkJCSR0aGlzLT5tcGRmLT5ibGtbJGldWydmbG9hdF9lbmRwb3MnXSA9ICR0aGlzLT5tcGRmLT5wYWdlICogMTAwMCArICR0aGlzLT5tcGRmLT55OwoJCQkJCX0KCQkJCX0KCgkJCQkkdGhpcy0+bXBkZi0+ZmxvYXREaXZzW10gPSBhcnJheSgKCQkJCQknc2lkZScgPT4gJ1InLAoJCQkJCSdzdGFydHBhZ2UnID0+ICR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ3N0YXJ0cGFnZSddLAoJCQkJCSd5MCcgPT4gJHRoaXMtPm1wZGYtPmJsa1skdGhpcy0+bXBkZi0+YmxrbHZsXVsnZmxvYXRfc3RhcnRfeSddLAoJCQkJCSdzdGFydHBvcycgPT4gKCR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ3N0YXJ0cGFnZSddICogMTAwMCArICR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ2Zsb2F0X3N0YXJ0X3knXSksCgkJCQkJJ2VuZHBhZ2UnID0+ICR0aGlzLT5tcGRmLT5wYWdlLAoJCQkJCSd5MScgPT4gJHRoaXMtPm1wZGYtPnksCgkJCQkJJ2VuZHBvcycgPT4gKCR0aGlzLT5tcGRmLT5wYWdlICogMTAwMCArICR0aGlzLT5tcGRmLT55KSwKCQkJCQkndycgPT4gJHRoaXMtPm1wZGYtPmJsa1skdGhpcy0+bXBkZi0+YmxrbHZsXVsnZmxvYXRfd2lkdGgnXSwKCQkJCQknYmxrbHZsJyA9PiAkdGhpcy0+bXBkZi0+YmxrbHZsLAoJCQkJCSdibG9ja0NvbnRleHQnID0+ICR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bCAtIDFdWydibG9ja0NvbnRleHQnXQoJCQkJKTsKCgkJCQkkdGhpcy0+bXBkZi0+eSA9ICR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ2Zsb2F0X3N0YXJ0X3knXTsKCQkJCSR0aGlzLT5tcGRmLT5wYWdlID0gJHRoaXMtPm1wZGYtPmJsa1skdGhpcy0+bXBkZi0+YmxrbHZsXVsnc3RhcnRwYWdlJ107CgkJCQkkdGhpcy0+bXBkZi0+UmVzZXRNYXJnaW5zKCk7CgkJCQkkdGhpcy0+bXBkZi0+cGFnZW91dHB1dFskdGhpcy0+bXBkZi0+cGFnZV0gPSBhcnJheSgpOwoJCQl9CgkJCWlmICgkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWydmbG9hdCddID09ICdMJykgewoJCQkJLy8gSWYgd2lkdGggbm90IHNldCwgaGVyZSB3b3VsZCBuZWVkIHRvIGFkanVzdCBhbmQgb3V0cHV0IGJ1ZmZlcgoJCQkJJHMgPSAkdGhpcy0+bXBkZi0+UHJpbnRQYWdlQmFja2dyb3VuZHMoKTsKCQkJCS8vIFdyaXRlcyBhZnRlciB0aGUgbWFya2VyIHNvIG5vdCBvdmVyd3JpdHRlbiBsYXRlciBieSBwYWdlIGJhY2tncm91bmQgZXRjLgoJCQkJJHRoaXMtPm1wZGYtPnBhZ2VzWyR0aGlzLT5tcGRmLT5wYWdlXSA9IHByZWdfcmVwbGFjZSgnLyhfX19CQUNLR1JPVU5EX19fUEFUVEVSTlMnIC4gJHRoaXMtPm1wZGYtPnVuaXFzdHIgLiAnKS8nLCAnXFwxJyAuICJcbiIgLiAkcyAuICJcbiIsICR0aGlzLT5tcGRmLT5wYWdlc1skdGhpcy0+bXBkZi0+cGFnZV0pOwoJCQkJJHRoaXMtPm1wZGYtPnBhZ2VCYWNrZ3JvdW5kcyA9IGFycmF5KCk7CgkJCQkkdGhpcy0+bXBkZi0+UmVzZXQoKTsKCQkJCSR0aGlzLT5tcGRmLT5wYWdlb3V0cHV0WyR0aGlzLT5tcGRmLT5wYWdlXSA9IGFycmF5KCk7CgoJCQkJZm9yICgkaSA9ICgkdGhpcy0+bXBkZi0+YmxrbHZsIC0gMSk7ICRpID49IDA7ICRpLS0pIHsKCQkJCQlpZiAoaXNzZXQoJHRoaXMtPm1wZGYtPmJsa1skaV1bJ2Zsb2F0X2VuZHBvcyddKSkgewoJCQkJCQkkdGhpcy0+bXBkZi0+YmxrWyRpXVsnZmxvYXRfZW5kcG9zJ10gPSBtYXgoJHRoaXMtPm1wZGYtPmJsa1skaV1bJ2Zsb2F0X2VuZHBvcyddLCAoJHRoaXMtPm1wZGYtPnBhZ2UgKiAxMDAwICsgJHRoaXMtPm1wZGYtPnkpKTsKCQkJCQl9IGVsc2UgewoJCQkJCQkkdGhpcy0+bXBkZi0+YmxrWyRpXVsnZmxvYXRfZW5kcG9zJ10gPSAkdGhpcy0+bXBkZi0+cGFnZSAqIDEwMDAgKyAkdGhpcy0+bXBkZi0+eTsKCQkJCQl9CgkJCQl9CgoJCQkJJHRoaXMtPm1wZGYtPmZsb2F0RGl2c1tdID0gYXJyYXkoCgkJCQkJJ3NpZGUnID0+ICdMJywKCQkJCQknc3RhcnRwYWdlJyA9PiAkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWydzdGFydHBhZ2UnXSwKCQkJCQkneTAnID0+ICR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ2Zsb2F0X3N0YXJ0X3knXSwKCQkJCQknc3RhcnRwb3MnID0+ICgkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWydzdGFydHBhZ2UnXSAqIDEwMDAgKyAkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWydmbG9hdF9zdGFydF95J10pLAoJCQkJCSdlbmRwYWdlJyA9PiAkdGhpcy0+bXBkZi0+cGFnZSwKCQkJCQkneTEnID0+ICR0aGlzLT5tcGRmLT55LAoJCQkJCSdlbmRwb3MnID0+ICgkdGhpcy0+bXBkZi0+cGFnZSAqIDEwMDAgKyAkdGhpcy0+bXBkZi0+eSksCgkJCQkJJ3cnID0+ICR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ2Zsb2F0X3dpZHRoJ10sCgkJCQkJJ2Jsa2x2bCcgPT4gJHRoaXMtPm1wZGYtPmJsa2x2bCwKCQkJCQknYmxvY2tDb250ZXh0JyA9PiAkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmwgLSAxXVsnYmxvY2tDb250ZXh0J10KCQkJCSk7CgoJCQkJJHRoaXMtPm1wZGYtPnkgPSAkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWydmbG9hdF9zdGFydF95J107CgkJCQkkdGhpcy0+bXBkZi0+cGFnZSA9ICR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ3N0YXJ0cGFnZSddOwoJCQkJJHRoaXMtPm1wZGYtPlJlc2V0TWFyZ2lucygpOwoJCQkJJHRoaXMtPm1wZGYtPnBhZ2VvdXRwdXRbJHRoaXMtPm1wZGYtPnBhZ2VdID0gYXJyYXkoKTsKCQkJfQoJCQkvKiAtLSBFTkQgQ1NTLUZMT0FUIC0tICovCgoJCQlpZiAoaXNzZXQoJHRoaXMtPm1wZGYtPmJsa1skdGhpcy0+bXBkZi0+YmxrbHZsXVsndmlzaWJpbGl0eSddKSAmJiAkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWyd2aXNpYmlsaXR5J10gIT0gJ3Zpc2libGUnKSB7CgkJCQkkdGhpcy0+bXBkZi0+U2V0VmlzaWJpbGl0eSgndmlzaWJsZScpOwoJCQl9CgoJCQlpZiAoaXNzZXQoJHRoaXMtPm1wZGYtPmJsa1skdGhpcy0+bXBkZi0+YmxrbHZsXVsncGFnZV9icmVha19hZnRlciddKSkgewoJCQkJJHBhZ2VfYnJlYWtfYWZ0ZXIgPSAkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWydwYWdlX2JyZWFrX2FmdGVyJ107CgkJCX0gZWxzZSB7CgkJCQkkcGFnZV9icmVha19hZnRlciA9ICcnOwoJCQl9CgoJCQkvL1Jlc2V0IHZhbHVlcwoJCQkkdGhpcy0+bXBkZi0+UmVzZXQoKTsKCgkJCWlmIChpc3NldCgkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWyd6LWluZGV4J10pICYmICR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ3otaW5kZXgnXSA+IDApIHsKCQkJCSR0aGlzLT5tcGRmLT5FbmRMYXllcigpOwoJCQl9CgoJCQkvLyBtUERGIDYgcGFnZS1icmVhay1pbnNpZGU6YXZvaWQKCQkJaWYgKCR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ2tlZXBfYmxvY2tfdG9nZXRoZXInXSkgewoJCQkJJG1vdmVwYWdlID0gZmFsc2U7CgkJCQkvLyBJZiBwYWdlLWJyZWFrLWluc2lkZTphdm9pZCBzZWN0aW9uIGhhcyBicm9rZW4gdG8gbmV3IHBhZ2UgYnV0IGZpdHMgb24gb25lIHNpZGUgLSB0aGVuIG1vdmU6CgkJCQlpZiAoKCR0aGlzLT5tcGRmLT5wYWdlIC0gJHRoaXMtPm1wZGYtPmt0X3AwMCkgPT0gMSAmJiAkdGhpcy0+bXBkZi0+eSA8ICR0aGlzLT5tcGRmLT5rdF95MDApIHsKCQkJCQkkbW92ZXBhZ2UgPSB0cnVlOwoJCQkJfQoJCQkJaWYgKCgkdGhpcy0+bXBkZi0+cGFnZSAtICR0aGlzLT5tcGRmLT5rdF9wMDApID4gMCkgewoJCQkJCWZvciAoJGkgPSAkdGhpcy0+bXBkZi0+cGFnZTsgJGkgPiAkdGhpcy0+bXBkZi0+a3RfcDAwOyAkaS0tKSB7CgkJCQkJCXVuc2V0KCR0aGlzLT5tcGRmLT5wYWdlc1skaV0pOwoJCQkJCQlpZiAoaXNzZXQoJHRoaXMtPm1wZGYtPmJsa1skdGhpcy0+bXBkZi0+YmxrbHZsXVsnYmJfcGFpbnRlZCddWyRpXSkpIHsKCQkJCQkJCXVuc2V0KCR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ2JiX3BhaW50ZWQnXVskaV0pOwoJCQkJCQl9CgkJCQkJCWlmIChpc3NldCgkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWydtYXJnaW5Db3JyZWN0ZWQnXVskaV0pKSB7CgkJCQkJCQl1bnNldCgkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWydtYXJnaW5Db3JyZWN0ZWQnXVskaV0pOwoJCQkJCQl9CgkJCQkJCWlmIChpc3NldCgkdGhpcy0+bXBkZi0+cGFnZW91dHB1dFskaV0pKSB7CgkJCQkJCQl1bnNldCgkdGhpcy0+bXBkZi0+cGFnZW91dHB1dFskaV0pOwoJCQkJCQl9CgkJCQkJfQoJCQkJCSR0aGlzLT5tcGRmLT5wYWdlID0gJHRoaXMtPm1wZGYtPmt0X3AwMDsKCQkJCX0KCQkJCSR0aGlzLT5tcGRmLT5rZWVwX2Jsb2NrX3RvZ2V0aGVyID0gMDsKCQkJCSR0aGlzLT5tcGRmLT5wYWdlb3V0cHV0WyR0aGlzLT5tcGRmLT5wYWdlXSA9IGFycmF5KCk7CgoJCQkJJHRoaXMtPm1wZGYtPnkgPSAkdGhpcy0+bXBkZi0+a3RfeTAwOwoJCQkJJGlodG1sID0gJHRoaXMtPm1wZGYtPmJsa1skdGhpcy0+bXBkZi0+YmxrbHZsXVsnYXJyYXlfaSddIC0gMTsKCgkJCQkkYWh0bWxbJGlodG1sICsgMV0gLj0gJyBwYWdlYnJlYWthdm9pZGNoZWNrZWQ9InRydWUiOyc7IC8vIGF2b2lkIHJlLWl0ZXJhdGluZzsgcmVhZCBpbiBPcGVuVGFnKCkKCgkJCQl1bnNldCgkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdKTsKCQkJCSR0aGlzLT5tcGRmLT5ibGtsdmwtLTsKCgkJCQlmb3IgKCRibGtsdmwgPSAxOyAkYmxrbHZsIDw9ICR0aGlzLT5tcGRmLT5ibGtsdmw7ICRibGtsdmwrKykgewoJCQkJCSR0aGlzLT5tcGRmLT5ibGtbJGJsa2x2bF1bJ3kwJ10gPSAkdGhpcy0+bXBkZi0+YmxrWyRibGtsdmxdWydpbml0aWFsX3kwJ107CgkJCQkJJHRoaXMtPm1wZGYtPmJsa1skYmxrbHZsXVsneDAnXSA9ICR0aGlzLT5tcGRmLT5ibGtbJGJsa2x2bF1bJ2luaXRpYWxfeDAnXTsKCQkJCQkkdGhpcy0+bXBkZi0+YmxrWyRibGtsdmxdWydzdGFydHBhZ2UnXSA9ICR0aGlzLT5tcGRmLT5ibGtbJGJsa2x2bF1bJ2luaXRpYWxfc3RhcnRwYWdlJ107CgkJCQl9CgoJCQkJaWYgKGlzc2V0KCR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ3gwJ10pKSB7CgkJCQkJJHRoaXMtPm1wZGYtPnggPSAkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWyd4MCddOwoJCQkJfSBlbHNlIHsKCQkJCQkkdGhpcy0+bXBkZi0+eCA9ICR0aGlzLT5tcGRmLT5sTWFyZ2luOwoJCQkJfQoKCQkJCSR0aGlzLT5tcGRmLT5sYXN0YmxvY2tsZXZlbGNoYW5nZSA9IDA7CgkJCQkkdGhpcy0+bXBkZi0+UmVzZXRNYXJnaW5zKCk7CgkJCQlpZiAoJG1vdmVwYWdlKSB7CgkJCQkJJHRoaXMtPm1wZGYtPkFkZFBhZ2UoKTsKCQkJCX0KCQkJCXJldHVybjsKCQkJfQoKCQkJaWYgKCR0aGlzLT5tcGRmLT5ibGtsdmwgPiAwKSB7IC8vID09MCBTSE9VTEROJ1QgSEFQUEVOIC0gTk9UIFhIVE1MCgkJCQlpZiAoJHRoaXMtPm1wZGYtPmJsa1skdGhpcy0+bXBkZi0+YmxrbHZsXVsndGFnJ10gPT0gJHRhZykgewoJCQkJCXVuc2V0KCR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF0pOwoJCQkJCSR0aGlzLT5tcGRmLT5ibGtsdmwtLTsKCQkJCX0KCQkJCS8vZWxzZSB7IGVjaG8gJHRhZzsgZXhpdDsgfQkvLyBkZWJ1ZyAtIGZvcmNlcyBlcnJvciBpZiBpbmNvcnJlY3RseSBuZXN0ZWQgaHRtbCB0YWdzCgkJCX0KCgkJCSR0aGlzLT5tcGRmLT5sYXN0YmxvY2tsZXZlbGNoYW5nZSA9IC0xOwoJCQkvLyBSZXNldCBJbmxpbmUtdHlwZSBwcm9wZXJ0aWVzCgkJCWlmIChpc3NldCgkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWydJbmxpbmVQcm9wZXJ0aWVzJ10pKSB7CgkJCQkkdGhpcy0+bXBkZi0+cmVzdG9yZUlubGluZVByb3BlcnRpZXMoJHRoaXMtPm1wZGYtPmJsa1skdGhpcy0+bXBkZi0+YmxrbHZsXVsnSW5saW5lUHJvcGVydGllcyddKTsKCQkJfQoKCQkJJHRoaXMtPm1wZGYtPnggPSAkdGhpcy0+bXBkZi0+bE1hcmdpbiArICR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ291dGVyX2xlZnRfbWFyZ2luJ107CgoJCQlpZiAoISR0aGlzLT5tcGRmLT50YWJsZUxldmVsICYmICRwYWdlX2JyZWFrX2FmdGVyKSB7CgkJCQkkc2F2ZV9ibGtsdmwgPSAkdGhpcy0+bXBkZi0+YmxrbHZsOwoJCQkJJHNhdmVfYmxrID0gJHRoaXMtPm1wZGYtPmJsazsKCQkJCSRzYXZlX3NpbHAgPSAkdGhpcy0+bXBkZi0+c2F2ZUlubGluZVByb3BlcnRpZXMoKTsKCQkJCSRzYXZlX2lscCA9ICR0aGlzLT5tcGRmLT5JbmxpbmVQcm9wZXJ0aWVzOwoJCQkJJHNhdmVfYmZscCA9ICR0aGlzLT5tcGRmLT5JbmxpbmVCREY7CgkJCQkkc2F2ZV9iZmxwYyA9ICR0aGlzLT5tcGRmLT5JbmxpbmVCREZjdHI7IC8vIG1QREYgNgoJCQkJLy8gbVBERiA2IHBhZ2VicmVha3R5cGUKCQkJCSRzdGFydHBhZ2UgPSAkdGhpcy0+bXBkZi0+cGFnZTsKCQkJCSRwYWdlYnJlYWt0eXBlID0gJHRoaXMtPm1wZGYtPmRlZmF1bHRQYWdlYnJlYWtUeXBlOwoJCQkJaWYgKCR0aGlzLT5tcGRmLT5Db2xBY3RpdmUpIHsKCQkJCQkkcGFnZWJyZWFrdHlwZSA9ICdjbG9uZWFsbCc7CgkJCQl9CgoJCQkJLy8gbVBERiA2IHBhZ2VicmVha3R5cGUKCQkJCSR0aGlzLT5tcGRmLT5fcHJlRm9yY2VkUGFnZWJyZWFrKCRwYWdlYnJlYWt0eXBlKTsKCgkJCQlpZiAoJHBhZ2VfYnJlYWtfYWZ0ZXIgPT0gJ1JJR0hUJykgewoJCQkJCSR0aGlzLT5tcGRmLT5BZGRQYWdlKCR0aGlzLT5tcGRmLT5DdXJPcmllbnRhdGlvbiwgJ05FWFQtT0REJywgJycsICcnLCAnJywgJycsICcnLCAnJywgJycsICcnLCAnJywgJycsICcnLCAnJywgJycsIDAsIDAsIDAsIDApOwoJCQkJfSBlbHNlIGlmICgkcGFnZV9icmVha19hZnRlciA9PSAnTEVGVCcpIHsKCQkJCQkkdGhpcy0+bXBkZi0+QWRkUGFnZSgkdGhpcy0+bXBkZi0+Q3VyT3JpZW50YXRpb24sICdORVhULUVWRU4nLCAnJywgJycsICcnLCAnJywgJycsICcnLCAnJywgJycsICcnLCAnJywgJycsICcnLCAnJywgMCwgMCwgMCwgMCk7CgkJCQl9IGVsc2UgewoJCQkJCSR0aGlzLT5tcGRmLT5BZGRQYWdlKCR0aGlzLT5tcGRmLT5DdXJPcmllbnRhdGlvbiwgJycsICcnLCAnJywgJycsICcnLCAnJywgJycsICcnLCAnJywgJycsICcnLCAnJywgJycsICcnLCAwLCAwLCAwLCAwKTsKCQkJCX0KCgkJCQkvLyBtUERGIDYgcGFnZWJyZWFrdHlwZQoJCQkJJHRoaXMtPm1wZGYtPl9wb3N0Rm9yY2VkUGFnZWJyZWFrKCRwYWdlYnJlYWt0eXBlLCAkc3RhcnRwYWdlLCAkc2F2ZV9ibGssICRzYXZlX2Jsa2x2bCk7CgoJCQkJJHRoaXMtPm1wZGYtPklubGluZVByb3BlcnRpZXMgPSAkc2F2ZV9pbHA7CgkJCQkkdGhpcy0+bXBkZi0+SW5saW5lQkRGID0gJHNhdmVfYmZscDsKCQkJCSR0aGlzLT5tcGRmLT5JbmxpbmVCREZjdHIgPSAkc2F2ZV9iZmxwYzsgLy8gbVBERiA2CgkJCQkkdGhpcy0+bXBkZi0+cmVzdG9yZUlubGluZVByb3BlcnRpZXMoJHNhdmVfc2lscCk7CgkJCX0KCQkJLy8gbVBERiA2IGJpZGkKCQkJLy8gQmxvY2sKCQkJLy8gSWYgdW5pY29kZS1iaWRpIHNldCwgYW55IGVtYmVkZGluZyBsZXZlbHMsIGlzb2xhdGVzLCBvciBvdmVycmlkZXMgcmVvcGVuZWQgaW4gdGhlIGNvbnRpbnVpbmcgYmxvY2sKCQkJaWYgKGlzc2V0KCR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ2JpZGljb2RlJ10pKSB7CgkJCQkkYmxvY2twcmUgPSAkdGhpcy0+bXBkZi0+X3NldEJpZGlDb2Rlcygnc3RhcnQnLCAkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWydiaWRpY29kZSddKTsKCQkJCWlmICgkYmxvY2twcmUpIHsKCQkJCQkkdGhpcy0+bXBkZi0+T1RMZGF0YSA9IGFycmF5KCk7CgkJCQkJaWYgKCR0aGlzLT5tcGRmLT50YWJsZUxldmVsKSB7CgkJCQkJCSR0aGlzLT5tcGRmLT5fc2F2ZUNlbGxUZXh0QnVmZmVyKCRibG9ja3ByZSk7CgkJCQkJfSBlbHNlIHsKCQkJCQkJJHRoaXMtPm1wZGYtPl9zYXZlVGV4dEJ1ZmZlcigkYmxvY2twcmUpOwoJCQkJCX0KCQkJCX0KCQkJfQoJCX0KCgoJCS8qIC0tIFRBQkxFUyAtLSAqLwoKCQlpZiAoJHRhZyA9PSAnVEgnKQoJCQkkdGhpcy0+bXBkZi0+U2V0U3R5bGUoJ0InLCBmYWxzZSk7CgoJCWlmICgoJHRhZyA9PSAnVEgnIG9yICR0YWcgPT0gJ1REJykgJiYgJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWwpIHsKCQkJJHRoaXMtPm1wZGYtPmxhc3RvcHRpb25hbHRhZyA9ICdUUic7CgkJCXVuc2V0KCR0aGlzLT5tcGRmLT5jc3NtZ3ItPnRhYmxlY2FzY2FkZUNTU1skdGhpcy0+bXBkZi0+Y3NzbWdyLT50YkNTU2x2bF0pOwoJCQkkdGhpcy0+bXBkZi0+Y3NzbWdyLT50YkNTU2x2bC0tOwoJCQlpZiAoISR0aGlzLT5tcGRmLT50ZGJlZ2luKSB7CgkJCQlyZXR1cm47CgkJCX0KCQkJJHRoaXMtPm1wZGYtPnRkYmVnaW4gPSBmYWxzZTsKCQkJLy8gQWRkZWQgZm9yIGNvcnJlY3QgY2FsY3VsYXRpb24gb2YgY2VsbCBjb2x1bW4gd2lkdGggLSBvdGhlcndpc2UgbWlzc2VzIHRoZSBsYXN0IGxpbmUgaWYgbm90IGVuZCA8L3A+IGV0Yy4KCQkJaWYgKCFpc3NldCgkdGhpcy0+bXBkZi0+Y2VsbFskdGhpcy0+bXBkZi0+cm93XVskdGhpcy0+bXBkZi0+Y29sXVsnbWF4cyddKSkgewoJCQkJaWYgKCFpc19hcnJheSgkdGhpcy0+bXBkZi0+Y2VsbFskdGhpcy0+bXBkZi0+cm93XVskdGhpcy0+bXBkZi0+Y29sXSkpIHsKCQkJCQl0aHJvdyBuZXcgTXBkZkV4Y2VwdGlvbigiWW91IG1heSBoYXZlIGFuIGVycm9yIGluIHlvdXIgSFRNTCBjb2RlIGUuZy4gJmx0Oy90ZCZndDsmbHQ7L3RkJmd0OyIpOwoJCQkJfQoJCQkJJHRoaXMtPm1wZGYtPmNlbGxbJHRoaXMtPm1wZGYtPnJvd11bJHRoaXMtPm1wZGYtPmNvbF1bJ21heHMnXSA9ICR0aGlzLT5tcGRmLT5jZWxsWyR0aGlzLT5tcGRmLT5yb3ddWyR0aGlzLT5tcGRmLT5jb2xdWydzJ107CgkJCX0gZWxzZWlmICgkdGhpcy0+bXBkZi0+Y2VsbFskdGhpcy0+bXBkZi0+cm93XVskdGhpcy0+bXBkZi0+Y29sXVsnbWF4cyddIDwgJHRoaXMtPm1wZGYtPmNlbGxbJHRoaXMtPm1wZGYtPnJvd11bJHRoaXMtPm1wZGYtPmNvbF1bJ3MnXSkgewoJCQkJJHRoaXMtPm1wZGYtPmNlbGxbJHRoaXMtPm1wZGYtPnJvd11bJHRoaXMtPm1wZGYtPmNvbF1bJ21heHMnXSA9ICR0aGlzLT5tcGRmLT5jZWxsWyR0aGlzLT5tcGRmLT5yb3ddWyR0aGlzLT5tcGRmLT5jb2xdWydzJ107CgkJCX0KCgkJCS8vIFJlbW92ZSBsYXN0IDxicj4gaWYgYXQgZW5kIG9mIGNlbGwKCQkJaWYgKGlzc2V0KCR0aGlzLT5tcGRmLT5jZWxsWyR0aGlzLT5tcGRmLT5yb3ddWyR0aGlzLT5tcGRmLT5jb2xdWyd0ZXh0YnVmZmVyJ10pKSB7CgkJCQkkbnRiID0gY291bnQoJHRoaXMtPm1wZGYtPmNlbGxbJHRoaXMtPm1wZGYtPnJvd11bJHRoaXMtPm1wZGYtPmNvbF1bJ3RleHRidWZmZXInXSk7CgkJCX0gZWxzZSB7CgkJCQkkbnRiID0gMDsKCQkJfQoJCQlpZiAoJG50YiA+IDEgJiYgJHRoaXMtPm1wZGYtPmNlbGxbJHRoaXMtPm1wZGYtPnJvd11bJHRoaXMtPm1wZGYtPmNvbF1bJ3RleHRidWZmZXInXVskbnRiIC0gMV1bMF0gPT0gIlxuIikgewoJCQkJdW5zZXQoJHRoaXMtPm1wZGYtPmNlbGxbJHRoaXMtPm1wZGYtPnJvd11bJHRoaXMtPm1wZGYtPmNvbF1bJ3RleHRidWZmZXInXVskbnRiIC0gMV0pOwoJCQl9CgoJCQlpZiAoJHRoaXMtPm1wZGYtPnRhYmxldGhlYWQpIHsKCQkJCSR0aGlzLT5tcGRmLT50YWJsZVskdGhpcy0+bXBkZi0+dGFibGVMZXZlbF1bJHRoaXMtPm1wZGYtPnRiY3RyWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXV1bJ2lzX3RoZWFkJ11bJHRoaXMtPm1wZGYtPnJvd10gPSB0cnVlOwoJCQkJaWYgKCR0aGlzLT5tcGRmLT50YWJsZUxldmVsID09IDEpIHsKCQkJCQkkdGhpcy0+bXBkZi0+dGFibGVbJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWxdWyR0aGlzLT5tcGRmLT50YmN0clskdGhpcy0+bXBkZi0+dGFibGVMZXZlbF1dWydoZWFkZXJucm93cyddID0gbWF4KCR0aGlzLT5tcGRmLT50YWJsZVskdGhpcy0+bXBkZi0+dGFibGVMZXZlbF1bJHRoaXMtPm1wZGYtPnRiY3RyWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXV1bJ2hlYWRlcm5yb3dzJ10sICgkdGhpcy0+bXBkZi0+cm93ICsgMSkpOwoJCQkJfQoJCQl9CgkJCWlmICgkdGhpcy0+bXBkZi0+dGFibGV0Zm9vdCkgewoJCQkJJHRoaXMtPm1wZGYtPnRhYmxlWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXVskdGhpcy0+bXBkZi0+dGJjdHJbJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWxdXVsnaXNfdGZvb3QnXVskdGhpcy0+bXBkZi0+cm93XSA9IHRydWU7CgkJCQlpZiAoJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWwgPT0gMSkgewoJCQkJCSR0aGlzLT5tcGRmLT50YWJsZVskdGhpcy0+bXBkZi0+dGFibGVMZXZlbF1bJHRoaXMtPm1wZGYtPnRiY3RyWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXV1bJ2Zvb3Rlcm5yb3dzJ10gPSBtYXgoJHRoaXMtPm1wZGYtPnRhYmxlWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXVskdGhpcy0+bXBkZi0+dGJjdHJbJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWxdXVsnZm9vdGVybnJvd3MnXSwgKCR0aGlzLT5tcGRmLT5yb3cgKyAxIC0gJHRoaXMtPm1wZGYtPnRhYmxlWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXVskdGhpcy0+bXBkZi0+dGJjdHJbJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWxdXVsnaGVhZGVybnJvd3MnXSkpOwoJCQkJfQoJCQl9CgkJCSR0aGlzLT5tcGRmLT5SZXNldCgpOwoJCX0KCgkJaWYgKCR0YWcgPT0gJ1RSJyAmJiAkdGhpcy0+bXBkZi0+dGFibGVMZXZlbCkgewoJCQkvLyBJZiBCb3JkZXIgc2V0IG9uIFRSIC0gVXBkYXRlIHJpZ2h0IGJvcmRlcgoJCQlpZiAoaXNzZXQoJHRoaXMtPm1wZGYtPnRhYmxlWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXVskdGhpcy0+bXBkZi0+dGJjdHJbJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWxdXVsndHJib3JkZXItbGVmdCddWyR0aGlzLT5tcGRmLT5yb3ddKSkgewoJCQkJJGMgPSAmICR0aGlzLT5tcGRmLT5jZWxsWyR0aGlzLT5tcGRmLT5yb3ddWyR0aGlzLT5tcGRmLT5jb2xdOwoJCQkJaWYgKCRjKSB7CgkJCQkJaWYgKCR0aGlzLT5tcGRmLT5wYWNrVGFibGVEYXRhKSB7CgkJCQkJCSRjZWxsID0gJHRoaXMtPm1wZGYtPl91bnBhY2tDZWxsQm9yZGVyKCRjWydib3JkZXJiaW4nXSk7CgkJCQkJfSBlbHNlIHsKCQkJCQkJJGNlbGwgPSAkYzsKCQkJCQl9CgkJCQkJJGNlbGxbJ2JvcmRlcl9kZXRhaWxzJ11bJ1InXSA9ICR0aGlzLT5tcGRmLT5ib3JkZXJfZGV0YWlscygkdGhpcy0+bXBkZi0+dGFibGVbJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWxdWyR0aGlzLT5tcGRmLT50YmN0clskdGhpcy0+bXBkZi0+dGFibGVMZXZlbF1dWyd0cmJvcmRlci1yaWdodCddWyR0aGlzLT5tcGRmLT5yb3ddKTsKCQkJCQkkdGhpcy0+bXBkZi0+c2V0Qm9yZGVyKCRjZWxsWydib3JkZXInXSwgX0JPUkRFUl9SSUdIVCwgJGNlbGxbJ2JvcmRlcl9kZXRhaWxzJ11bJ1InXVsncyddKTsKCQkJCQlpZiAoJHRoaXMtPm1wZGYtPnBhY2tUYWJsZURhdGEpIHsKCQkJCQkJJGNbJ2JvcmRlcmJpbiddID0gJHRoaXMtPm1wZGYtPl9wYWNrQ2VsbEJvcmRlcigkY2VsbCk7CgkJCQkJCXVuc2V0KCRjWydib3JkZXInXSk7CgkJCQkJCXVuc2V0KCRjWydib3JkZXJfZGV0YWlscyddKTsKCQkJCQl9IGVsc2UgewoJCQkJCQkkYyA9ICRjZWxsOwoJCQkJCX0KCQkJCX0KCQkJfQoJCQkkdGhpcy0+bXBkZi0+bGFzdG9wdGlvbmFsdGFnID0gJyc7CgkJCXVuc2V0KCR0aGlzLT5tcGRmLT5jc3NtZ3ItPnRhYmxlY2FzY2FkZUNTU1skdGhpcy0+bXBkZi0+Y3NzbWdyLT50YkNTU2x2bF0pOwoJCQkkdGhpcy0+bXBkZi0+Y3NzbWdyLT50YkNTU2x2bC0tOwoJCQkkdGhpcy0+bXBkZi0+dHJvd190ZXh0X3JvdGF0ZSA9ICcnOwoJCQkkdGhpcy0+bXBkZi0+dGFibGV0aGVhZGp1c3RmaW5pc2hlZCA9IGZhbHNlOwoJCX0KCgkJaWYgKCR0YWcgPT0gJ1RCT0RZJykgewoJCQkkdGhpcy0+bXBkZi0+bGFzdG9wdGlvbmFsdGFnID0gJyc7CgkJCXVuc2V0KCR0aGlzLT5tcGRmLT5jc3NtZ3ItPnRhYmxlY2FzY2FkZUNTU1skdGhpcy0+bXBkZi0+Y3NzbWdyLT50YkNTU2x2bF0pOwoJCQkkdGhpcy0+bXBkZi0+Y3NzbWdyLT50YkNTU2x2bC0tOwoJCX0KCgkJaWYgKCR0YWcgPT0gJ1RIRUFEJykgewoJCQkkdGhpcy0+bXBkZi0+bGFzdG9wdGlvbmFsdGFnID0gJyc7CgkJCXVuc2V0KCR0aGlzLT5tcGRmLT5jc3NtZ3ItPnRhYmxlY2FzY2FkZUNTU1skdGhpcy0+bXBkZi0+Y3NzbWdyLT50YkNTU2x2bF0pOwoJCQkkdGhpcy0+bXBkZi0+Y3NzbWdyLT50YkNTU2x2bC0tOwoJCQkkdGhpcy0+bXBkZi0+dGFibGV0aGVhZCA9IDA7CgkJCSR0aGlzLT5tcGRmLT50YWJsZXRoZWFkanVzdGZpbmlzaGVkID0gdHJ1ZTsKCQkJJHRoaXMtPm1wZGYtPlJlc2V0U3R5bGVzKCk7CgkJCSR0aGlzLT5tcGRmLT50aGVhZF9mb250X3dlaWdodCA9ICcnOwoJCQkkdGhpcy0+bXBkZi0+dGhlYWRfZm9udF9zdHlsZSA9ICcnOwoJCQkkdGhpcy0+bXBkZi0+dGhlYWRfZm9udF9zbUNhcHMgPSAnJzsKCgkJCSR0aGlzLT5tcGRmLT50aGVhZF92YWxpZ25fZGVmYXVsdCA9ICcnOwoJCQkkdGhpcy0+bXBkZi0+dGhlYWRfdGV4dGFsaWduX2RlZmF1bHQgPSAnJzsKCQl9CgoJCWlmICgkdGFnID09ICdURk9PVCcpIHsKCQkJJHRoaXMtPm1wZGYtPmxhc3RvcHRpb25hbHRhZyA9ICcnOwoJCQl1bnNldCgkdGhpcy0+bXBkZi0+Y3NzbWdyLT50YWJsZWNhc2NhZGVDU1NbJHRoaXMtPm1wZGYtPmNzc21nci0+dGJDU1NsdmxdKTsKCQkJJHRoaXMtPm1wZGYtPmNzc21nci0+dGJDU1NsdmwtLTsKCQkJJHRoaXMtPm1wZGYtPnRhYmxldGZvb3QgPSAwOwoJCQkkdGhpcy0+bXBkZi0+UmVzZXRTdHlsZXMoKTsKCQkJJHRoaXMtPm1wZGYtPnRmb290X2ZvbnRfd2VpZ2h0ID0gJyc7CgkJCSR0aGlzLT5tcGRmLT50Zm9vdF9mb250X3N0eWxlID0gJyc7CgkJCSR0aGlzLT5tcGRmLT50Zm9vdF9mb250X3NtQ2FwcyA9ICcnOwoKCQkJJHRoaXMtPm1wZGYtPnRmb290X3ZhbGlnbl9kZWZhdWx0ID0gJyc7CgkJCSR0aGlzLT5tcGRmLT50Zm9vdF90ZXh0YWxpZ25fZGVmYXVsdCA9ICcnOwoJCX0KCgkJaWYgKCR0YWcgPT0gJ1RBQkxFJykgeyAvLyBUQUJMRS1FTkQgKAoJCQlpZiAoJHRoaXMtPm1wZGYtPnByb2dyZXNzQmFyKSB7CgkJCQkkdGhpcy0+bXBkZi0+VXBkYXRlUHJvZ3Jlc3NCYXIoMSwgJycsICdUQUJMRScpOwoJCQl9IC8vICpQUk9HUkVTUy1CQVIqCgkJCWlmICgkdGhpcy0+bXBkZi0+cHJvZ3Jlc3NCYXIpIHsKCQkJCSR0aGlzLT5tcGRmLT5VcGRhdGVQcm9ncmVzc0Jhcig3LCAwLCAnJyk7CgkJCX0gLy8gKlBST0dSRVNTLUJBUioKCQkJJHRoaXMtPm1wZGYtPmxhc3RvcHRpb25hbHRhZyA9ICcnOwoJCQl1bnNldCgkdGhpcy0+bXBkZi0+Y3NzbWdyLT50YWJsZWNhc2NhZGVDU1NbJHRoaXMtPm1wZGYtPmNzc21nci0+dGJDU1NsdmxdKTsKCQkJJHRoaXMtPm1wZGYtPmNzc21nci0+dGJDU1NsdmwtLTsKCQkJJHRoaXMtPm1wZGYtPmlnbm9yZWZvbGxvd2luZ3NwYWNlcyA9IHRydWU7IC8vRWxpbWluYXRlIGV4Y2VlZGluZyBsZWZ0LXNpZGUgc3BhY2VzCgkJCS8vIG1QREYgNS43LjMKCQkJLy8gSW4gY2FzZSBhIGNvbHNwYW4gKG9uIGEgcm93IGFmdGVyIGZpcnN0IHJvdykgZXhjZWVkZWQgbnVtYmVyIG9mIGNvbHVtbnMgaW4gdGFibGUKCQkJZm9yICgkayA9IDA7ICRrIDwgJHRoaXMtPm1wZGYtPnRhYmxlWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXVskdGhpcy0+bXBkZi0+dGJjdHJbJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWxdXVsnbnInXTsgJGsrKykgewoJCQkJZm9yICgkbCA9IDA7ICRsIDwgJHRoaXMtPm1wZGYtPnRhYmxlWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXVskdGhpcy0+bXBkZi0+dGJjdHJbJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWxdXVsnbmMnXTsgJGwrKykgewoJCQkJCWlmICghaXNzZXQoJHRoaXMtPm1wZGYtPmNlbGxbJGtdWyRsXSkpIHsKCQkJCQkJZm9yICgkbiA9ICRsIC0gMTsgJG4gPj0gMDsgJG4tLSkgewoJCQkJCQkJaWYgKGlzc2V0KCR0aGlzLT5tcGRmLT5jZWxsWyRrXVskbl0pICYmICR0aGlzLT5tcGRmLT5jZWxsWyRrXVskbl0gIT0gMCkgewoJCQkJCQkJCWJyZWFrOwoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJCSR0aGlzLT5tcGRmLT5jZWxsWyRrXVskbF0gPSBhcnJheSgKCQkJCQkJCSdhJyA9PiAnQycsCgkJCQkJCQkndmEnID0+ICdNJywKCQkJCQkJCSdSJyA9PiBmYWxzZSwKCQkJCQkJCSdub3dyYXAnID0+IGZhbHNlLAoJCQkJCQkJJ2JnY29sb3InID0+IGZhbHNlLAoJCQkJCQkJJ3BhZGRpbmcnID0+IGFycmF5KCdMJyA9PiBmYWxzZSwgJ1InID0+IGZhbHNlLCAnVCcgPT4gZmFsc2UsICdCJyA9PiBmYWxzZSksCgkJCQkJCQknZ3JhZGllbnQnID0+IGZhbHNlLAoJCQkJCQkJJ3MnID0+IDAsCgkJCQkJCQknbWF4cycgPT4gMCwKCQkJCQkJCSd0ZXh0YnVmZmVyJyA9PiBhcnJheSgpLAoJCQkJCQkJJ2RmcycgPT4gJHRoaXMtPm1wZGYtPkZvbnRTaXplLAoJCQkJCQkpOwoKCQkJCQkJaWYgKCEkdGhpcy0+bXBkZi0+c2ltcGxlVGFibGVzKSB7CgkJCQkJCQkkdGhpcy0+bXBkZi0+Y2VsbFska11bJGxdWydib3JkZXInXSA9IDA7CgkJCQkJCQkkdGhpcy0+bXBkZi0+Y2VsbFska11bJGxdWydib3JkZXJfZGV0YWlscyddWydSJ10gPSBhcnJheSgncycgPT4gMCwgJ3cnID0+IDAsICdjJyA9PiBmYWxzZSwgJ3N0eWxlJyA9PiAnbm9uZScsICdkb20nID0+IDApOwoJCQkJCQkJJHRoaXMtPm1wZGYtPmNlbGxbJGtdWyRsXVsnYm9yZGVyX2RldGFpbHMnXVsnTCddID0gYXJyYXkoJ3MnID0+IDAsICd3JyA9PiAwLCAnYycgPT4gZmFsc2UsICdzdHlsZScgPT4gJ25vbmUnLCAnZG9tJyA9PiAwKTsKCQkJCQkJCSR0aGlzLT5tcGRmLT5jZWxsWyRrXVskbF1bJ2JvcmRlcl9kZXRhaWxzJ11bJ1QnXSA9IGFycmF5KCdzJyA9PiAwLCAndycgPT4gMCwgJ2MnID0+IGZhbHNlLCAnc3R5bGUnID0+ICdub25lJywgJ2RvbScgPT4gMCk7CgkJCQkJCQkkdGhpcy0+bXBkZi0+Y2VsbFska11bJGxdWydib3JkZXJfZGV0YWlscyddWydCJ10gPSBhcnJheSgncycgPT4gMCwgJ3cnID0+IDAsICdjJyA9PiBmYWxzZSwgJ3N0eWxlJyA9PiAnbm9uZScsICdkb20nID0+IDApOwoJCQkJCQkJJHRoaXMtPm1wZGYtPmNlbGxbJGtdWyRsXVsnYm9yZGVyX2RldGFpbHMnXVsnbWJ3J10gPSBhcnJheSgnQkwnID0+IDAsICdCUicgPT4gMCwgJ1JUJyA9PiAwLCAnUkInID0+IDAsICdUTCcgPT4gMCwgJ1RSJyA9PiAwLCAnTFQnID0+IDAsICdMQicgPT4gMCk7CgkJCQkJCQlpZiAoJHRoaXMtPm1wZGYtPnBhY2tUYWJsZURhdGEpIHsKCQkJCQkJCQkkdGhpcy0+bXBkZi0+Y2VsbFska11bJGxdWydib3JkZXJiaW4nXSA9ICR0aGlzLT5tcGRmLT5fcGFja0NlbGxCb3JkZXIoJHRoaXMtPm1wZGYtPmNlbGxbJGtdWyRsXSk7CgkJCQkJCQkJdW5zZXQoJHRoaXMtPm1wZGYtPmNlbGxbJGtdWyRsXVsnYm9yZGVyJ10pOwoJCQkJCQkJCXVuc2V0KCR0aGlzLT5tcGRmLT5jZWxsWyRrXVskbF1bJ2JvcmRlcl9kZXRhaWxzJ10pOwoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJfQoJCQkJfQoJCQl9CgkJCSR0aGlzLT5tcGRmLT50YWJsZVskdGhpcy0+bXBkZi0+dGFibGVMZXZlbF1bJHRoaXMtPm1wZGYtPnRiY3RyWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXV1bJ2NlbGxzJ10gPSAkdGhpcy0+bXBkZi0+Y2VsbDsKCQkJJHRoaXMtPm1wZGYtPnRhYmxlWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXVskdGhpcy0+bXBkZi0+dGJjdHJbJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWxdXVsnd2MnXSA9IGFycmF5X3BhZChhcnJheSgpLCAkdGhpcy0+bXBkZi0+dGFibGVbJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWxdWyR0aGlzLT5tcGRmLT50YmN0clskdGhpcy0+bXBkZi0+dGFibGVMZXZlbF1dWyduYyddLCBhcnJheSgnbWl3JyA9PiAwLCAnbWF3JyA9PiAwKSk7CgkJCSR0aGlzLT5tcGRmLT50YWJsZVskdGhpcy0+bXBkZi0+dGFibGVMZXZlbF1bJHRoaXMtPm1wZGYtPnRiY3RyWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXV1bJ2hyJ10gPSBhcnJheV9wYWQoYXJyYXkoKSwgJHRoaXMtPm1wZGYtPnRhYmxlWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXVskdGhpcy0+bXBkZi0+dGJjdHJbJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWxdXVsnbnInXSwgMCk7CgoJCQkvLyBNb3ZlIHRhYmxlIGZvb3RlciA8dGZvb3Q+IHJvdyB0byBlbmQgb2YgdGFibGUKCQkJaWYgKGlzc2V0KCR0aGlzLT5tcGRmLT50YWJsZVskdGhpcy0+bXBkZi0+dGFibGVMZXZlbF1bJHRoaXMtPm1wZGYtPnRiY3RyWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXV1bJ2lzX3Rmb290J10pICYmIGNvdW50KCR0aGlzLT5tcGRmLT50YWJsZVskdGhpcy0+bXBkZi0+dGFibGVMZXZlbF1bJHRoaXMtPm1wZGYtPnRiY3RyWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXV1bJ2lzX3Rmb290J10pKSB7CgkJCQkkdGZyb3dzID0gYXJyYXkoKTsKCQkJCWZvcmVhY2ggKCR0aGlzLT5tcGRmLT50YWJsZVskdGhpcy0+bXBkZi0+dGFibGVMZXZlbF1bJHRoaXMtPm1wZGYtPnRiY3RyWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXV1bJ2lzX3Rmb290J10gQVMgJHIgPT4gJHZhbCkgewoJCQkJCWlmICgkdmFsKSB7CgkJCQkJCSR0ZnJvd3NbXSA9ICRyOwoJCQkJCX0KCQkJCX0KCQkJCSR0ZW1wID0gYXJyYXkoKTsKCQkJCSR0ZW1wdGYgPSBhcnJheSgpOwoJCQkJZm9yZWFjaCAoJHRoaXMtPm1wZGYtPnRhYmxlWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXVskdGhpcy0+bXBkZi0+dGJjdHJbJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWxdXVsnY2VsbHMnXSBBUyAkayA9PiAkcm93KSB7CgkJCQkJaWYgKGluX2FycmF5KCRrLCAkdGZyb3dzKSkgewoJCQkJCQkkdGVtcHRmW10gPSAkcm93OwoJCQkJCX0gZWxzZSB7CgkJCQkJCSR0ZW1wW10gPSAkcm93OwoJCQkJCX0KCQkJCX0KCQkJCSR0aGlzLT5tcGRmLT50YWJsZVskdGhpcy0+bXBkZi0+dGFibGVMZXZlbF1bJHRoaXMtPm1wZGYtPnRiY3RyWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXV1bJ2lzX3Rmb290J10gPSBhcnJheSgpOwoJCQkJZm9yICgkaSA9IGNvdW50KCR0ZW1wKTsgJGkgPCAoY291bnQoJHRlbXApICsgY291bnQoJHRlbXB0ZikpOyAkaSsrKSB7CgkJCQkJJHRoaXMtPm1wZGYtPnRhYmxlWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXVskdGhpcy0+bXBkZi0+dGJjdHJbJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWxdXVsnaXNfdGZvb3QnXVskaV0gPSB0cnVlOwoJCQkJfQoJCQkJLy8gVXBkYXRlIG5lc3RlZHBvcyByb3cgcmVmZXJlbmNlcwoJCQkJaWYgKGlzc2V0KCR0aGlzLT5tcGRmLT50YWJsZVsoJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWwgKyAxKV0pICYmIGNvdW50KCR0aGlzLT5tcGRmLT50YWJsZVsoJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWwgKyAxKV0pKSB7CgkJCQkJZm9yZWFjaCAoJHRoaXMtPm1wZGYtPnRhYmxlWygkdGhpcy0+bXBkZi0+dGFibGVMZXZlbCArIDEpXSBBUyAkbmlkID0+ICRuZXN0ZWQpIHsKCQkJCQkJJHRoaXMtPm1wZGYtPnRhYmxlWygkdGhpcy0+bXBkZi0+dGFibGVMZXZlbCArIDEpXVskbmlkXVsnbmVzdGVkcG9zJ11bMF0gLT0gY291bnQoJHRlbXB0Zik7CgkJCQkJfQoJCQkJfQoJCQkJJHRoaXMtPm1wZGYtPnRhYmxlWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXVskdGhpcy0+bXBkZi0+dGJjdHJbJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWxdXVsnY2VsbHMnXSA9IGFycmF5X21lcmdlKCR0ZW1wLCAkdGVtcHRmKTsKCgkJCQkvLyBVcGRhdGUgb3RoZXIgYXJheXMgc2V0IG9uIHJvdyBudW1iZXIKCQkJCS8vIFt0cmJhY2tncm91bmQtaW1hZ2VzXSBbdHJncmFkaWVudHNdCgkJCQkkdGVtcHRyYmdpID0gYXJyYXkoKTsKCQkJCSR0ZW1wdHJiZ2cgPSBhcnJheSgpOwoJCQkJJHRlbXB0cmJnYyA9IGFycmF5KCk7CgkJCQlpZiAoaXNzZXQoJHRoaXMtPm1wZGYtPnRhYmxlWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXVskdGhpcy0+bXBkZi0+dGJjdHJbJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWxdXVsnYmdjb2xvciddWy0xXSkpIHsKCQkJCQkkdGVtcHRyYmdjWy0xXSA9ICR0aGlzLT5tcGRmLT50YWJsZVskdGhpcy0+bXBkZi0+dGFibGVMZXZlbF1bJHRoaXMtPm1wZGYtPnRiY3RyWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXV1bJ2JnY29sb3InXVstMV07CgkJCQl9CgkJCQlmb3IgKCRrID0gMDsgJGsgPCAkdGhpcy0+bXBkZi0+dGFibGVbJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWxdWyR0aGlzLT5tcGRmLT50YmN0clskdGhpcy0+bXBkZi0+dGFibGVMZXZlbF1dWyduciddOyAkaysrKSB7CgkJCQkJaWYgKCFpbl9hcnJheSgkaywgJHRmcm93cykpIHsKCQkJCQkJJHRlbXB0cmJnaVtdID0gKGlzc2V0KCR0aGlzLT5tcGRmLT50YWJsZVskdGhpcy0+bXBkZi0+dGFibGVMZXZlbF1bJHRoaXMtPm1wZGYtPnRiY3RyWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXV1bJ3RyYmFja2dyb3VuZC1pbWFnZXMnXVska10pID8gJHRoaXMtPm1wZGYtPnRhYmxlWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXVskdGhpcy0+bXBkZi0+dGJjdHJbJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWxdXVsndHJiYWNrZ3JvdW5kLWltYWdlcyddWyRrXSA6IG51bGwpOwoJCQkJCQkkdGVtcHRyYmdnW10gPSAoaXNzZXQoJHRoaXMtPm1wZGYtPnRhYmxlWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXVskdGhpcy0+bXBkZi0+dGJjdHJbJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWxdXVsndHJncmFkaWVudHMnXVska10pID8gJHRoaXMtPm1wZGYtPnRhYmxlWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXVskdGhpcy0+bXBkZi0+dGJjdHJbJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWxdXVsndHJncmFkaWVudHMnXVska10gOiBudWxsKTsKCQkJCQkJJHRlbXB0cmJnY1tdID0gKGlzc2V0KCR0aGlzLT5tcGRmLT50YWJsZVskdGhpcy0+bXBkZi0+dGFibGVMZXZlbF1bJHRoaXMtPm1wZGYtPnRiY3RyWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXV1bJ2JnY29sb3InXVska10pID8gJHRoaXMtPm1wZGYtPnRhYmxlWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXVskdGhpcy0+bXBkZi0+dGJjdHJbJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWxdXVsnYmdjb2xvciddWyRrXSA6IG51bGwpOwoJCQkJCX0KCQkJCX0KCQkJCWZvciAoJGsgPSAwOyAkayA8ICR0aGlzLT5tcGRmLT50YWJsZVskdGhpcy0+bXBkZi0+dGFibGVMZXZlbF1bJHRoaXMtPm1wZGYtPnRiY3RyWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXV1bJ25yJ107ICRrKyspIHsKCQkJCQlpZiAoaW5fYXJyYXkoJGssICR0ZnJvd3MpKSB7CgkJCQkJCSR0ZW1wdHJiZ2lbXSA9IChpc3NldCgkdGhpcy0+bXBkZi0+dGFibGVbJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWxdWyR0aGlzLT5tcGRmLT50YmN0clskdGhpcy0+bXBkZi0+dGFibGVMZXZlbF1dWyd0cmJhY2tncm91bmQtaW1hZ2VzJ11bJGtdKSA/ICR0aGlzLT5tcGRmLT50YWJsZVskdGhpcy0+bXBkZi0+dGFibGVMZXZlbF1bJHRoaXMtPm1wZGYtPnRiY3RyWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXV1bJ3RyYmFja2dyb3VuZC1pbWFnZXMnXVska10gOiBudWxsKTsKCQkJCQkJJHRlbXB0cmJnZ1tdID0gKGlzc2V0KCR0aGlzLT5tcGRmLT50YWJsZVskdGhpcy0+bXBkZi0+dGFibGVMZXZlbF1bJHRoaXMtPm1wZGYtPnRiY3RyWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXV1bJ3RyZ3JhZGllbnRzJ11bJGtdKSA/ICR0aGlzLT5tcGRmLT50YWJsZVskdGhpcy0+bXBkZi0+dGFibGVMZXZlbF1bJHRoaXMtPm1wZGYtPnRiY3RyWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXV1bJ3RyZ3JhZGllbnRzJ11bJGtdIDogbnVsbCk7CgkJCQkJCSR0ZW1wdHJiZ2NbXSA9IChpc3NldCgkdGhpcy0+bXBkZi0+dGFibGVbJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWxdWyR0aGlzLT5tcGRmLT50YmN0clskdGhpcy0+bXBkZi0+dGFibGVMZXZlbF1dWydiZ2NvbG9yJ11bJGtdKSA/ICR0aGlzLT5tcGRmLT50YWJsZVskdGhpcy0+bXBkZi0+dGFibGVMZXZlbF1bJHRoaXMtPm1wZGYtPnRiY3RyWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXV1bJ2JnY29sb3InXVska10gOiBudWxsKTsKCQkJCQl9CgkJCQl9CgkJCQkkdGhpcy0+bXBkZi0+dGFibGVbJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWxdWyR0aGlzLT5tcGRmLT50YmN0clskdGhpcy0+bXBkZi0+dGFibGVMZXZlbF1dWyd0cmJhY2tncm91bmQtaW1hZ2VzJ10gPSAkdGVtcHRyYmdpOwoJCQkJJHRoaXMtPm1wZGYtPnRhYmxlWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXVskdGhpcy0+bXBkZi0+dGJjdHJbJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWxdXVsndHJncmFkaWVudHMnXSA9ICR0ZW1wdHJiZ2c7CgkJCQkkdGhpcy0+bXBkZi0+dGFibGVbJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWxdWyR0aGlzLT5tcGRmLT50YmN0clskdGhpcy0+bXBkZi0+dGFibGVMZXZlbF1dWydiZ2NvbG9yJ10gPSAkdGVtcHRyYmdjOwoJCQkJLy8gU2hvdWxkIFVwZGF0ZSBhbGwgb3RoZXIgYXJheXMgc2V0IG9uIHJvdyBudW1iZXIsIGJ1dCBjZWxsIHByb3BlcnRpZXMgaGF2ZSBiZWVuIHNldCBzbyBub3QgbmVlZGVkCgkJCQkvLyBbYmdjb2xvcl0gW3RyYm9yZGVyLWxlZnRdIFt0cmJvcmRlci1yaWdodF0gW3RyYm9yZGVyLXRvcF0gW3RyYm9yZGVyLWJvdHRvbV0KCQkJfQoKCQkJaWYgKCR0aGlzLT5tcGRmLT50YWJsZVskdGhpcy0+bXBkZi0+dGFibGVMZXZlbF1bJHRoaXMtPm1wZGYtPnRiY3RyWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXV1bJ2RpcmVjdGlvbiddID09ICdydGwnKSB7CgkJCQkkdGhpcy0+bXBkZi0+X3JldmVyc2VUYWJsZURpcigkdGhpcy0+bXBkZi0+dGFibGVbJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWxdWyR0aGlzLT5tcGRmLT50YmN0clskdGhpcy0+bXBkZi0+dGFibGVMZXZlbF1dKTsKCQkJfQoKCQkJLy8gRml4IEJvcmRlcnMgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCgkJCSR0aGlzLT5tcGRmLT5fZml4VGFibGVCb3JkZXJzKCR0aGlzLT5tcGRmLT50YWJsZVskdGhpcy0+bXBkZi0+dGFibGVMZXZlbF1bJHRoaXMtPm1wZGYtPnRiY3RyWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXV0pOwoKCQkJaWYgKCR0aGlzLT5tcGRmLT5wcm9ncmVzc0JhcikgewoJCQkJJHRoaXMtPm1wZGYtPlVwZGF0ZVByb2dyZXNzQmFyKDcsIDEwLCAnICcpOwoJCQl9IC8vICpQUk9HUkVTUy1CQVIqCgoJCQlpZiAoJHRoaXMtPm1wZGYtPkNvbEFjdGl2ZSkgewoJCQkJJHRoaXMtPm1wZGYtPnRhYmxlX3JvdGF0ZSA9IDA7CgkJCX0gLy8gKkNPTFVNTlMqCgkJCWlmICgkdGhpcy0+bXBkZi0+dGFibGVfcm90YXRlIDw+IDApIHsKCQkJCSR0aGlzLT5tcGRmLT50YWJsZWJ1ZmZlciA9ICcnOwoJCQkJLy8gTWF4IHdpZHRoIGZvciByb3RhdGVkIHRhYmxlCgkJCQkkdGhpcy0+bXBkZi0+dGJyb3RfbWF4dyA9ICR0aGlzLT5tcGRmLT5oIC0gKCR0aGlzLT5tcGRmLT55ICsgJHRoaXMtPm1wZGYtPmJNYXJnaW4gKyAxKTsKCQkJCSR0aGlzLT5tcGRmLT50YnJvdF9tYXhoID0gJHRoaXMtPm1wZGYtPmJsa1skdGhpcy0+bXBkZi0+YmxrbHZsXVsnaW5uZXJfd2lkdGgnXTsgIC8vIE1heCB3aWR0aCBmb3Igcm90YXRlZCB0YWJsZQoJCQkJJHRoaXMtPm1wZGYtPnRicm90X2FsaWduID0gJHRoaXMtPm1wZGYtPnRhYmxlWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXVskdGhpcy0+bXBkZi0+dGJjdHJbJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWxdXVsnYSddOwoJCQl9CgkJCSR0aGlzLT5tcGRmLT5zaHJpbl9rID0gMTsKCgkJCWlmICgkdGhpcy0+bXBkZi0+c2hyaW5rX3RhYmxlc190b19maXQgPCAxKSB7CgkJCQkkdGhpcy0+bXBkZi0+c2hyaW5rX3RhYmxlc190b19maXQgPSAxOwoJCQl9CgkJCWlmICghJHRoaXMtPm1wZGYtPnNocmlua190aGlzX3RhYmxlX3RvX2ZpdCkgewoJCQkJJHRoaXMtPm1wZGYtPnNocmlua190aGlzX3RhYmxlX3RvX2ZpdCA9ICR0aGlzLT5tcGRmLT5zaHJpbmtfdGFibGVzX3RvX2ZpdDsKCQkJfQoKCQkJaWYgKCR0aGlzLT5tcGRmLT50YWJsZUxldmVsID4gMSkgewoJCQkJLy8gZGVhbCB3aXRoIG5lc3RlZCB0YWJsZQoKCQkJCSR0aGlzLT5tcGRmLT5fdGFibGVDb2x1bW5XaWR0aCgkdGhpcy0+bXBkZi0+dGFibGVbJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWxdWyR0aGlzLT5tcGRmLT50YmN0clskdGhpcy0+bXBkZi0+dGFibGVMZXZlbF1dLCB0cnVlKTsKCgkJCQkkdG1pdyA9ICR0aGlzLT5tcGRmLT50YWJsZVskdGhpcy0+bXBkZi0+dGFibGVMZXZlbF1bJHRoaXMtPm1wZGYtPnRiY3RyWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXV1bJ21pdyddOwoJCQkJJHRtYXcgPSAkdGhpcy0+bXBkZi0+dGFibGVbJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWxdWyR0aGlzLT5tcGRmLT50YmN0clskdGhpcy0+bXBkZi0+dGFibGVMZXZlbF1dWydtYXcnXTsKCQkJCSR0bCA9ICR0aGlzLT5tcGRmLT50YWJsZVskdGhpcy0+bXBkZi0+dGFibGVMZXZlbF1bJHRoaXMtPm1wZGYtPnRiY3RyWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXV1bJ3RsJ107CgoJCQkJLy8gR28gZG93biB0byBsb3dlciB0YWJsZSBsZXZlbAoJCQkJJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWwtLTsKCgkJCQkvLyBSZXNldCBsb3dlciBsZXZlbCB0YWJsZQoJCQkJJHRoaXMtPm1wZGYtPmJhc2VfdGFibGVfcHJvcGVydGllcyA9ICR0aGlzLT5tcGRmLT50YWJsZVskdGhpcy0+bXBkZi0+dGFibGVMZXZlbF1bJHRoaXMtPm1wZGYtPnRiY3RyWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXV1bJ2Jhc2VQcm9wZXJ0aWVzJ107CgkJCQkvLyBtUERGIDUuNy4zCgkJCQkkdGhpcy0+bXBkZi0+ZGVmYXVsdF9mb250ID0gJHRoaXMtPm1wZGYtPmJhc2VfdGFibGVfcHJvcGVydGllc1snRk9OVC1GQU1JTFknXTsKCQkJCSR0aGlzLT5tcGRmLT5TZXRGb250KCR0aGlzLT5tcGRmLT5kZWZhdWx0X2ZvbnQsICcnLCAwLCBmYWxzZSk7CgkJCQkkdGhpcy0+bXBkZi0+ZGVmYXVsdF9mb250X3NpemUgPSAkdGhpcy0+bXBkZi0+Q29udmVydFNpemUoJHRoaXMtPm1wZGYtPmJhc2VfdGFibGVfcHJvcGVydGllc1snRk9OVC1TSVpFJ10pICogKF9NUERGSyk7CgkJCQkkdGhpcy0+bXBkZi0+U2V0Rm9udFNpemUoJHRoaXMtPm1wZGYtPmRlZmF1bHRfZm9udF9zaXplLCBmYWxzZSk7CgoJCQkJJHRoaXMtPm1wZGYtPmNlbGwgPSAkdGhpcy0+bXBkZi0+dGFibGVbJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWxdWyR0aGlzLT5tcGRmLT50YmN0clskdGhpcy0+bXBkZi0+dGFibGVMZXZlbF1dWydjZWxscyddOwoJCQkJaWYgKGlzc2V0KCR0aGlzLT5tcGRmLT5jZWxsWydQQVJFTlRDRUxMJ10pKSB7CgkJCQkJaWYgKCR0aGlzLT5tcGRmLT5jZWxsWydQQVJFTlRDRUxMJ10pIHsKCQkJCQkJJHRoaXMtPm1wZGYtPnJlc3RvcmVJbmxpbmVQcm9wZXJ0aWVzKCR0aGlzLT5tcGRmLT5jZWxsWydQQVJFTlRDRUxMJ10pOwoJCQkJCX0KCQkJCQl1bnNldCgkdGhpcy0+bXBkZi0+Y2VsbFsnUEFSRU5UQ0VMTCddKTsKCQkJCX0KCQkJCSR0aGlzLT5tcGRmLT5yb3cgPSAkdGhpcy0+bXBkZi0+dGFibGVbJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWxdWyR0aGlzLT5tcGRmLT50YmN0clskdGhpcy0+bXBkZi0+dGFibGVMZXZlbF1dWydjdXJycm93J107CgkJCQkkdGhpcy0+bXBkZi0+Y29sID0gJHRoaXMtPm1wZGYtPnRhYmxlWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXVskdGhpcy0+bXBkZi0+dGJjdHJbJHRoaXMtPm1wZGYtPnRhYmxlTGV2ZWxdXVsnY3VycmNvbCddOwoJCQkJJG9iamF0dHIgPSBhcnJheSgpOwoJCQkJJG9iamF0dHJbJ3R5cGUnXSA9ICduZXN0ZWR0YWJsZSc7CgkJCQkkb2JqYXR0clsnbmVzdGVkY29udGVudCddID0gJHRoaXMtPm1wZGYtPnRiY3RyWygkdGhpcy0+bXBkZi0+dGFibGVMZXZlbCArIDEpXTsKCQkJCSRvYmphdHRyWyd0YWJsZSddID0gJHRoaXMtPm1wZGYtPnRiY3RyWyR0aGlzLT5tcGRmLT50YWJsZUxldmVsXTsKCQkJCSRvYmphdHRyWydyb3cnXSA9ICR0aGlzLT5tcGRmLT5yb3c7CgkJCQkkb2JqYXR0clsnY29sJ10gPSAkdGhpcy0+bXBkZi0+Y29sOwoJCQkJJG9iamF0dHJbJ2xldmVsJ10gPSAkdGhpcy0+bXBkZi0+dGFibGVMZXZlbDsKCQkJCSRlID0gIlx4YmJceGE0XHhhY3R5cGU9bmVzdGVkdGFibGUsb2JqYXR0cj0iIC4gc2VyaWFsaXplKCRvYmphdHRyKSAuICJceGJiXHhhNFx4YWMiOwoJCQkJJHRoaXMtPm1wZGYtPl9zYXZlQ2VsbFRleHRCdWZmZXIoJGUpOwoJCQkJJHRoaXMtPm1wZGYtPmNlbGxbJHRoaXMtPm1wZGYtPnJvd11bJHRoaXMtPm1wZGYtPmNvbF1bJ3MnXSArPSAkdGw7CgkJCQlpZiAoIWlzc2V0KCR0aGlzLT5tcGRmLT5jZWxsWyR0aGlzLT5tcGRmLT5yb3ddWyR0aGlzLT5tcGRmLT5jb2xdWydtYXhzJ10pKSB7CgkJCQkJJHRoaXMtPm1wZGYtPmNlbGxbJHRoaXMtPm1wZGYtPnJvd11bJHRoaXMtPm1wZGYtPmNvbF1bJ21heHMnXSA9ICR0aGlzLT5tcGRmLT5jZWxsWyR0aGlzLT5tcGRmLT5yb3ddWyR0aGlzLT5tcGRmLT5jb2xdWydzJ107CgkJCQl9IGVsc2VpZiAoJHRoaXMtPm1wZGYtPmNlbGxbJHRoaXMtPm1wZGYtPnJvd11bJHRoaXMtPm1wZGYtPmNvbF1bJ21heHMnXSA8ICR0aGlzLT5tcGRmLT5jZWxsWyR0aGlzLT5tcGRmLT5yb3ddWyR0aGlzLT5tcGRmLT5jb2xdWydzJ10pIHsKCQkJCQkkdGhpcy0+bXBkZi0+Y2VsbFskdGhpcy0+bXBkZi0+cm93XVskdGhpcy0+bXBkZi0+Y29sXVsnbWF4cyddID0gJHRoaXMtPm1wZGYtPmNlbGxbJHRoaXMtPm1wZGYtPnJvd11bJHRoaXMtPm1wZGYtPmNvbF1bJ3MnXTsKCQkJCX0KCQkJCSR0aGlzLT5tcGRmLT5jZWxsWyR0aGlzLT5tcGRmLT5yb3ddWyR0aGlzLT5tcGRmLT5jb2xdWydzJ10gPSAwOyAvLyByZXNldAoJCQkJaWYgKChpc3NldCgkdGhpcy0+bXBkZi0+Y2VsbFskdGhpcy0+bXBkZi0+cm93XVskdGhpcy0+bXBkZi0+Y29sXVsnbmVzdGVkbWF3J10pICYmICR0aGlzLT5tcGRmLT5jZWxsWyR0aGlzLT5tcGRmLT5yb3ddWyR0aGlzLT5tcGRmLT5jb2xdWyduZXN0ZWRtYXcnXSA8ICR0bWF3KSB8fCAhaXNzZXQoJHRoaXMtPm1wZGYtPmNlbGxbJHRoaXMtPm1wZGYtPnJvd11bJHRoaXMtPm1wZGYtPmNvbF1bJ25lc3RlZG1hdyddKSkgewoJCQkJCSR0aGlzLT5tcGRmLT5jZWxsWyR0aGlzLT5tcGRmLT5yb3ddWyR0aGlzLT5tcGRmLT5jb2xdWyduZXN0ZWRtYXcnXSA9ICR0bWF3OwoJCQkJfQoJCQkJaWYgKChpc3NldCgkdGhpcy0+bXBkZi0+Y2VsbFskdGhpcy0+bXBkZi0+cm93XVskdGhpcy0+bXBkZi0+Y29sXVsnbmVzdGVkbWl3J10pICYmICR0aGlzLT5tcGRmLT5jZWxsWyR0aGlzLT5tcGRmLT5yb3ddWyR0aGlzLT5tcGRmLT5jb2xdWyduZXN0ZWRtaXcnXSA8ICR0bWl3KSB8fCAhaXNzZXQoJHRoaXMtPm1wZGYtPmNlbGxbJHRoaXMtPm1wZGYtPnJvd11bJHRoaXMtPm1wZGYtPmNvbF1bJ25lc3RlZG1pdyddKSkgewoJCQkJCSR0aGlzLT5tcGRmLT5jZWxsWyR0aGlzLT5tcGRmLT5yb3ddWyR0aGlzLT5tcGRmLT5jb2xdWyduZXN0ZWRtaXcnXSA9ICR0bWl3OwoJCQkJfQoJCQkJJHRoaXMtPm1wZGYtPnRkYmVnaW4gPSB0cnVlOwoJCQkJJHRoaXMtPm1wZGYtPm5lc3RlZHRhYmxlanVzdGZpbmlzaGVkID0gdHJ1ZTsKCQkJCSR0aGlzLT5tcGRmLT5pZ25vcmVmb2xsb3dpbmdzcGFjZXMgPSB0cnVlOwoJCQkJcmV0dXJuOwoJCQl9CgkJCSR0aGlzLT5tcGRmLT5jTWFyZ2luTCA9IDA7CgkJCSR0aGlzLT5tcGRmLT5jTWFyZ2luUiA9IDA7CgkJCSR0aGlzLT5tcGRmLT5jTWFyZ2luVCA9IDA7CgkJCSR0aGlzLT5tcGRmLT5jTWFyZ2luQiA9IDA7CgkJCSR0aGlzLT5tcGRmLT5jZWxsUGFkZGluZ0wgPSAwOwoJCQkkdGhpcy0+bXBkZi0+Y2VsbFBhZGRpbmdSID0gMDsKCQkJJHRoaXMtPm1wZGYtPmNlbGxQYWRkaW5nVCA9IDA7CgkJCSR0aGlzLT5tcGRmLT5jZWxsUGFkZGluZ0IgPSAwOwoKCQkJaWYgKGlzc2V0KCR0aGlzLT5tcGRmLT50YWJsZVsxXVsxXVsnb3ZlcmZsb3cnXSkgJiYgJHRoaXMtPm1wZGYtPnRhYmxlWzFdWzFdWydvdmVyZmxvdyddID09ICd2aXNpYmxlJykgewoJCQkJaWYgKCR0aGlzLT5tcGRmLT5rd3QgfHwgJHRoaXMtPm1wZGYtPnRhYmxlX3JvdGF0ZSB8fCAkdGhpcy0+bXBkZi0+dGFibGVfa2VlcF90b2dldGhlciB8fCAkdGhpcy0+bXBkZi0+Q29sQWN0aXZlKSB7CgkJCQkJJHRoaXMtPm1wZGYtPmt3dCA9IGZhbHNlOwoJCQkJCSR0aGlzLT5tcGRmLT50YWJsZV9yb3RhdGUgPSAwOwoJCQkJCSR0aGlzLT5tcGRmLT50YWJsZV9rZWVwX3RvZ2V0aGVyID0gZmFsc2U7CgkJCQkJLy90aHJvdyBuZXcgTXBkZkV4Y2VwdGlvbigibVBERiBXYXJuaW5nOiBZb3UgY2Fubm90IHVzZSBDU1Mgb3ZlcmZsb3c6dmlzaWJsZSB0b2dldGhlciB3aXRoIGFueSBvZiB0aGVzZSBmdW5jdGlvbnM6ICdLZWVwLXdpdGgtdGFibGUnLCByb3RhdGVkIHRhYmxlcywgcGFnZS1icmVhay1pbnNpZGU6YXZvaWQsIG9yIGNvbHVtbnMiKTsKCQkJCX0KCQkJCSR0aGlzLT5tcGRmLT5fdGFibGVDb2x1bW5XaWR0aCgkdGhpcy0+bXBkZi0+dGFibGVbMV1bMV0sIHRydWUpOwoJCQkJJHRoaXMtPm1wZGYtPl90YWJsZVdpZHRoKCR0aGlzLT5tcGRmLT50YWJsZVsxXVsxXSk7CgkJCX0gZWxzZSB7CgkJCQlpZiAoISR0aGlzLT5tcGRmLT5rd3Rfc2F2ZWQpIHsKCQkJCQkkdGhpcy0+bXBkZi0+a3d0X2hlaWdodCA9IDA7CgkJCQl9CgoJCQkJbGlzdCgkY2hlY2ssICR0YWJsZW1pdykgPSAkdGhpcy0+bXBkZi0+X3RhYmxlQ29sdW1uV2lkdGgoJHRoaXMtPm1wZGYtPnRhYmxlWzFdWzFdLCB0cnVlKTsKCQkJCSRzYXZlX3RhYmxlID0gJHRoaXMtPm1wZGYtPnRhYmxlOwoJCQkJJHJlc2V0X3RvX21pbmltdW1fd2lkdGggPSBmYWxzZTsKCQkJCSRhZGRlZF9wYWdlID0gZmFsc2U7CgoJCQkJaWYgKCRjaGVjayA+IDEpIHsKCQkJCQlpZiAoJGNoZWNrID4gJHRoaXMtPm1wZGYtPnNocmlua190aGlzX3RhYmxlX3RvX2ZpdCAmJiAkdGhpcy0+bXBkZi0+dGFibGVfcm90YXRlKSB7CgkJCQkJCWlmICgkdGhpcy0+bXBkZi0+eSAhPSAkdGhpcy0+bXBkZi0+dE1hcmdpbikgewoJCQkJCQkJJHRoaXMtPm1wZGYtPkFkZFBhZ2UoJHRoaXMtPm1wZGYtPkN1ck9yaWVudGF0aW9uKTsKCQkJCQkJCSR0aGlzLT5tcGRmLT5rd3RfbW92ZWQgPSB0cnVlOwoJCQkJCQl9CgkJCQkJCSRhZGRlZF9wYWdlID0gdHJ1ZTsKCQkJCQkJJHRoaXMtPm1wZGYtPnRicm90X21heHcgPSAkdGhpcy0+bXBkZi0+aCAtICgkdGhpcy0+bXBkZi0+eSArICR0aGlzLT5tcGRmLT5iTWFyZ2luICsgNSkgLSAkdGhpcy0+bXBkZi0+a3d0X2hlaWdodDsKCQkJCQkJLy8kY2hlY2sgPSAkdGFibGVtaXcvJHRoaXMtPm1wZGYtPnRicm90X21heHc7IAkvLyB1bmRvIGFueSBzaHJpbmsKCQkJCQkJJGNoZWNrID0gMTsgIC8vIHVuZG8gYW55IHNocmluawoJCQkJCX0KCQkJCQkkcmVzZXRfdG9fbWluaW11bV93aWR0aCA9IHRydWU7CgkJCQl9CgoJCQkJaWYgKCRyZXNldF90b19taW5pbXVtX3dpZHRoKSB7CgkJCQkJJHRoaXMtPm1wZGYtPnNocmluX2sgPSAkY2hlY2s7CgoJCQkJCSR0aGlzLT5tcGRmLT5kZWZhdWx0X2ZvbnRfc2l6ZSAvPSAkdGhpcy0+bXBkZi0+c2hyaW5fazsKCQkJCQkkdGhpcy0+bXBkZi0+U2V0Rm9udFNpemUoJHRoaXMtPm1wZGYtPmRlZmF1bHRfZm9udF9zaXplLCBmYWxzZSk7CgoJCQkJCSR0aGlzLT5tcGRmLT5zaHJpbmtUYWJsZSgkdGhpcy0+bXBkZi0+dGFibGVbMV1bMV0sICR0aGlzLT5tcGRmLT5zaHJpbl9rKTsKCgkJCQkJJHRoaXMtPm1wZGYtPl90YWJsZUNvbHVtbldpZHRoKCR0aGlzLT5tcGRmLT50YWJsZVsxXVsxXSwgZmFsc2UpOyAvLyByZXBlYXQKCQkJCQkvLyBTdGFydGluZyBhdCAkdGhpcy0+bXBkZi0+aW5uZXJtb3N0VGFibGVMZXZlbAoJCQkJCS8vIFNocmluayB0YWJsZSB2YWx1ZXMgLSBhbmQgcmVkbyBjb2x1bW5XaWR0aAoJCQkJCWZvciAoJGx2bCA9IDI7ICRsdmwgPD0gJHRoaXMtPm1wZGYtPmlubmVybW9zdFRhYmxlTGV2ZWw7ICRsdmwrKykgewoJCQkJCQlmb3IgKCRuaWQgPSAxOyAkbmlkIDw9ICR0aGlzLT5tcGRmLT50YmN0clskbHZsXTsgJG5pZCsrKSB7CgkJCQkJCQkkdGhpcy0+bXBkZi0+c2hyaW5rVGFibGUoJHRoaXMtPm1wZGYtPnRhYmxlWyRsdmxdWyRuaWRdLCAkdGhpcy0+bXBkZi0+c2hyaW5fayk7CgkJCQkJCQkkdGhpcy0+bXBkZi0+X3RhYmxlQ29sdW1uV2lkdGgoJHRoaXMtPm1wZGYtPnRhYmxlWyRsdmxdWyRuaWRdLCBmYWxzZSk7CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgoJCQkJLy8gU2V0IHRhYmxlIGNlbGwgd2lkdGhzIGZvciB0b3AgbGV2ZWwgdGFibGUKCQkJCS8vIFVzZSAkc2hyaW5fayB0byByZXNpemUgYnV0IGRvbid0IGNoYW5nZSBhZ2FpbgoJCQkJJHRoaXMtPm1wZGYtPlNldExpbmVIZWlnaHQoJycsICR0aGlzLT5tcGRmLT50YWJsZVsxXVsxXVsnY2VsbExpbmVIZWlnaHQnXSk7CgoJCQkJLy8gVG9wIGxldmVsIHRhYmxlCgkJCQkkdGhpcy0+bXBkZi0+X3RhYmxlV2lkdGgoJHRoaXMtPm1wZGYtPnRhYmxlWzFdWzFdKTsKCQkJfQoKCQkJLy8gTm93IHdvcmsgdGhyb3VnaCBhbnkgbmVzdGVkIHRhYmxlcyBzZXR0aW5nIGNoaWxkIHRhYmxlW3cnXSA9IHBhcmVudCBjZWxsWyd3J10KCQkJLy8gTm93IGRvIG5lc3RlZCB0YWJsZXMgX3RhYmxlV2lkdGgKCQkJZm9yICgkbHZsID0gMjsgJGx2bCA8PSAkdGhpcy0+bXBkZi0+aW5uZXJtb3N0VGFibGVMZXZlbDsgJGx2bCsrKSB7CgkJCQlmb3IgKCRuaWQgPSAxOyAkbmlkIDw9ICR0aGlzLT5tcGRmLT50YmN0clskbHZsXTsgJG5pZCsrKSB7CgkJCQkJLy8gSEVSRSBzZXQgY2hpbGQgdGFibGUgd2lkdGggPSBjZWxsIHdpZHRoCgoJCQkJCWxpc3QoJHBhcmVudHJvdywgJHBhcmVudGNvbCwgJHBhcmVudG5pZCkgPSAkdGhpcy0+bXBkZi0+dGFibGVbJGx2bF1bJG5pZF1bJ25lc3RlZHBvcyddOwoKCQkJCQkkYyA9ICYgJHRoaXMtPm1wZGYtPnRhYmxlWygkbHZsIC0gMSldWyRwYXJlbnRuaWRdWydjZWxscyddWyRwYXJlbnRyb3ddWyRwYXJlbnRjb2xdOwoKCQkJCQlpZiAoaXNzZXQoJGNbJ2NvbHNwYW4nXSkgJiYgJGNbJ2NvbHNwYW4nXSA+IDEpIHsKCQkJCQkJJHBhcmVudHdpZHRoID0gMDsKCQkJCQkJZm9yICgkY3MgPSAwOyAkY3MgPCAkY1snY29sc3BhbiddOyAkY3MrKykgewoJCQkJCQkJJHBhcmVudHdpZHRoICs9ICR0aGlzLT5tcGRmLT50YWJsZVsoJGx2bCAtIDEpXVskcGFyZW50bmlkXVsnd2MnXVskcGFyZW50Y29sICsgJGNzXTsKCQkJCQkJfQoJCQkJCX0gZWxzZSB7CgkJCQkJCSRwYXJlbnR3aWR0aCA9ICR0aGlzLT5tcGRmLT50YWJsZVsoJGx2bCAtIDEpXVskcGFyZW50bmlkXVsnd2MnXVskcGFyZW50Y29sXTsKCQkJCQl9CgoKCQkJCQkvLyRwYXJlbnR3aWR0aCAtPSBBTExPVyBGT1IgUEFERElORyBFVEMuaW4gcGFyZW50IGNlbGwKCQkJCQlpZiAoISR0aGlzLT5tcGRmLT5zaW1wbGVUYWJsZXMpIHsKCQkJCQkJaWYgKCR0aGlzLT5tcGRmLT5wYWNrVGFibGVEYXRhKSB7CgkJCQkJCQlsaXN0KCRidCwgJGJyLCAkYmIsICRibCkgPSAkdGhpcy0+bXBkZi0+X2dldEJvcmRlcldpZHRocygkY1snYm9yZGVyYmluJ10pOwoJCQkJCQl9IGVsc2UgewoJCQkJCQkJJGJyID0gJGNbJ2JvcmRlcl9kZXRhaWxzJ11bJ1InXVsndyddOwoJCQkJCQkJJGJsID0gJGNbJ2JvcmRlcl9kZXRhaWxzJ11bJ0wnXVsndyddOwoJCQkJCQl9CgkJCQkJCWlmICgkdGhpcy0+bXBkZi0+dGFibGVbJGx2bCAtIDFdWyRwYXJlbnRuaWRdWydib3JkZXJzX3NlcGFyYXRlJ10pIHsKCQkJCQkJCSRwYXJlbnR3aWR0aCAtPSAkYnIgKyAkYmwgKyAkY1sncGFkZGluZyddWydMJ10gKyAkY1sncGFkZGluZyddWydSJ10gKyAkdGhpcy0+bXBkZi0+dGFibGVbKCRsdmwgLSAxKV1bJHBhcmVudG5pZF1bJ2JvcmRlcl9zcGFjaW5nX0gnXTsKCQkJCQkJfSBlbHNlIHsKCQkJCQkJCSRwYXJlbnR3aWR0aCAtPSAkYnIgLyAyICsgJGJsIC8gMiArICRjWydwYWRkaW5nJ11bJ0wnXSArICRjWydwYWRkaW5nJ11bJ1InXTsKCQkJCQkJfQoJCQkJCX0gZWxzZSBpZiAoJHRoaXMtPm1wZGYtPnNpbXBsZVRhYmxlcykgewoJCQkJCQlpZiAoJHRoaXMtPm1wZGYtPnRhYmxlWyRsdmwgLSAxXVskcGFyZW50bmlkXVsnYm9yZGVyc19zZXBhcmF0ZSddKSB7CgkJCQkJCQkkcGFyZW50d2lkdGggLT0gJHRoaXMtPm1wZGYtPnRhYmxlWygkbHZsIC0gMSldWyRwYXJlbnRuaWRdWydzaW1wbGUnXVsnYm9yZGVyX2RldGFpbHMnXVsnTCddWyd3J10gKyAkdGhpcy0+bXBkZi0+dGFibGVbKCRsdmwgLSAxKV1bJHBhcmVudG5pZF1bJ3NpbXBsZSddWydib3JkZXJfZGV0YWlscyddWydSJ11bJ3cnXSArICRjWydwYWRkaW5nJ11bJ0wnXSArICRjWydwYWRkaW5nJ11bJ1InXSArICR0aGlzLT5tcGRmLT50YWJsZVsoJGx2bCAtIDEpXVskcGFyZW50bmlkXVsnYm9yZGVyX3NwYWNpbmdfSCddOwoJCQkJCQl9IGVsc2UgewoJCQkJCQkJJHBhcmVudHdpZHRoIC09ICR0aGlzLT5tcGRmLT50YWJsZVsoJGx2bCAtIDEpXVskcGFyZW50bmlkXVsnc2ltcGxlJ11bJ2JvcmRlcl9kZXRhaWxzJ11bJ0wnXVsndyddIC8gMiArICR0aGlzLT5tcGRmLT50YWJsZVsoJGx2bCAtIDEpXVskcGFyZW50bmlkXVsnc2ltcGxlJ11bJ2JvcmRlcl9kZXRhaWxzJ11bJ1InXVsndyddIC8gMiArICRjWydwYWRkaW5nJ11bJ0wnXSArICRjWydwYWRkaW5nJ11bJ1InXTsKCQkJCQkJfQoJCQkJCX0KCQkJCQlpZiAoaXNzZXQoJHRoaXMtPm1wZGYtPnRhYmxlWyRsdmxdWyRuaWRdWyd3cGVyY2VudCddKSAmJiAkdGhpcy0+bXBkZi0+dGFibGVbJGx2bF1bJG5pZF1bJ3dwZXJjZW50J10gJiYgJGx2bCA+IDEpIHsKCQkJCQkJJHRoaXMtPm1wZGYtPnRhYmxlWyRsdmxdWyRuaWRdWyd3J10gPSAkcGFyZW50d2lkdGg7CgkJCQkJfSBlbHNlIGlmICgkcGFyZW50d2lkdGggPiAkdGhpcy0+bXBkZi0+dGFibGVbJGx2bF1bJG5pZF1bJ21hdyddKSB7CgkJCQkJCSR0aGlzLT5tcGRmLT50YWJsZVskbHZsXVskbmlkXVsndyddID0gJHRoaXMtPm1wZGYtPnRhYmxlWyRsdmxdWyRuaWRdWydtYXcnXTsKCQkJCQl9IGVsc2UgewoJCQkJCQkkdGhpcy0+bXBkZi0+dGFibGVbJGx2bF1bJG5pZF1bJ3cnXSA9ICRwYXJlbnR3aWR0aDsKCQkJCQl9CgkJCQkJdW5zZXQoJGMpOwoJCQkJCSR0aGlzLT5tcGRmLT5fdGFibGVXaWR0aCgkdGhpcy0+bXBkZi0+dGFibGVbJGx2bF1bJG5pZF0pOwoJCQkJfQoJCQl9CgoJCQkvLyBTdGFydGluZyBhdCAkdGhpcy0+bXBkZi0+aW5uZXJtb3N0VGFibGVMZXZlbAoJCQkvLyBDYXNjYWRlIGJhY2sgdXAgbmVzdGVkIHRhYmxlczogc2V0dGluZyBoZWlnaHRzIGJhY2sgdXAgdGhlIHRyZWUKCQkJZm9yICgkbHZsID0gJHRoaXMtPm1wZGYtPmlubmVybW9zdFRhYmxlTGV2ZWw7ICRsdmwgPiAwOyAkbHZsLS0pIHsKCQkJCWZvciAoJG5pZCA9IDE7ICRuaWQgPD0gJHRoaXMtPm1wZGYtPnRiY3RyWyRsdmxdOyAkbmlkKyspIHsKCQkJCQlsaXN0KCR0YWJsZWhlaWdodCwgJG1heHJvd2hlaWdodCwgJGZ1bGxwYWdlLCAkcmVtYWluaW5ncGFnZSwgJG1heGZpcnN0cm93aGVpZ2h0KSA9ICR0aGlzLT5tcGRmLT5fdGFibGVIZWlnaHQoJHRoaXMtPm1wZGYtPnRhYmxlWyRsdmxdWyRuaWRdKTsKCQkJCX0KCQkJfQoJCQlpZiAoJHRoaXMtPm1wZGYtPnByb2dyZXNzQmFyKSB7CgkJCQkkdGhpcy0+bXBkZi0+VXBkYXRlUHJvZ3Jlc3NCYXIoNywgMjAsICcgJyk7CgkJCX0gLy8gKlBST0dSRVNTLUJBUioKCQkJaWYgKCR0aGlzLT5tcGRmLT50YWJsZVsxXVsxXVsnb3ZlcmZsb3cnXSA9PSAndmlzaWJsZScpIHsKCQkJCWlmICgkbWF4cm93aGVpZ2h0ID4gJGZ1bGxwYWdlKSB7CgkJCQkJdGhyb3cgbmV3IE1wZGZFeGNlcHRpb24oIm1QREYgV2FybmluZzogQSBUYWJsZSByb3cgaXMgZ3JlYXRlciB0aGFuIGF2YWlsYWJsZSBoZWlnaHQuIFlvdSBjYW5ub3QgdXNlIENTUyBvdmVyZmxvdzp2aXNpYmxlIik7CgkJCQl9CgkJCQlpZiAoJG1heGZpcnN0cm93aGVpZ2h0ID4gJHJlbWFpbmluZ3BhZ2UpIHsKCQkJCQkkdGhpcy0+bXBkZi0+QWRkUGFnZSgkdGhpcy0+bXBkZi0+Q3VyT3JpZW50YXRpb24pOwoJCQkJfQoJCQkJJHIgPSAwOwoJCQkJJGMgPSAwOwoJCQkJJHAgPSAwOwoJCQkJJHkgPSAwOwoJCQkJJGZpbmlzaGVkID0gZmFsc2U7CgkJCQl3aGlsZSAoISRmaW5pc2hlZCkgewoJCQkJCWxpc3QoJGZpbmlzaGVkLCAkciwgJGMsICRwLCAkeSwgJHkwKSA9ICR0aGlzLT5tcGRmLT5fdGFibGVXcml0ZSgkdGhpcy0+bXBkZi0+dGFibGVbMV1bMV0sIHRydWUsICRyLCAkYywgJHAsICR5KTsKCQkJCQlpZiAoISRmaW5pc2hlZCkgewoJCQkJCQkkdGhpcy0+bXBkZi0+QWRkUGFnZSgkdGhpcy0+bXBkZi0+Q3VyT3JpZW50YXRpb24pOwoJCQkJCQkvLyBJZiBwcmludGVkIHNvbWV0aGluZyBvbiBmaXJzdCBzcHJlYWQsIHNldCBzYW1lIHkKCQkJCQkJaWYgKCRyID09IDAgJiYgJHkwID4gLTEpIHsKCQkJCQkJCSR0aGlzLT5tcGRmLT55ID0gJHkwOwoJCQkJCQl9CgkJCQkJfQoJCQkJfQoJCQl9IGVsc2UgewoJCQkJJHJlY2FsY3VsYXRlID0gMTsKCQkJCSRmb3JjZXJlY2FsYyA9IGZhbHNlOwoJCQkJLy8gUkVTSVpJTkcgQUxHT1JJVEhNCgkJCQlpZiAoJG1heHJvd2hlaWdodCA+ICRmdWxscGFnZSkgewoJCQkJCSRyZWNhbGN1bGF0ZSA9ICR0aGlzLT5tcGRmLT50YnNxcnQoJG1heHJvd2hlaWdodCAvICRmdWxscGFnZSwgMSk7CgkJCQkJJGZvcmNlcmVjYWxjID0gdHJ1ZTsKCQkJCX0gZWxzZSBpZiAoJHRoaXMtPm1wZGYtPnRhYmxlX3JvdGF0ZSkgeyAvLyBOQiAkcmVtYWluaW5ncGFnZSA9PSAkZnVsbHBhZ2UgPT0gdGhlIHdpZHRoIG9mIHRoZSBwYWdlCgkJCQkJaWYgKCR0YWJsZWhlaWdodCA+ICRyZW1haW5pbmdwYWdlKSB7CgkJCQkJCS8vIElmIGNhbiBmaXQgb24gcmVtYWluZGVyIG9mIHBhZ2Ugd2hpbHN0IHJlc3BlY3RpbmcgYXV0c2l6ZSB2YWx1ZS4uCgkJCQkJCWlmICgoJHRoaXMtPm1wZGYtPnNocmluX2sgKiAkdGhpcy0+bXBkZi0+dGJzcXJ0KCR0YWJsZWhlaWdodCAvICRyZW1haW5pbmdwYWdlLCAxKSkgPD0gJHRoaXMtPm1wZGYtPnNocmlua190aGlzX3RhYmxlX3RvX2ZpdCkgewoJCQkJCQkJJHJlY2FsY3VsYXRlID0gJHRoaXMtPm1wZGYtPnRic3FydCgkdGFibGVoZWlnaHQgLyAkcmVtYWluaW5ncGFnZSwgMSk7CgkJCQkJCX0gZWxzZSBpZiAoISRhZGRlZF9wYWdlKSB7CgkJCQkJCQlpZiAoJHRoaXMtPm1wZGYtPnkgIT0gJHRoaXMtPm1wZGYtPnRNYXJnaW4pIHsKCQkJCQkJCQkkdGhpcy0+bXBkZi0+QWRkUGFnZSgkdGhpcy0+bXBkZi0+Q3VyT3JpZW50YXRpb24pOwoJCQkJCQkJCSR0aGlzLT5tcGRmLT5rd3RfbW92ZWQgPSB0cnVlOwoJCQkJCQkJfQoJCQkJCQkJJGFkZGVkX3BhZ2UgPSB0cnVlOwoJCQkJCQkJJHRoaXMtPm1wZGYtPnRicm90X21heHcgPSAkdGhpcy0+bXBkZi0+aCAtICgkdGhpcy0+bXBkZi0+eSArICR0aGlzLT5tcGRmLT5iTWFyZ2luICsgNSkgLSAkdGhpcy0+bXBkZi0+a3d0X2hlaWdodDsKCQkJCQkJCS8vIDAuMDAxIHRvIGZvcmNlIGl0IHRvIHJlY2FsY3VsYXRlCgkJCQkJCQkkcmVjYWxjdWxhdGUgPSAoMSAvICR0aGlzLT5tcGRmLT5zaHJpbl9rKSArIDAuMDAxOyAgLy8gdW5kbyBhbnkgc2hyaW5rCgkJCQkJCX0KCQkJCQl9IGVsc2UgewoJCQkJCQkkcmVjYWxjdWxhdGUgPSAxOwoJCQkJCX0KCQkJCX0gZWxzZSBpZiAoJHRoaXMtPm1wZGYtPnRhYmxlX2tlZXBfdG9nZXRoZXIgfHwgKCR0aGlzLT5tcGRmLT50YWJsZVsxXVsxXVsnbnInXSA9PSAxICYmICEkdGhpcy0+bXBkZi0+d3JpdGluZ0hUTUxmb290ZXIpKSB7CgkJCQkJaWYgKCR0YWJsZWhlaWdodCA+ICRmdWxscGFnZSkgewoJCQkJCQlpZiAoKCR0aGlzLT5tcGRmLT5zaHJpbl9rICogJHRoaXMtPm1wZGYtPnRic3FydCgkdGFibGVoZWlnaHQgLyAkZnVsbHBhZ2UsIDEpKSA8PSAkdGhpcy0+bXBkZi0+c2hyaW5rX3RoaXNfdGFibGVfdG9fZml0KSB7CgkJCQkJCQkkcmVjYWxjdWxhdGUgPSAkdGhpcy0+bXBkZi0+dGJzcXJ0KCR0YWJsZWhlaWdodCAvICRmdWxscGFnZSwgMSk7CgkJCQkJCX0gZWxzZSBpZiAoJHRoaXMtPm1wZGYtPnRhYmxlTWluU2l6ZVByaW9yaXR5KSB7CgkJCQkJCQkkdGhpcy0+bXBkZi0+dGFibGVfa2VlcF90b2dldGhlciA9IGZhbHNlOwoJCQkJCQkJJHJlY2FsY3VsYXRlID0gMS4wMDE7CgkJCQkJCX0gZWxzZSB7CgkJCQkJCQlpZiAoJHRoaXMtPm1wZGYtPnkgIT0gJHRoaXMtPm1wZGYtPnRNYXJnaW4pIHsKCQkJCQkJCQkkdGhpcy0+bXBkZi0+QWRkUGFnZSgkdGhpcy0+bXBkZi0+Q3VyT3JpZW50YXRpb24pOwoJCQkJCQkJCSR0aGlzLT5tcGRmLT5rd3RfbW92ZWQgPSB0cnVlOwoJCQkJCQkJfQoJCQkJCQkJJGFkZGVkX3BhZ2UgPSB0cnVlOwoJCQkJCQkJJHRoaXMtPm1wZGYtPnRicm90X21heHcgPSAkdGhpcy0+bXBkZi0+aCAtICgkdGhpcy0+bXBkZi0+eSArICR0aGlzLT5tcGRmLT5iTWFyZ2luICsgNSkgLSAkdGhpcy0+bXBkZi0+a3d0X2hlaWdodDsKCQkJCQkJCSRyZWNhbGN1bGF0ZSA9ICR0aGlzLT5tcGRmLT50YnNxcnQoJHRhYmxlaGVpZ2h0IC8gJGZ1bGxwYWdlLCAxKTsKCQkJCQkJfQoJCQkJCX0gZWxzZSBpZiAoJHRhYmxlaGVpZ2h0ID4gJHJlbWFpbmluZ3BhZ2UpIHsKCQkJCQkJLy8gSWYgY2FuIGZpdCBvbiByZW1haW5kZXIgb2YgcGFnZSB3aGlsc3QgcmVzcGVjdGluZyBhdXRzaXplIHZhbHVlLi4KCQkJCQkJaWYgKCgkdGhpcy0+bXBkZi0+c2hyaW5fayAqICR0aGlzLT5tcGRmLT50YnNxcnQoJHRhYmxlaGVpZ2h0IC8gJHJlbWFpbmluZ3BhZ2UsIDEpKSA8PSAkdGhpcy0+bXBkZi0+c2hyaW5rX3RoaXNfdGFibGVfdG9fZml0KSB7CgkJCQkJCQkkcmVjYWxjdWxhdGUgPSAkdGhpcy0+bXBkZi0+dGJzcXJ0KCR0YWJsZWhlaWdodCAvICRyZW1haW5pbmdwYWdlLCAxKTsKCQkJCQkJfSBlbHNlIHsKCQkJCQkJCWlmICgkdGhpcy0+bXBkZi0+eSAhPSAkdGhpcy0+bXBkZi0+dE1hcmdpbikgewoJCQkJCQkJCS8vIG1QREYgNgoJCQkJCQkJCWlmICgkdGhpcy0+bXBkZi0+QWNjZXB0UGFnZUJyZWFrKCkpIHsKCQkJCQkJCQkJJHRoaXMtPm1wZGYtPkFkZFBhZ2UoJHRoaXMtPm1wZGYtPkN1ck9yaWVudGF0aW9uKTsKCQkJCQkJCQl9IGVsc2UgaWYgKCR0aGlzLT5tcGRmLT5Db2xBY3RpdmUgJiYgJHRhYmxlaGVpZ2h0ID4gKCgkdGhpcy0+bXBkZi0+aCAtICR0aGlzLT5tcGRmLT5iTWFyZ2luKSAtICR0aGlzLT5tcGRmLT55MCkpIHsKCQkJCQkJCQkJJHRoaXMtPm1wZGYtPkFkZFBhZ2UoJHRoaXMtPm1wZGYtPkN1ck9yaWVudGF0aW9uKTsKCQkJCQkJCQl9CgkJCQkJCQkJJHRoaXMtPm1wZGYtPmt3dF9tb3ZlZCA9IHRydWU7CgkJCQkJCQl9CgkJCQkJCQkkYWRkZWRfcGFnZSA9IHRydWU7CgkJCQkJCQkkdGhpcy0+bXBkZi0+dGJyb3RfbWF4dyA9ICR0aGlzLT5tcGRmLT5oIC0gKCR0aGlzLT5tcGRmLT55ICsgJHRoaXMtPm1wZGYtPmJNYXJnaW4gKyA1KSAtICR0aGlzLT5tcGRmLT5rd3RfaGVpZ2h0OwoJCQkJCQkJJHJlY2FsY3VsYXRlID0gMS4wMDE7CgkJCQkJCX0KCQkJCQl9IGVsc2UgewoJCQkJCQkkcmVjYWxjdWxhdGUgPSAxOwoJCQkJCX0KCQkJCX0gZWxzZSB7CgkJCQkJJHJlY2FsY3VsYXRlID0gMTsKCQkJCX0KCgkJCQlpZiAoJHJlY2FsY3VsYXRlID4gJHRoaXMtPm1wZGYtPnNocmlua190aGlzX3RhYmxlX3RvX2ZpdCAmJiAhJGZvcmNlcmVjYWxjKSB7CgkJCQkJJHJlY2FsY3VsYXRlID0gJHRoaXMtPm1wZGYtPnNocmlua190aGlzX3RhYmxlX3RvX2ZpdDsKCQkJCX0KCgkJCQkkaXRlcmF0aW9uID0gMTsKCgkJCQkvLyBSRUNBTENVTEFURQoJCQkJd2hpbGUgKCRyZWNhbGN1bGF0ZSA8PiAxKSB7CgkJCQkJJHRoaXMtPm1wZGYtPnNocmluX2sxID0gJHJlY2FsY3VsYXRlOwoJCQkJCSR0aGlzLT5tcGRmLT5zaHJpbl9rICo9ICRyZWNhbGN1bGF0ZTsKCQkJCQkkdGhpcy0+bXBkZi0+ZGVmYXVsdF9mb250X3NpemUgLz0gKCR0aGlzLT5tcGRmLT5zaHJpbl9rMSk7CgkJCQkJJHRoaXMtPm1wZGYtPlNldEZvbnRTaXplKCR0aGlzLT5tcGRmLT5kZWZhdWx0X2ZvbnRfc2l6ZSwgZmFsc2UpOwoJCQkJCSR0aGlzLT5tcGRmLT5TZXRMaW5lSGVpZ2h0KCcnLCAkdGhpcy0+bXBkZi0+dGFibGVbMV1bMV1bJ2NlbGxMaW5lSGVpZ2h0J10pOwoJCQkJCSR0aGlzLT5tcGRmLT50YWJsZSA9ICRzYXZlX3RhYmxlOwoJCQkJCWlmICgkdGhpcy0+bXBkZi0+c2hyaW5fayA8PiAxKSB7CgkJCQkJCSR0aGlzLT5tcGRmLT5zaHJpbmtUYWJsZSgkdGhpcy0+bXBkZi0+dGFibGVbMV1bMV0sICR0aGlzLT5tcGRmLT5zaHJpbl9rKTsKCQkJCQl9CgkJCQkJJHRoaXMtPm1wZGYtPl90YWJsZUNvbHVtbldpZHRoKCR0aGlzLT5tcGRmLT50YWJsZVsxXVsxXSwgZmFsc2UpOyAvLyByZXBlYXQKCQkJCQkvLyBTdGFydGluZyBhdCAkdGhpcy0+bXBkZi0+aW5uZXJtb3N0VGFibGVMZXZlbAoJCQkJCS8vIFNocmluayB0YWJsZSB2YWx1ZXMgLSBhbmQgcmVkbyBjb2x1bW5XaWR0aAoJCQkJCWZvciAoJGx2bCA9IDI7ICRsdmwgPD0gJHRoaXMtPm1wZGYtPmlubmVybW9zdFRhYmxlTGV2ZWw7ICRsdmwrKykgewoJCQkJCQlmb3IgKCRuaWQgPSAxOyAkbmlkIDw9ICR0aGlzLT5tcGRmLT50YmN0clskbHZsXTsgJG5pZCsrKSB7CgkJCQkJCQlpZiAoJHRoaXMtPm1wZGYtPnNocmluX2sgPD4gMSkgewoJCQkJCQkJCSR0aGlzLT5tcGRmLT5zaHJpbmtUYWJsZSgkdGhpcy0+bXBkZi0+dGFibGVbJGx2bF1bJG5pZF0sICR0aGlzLT5tcGRmLT5zaHJpbl9rKTsKCQkJCQkJCX0KCQkJCQkJCSR0aGlzLT5tcGRmLT5fdGFibGVDb2x1bW5XaWR0aCgkdGhpcy0+bXBkZi0+dGFibGVbJGx2bF1bJG5pZF0sIGZhbHNlKTsKCQkJCQkJfQoJCQkJCX0KCQkJCQkvLyBTZXQgdGFibGUgY2VsbCB3aWR0aHMgZm9yIHRvcCBsZXZlbCB0YWJsZQoJCQkJCS8vIFRvcCBsZXZlbCB0YWJsZQoJCQkJCSR0aGlzLT5tcGRmLT5fdGFibGVXaWR0aCgkdGhpcy0+bXBkZi0+dGFibGVbMV1bMV0pOwoKCQkJCQkvLyBOb3cgd29yayB0aHJvdWdoIGFueSBuZXN0ZWQgdGFibGVzIHNldHRpbmcgY2hpbGQgdGFibGVbdyddID0gcGFyZW50IGNlbGxbJ3cnXQoJCQkJCS8vIE5vdyBkbyBuZXN0ZWQgdGFibGVzIF90YWJsZVdpZHRoCgkJCQkJZm9yICgkbHZsID0gMjsgJGx2bCA8PSAkdGhpcy0+bXBkZi0+aW5uZXJtb3N0VGFibGVMZXZlbDsgJGx2bCsrKSB7CgkJCQkJCWZvciAoJG5pZCA9IDE7ICRuaWQgPD0gJHRoaXMtPm1wZGYtPnRiY3RyWyRsdmxdOyAkbmlkKyspIHsKCQkJCQkJCS8vIEhFUkUgc2V0IGNoaWxkIHRhYmxlIHdpZHRoID0gY2VsbCB3aWR0aAoKCQkJCQkJCWxpc3QoJHBhcmVudHJvdywgJHBhcmVudGNvbCwgJHBhcmVudG5pZCkgPSAkdGhpcy0+bXBkZi0+dGFibGVbJGx2bF1bJG5pZF1bJ25lc3RlZHBvcyddOwoJCQkJCQkJJGMgPSAmICR0aGlzLT5tcGRmLT50YWJsZVsoJGx2bCAtIDEpXVskcGFyZW50bmlkXVsnY2VsbHMnXVskcGFyZW50cm93XVskcGFyZW50Y29sXTsKCgkJCQkJCQlpZiAoaXNzZXQoJGNbJ2NvbHNwYW4nXSkgJiYgJGNbJ2NvbHNwYW4nXSA+IDEpIHsKCQkJCQkJCQkkcGFyZW50d2lkdGggPSAwOwoJCQkJCQkJCWZvciAoJGNzID0gMDsgJGNzIDwgJGNbJ2NvbHNwYW4nXTsgJGNzKyspIHsKCQkJCQkJCQkJJHBhcmVudHdpZHRoICs9ICR0aGlzLT5tcGRmLT50YWJsZVsoJGx2bCAtIDEpXVskcGFyZW50bmlkXVsnd2MnXVskcGFyZW50Y29sICsgJGNzXTsKCQkJCQkJCQl9CgkJCQkJCQl9IGVsc2UgewoJCQkJCQkJCSRwYXJlbnR3aWR0aCA9ICR0aGlzLT5tcGRmLT50YWJsZVsoJGx2bCAtIDEpXVskcGFyZW50bmlkXVsnd2MnXVskcGFyZW50Y29sXTsKCQkJCQkJCX0KCgkJCQkJCQkvLyRwYXJlbnR3aWR0aCAtPSBBTExPVyBGT1IgUEFERElORyBFVEMuaW4gcGFyZW50IGNlbGwKCQkJCQkJCWlmICghJHRoaXMtPm1wZGYtPnNpbXBsZVRhYmxlcykgewoJCQkJCQkJCWlmICgkdGhpcy0+bXBkZi0+cGFja1RhYmxlRGF0YSkgewoJCQkJCQkJCQlsaXN0KCRidCwgJGJyLCAkYmIsICRibCkgPSAkdGhpcy0+bXBkZi0+X2dldEJvcmRlcldpZHRocygkY1snYm9yZGVyYmluJ10pOwoJCQkJCQkJCX0gZWxzZSB7CgkJCQkJCQkJCSRiciA9ICRjWydib3JkZXJfZGV0YWlscyddWydSJ11bJ3cnXTsKCQkJCQkJCQkJJGJsID0gJGNbJ2JvcmRlcl9kZXRhaWxzJ11bJ0wnXVsndyddOwoJCQkJCQkJCX0KCQkJCQkJCQlpZiAoJHRoaXMtPm1wZGYtPnRhYmxlWyRsdmwgLSAxXVskcGFyZW50bmlkXVsnYm9yZGVyc19zZXBhcmF0ZSddKSB7CgkJCQkJCQkJCSRwYXJlbnR3aWR0aCAtPSAkYnIgKyAkYmwgKyAkY1sncGFkZGluZyddWydMJ10gKyAkY1sncGFkZGluZyddWydSJ10gKyAkdGhpcy0+bXBkZi0+dGFibGVbKCRsdmwgLSAxKV1bJHBhcmVudG5pZF1bJ2JvcmRlcl9zcGFjaW5nX0gnXTsKCQkJCQkJCQl9IGVsc2UgewoJCQkJCQkJCQkkcGFyZW50d2lkdGggLT0gJGJyIC8gMiArICRibCAvIDIgKyAkY1sncGFkZGluZyddWydMJ10gKyAkY1sncGFkZGluZyddWydSJ107CgkJCQkJCQkJfQoJCQkJCQkJfSBlbHNlIGlmICgkdGhpcy0+bXBkZi0+c2ltcGxlVGFibGVzKSB7CgkJCQkJCQkJaWYgKCR0aGlzLT5tcGRmLT50YWJsZVskbHZsIC0gMV1bJHBhcmVudG5pZF1bJ2JvcmRlcnNfc2VwYXJhdGUnXSkgewoJCQkJCQkJCQkkcGFyZW50d2lkdGggLT0gJHRoaXMtPm1wZGYtPnRhYmxlWygkbHZsIC0gMSldWyRwYXJlbnRuaWRdWydzaW1wbGUnXVsnYm9yZGVyX2RldGFpbHMnXVsnTCddWyd3J10gKyAkdGhpcy0+bXBkZi0+dGFibGVbKCRsdmwgLSAxKV1bJHBhcmVudG5pZF1bJ3NpbXBsZSddWydib3JkZXJfZGV0YWlscyddWydSJ11bJ3cnXSArICRjWydwYWRkaW5nJ11bJ0wnXSArICRjWydwYWRkaW5nJ11bJ1InXSArICR0aGlzLT5tcGRmLT50YWJsZVsoJGx2bCAtIDEpXVskcGFyZW50bmlkXVsnYm9yZGVyX3NwYWNpbmdfSCddOwoJCQkJCQkJCX0gZWxzZSB7CgkJCQkJCQkJCSRwYXJlbnR3aWR0aCAtPSAoJHRoaXMtPm1wZGYtPnRhYmxlWygkbHZsIC0gMSldWyRwYXJlbnRuaWRdWydzaW1wbGUnXVsnYm9yZGVyX2RldGFpbHMnXVsnTCddWyd3J10gKyAkdGhpcy0+bXBkZi0+dGFibGVbKCRsdmwgLSAxKV1bJHBhcmVudG5pZF1bJ3NpbXBsZSddWydib3JkZXJfZGV0YWlscyddWydSJ11bJ3cnXSkgLyAyICsgJGNbJ3BhZGRpbmcnXVsnTCddICsgJGNbJ3BhZGRpbmcnXVsnUiddOwoJCQkJCQkJCX0KCQkJCQkJCX0KCQkJCQkJCWlmIChpc3NldCgkdGhpcy0+bXBkZi0+dGFibGVbJGx2bF1bJG5pZF1bJ3dwZXJjZW50J10pICYmICR0aGlzLT5tcGRmLT50YWJsZVskbHZsXVskbmlkXVsnd3BlcmNlbnQnXSAmJiAkbHZsID4gMSkgewoJCQkJCQkJCSR0aGlzLT5tcGRmLT50YWJsZVskbHZsXVskbmlkXVsndyddID0gJHBhcmVudHdpZHRoOwoJCQkJCQkJfSBlbHNlIGlmICgkcGFyZW50d2lkdGggPiAkdGhpcy0+bXBkZi0+dGFibGVbJGx2bF1bJG5pZF1bJ21hdyddKSB7CgkJCQkJCQkJJHRoaXMtPm1wZGYtPnRhYmxlWyRsdmxdWyRuaWRdWyd3J10gPSAkdGhpcy0+bXBkZi0+dGFibGVbJGx2bF1bJG5pZF1bJ21hdyddOwoJCQkJCQkJfSBlbHNlIHsKCQkJCQkJCQkkdGhpcy0+bXBkZi0+dGFibGVbJGx2bF1bJG5pZF1bJ3cnXSA9ICRwYXJlbnR3aWR0aDsKCQkJCQkJCX0KCQkJCQkJCXVuc2V0KCRjKTsKCQkJCQkJCSR0aGlzLT5tcGRmLT5fdGFibGVXaWR0aCgkdGhpcy0+bXBkZi0+dGFibGVbJGx2bF1bJG5pZF0pOwoJCQkJCQl9CgkJCQkJfQoKCQkJCQkvLyBTdGFydGluZyBhdCAkdGhpcy0+bXBkZi0+aW5uZXJtb3N0VGFibGVMZXZlbAoJCQkJCS8vIENhc2NhZGUgYmFjayB1cCBuZXN0ZWQgdGFibGVzOiBzZXR0aW5nIGhlaWdodHMgYmFjayB1cCB0aGUgdHJlZQoJCQkJCWZvciAoJGx2bCA9ICR0aGlzLT5tcGRmLT5pbm5lcm1vc3RUYWJsZUxldmVsOyAkbHZsID4gMDsgJGx2bC0tKSB7CgkJCQkJCWZvciAoJG5pZCA9IDE7ICRuaWQgPD0gJHRoaXMtPm1wZGYtPnRiY3RyWyRsdmxdOyAkbmlkKyspIHsKCQkJCQkJCWxpc3QoJHRhYmxlaGVpZ2h0LCAkbWF4cm93aGVpZ2h0LCAkZnVsbHBhZ2UsICRyZW1haW5pbmdwYWdlLCAkbWF4Zmlyc3Ryb3doZWlnaHQpID0gJHRoaXMtPm1wZGYtPl90YWJsZUhlaWdodCgkdGhpcy0+bXBkZi0+dGFibGVbJGx2bF1bJG5pZF0pOwoJCQkJCQl9CgkJCQkJfQoKCQkJCQkvLyBSRVNJWklORyBBTEdPUklUSE0KCgkJCQkJaWYgKCRtYXhyb3doZWlnaHQgPiAkZnVsbHBhZ2UpIHsKCQkJCQkJJHJlY2FsY3VsYXRlID0gJHRoaXMtPm1wZGYtPnRic3FydCgkbWF4cm93aGVpZ2h0IC8gJGZ1bGxwYWdlLCAkaXRlcmF0aW9uKTsKCQkJCQkJJGl0ZXJhdGlvbisrOwoJCQkJCX0gZWxzZSBpZiAoJHRoaXMtPm1wZGYtPnRhYmxlX3JvdGF0ZSAmJiAkdGFibGVoZWlnaHQgPiAkcmVtYWluaW5ncGFnZSAmJiAhJGFkZGVkX3BhZ2UpIHsKCQkJCQkJLy8gSWYgY2FuIGZpdCBvbiByZW1haW5kZXIgb2YgcGFnZSB3aGlsc3QgcmVzcGVjdGluZyBhdXRvc2l6ZSB2YWx1ZS4uCgkJCQkJCWlmICgoJHRoaXMtPm1wZGYtPnNocmluX2sgKiAkdGhpcy0+bXBkZi0+dGJzcXJ0KCR0YWJsZWhlaWdodCAvICRyZW1haW5pbmdwYWdlLCAkaXRlcmF0aW9uKSkgPD0gJHRoaXMtPm1wZGYtPnNocmlua190aGlzX3RhYmxlX3RvX2ZpdCkgewoJCQkJCQkJJHJlY2FsY3VsYXRlID0gJHRoaXMtPm1wZGYtPnRic3FydCgkdGFibGVoZWlnaHQgLyAkcmVtYWluaW5ncGFnZSwgJGl0ZXJhdGlvbik7CgkJCQkJCQkkaXRlcmF0aW9uKys7CgkJCQkJCX0gZWxzZSB7CgkJCQkJCQlpZiAoISRhZGRlZF9wYWdlKSB7CgkJCQkJCQkJJHRoaXMtPm1wZGYtPkFkZFBhZ2UoJHRoaXMtPm1wZGYtPkN1ck9yaWVudGF0aW9uKTsKCQkJCQkJCQkkYWRkZWRfcGFnZSA9IHRydWU7CgkJCQkJCQkJJHRoaXMtPm1wZGYtPmt3dF9tb3ZlZCA9IHRydWU7CgkJCQkJCQkJJHRoaXMtPm1wZGYtPnRicm90X21heHcgPSAkdGhpcy0+bXBkZi0+aCAtICgkdGhpcy0+bXBkZi0+eSArICR0aGlzLT5tcGRmLT5iTWFyZ2luICsgNSkgLSAkdGhpcy0+bXBkZi0+a3d0X2hlaWdodDsKCQkJCQkJCX0KCQkJCQkJCS8vIDAuMDAxIHRvIGZvcmNlIGl0IHRvIHJlY2FsY3VsYXRlCgkJCQkJCQkkcmVjYWxjdWxhdGUgPSAoMSAvICR0aGlzLT5tcGRmLT5zaHJpbl9rKSArIDAuMDAxOyAgLy8gdW5kbyBhbnkgc2hyaW5rCgkJCQkJCX0KCQkJCQl9IGVsc2UgaWYgKCR0aGlzLT5tcGRmLT50YWJsZV9rZWVwX3RvZ2V0aGVyIHx8ICgkdGhpcy0+bXBkZi0+dGFibGVbMV1bMV1bJ25yJ10gPT0gMSAmJiAhJHRoaXMtPm1wZGYtPndyaXRpbmdIVE1MZm9vdGVyKSkgewoJCQkJCQlpZiAoJHRhYmxlaGVpZ2h0ID4gJGZ1bGxwYWdlKSB7CgkJCQkJCQlpZiAoKCR0aGlzLT5tcGRmLT5zaHJpbl9rICogJHRoaXMtPm1wZGYtPnRic3FydCgkdGFibGVoZWlnaHQgLyAkZnVsbHBhZ2UsICRpdGVyYXRpb24pKSA8PSAkdGhpcy0+bXBkZi0+c2hyaW5rX3RoaXNfdGFibGVfdG9fZml0KSB7CgkJCQkJCQkJJHJlY2FsY3VsYXRlID0gJHRoaXMtPm1wZGYtPnRic3FydCgkdGFibGVoZWlnaHQgLyAkZnVsbHBhZ2UsICRpdGVyYXRpb24pOwoJCQkJCQkJCSRpdGVyYXRpb24rKzsKCQkJCQkJCX0gZWxzZSBpZiAoJHRoaXMtPm1wZGYtPnRhYmxlTWluU2l6ZVByaW9yaXR5KSB7CgkJCQkJCQkJJHRoaXMtPm1wZGYtPnRhYmxlX2tlZXBfdG9nZXRoZXIgPSBmYWxzZTsKCQkJCQkJCQkkcmVjYWxjdWxhdGUgPSAoMSAvICR0aGlzLT5tcGRmLT5zaHJpbl9rKSArIDAuMDAxOwoJCQkJCQkJfSBlbHNlIHsKCQkJCQkJCQlpZiAoISRhZGRlZF9wYWdlICYmICR0aGlzLT5tcGRmLT55ICE9ICR0aGlzLT5tcGRmLT50TWFyZ2luKSB7CgkJCQkJCQkJCSR0aGlzLT5tcGRmLT5BZGRQYWdlKCR0aGlzLT5tcGRmLT5DdXJPcmllbnRhdGlvbik7CgkJCQkJCQkJCSRhZGRlZF9wYWdlID0gdHJ1ZTsKCQkJCQkJCQkJJHRoaXMtPm1wZGYtPmt3dF9tb3ZlZCA9IHRydWU7CgkJCQkJCQkJCSR0aGlzLT5tcGRmLT50YnJvdF9tYXh3ID0gJHRoaXMtPm1wZGYtPmggLSAoJHRoaXMtPm1wZGYtPnkgKyAkdGhpcy0+bXBkZi0+Yk1hcmdpbiArIDUpIC0gJHRoaXMtPm1wZGYtPmt3dF9oZWlnaHQ7CgkJCQkJCQkJfQoJCQkJCQkJCSRyZWNhbGN1bGF0ZSA9ICR0aGlzLT5tcGRmLT50YnNxcnQoJHRhYmxlaGVpZ2h0IC8gJGZ1bGxwYWdlLCAkaXRlcmF0aW9uKTsKCQkJCQkJCQkkaXRlcmF0aW9uKys7CgkJCQkJCQl9CgkJCQkJCX0gZWxzZSBpZiAoJHRhYmxlaGVpZ2h0ID4gJHJlbWFpbmluZ3BhZ2UpIHsKCQkJCQkJCS8vIElmIGNhbiBmaXQgb24gcmVtYWluZGVyIG9mIHBhZ2Ugd2hpbHN0IHJlc3BlY3RpbmcgYXV0b3NpemUgdmFsdWUuLgoJCQkJCQkJaWYgKCgkdGhpcy0+bXBkZi0+c2hyaW5fayAqICR0aGlzLT5tcGRmLT50YnNxcnQoJHRhYmxlaGVpZ2h0IC8gJHJlbWFpbmluZ3BhZ2UsICRpdGVyYXRpb24pKSA8PSAkdGhpcy0+bXBkZi0+c2hyaW5rX3RoaXNfdGFibGVfdG9fZml0KSB7CgkJCQkJCQkJJHJlY2FsY3VsYXRlID0gJHRoaXMtPm1wZGYtPnRic3FydCgkdGFibGVoZWlnaHQgLyAkcmVtYWluaW5ncGFnZSwgJGl0ZXJhdGlvbik7CgkJCQkJCQkJJGl0ZXJhdGlvbisrOwoJCQkJCQkJfSBlbHNlIHsKCQkJCQkJCQlpZiAoISRhZGRlZF9wYWdlKSB7CgkJCQkJCQkJCS8vIG1QREYgNgoJCQkJCQkJCQlpZiAoJHRoaXMtPm1wZGYtPkFjY2VwdFBhZ2VCcmVhaygpKSB7CgkJCQkJCQkJCQkkdGhpcy0+bXBkZi0+QWRkUGFnZSgkdGhpcy0+bXBkZi0+Q3VyT3JpZW50YXRpb24pOwoJCQkJCQkJCQl9IGVsc2UgaWYgKCR0aGlzLT5tcGRmLT5Db2xBY3RpdmUgJiYgJHRhYmxlaGVpZ2h0ID4gKCgkdGhpcy0+bXBkZi0+aCAtICR0aGlzLT5tcGRmLT5iTWFyZ2luKSAtICR0aGlzLT5tcGRmLT55MCkpIHsKCQkJCQkJCQkJCSR0aGlzLT5tcGRmLT5BZGRQYWdlKCR0aGlzLT5tcGRmLT5DdXJPcmllbnRhdGlvbik7CgkJCQkJCQkJCX0KCQkJCQkJCQkJJGFkZGVkX3BhZ2UgPSB0cnVlOwoJCQkJCQkJCQkkdGhpcy0+bXBkZi0+a3d0X21vdmVkID0gdHJ1ZTsKCQkJCQkJCQkJJHRoaXMtPm1wZGYtPnRicm90X21heHcgPSAkdGhpcy0+bXBkZi0+aCAtICgkdGhpcy0+bXBkZi0+eSArICR0aGlzLT5tcGRmLT5iTWFyZ2luICsgNSkgLSAkdGhpcy0+bXBkZi0+a3d0X2hlaWdodDsKCQkJCQkJCQl9CgoJCQkJCQkJCS8vJHJlY2FsY3VsYXRlID0gJHRoaXMtPm1wZGYtPnRic3FydCgkdGFibGVoZWlnaHQgLyAkZnVsbHBhZ2UsICRpdGVyYXRpb24pOyAkaXRlcmF0aW9uKys7CgkJCQkJCQkJJHJlY2FsY3VsYXRlID0gKDEgLyAkdGhpcy0+bXBkZi0+c2hyaW5faykgKyAwLjAwMTsgIC8vIHVuZG8gYW55IHNocmluawoJCQkJCQkJfQoJCQkJCQl9IGVsc2UgewoJCQkJCQkJJHJlY2FsY3VsYXRlID0gMTsKCQkJCQkJfQoJCQkJCX0gZWxzZSB7CgkJCQkJCSRyZWNhbGN1bGF0ZSA9IDE7CgkJCQkJfQoJCQkJfQoKCgkJCQlpZiAoJG1heGZpcnN0cm93aGVpZ2h0ID4gJHJlbWFpbmluZ3BhZ2UgJiYgISRhZGRlZF9wYWdlICYmICEkdGhpcy0+bXBkZi0+dGFibGVfcm90YXRlICYmICEkdGhpcy0+bXBkZi0+Q29sQWN0aXZlICYmICEkdGhpcy0+bXBkZi0+dGFibGVfa2VlcF90b2dldGhlciAmJiAhJHRoaXMtPm1wZGYtPndyaXRpbmdIVE1MaGVhZGVyICYmICEkdGhpcy0+bXBkZi0+d3JpdGluZ0hUTUxmb290ZXIpIHsKCQkJCQkkdGhpcy0+bXBkZi0+QWRkUGFnZSgkdGhpcy0+bXBkZi0+Q3VyT3JpZW50YXRpb24pOwoJCQkJCSR0aGlzLT5tcGRmLT5rd3RfbW92ZWQgPSB0cnVlOwoJCQkJfQoKCQkJCS8vIGtlZXAtd2l0aC10YWJsZTogaWYgcGFnZSBoYXMgYWR2YW5jZWQsIHByaW50IG91dCBidWZmZXIgbm93LCBlbHNlIGRvbmUgaW4gZm4uIF9UYWJsZXdyaXRlKCkKCQkJCWlmICgkdGhpcy0+bXBkZi0+a3d0X3NhdmVkICYmICR0aGlzLT5tcGRmLT5rd3RfbW92ZWQpIHsKCQkJCQkkdGhpcy0+bXBkZi0+cHJpbnRrd3RidWZmZXIoKTsKCQkJCQkkdGhpcy0+bXBkZi0+a3d0X21vdmVkID0gZmFsc2U7CgkJCQkJJHRoaXMtPm1wZGYtPmt3dF9zYXZlZCA9IGZhbHNlOwoJCQkJfQoKCQkJCWlmICgkdGhpcy0+bXBkZi0+cHJvZ3Jlc3NCYXIpIHsKCQkJCQkkdGhpcy0+bXBkZi0+VXBkYXRlUHJvZ3Jlc3NCYXIoNywgMzAsICcgJyk7CgkJCQl9IC8vICpQUk9HUkVTUy1CQVIqCgkJCQkvLyBSZWN1cnNpdmVseSB3cml0ZXMgYWxsIHRhYmxlcyBzdGFydGluZyBhdCB0b3AgbGV2ZWwKCQkJCSR0aGlzLT5tcGRmLT5fdGFibGVXcml0ZSgkdGhpcy0+bXBkZi0+dGFibGVbMV1bMV0pOwoKCQkJCWlmICgkdGhpcy0+bXBkZi0+dGFibGVfcm90YXRlICYmICR0aGlzLT5tcGRmLT50YWJsZWJ1ZmZlcikgewoJCQkJCSR0aGlzLT5tcGRmLT5QYWdlQnJlYWtUcmlnZ2VyID0gJHRoaXMtPm1wZGYtPmggLSAkdGhpcy0+bXBkZi0+Yk1hcmdpbjsKCQkJCQkkc2F2ZV90ciA9ICR0aGlzLT5tcGRmLT50YWJsZV9yb3RhdGU7CgkJCQkJJHNhdmVfeSA9ICR0aGlzLT5tcGRmLT55OwoJCQkJCSR0aGlzLT5tcGRmLT50YWJsZV9yb3RhdGUgPSAwOwoJCQkJCSR0aGlzLT5tcGRmLT55ID0gJHRoaXMtPm1wZGYtPnRicm90X3kwOwoJCQkJCSRoID0gJHRoaXMtPm1wZGYtPnRicm90X3c7CgkJCQkJJHRoaXMtPm1wZGYtPkRpdkxuKCRoLCAkdGhpcy0+bXBkZi0+YmxrbHZsLCB0cnVlKTsKCgkJCQkJJHRoaXMtPm1wZGYtPnRhYmxlX3JvdGF0ZSA9ICRzYXZlX3RyOwoJCQkJCSR0aGlzLT5tcGRmLT55ID0gJHNhdmVfeTsKCgkJCQkJJHRoaXMtPm1wZGYtPnByaW50dGFibGVidWZmZXIoKTsKCQkJCX0KCQkJCSR0aGlzLT5tcGRmLT50YWJsZV9yb3RhdGUgPSAwOwoJCQl9CgoKCQkJJHRoaXMtPm1wZGYtPnggPSAkdGhpcy0+bXBkZi0+bE1hcmdpbiArICR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ291dGVyX2xlZnRfbWFyZ2luJ107CgoJCQkkdGhpcy0+bXBkZi0+bWF4UG9zUiA9IG1heCgkdGhpcy0+bXBkZi0+bWF4UG9zUiwgKCR0aGlzLT5tcGRmLT54ICsgJHRoaXMtPm1wZGYtPnRhYmxlWzFdWzFdWyd3J10pKTsKCgkJCSR0aGlzLT5tcGRmLT5ibG9ja2p1c3RmaW5pc2hlZCA9IHRydWU7CgkJCSR0aGlzLT5tcGRmLT5sYXN0YmxvY2tib3R0b21tYXJnaW4gPSAkdGhpcy0+bXBkZi0+dGFibGVbMV1bMV1bJ21hcmdpbiddWydCJ107CgkJCS8vUmVzZXQgdmFsdWVzCgoJCQlpZiAoaXNzZXQoJHRoaXMtPm1wZGYtPnRhYmxlWzFdWzFdWydwYWdlX2JyZWFrX2FmdGVyJ10pKSB7CgkJCQkkcGFnZV9icmVha19hZnRlciA9ICR0aGlzLT5tcGRmLT50YWJsZVsxXVsxXVsncGFnZV9icmVha19hZnRlciddOwoJCQl9IGVsc2UgewoJCQkJJHBhZ2VfYnJlYWtfYWZ0ZXIgPSAnJzsKCQkJfQoKCQkJLy8gS2VlcC13aXRoLXRhYmxlCgkJCSR0aGlzLT5tcGRmLT5rd3QgPSBmYWxzZTsKCQkJJHRoaXMtPm1wZGYtPmt3dF95MCA9IDA7CgkJCSR0aGlzLT5tcGRmLT5rd3RfeDAgPSAwOwoJCQkkdGhpcy0+bXBkZi0+a3d0X2hlaWdodCA9IDA7CgkJCSR0aGlzLT5tcGRmLT5rd3RfYnVmZmVyID0gYXJyYXkoKTsKCQkJJHRoaXMtPm1wZGYtPmt3dF9MaW5rcyA9IGFycmF5KCk7CgkJCSR0aGlzLT5tcGRmLT5rd3RfQW5ub3RzID0gYXJyYXkoKTsKCQkJJHRoaXMtPm1wZGYtPmt3dF9tb3ZlZCA9IGZhbHNlOwoJCQkkdGhpcy0+bXBkZi0+a3d0X3NhdmVkID0gZmFsc2U7CgoJCQkkdGhpcy0+bXBkZi0+a3d0X1JlZmVyZW5jZSA9IGFycmF5KCk7CgkJCSR0aGlzLT5tcGRmLT5rd3RfQk1vdXRsaW5lcyA9IGFycmF5KCk7CgkJCSR0aGlzLT5tcGRmLT5rd3RfdG9jID0gYXJyYXkoKTsKCgkJCSR0aGlzLT5tcGRmLT5zaHJpbl9rID0gMTsKCQkJJHRoaXMtPm1wZGYtPnNocmlua190aGlzX3RhYmxlX3RvX2ZpdCA9IDA7CgoJCQl1bnNldCgkdGhpcy0+bXBkZi0+dGFibGUpOwoJCQkkdGhpcy0+bXBkZi0+dGFibGUgPSBhcnJheSgpOyAvL2FycmF5CgkJCSR0aGlzLT5tcGRmLT50YWJsZUxldmVsID0gMDsKCQkJJHRoaXMtPm1wZGYtPnRiY3RyID0gYXJyYXkoKTsKCQkJJHRoaXMtPm1wZGYtPmlubmVybW9zdFRhYmxlTGV2ZWwgPSAwOwoJCQkkdGhpcy0+bXBkZi0+Y3NzbWdyLT50YkNTU2x2bCA9IDA7CgkJCSR0aGlzLT5tcGRmLT5jc3NtZ3ItPnRhYmxlY2FzY2FkZUNTUyA9IGFycmF5KCk7CgoJCQl1bnNldCgkdGhpcy0+bXBkZi0+Y2VsbCk7CgkJCSR0aGlzLT5tcGRmLT5jZWxsID0gYXJyYXkoKTsgLy9hcnJheQoKCQkJJHRoaXMtPm1wZGYtPmNvbCA9IC0xOyAvL2ludAoJCQkkdGhpcy0+bXBkZi0+cm93ID0gLTE7IC8vaW50CgkJCSR0aGlzLT5tcGRmLT5SZXNldCgpOwoKCQkJJHRoaXMtPm1wZGYtPmNlbGxQYWRkaW5nTCA9IDA7CgkJCSR0aGlzLT5tcGRmLT5jZWxsUGFkZGluZ1QgPSAwOwoJCQkkdGhpcy0+bXBkZi0+Y2VsbFBhZGRpbmdSID0gMDsKCQkJJHRoaXMtPm1wZGYtPmNlbGxQYWRkaW5nQiA9IDA7CgkJCSR0aGlzLT5tcGRmLT5jTWFyZ2luTCA9IDA7CgkJCSR0aGlzLT5tcGRmLT5jTWFyZ2luVCA9IDA7CgkJCSR0aGlzLT5tcGRmLT5jTWFyZ2luUiA9IDA7CgkJCSR0aGlzLT5tcGRmLT5jTWFyZ2luQiA9IDA7CgkJCSR0aGlzLT5tcGRmLT5kZWZhdWx0X2ZvbnRfc2l6ZSA9ICR0aGlzLT5tcGRmLT5vcmlnaW5hbF9kZWZhdWx0X2ZvbnRfc2l6ZTsKCQkJJHRoaXMtPm1wZGYtPmRlZmF1bHRfZm9udCA9ICR0aGlzLT5tcGRmLT5vcmlnaW5hbF9kZWZhdWx0X2ZvbnQ7CgkJCSR0aGlzLT5tcGRmLT5TZXRGb250U2l6ZSgkdGhpcy0+bXBkZi0+ZGVmYXVsdF9mb250X3NpemUsIGZhbHNlKTsKCQkJJHRoaXMtPm1wZGYtPlNldEZvbnQoJHRoaXMtPm1wZGYtPmRlZmF1bHRfZm9udCwgJycsIDAsIGZhbHNlKTsKCQkJJHRoaXMtPm1wZGYtPlNldExpbmVIZWlnaHQoKTsKCQkJaWYgKGlzc2V0KCR0aGlzLT5tcGRmLT5ibGtbJHRoaXMtPm1wZGYtPmJsa2x2bF1bJ0lubGluZVByb3BlcnRpZXMnXSkpIHsKCQkJCSR0aGlzLT5tcGRmLT5yZXN0b3JlSW5saW5lUHJvcGVydGllcygkdGhpcy0+bXBkZi0+YmxrWyR0aGlzLT5tcGRmLT5ibGtsdmxdWydJbmxpbmVQcm9wZXJ0aWVzJ10pOwoJCQl9CgkJCWlmICgkdGhpcy0+bXBkZi0+cHJvZ3Jlc3NCYXIpIHsKCQkJCSR0aGlzLT5tcGRmLT5VcGRhdGVQcm9ncmVzc0Jhcig3LCAxMDAsICcgJyk7CgkJCX0gLy8gKlBST0dSRVNTLUJBUioKCgkJCWlmICgkcGFnZV9icmVha19hZnRlcikgewoJCQkJJHNhdmVfYmxrbHZsID0gJHRoaXMtPm1wZGYtPmJsa2x2bDsKCQkJCSRzYXZlX2JsayA9ICR0aGlzLT5tcGRmLT5ibGs7CgkJCQkkc2F2ZV9zaWxwID0gJHRoaXMtPm1wZGYtPnNhdmVJbmxpbmVQcm9wZXJ0aWVzKCk7CgkJCQkkc2F2ZV9pbHAgPSAkdGhpcy0+bXBkZi0+SW5saW5lUHJvcGVydGllczsKCQkJCSRzYXZlX2JmbHAgPSAkdGhpcy0+bXBkZi0+SW5saW5lQkRGOwoJCQkJJHNhdmVfYmZscGMgPSAkdGhpcy0+bXBkZi0+SW5saW5lQkRGY3RyOyAvLyBtUERGIDYKCQkJCS8vIG1QREYgNiBwYWdlYnJlYWt0eXBlCgkJCQkkc3RhcnRwYWdlID0gJHRoaXMtPm1wZGYtPnBhZ2U7CgkJCQkkcGFnZWJyZWFrdHlwZSA9ICR0aGlzLT5tcGRmLT5kZWZhdWx0UGFnZWJyZWFrVHlwZTsKCQkJCWlmICgkdGhpcy0+bXBkZi0+Q29sQWN0aXZlKSB7CgkJCQkJJHBhZ2VicmVha3R5cGUgPSAnY2xvbmVhbGwnOwoJCQkJfQoKCQkJCS8vIG1QREYgNiBwYWdlYnJlYWt0eXBlCgkJCQkkdGhpcy0+bXBkZi0+X3ByZUZvcmNlZFBhZ2VicmVhaygkcGFnZWJyZWFrdHlwZSk7CgoJCQkJaWYgKCRwYWdlX2JyZWFrX2FmdGVyID09ICdSSUdIVCcpIHsKCQkJCQkkdGhpcy0+bXBkZi0+QWRkUGFnZSgkdGhpcy0+bXBkZi0+Q3VyT3JpZW50YXRpb24sICdORVhULU9ERCcsICcnLCAnJywgJycsICcnLCAnJywgJycsICcnLCAnJywgJycsICcnLCAnJywgJycsICcnLCAwLCAwLCAwLCAwKTsKCQkJCX0gZWxzZSBpZiAoJHBhZ2VfYnJlYWtfYWZ0ZXIgPT0gJ0xFRlQnKSB7CgkJCQkJJHRoaXMtPm1wZGYtPkFkZFBhZ2UoJHRoaXMtPm1wZGYtPkN1ck9yaWVudGF0aW9uLCAnTkVYVC1FVkVOJywgJycsICcnLCAnJywgJycsICcnLCAnJywgJycsICcnLCAnJywgJycsICcnLCAnJywgJycsIDAsIDAsIDAsIDApOwoJCQkJfSBlbHNlIHsKCQkJCQkkdGhpcy0+bXBkZi0+QWRkUGFnZSgkdGhpcy0+bXBkZi0+Q3VyT3JpZW50YXRpb24sICcnLCAnJywgJycsICcnLCAnJywgJycsICcnLCAnJywgJycsICcnLCAnJywgJycsICcnLCAnJywgMCwgMCwgMCwgMCk7CgkJCQl9CgoJCQkJLy8gbVBERiA2IHBhZ2VicmVha3R5cGUKCQkJCSR0aGlzLT5tcGRmLT5fcG9zdEZvcmNlZFBhZ2VicmVhaygkcGFnZWJyZWFrdHlwZSwgJHN0YXJ0cGFnZSwgJHNhdmVfYmxrLCAkc2F2ZV9ibGtsdmwpOwoKCQkJCSR0aGlzLT5tcGRmLT5JbmxpbmVQcm9wZXJ0aWVzID0gJHNhdmVfaWxwOwoJCQkJJHRoaXMtPm1wZGYtPklubGluZUJERiA9ICRzYXZlX2JmbHA7CgkJCQkkdGhpcy0+bXBkZi0+SW5saW5lQkRGY3RyID0gJHNhdmVfYmZscGM7IC8vIG1QREYgNgoJCQkJJHRoaXMtPm1wZGYtPnJlc3RvcmVJbmxpbmVQcm9wZXJ0aWVzKCRzYXZlX3NpbHApOwoJCQl9CgkJfQoJCS8qIC0tIEVORCBUQUJMRVMgLS0gKi8KCX0KCn0KIjtzOjQ1OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlAG5hbWVzcGFjZXMiO2E6MDp7fXM6NDM6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXEZpbGUAaW5jbHVkZXMiO2E6MDp7fXM6NDQ6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXEZpbGUAZnVuY3Rpb25zIjthOjA6e31zOjQ0OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlAGNvbnN0YW50cyI7YTowOnt9czo0MjoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcRmlsZQBjbGFzc2VzIjthOjE6e3M6NDoiXFRhZyI7TzozNToicGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxDbGFzc18iOjEzOntzOjQyOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxDbGFzc18AZnFzZW4iO086MzA6InBocERvY3VtZW50b3JcUmVmbGVjdGlvblxGcXNlbiI6Mjp7czozNzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxGcXNlbgBmcXNlbiI7czo0OiJcVGFnIjtzOjM2OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXEZxc2VuAG5hbWUiO3M6MzoiVGFnIjt9czo0NToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcQ2xhc3NfAGRvY0Jsb2NrIjtOO3M6NDU6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXENsYXNzXwBhYnN0cmFjdCI7YjowO3M6NDI6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXENsYXNzXwBmaW5hbCI7YjowO3M6NDM6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXENsYXNzXwBwYXJlbnQiO047czo0NzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcQ2xhc3NfAGltcGxlbWVudHMiO2E6MDp7fXM6NDY6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXENsYXNzXwBjb25zdGFudHMiO2E6MDp7fXM6NDc6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXENsYXNzXwBwcm9wZXJ0aWVzIjthOjE6e3M6MTE6IlxUYWc6OiRtcGRmIjtPOjM3OiJwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXFByb3BlcnR5IjoxMTp7czo0NDoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcUHJvcGVydHkAZnFzZW4iO086MzA6InBocERvY3VtZW50b3JcUmVmbGVjdGlvblxGcXNlbiI6Mjp7czozNzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxGcXNlbgBmcXNlbiI7czoxMToiXFRhZzo6JG1wZGYiO3M6MzY6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cRnFzZW4AbmFtZSI7czo0OiJtcGRmIjt9czo0NzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcUHJvcGVydHkAZG9jQmxvY2siO047czo0NDoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcUHJvcGVydHkAdHlwZXMiO2E6MDp7fXM6NDY6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXFByb3BlcnR5AGRlZmF1bHQiO047czo0NToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcUHJvcGVydHkAc3RhdGljIjtiOjA7czo0OToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcUHJvcGVydHkAdmlzaWJpbGl0eSI7TzozOToicGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxWaXNpYmlsaXR5IjoxOntzOjUxOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxWaXNpYmlsaXR5AHZpc2liaWxpdHkiO3M6NzoicHJpdmF0ZSI7fXM6NDc6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXFByb3BlcnR5AGxvY2F0aW9uIjtPOjMzOiJwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cTG9jYXRpb24iOjI6e3M6NDU6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cTG9jYXRpb24AbGluZU51bWJlciI7aTo2O3M6NDc6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cTG9jYXRpb24AY29sdW1uTnVtYmVyIjtpOjA7fXM6NTA6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXFByb3BlcnR5AGVuZExvY2F0aW9uIjtPOjMzOiJwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cTG9jYXRpb24iOjI6e3M6NDU6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cTG9jYXRpb24AbGluZU51bWJlciI7aTo2O3M6NDc6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cTG9jYXRpb24AY29sdW1uTnVtYmVyIjtpOjA7fXM6NDM6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXFByb3BlcnR5AHR5cGUiO047czo0NzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcUHJvcGVydHkAcmVhZE9ubHkiO2I6MDtzOjQ3OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxQcm9wZXJ0eQBtZXRhZGF0YSI7YTowOnt9fX1zOjQ0OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxDbGFzc18AbWV0aG9kcyI7YTozOntzOjE5OiJcVGFnOjpfX2NvbnN0cnVjdCgpIjtPOjM1OiJwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXE1ldGhvZCI6MTI6e3M6NDU6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXE1ldGhvZABkb2NCbG9jayI7TjtzOjQyOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxNZXRob2QAZnFzZW4iO086MzA6InBocERvY3VtZW50b3JcUmVmbGVjdGlvblxGcXNlbiI6Mjp7czozNzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxGcXNlbgBmcXNlbiI7czoxOToiXFRhZzo6X19jb25zdHJ1Y3QoKSI7czozNjoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxGcXNlbgBuYW1lIjtzOjExOiJfX2NvbnN0cnVjdCI7fXM6NDU6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXE1ldGhvZABhYnN0cmFjdCI7YjowO3M6NDI6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXE1ldGhvZABmaW5hbCI7YjowO3M6NDM6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXE1ldGhvZABzdGF0aWMiO2I6MDtzOjQ3OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxNZXRob2QAdmlzaWJpbGl0eSI7TzozOToicGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxWaXNpYmlsaXR5IjoxOntzOjUxOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxWaXNpYmlsaXR5AHZpc2liaWxpdHkiO3M6NjoicHVibGljIjt9czo0NjoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcTWV0aG9kAGFyZ3VtZW50cyI7YToxOntpOjA7TzozNzoicGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxBcmd1bWVudCI6NTp7czo0MzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcQXJndW1lbnQAbmFtZSI7czo0OiJtcGRmIjtzOjQzOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxBcmd1bWVudAB0eXBlIjtPOjM4OiJwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cVHlwZXNcT2JqZWN0XyI6MTp7czo0NToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxUeXBlc1xPYmplY3RfAGZxc2VuIjtPOjMwOiJwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cRnFzZW4iOjI6e3M6Mzc6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cRnFzZW4AZnFzZW4iO3M6NToiXG1QREYiO3M6MzY6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cRnFzZW4AbmFtZSI7czo0OiJtUERGIjt9fXM6NDY6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXEFyZ3VtZW50AGRlZmF1bHQiO047czo1MDoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcQXJndW1lbnQAYnlSZWZlcmVuY2UiO2I6MDtzOjQ5OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxBcmd1bWVudABpc1ZhcmlhZGljIjtiOjA7fX1zOjQ1OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxNZXRob2QAbG9jYXRpb24iO086MzM6InBocERvY3VtZW50b3JcUmVmbGVjdGlvblxMb2NhdGlvbiI6Mjp7czo0NToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxMb2NhdGlvbgBsaW5lTnVtYmVyIjtpOjg7czo0NzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxMb2NhdGlvbgBjb2x1bW5OdW1iZXIiO2k6MDt9czo0ODoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcTWV0aG9kAGVuZExvY2F0aW9uIjtPOjMzOiJwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cTG9jYXRpb24iOjI6e3M6NDU6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cTG9jYXRpb24AbGluZU51bWJlciI7aToxMTtzOjQ3OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXExvY2F0aW9uAGNvbHVtbk51bWJlciI7aTowO31zOjQ3OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxNZXRob2QAcmV0dXJuVHlwZSI7TzozNzoicGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFR5cGVzXE1peGVkXyI6MDp7fXM6NTc6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXE1ldGhvZABoYXNSZXR1cm5CeVJlZmVyZW5jZSI7YjowO3M6NDU6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXE1ldGhvZABtZXRhZGF0YSI7YTowOnt9fXM6MTU6IlxUYWc6Ok9wZW5UYWcoKSI7TzozNToicGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxNZXRob2QiOjEyOntzOjQ1OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxNZXRob2QAZG9jQmxvY2siO047czo0MjoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcTWV0aG9kAGZxc2VuIjtPOjMwOiJwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cRnFzZW4iOjI6e3M6Mzc6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cRnFzZW4AZnFzZW4iO3M6MTU6IlxUYWc6Ok9wZW5UYWcoKSI7czozNjoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxGcXNlbgBuYW1lIjtzOjc6Ik9wZW5UYWciO31zOjQ1OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxNZXRob2QAYWJzdHJhY3QiO2I6MDtzOjQyOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxNZXRob2QAZmluYWwiO2I6MDtzOjQzOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxNZXRob2QAc3RhdGljIjtiOjA7czo0NzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcTWV0aG9kAHZpc2liaWxpdHkiO086Mzk6InBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcVmlzaWJpbGl0eSI6MTp7czo1MToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcVmlzaWJpbGl0eQB2aXNpYmlsaXR5IjtzOjY6InB1YmxpYyI7fXM6NDY6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXE1ldGhvZABhcmd1bWVudHMiO2E6NDp7aTowO086Mzc6InBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcQXJndW1lbnQiOjU6e3M6NDM6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXEFyZ3VtZW50AG5hbWUiO3M6MzoidGFnIjtzOjQzOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxBcmd1bWVudAB0eXBlIjtPOjM3OiJwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cVHlwZXNcTWl4ZWRfIjowOnt9czo0NjoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcQXJndW1lbnQAZGVmYXVsdCI7TjtzOjUwOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxBcmd1bWVudABieVJlZmVyZW5jZSI7YjowO3M6NDk6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXEFyZ3VtZW50AGlzVmFyaWFkaWMiO2I6MDt9aToxO086Mzc6InBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcQXJndW1lbnQiOjU6e3M6NDM6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXEFyZ3VtZW50AG5hbWUiO3M6NDoiYXR0ciI7czo0MzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcQXJndW1lbnQAdHlwZSI7TzozNzoicGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFR5cGVzXE1peGVkXyI6MDp7fXM6NDY6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXEFyZ3VtZW50AGRlZmF1bHQiO047czo1MDoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcQXJndW1lbnQAYnlSZWZlcmVuY2UiO2I6MDtzOjQ5OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxBcmd1bWVudABpc1ZhcmlhZGljIjtiOjA7fWk6MjtPOjM3OiJwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXEFyZ3VtZW50Ijo1OntzOjQzOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxBcmd1bWVudABuYW1lIjtzOjU6ImFodG1sIjtzOjQzOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxBcmd1bWVudAB0eXBlIjtPOjM3OiJwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cVHlwZXNcTWl4ZWRfIjowOnt9czo0NjoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcQXJndW1lbnQAZGVmYXVsdCI7TjtzOjUwOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxBcmd1bWVudABieVJlZmVyZW5jZSI7YjoxO3M6NDk6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXEFyZ3VtZW50AGlzVmFyaWFkaWMiO2I6MDt9aTozO086Mzc6InBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcQXJndW1lbnQiOjU6e3M6NDM6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXEFyZ3VtZW50AG5hbWUiO3M6NToiaWh0bWwiO3M6NDM6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXEFyZ3VtZW50AHR5cGUiO086Mzc6InBocERvY3VtZW50b3JcUmVmbGVjdGlvblxUeXBlc1xNaXhlZF8iOjA6e31zOjQ2OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxBcmd1bWVudABkZWZhdWx0IjtOO3M6NTA6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXEFyZ3VtZW50AGJ5UmVmZXJlbmNlIjtiOjE7czo0OToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcQXJndW1lbnQAaXNWYXJpYWRpYyI7YjowO319czo0NToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcTWV0aG9kAGxvY2F0aW9uIjtPOjMzOiJwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cTG9jYXRpb24iOjI6e3M6NDU6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cTG9jYXRpb24AbGluZU51bWJlciI7aToxMztzOjQ3OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXExvY2F0aW9uAGNvbHVtbk51bWJlciI7aTowO31zOjQ4OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxNZXRob2QAZW5kTG9jYXRpb24iO086MzM6InBocERvY3VtZW50b3JcUmVmbGVjdGlvblxMb2NhdGlvbiI6Mjp7czo0NToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxMb2NhdGlvbgBsaW5lTnVtYmVyIjtpOjQ3MDM7czo0NzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxMb2NhdGlvbgBjb2x1bW5OdW1iZXIiO2k6MDt9czo0NzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcTWV0aG9kAHJldHVyblR5cGUiO086Mzc6InBocERvY3VtZW50b3JcUmVmbGVjdGlvblxUeXBlc1xNaXhlZF8iOjA6e31zOjU3OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxNZXRob2QAaGFzUmV0dXJuQnlSZWZlcmVuY2UiO2I6MDtzOjQ1OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxNZXRob2QAbWV0YWRhdGEiO2E6MDp7fX1zOjE2OiJcVGFnOjpDbG9zZVRhZygpIjtPOjM1OiJwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXE1ldGhvZCI6MTI6e3M6NDU6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXE1ldGhvZABkb2NCbG9jayI7TjtzOjQyOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxNZXRob2QAZnFzZW4iO086MzA6InBocERvY3VtZW50b3JcUmVmbGVjdGlvblxGcXNlbiI6Mjp7czozNzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxGcXNlbgBmcXNlbiI7czoxNjoiXFRhZzo6Q2xvc2VUYWcoKSI7czozNjoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxGcXNlbgBuYW1lIjtzOjg6IkNsb3NlVGFnIjt9czo0NToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcTWV0aG9kAGFic3RyYWN0IjtiOjA7czo0MjoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcTWV0aG9kAGZpbmFsIjtiOjA7czo0MzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcTWV0aG9kAHN0YXRpYyI7YjowO3M6NDc6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXE1ldGhvZAB2aXNpYmlsaXR5IjtPOjM5OiJwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXFZpc2liaWxpdHkiOjE6e3M6NTE6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXFZpc2liaWxpdHkAdmlzaWJpbGl0eSI7czo2OiJwdWJsaWMiO31zOjQ2OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxNZXRob2QAYXJndW1lbnRzIjthOjM6e2k6MDtPOjM3OiJwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXEFyZ3VtZW50Ijo1OntzOjQzOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxBcmd1bWVudABuYW1lIjtzOjM6InRhZyI7czo0MzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcQXJndW1lbnQAdHlwZSI7TzozNzoicGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFR5cGVzXE1peGVkXyI6MDp7fXM6NDY6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXEFyZ3VtZW50AGRlZmF1bHQiO047czo1MDoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcQXJndW1lbnQAYnlSZWZlcmVuY2UiO2I6MDtzOjQ5OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxBcmd1bWVudABpc1ZhcmlhZGljIjtiOjA7fWk6MTtPOjM3OiJwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXEFyZ3VtZW50Ijo1OntzOjQzOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxBcmd1bWVudABuYW1lIjtzOjU6ImFodG1sIjtzOjQzOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxBcmd1bWVudAB0eXBlIjtPOjM3OiJwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cVHlwZXNcTWl4ZWRfIjowOnt9czo0NjoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcQXJndW1lbnQAZGVmYXVsdCI7TjtzOjUwOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxBcmd1bWVudABieVJlZmVyZW5jZSI7YjoxO3M6NDk6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXEFyZ3VtZW50AGlzVmFyaWFkaWMiO2I6MDt9aToyO086Mzc6InBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcQXJndW1lbnQiOjU6e3M6NDM6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXEFyZ3VtZW50AG5hbWUiO3M6NToiaWh0bWwiO3M6NDM6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXEFyZ3VtZW50AHR5cGUiO086Mzc6InBocERvY3VtZW50b3JcUmVmbGVjdGlvblxUeXBlc1xNaXhlZF8iOjA6e31zOjQ2OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxBcmd1bWVudABkZWZhdWx0IjtOO3M6NTA6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXEFyZ3VtZW50AGJ5UmVmZXJlbmNlIjtiOjE7czo0OToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcQXJndW1lbnQAaXNWYXJpYWRpYyI7YjowO319czo0NToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcTWV0aG9kAGxvY2F0aW9uIjtPOjMzOiJwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cTG9jYXRpb24iOjI6e3M6NDU6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cTG9jYXRpb24AbGluZU51bWJlciI7aTo0NzA1O3M6NDc6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cTG9jYXRpb24AY29sdW1uTnVtYmVyIjtpOjA7fXM6NDg6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXE1ldGhvZABlbmRMb2NhdGlvbiI7TzozMzoicGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXExvY2F0aW9uIjoyOntzOjQ1OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXExvY2F0aW9uAGxpbmVOdW1iZXIiO2k6NjExNjtzOjQ3OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXExvY2F0aW9uAGNvbHVtbk51bWJlciI7aTowO31zOjQ3OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxNZXRob2QAcmV0dXJuVHlwZSI7TzozNzoicGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFR5cGVzXE1peGVkXyI6MDp7fXM6NTc6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXE1ldGhvZABoYXNSZXR1cm5CeVJlZmVyZW5jZSI7YjowO3M6NDU6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXE1ldGhvZABtZXRhZGF0YSI7YTowOnt9fX1zOjQ3OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxDbGFzc18AdXNlZFRyYWl0cyI7YTowOnt9czo0NToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcQ2xhc3NfAGxvY2F0aW9uIjtPOjMzOiJwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cTG9jYXRpb24iOjI6e3M6NDU6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cTG9jYXRpb24AbGluZU51bWJlciI7aTozO3M6NDc6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cTG9jYXRpb24AY29sdW1uTnVtYmVyIjtpOjA7fXM6NDg6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXENsYXNzXwBlbmRMb2NhdGlvbiI7TzozMzoicGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXExvY2F0aW9uIjoyOntzOjQ1OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXExvY2F0aW9uAGxpbmVOdW1iZXIiO2k6NjExODtzOjQ3OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXExvY2F0aW9uAGNvbHVtbk51bWJlciI7aTowO31zOjQ1OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxDbGFzc18AbWV0YWRhdGEiO2E6MDp7fX19czo0NToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcRmlsZQBpbnRlcmZhY2VzIjthOjA6e31zOjQxOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlAHRyYWl0cyI7YTowOnt9czo0MDoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcRmlsZQBlbnVtcyI7YTowOnt9czo0MzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcRmlsZQBtZXRhZGF0YSI7YTowOnt9fQ==";